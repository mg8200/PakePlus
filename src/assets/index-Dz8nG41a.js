import{_ as a}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{_ as e}from"./round-delete-DScxCu5A.js";import{_ as l}from"./round-add-MytOGm9O.js";import{_ as t}from"./common-search.vue_vue_type_script_setup_true_lang-BX9APgbN.js";import{g as s,Y as n,Z as i,df as o,r,a0 as p,o as u,e as c,W as d,w as m,f as v,i as f,h as g,J as y,cF as _,c as h,aj as b,al as w,t as k,a1 as x,a5 as j,B as S,N as z,Q as O,cH as P,cI as R}from"./index-B3PZsRwT.js";import{E as U}from"./index-Dbr53s25.js";import"./index-BThgVJ70.js";import"./use-form-common-props-DQAdjfyv.js";import"./fromPairs-BI-MgVCs.js";var I={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function V(a){for(var e=1;e<arguments.length;e++){var l=null!=arguments[e]?Object(arguments[e]):{},t=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(l).filter((function(a){return Object.getOwnPropertyDescriptor(l,a).enumerable})))),t.forEach((function(e){M(a,e,l[e])}))}return a}function M(a,e,l){return e in a?Object.defineProperty(a,e,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[e]=l,a}var D=function(a,e){var l=V({},a,e.attrs);return s(n,V({},l,{icon:I}),null)};D.displayName="InboxOutlined",D.inheritAttrs=!1;const H={class:"event-form"},Y={class:"upload-drag-icon"},C=y({__name:"add",props:{rowData:{type:Object,default:()=>null}},setup(a,{expose:e}){const l=a,t=r(null);const n=r(function(){if(l.rowData){const{appVersion:a,appUpdateInfo:e,appRemark:t,appSize:s}=l.rowData;return{appVersion:a,appUpdateInfo:e,appRemark:t,appSize:s,appName:"MES生产执行系统"}}return{appVersion:null,appUpdateInfo:null,appRemark:null,appSize:null,appName:"MES生产执行系统"}}()),i=[{type:"tabs",name:"基本信息",span:24},{type:"input",key:"appVersion",label:"版本号",placeholder:"请输入版本号",span:24,rule:{required:!0,message:"请输入版本号",trigger:"change"}},{type:"textarea",key:"appUpdateInfo",label:"更新信息",placeholder:"请输入更新信息",span:24},{type:"textarea",key:"appRemark",label:"备注",placeholder:"请输入备注",span:24},{type:"tabs",name:"APP包",span:24}],o=r([]);function y(a,e){}const _=r(null);const h=a=>!1;return p((()=>o.value),(a=>{n.value.appSize="".concat((a[0].size/1024/1024).toFixed(2),"MB")}),{deep:!0}),e({model:n.value,fileList:o,validateForm:async function(){await t.value.validateForm()}}),(a,e)=>(u(),c("div",H,[s(d,{ref_key:"formRef",ref:t,model:n.value,"onUpdate:model":e[0]||(e[0]=a=>n.value=a),"form-list":i},null,8,["model"]),s(f(U),{ref_key:"uploadRef",ref:_,"file-list":o.value,"onUpdate:fileList":e[1]||(e[1]=a=>o.value=a),limit:1,accept:".apk","auto-upload":!1,drag:"","before-upload":h,"on-change":y},{default:m((()=>[v("p",Y,[s(f(D))]),e[2]||(e[2]=v("div",{class:"el-upload__text"},[g(" 将文件拖到此处，或 "),v("em",null,"点击上传")],-1))])),_:1},8,["file-list"])]))}},[["__scopeId","data-v-931e7207"]]),E={class:"app-version h-full w-full"},N={class:"item"},L={class:"left"},T={class:"data"},F={class:"value"},B={class:"data"},A={class:"value"},$={class:"data"},q={class:"value"},G={class:"data"},J=["title"],Q={class:"data"},W={class:"value"},Z={class:"right"},K=["src"],X={class:"operation"},aa={class:"pagination"},ea={class:"modal-footer"},la=y(Object.assign({name:"manage_app-version-manage"},{__name:"index",setup(n){const p=_.PRESENTED_IMAGE_SIMPLE,d=r(null),y=r({time:null}),U=[{type:"dateRangePicker",key:"time",label:"时间",span:24,md:12,lg:10,xl:8,xxl:6,showTime:!0}],I=r(0),V=r(1),M=r(20),D=r(["20","50","100"]),H=r(null),Y=r([]),la=r(!1);function ta(a,e){V.value=a,M.value=e,H.value.scrollTop=0}async function sa(){var a,e;const l={pageNum:V.value,pageSize:M.value};(null==(e=null==(a=y.value)?void 0:a.time)?void 0:e[0])&&(l.beginTime=dayjs(y.value.time[0]).format("YYYY-MM-DD HH:mm:ss"),l.endTime=dayjs(y.value.time[1]).format("YYYY-MM-DD HH:mm:ss")),la.value=!0;try{const{data:a,error:e}=await function(a){return i({url:"/mes/mes-pda-application/list",method:"get",params:a})}(l);e||(Y.value=a.list,I.value=a.total)}finally{la.value=!1}}function na(){sa()}function ia(){j((()=>{y.value={appName:null,time:null},na()}))}const oa=r(!1),ra=r("add"),pa=r(!1),ua=r(null),ca=r(null);function da(){oa.value=!1}async function ma(){const a={...ca.value},e={...a.model};var l,t;await a.validateForm(),pa.value=!0,(l=e,t=a.fileList,o({url:"/mes/mes-pda-application/add/new",method:"POST",data:l,files:t})).then((({error:a})=>{a||(window.$message.success("上传成功"),ia(),da())})).finally((()=>pa.value=!1))}function va(a){window.$modal.confirm({title:"确定删除版本号为V".concat(a.appVersion,"的应用吗？"),onOk:async()=>{const{error:e}=await(l=[a.appFileUuid],i({url:"/mes/mes-pda-application/deleteBatch",method:"post",data:l}));var l;e||(window.$message.success("删除成功"),ia())},onCancel:()=>{}})}return sa(),(n,i)=>{const o=l,r=S,j=e,sa=z,fa=O,ga=_,ya=P,_a=R,ha=a;return u(),c("div",E,[s(t,{ref_key:"commonSearchRef",ref:d,searchParams:y.value,"onUpdate:searchParams":i[1]||(i[1]=a=>y.value=a),"form-list":U,"is-search":!0,onSearch:na,onReset:ia},{other:m((()=>[s(r,{type:"primary",ghost:"",class:"mini-btn mr-8px",onClick:i[0]||(i[0]=a=>{return e="add",ra.value=e,void(oa.value=!0);var e})},{icon:m((()=>[s(o,{class:"align-sub text-icon"})])),default:m((()=>[i[5]||(i[5]=v("span",{class:"ml-3px"},"新增",-1))])),_:1})])),_:1},8,["searchParams"]),v("div",{ref_key:"listContentRef",ref:H,class:x(["list-content w-full",Y.value.length?"":"empty-list"])},[s(ya,{tip:"数据加载中...",spinning:la.value},{default:m((()=>[Y.value.length?(u(),h(fa,{key:0,gutter:16},{default:m((()=>[(u(!0),c(b,null,w(Y.value,((a,e)=>(u(),h(sa,{key:e,lg:12,xl:8,xxl:6},{default:m((()=>[v("div",N,[v("div",L,[v("div",T,[i[6]||(i[6]=v("div",{class:"label"},"版本号",-1)),v("div",F,"V"+k(a.appVersion),1)]),v("div",B,[i[7]||(i[7]=v("div",{class:"label"},"上传时间",-1)),v("div",A,k(a.createTime),1)]),v("div",$,[i[8]||(i[8]=v("div",{class:"label"},"包体积",-1)),v("div",q,k(a.appSize),1)]),v("div",G,[i[9]||(i[9]=v("div",{class:"label"},"更新信息",-1)),v("div",{class:"value",title:a.appUpdateInfo},k(a.appUpdateInfo),9,J)]),v("div",Q,[i[10]||(i[10]=v("div",{class:"label"},"备注信息",-1)),v("div",W,k(a.appRemark),1)])]),v("div",Z,[v("img",{src:f("/assets/Android-DftwRjSY.png"),alt:""},null,8,K)]),v("div",X,[s(j,{class:"cursor-pointer align-sub text-icon color-red",onClick:e=>va(a)},null,8,["onClick"])])])])),_:2},1024)))),128))])),_:1})):(u(),h(ga,{key:1,image:f(p)},null,8,["image"]))])),_:1},8,["spinning"])],2),v("div",aa,[s(_a,{current:V.value,"onUpdate:current":i[2]||(i[2]=a=>V.value=a),"page-size":M.value,"onUpdate:pageSize":i[3]||(i[3]=a=>M.value=a),"show-size-changer":"","show-quick-jumper":"",total:I.value,"page-size-options":D.value,onChange:ta},null,8,["current","page-size","total","page-size-options"])]),s(ha,{visible:oa.value,"onUpdate:visible":i[4]||(i[4]=a=>oa.value=a),title:"".concat("add"==ra.value?"新增":"修改","版本信息"),height:"650px",width:"700px","destroy-on-close":!0,onClose:da},{footer:m((()=>[v("div",ea,[s(r,{type:"primary",loading:pa.value,onClick:ma},{default:m((()=>i[11]||(i[11]=[g("提 交")]))),_:1},8,["loading"]),s(r,{onClick:da},{default:m((()=>i[12]||(i[12]=[g("关 闭")]))),_:1})])])),default:m((()=>[s(C,{ref_key:"addRef",ref:ca,"row-data":ua.value},null,8,["row-data"])])),_:1},8,["visible","title"])])}}}),[["__scopeId","data-v-92066cd9"]]);export{la as default};
