import{_ as e}from"./table-DoFSI9NT.js";import{_ as a}from"./common-search.vue_vue_type_script_setup_true_lang-BX9APgbN.js";import{J as t,r as l,aa as s,j as r,a0 as n,o,e as i,f as c,a3 as d,e1 as u,aj as m,al as p,t as v,i as h,c as g,w as y,h as f,a1 as x,b as k,g as w,a5 as b}from"./index-B3PZsRwT.js";import"./index-C0RlPYe-.js";import{a as _}from"./index-DqnulfE2.js";import{C as I}from"./index-BThgVJ70.js";import{r as N}from"./installCanvasRenderer-Dfk03Uyn.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import"./api-By23aosn.js";const A={class:"chart-container"},j={class:"month"},Y={class:"year-selector"},P=["value"],C=t({__name:"day-echarts",setup(e){const a=l(),t=s(),k=l(t.year()),w=l(t.month());let b;const C=l(Array.from({length:12}).fill(0).map(((e,a)=>a+1>9?"".concat(k.value,"-").concat(a+1):"".concat(k.value,"-0").concat(a+1)))),D=l(C.value[w.value]),R=e=>{_("/erpsyncmes/baseData/bugRequestLog/view/imageDatas",{yearMonth:"".concat(e)}).then((a=>{const t=a.data.filter((e=>e.bugLogViewdetails.length>0)),l={title:{text:"月度缺陷数量统计（".concat(e,"）月"),left:"center",top:10},toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},dataZoom:[{type:"inside",start:0,end:30},{start:0,end:30}],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{left:"center",top:30},xAxis:{type:"category",data:t.map((e=>e.day))},yAxis:{type:"value",name:"单位（PCS）",nameGap:25,nameTextStyle:{fontSize:16},axisLine:{show:!0,symbol:["none","arrow"],symbolSize:[6,7]}},series:[0,1,2].map((e=>({type:"bar",label:{show:!0,position:"top",textStyle:{fontSize:"12px",color:"grey"}},data:t.map(((a,t)=>[t,a.bugLogViewdetails[e].pcsQty,a.bugLogViewdetails[e].ltBugName])),encode:{tooltip:[2,1]}})))};0===t.length&&(l.title.text="月度缺陷数量统计（".concat(e.slice(5)," 月） - 暂无数据"),l.series=[],l.graphic=[{type:"text",left:"center",top:"center"}]),b.setOption(l)}))};return r((()=>{b=N(a.value),window.addEventListener("resize",b.resize);Array.from({length:t.year()-2020+1},((e,a)=>2020+a)),k.value=t.year(),C.value=Array.from({length:12}).fill(0).map(((e,a)=>a+1>9?"".concat(k.value,"-").concat(a+1):"".concat(k.value,"-0").concat(a+1))),w.value=t.month(),D.value=C.value[w.value];const e=t.format("YYYY-MM"),l=C.value.indexOf(e);-1!==l?(D.value=C.value[l],w.value=l,R(e)):R(C.value[0])})),n(k,(e=>{C.value=Array.from({length:12}).fill(0).map(((a,t)=>t+1>9?"".concat(e,"-").concat(t+1):"".concat(e,"-0").concat(t+1))),w.value=t.year()===e?t.month():0,D.value=C.value[w.value],R(D.value)})),(e,l)=>{const s=I;return o(),i("div",A,[c("div",j,[c("div",Y,[d(c("select",{"onUpdate:modelValue":l[0]||(l[0]=e=>k.value=e),onChange:l[1]||(l[1]=e=>{return a=k.value,k.value=a,C.value=Array.from({length:12}).fill(0).map(((e,t)=>t+1>9?"".concat(a,"-").concat(t+1):"".concat(a,"-0").concat(t+1))),w.value=t.year()===a?t.month():0,D.value=C.value[w.value],void R(D.value);var a})},[(o(!0),i(m,null,p(Array.from({length:h(t).year()-2020+1},((e,a)=>2020+a)),(e=>(o(),i("option",{key:e,value:e,class:"year-options"},v(e),9,P)))),128))],544),[[u,k.value]])]),(o(!0),i(m,null,p(C.value,((e,a)=>(o(),g(s,{key:a,title:"",class:x(["month-item iconfont icon-keshihuakanban",{active:a===w.value}]),onClick:a=>(e=>{D.value=e,w.value=C.value.indexOf(e),R(e)})(e)},{default:y((()=>[f(v(e.slice(5))+" 月 ",1)])),_:2},1032,["class","onClick"])))),128))]),c("div",{ref_key:"chartRef",ref:a,class:"chart"},null,512)])}}},[["__scopeId","data-v-e7685332"]]),D={class:"frame-management-page min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},R={class:"min-h-38% flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},S={class:"min-h-62% flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto",style:{"background-color":"rgb(250, 250, 250)"}},B=Object.assign({name:"quality-management_scrap-judgment-details"},{__name:"index",setup(t){const r=l({prodNo:null,lotNo:null,time:null}),n=[{type:"input",key:"prodNo",label:"生产型号",placeholder:"请输入生产型号",span:24,md:12,lg:8,xl:8,xxl:5},{type:"input",key:"lotNo",label:"批卡号",placeholder:"请输入批卡号",span:24,md:12,lg:8,xl:8,xxl:5},{type:"dateRangePicker",key:"time",label:"日期",span:24,md:12,lg:10,xl:8,xxl:6,showTime:!0}],d=k((()=>{var e;const a={...r.value};return(null==(e=r.value)?void 0:e[0])&&(a.beginTime=s(r.value.time[0]).format("YYYY-MM-DD HH:mm:ss"),a.endTime=s(r.value.time[1]).format("YYYY-MM-DD HH:mm:ss")),delete a.time,a})),u=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"requestNo",dataIndex:"requestNo",title:"报废单号",align:"center",checked:!0,ellipsis:!0,sorter:!0},{key:"lotNo",dataIndex:"lotNo",title:"批卡号",align:"center",checked:!0,ellipsis:!0,sorter:!0},{key:"fullProdNo",dataIndex:"fullProdNo",title:"生产型号",align:"center",checked:!0,ellipsis:!0,sorter:!0},{key:"ltBugName",dataIndex:"ltBugName",title:"缺陷名称",align:"center",checked:!0,ellipsis:!0,sorter:!0,customRender:({record:e})=>w("span",{class:"fonw-900 color-red"},[e.ltBugName])},{key:"deptCaption",dataIndex:"deptCaption",title:"责任部门",align:"center",checked:!0,ellipsis:!0,sorter:!0},{key:"techName",dataIndex:"techName",title:"责任工艺",align:"center",checked:!0,ellipsis:!0,sorter:!0},{key:"pcsQty",dataIndex:"pcsQty",title:"报废PCS数量",align:"center",checked:!0,ellipsis:!0,sorter:!0},{key:"unitArea",dataIndex:"unitArea",title:"单元面积",align:"center",checked:!0,ellipsis:!0,sorter:!0},{key:"scrapArea",dataIndex:"scrapArea",title:"报废面积",align:"center",checked:!0,ellipsis:!0,sorter:!0,customRender:({record:e})=>w("span",{class:"fonw-900 color-red"},[e.scrapArea])},{key:"createBy",dataIndex:"createBy",title:"报废人",align:"center",checked:!0,ellipsis:!0,width:100,sorter:!0},{key:"createDate",dataIndex:"createDate",title:"报废时间",align:"center",checked:!0,ellipsis:!0,width:150,sorter:!0},{key:"remark",dataIndex:"remark",title:"备注",align:"center",checked:!0,ellipsis:!0}],m=l(null),p=l([]);function v(e){p.value=e}function h(){m.value.getData(1)}function g(){r.value={lotNo:null,prodNo:null,time:null},b((()=>{h()}))}return(t,l)=>{const s=a,p=e;return o(),i("div",D,[w(s,{searchParams:r.value,"onUpdate:searchParams":l[0]||(l[0]=e=>r.value=e),"form-list":n,"is-search":!0,onSearch:h,onReset:g},null,8,["searchParams"]),c("div",R,[w(p,{ref_key:"tableRef",ref:m,searchParams:d.value,"onUpdate:searchParams":l[1]||(l[1]=e=>d.value=e),column:u,"show-row-selection":"","row-key":"frameId","auto-generate-uuid":"",scroll:{y:"auto"},"is-init-get-data":"",url:"/erpsyncmes/baseData/bugRequestLog/view/list",onTableSelectChange:v},null,8,["searchParams"])]),c("div",S,[w(C)])])}}});export{B as default};
