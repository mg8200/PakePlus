import{_ as e}from"./round-download-DUbhM0Ds.js";import{_ as a}from"./round-add-MytOGm9O.js";import{ag as l,aa as t,Z as r,r as s,o as n,e as o,g as d,W as i,b as p,w as c,h as u,f as m,t as y,a5 as v,B as k}from"./index-B3PZsRwT.js";import{_ as g}from"./table-DoFSI9NT.js";import{_ as f}from"./common-search.vue_vue_type_script_setup_true_lang-BX9APgbN.js";import{_ as h}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import"./api-By23aosn.js";import"./index-BThgVJ70.js";const b={class:"event-form"},x={__name:"add",props:{rowData:{type:Object,default:()=>null},operateType:{type:String,default:()=>"add"}},setup(e,{expose:a}){const l=e,t=[{type:"tabs",name:"基本项目",span:24},{type:"input",key:"moldNo",label:"模具型号",placeholder:"请输入模具型号",span:8,rule:{required:!0,message:"请输入模具型号",trigger:"blur"}},{type:"select",key:"moldType",label:"模具类型",placeholder:"请选择模具类型",span:8,rule:{required:!0,message:"请选择模具类型",trigger:"change"},selectOptions:[{value:1,label:"软模"},{value:2,label:"硬模"}]},{type:"select",key:"applyType",label:"申请类型",placeholder:"请选择申请类型",span:8,rule:{required:!0,message:"请选择申请类型",trigger:"change"},selectOptions:[{value:1,label:"新开"},{value:2,label:"重开"}]},{type:"input",key:"moldAddress",label:"存放位置",placeholder:"请输入存放位置",span:8},{type:"input",key:"boardMaterial",label:"板材",placeholder:"请选择板材",span:8,selectOptions:[{value:"FR-1",label:"FR-1"},{value:"CEM-1",label:"CEM-1"},{value:"FR-4",label:"FR-4"},{value:"CEM-3",label:"CEM-3"}]},{type:"input",key:"boardThick",label:"板厚(MM)",placeholder:"请输入板厚(MM)",span:8},{type:"datePicker",key:"moldInDate",label:"入厂日期",placeholder:"请输入入厂日期",span:8},{type:"input",key:"supplier",label:"供应商",placeholder:"请输入供应商",span:8},{type:"textarea",key:"remark",label:"备注",placeholder:"请输入备注",span:8,textareaRows:1}];const r=s(null),p=s(function(){const e={};return t.forEach((a=>{a.key&&a.span&&("add"===l.operateType?e[a.key]=null:e[a.key]=l.rowData[a.key])})),e}());return a({model:p.value,validateForm:function(){return r.value.validateForm()}}),(e,a)=>(n(),o("div",b,[d(i,{ref_key:"formRef",ref:r,model:p.value,"onUpdate:model":a[0]||(a[0]=e=>p.value=e),"form-list":t},null,8,["model"])]))}},_={class:"mold-maintenance-page min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},w={class:"modal-footer"},I=Object.assign({name:"workwear_stamping-die-management_mold-ledger"},{__name:"index",setup(i){const b=s(null),I=s(null),M=s({moldNo:null,moldState:null,time:null}),D=[{type:"input",key:"moldNo",label:"模具编号",placeholder:"请输入模具编号",span:24,md:12,lg:8,xl:8,xxl:6},{type:"select",key:"moldState",label:"状态",placeholder:"请输入状态",span:24,md:12,lg:8,xl:8,xxl:6,selectOptions:[{value:1,label:"生效"},{value:2,label:"报废"},{value:3,label:"暂停"},{value:4,label:"调出"}]},{type:"dateRangePicker",key:"time",label:"日期",span:24,md:12,lg:10,xl:8,xxl:6}],R=p((()=>{var e;const a={...M.value};return(null==(e=M.value)?void 0:e[0])&&(a.startTime=t(M.value.time[0]).format("YYYY-MM-DD"),a.endTime=t(M.value.time[1]).format("YYYY-MM-DD")),delete a.time,a})),N=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"moldNo",dataIndex:"moldNo",title:"模具型号",align:"center",checked:!0,ellipsis:!0,width:150},{key:"moldStateName",dataIndex:"moldStateName",title:"状态",align:"center",checked:!0,ellipsis:!0},{key:"moldTypeName",dataIndex:"moldTypeName",title:"模具类型",align:"center",checked:!0,ellipsis:!0,width:120},{key:"applyTypeName",dataIndex:"applyTypeName",title:"申请类型",align:"center",checked:!0,ellipsis:!0},{key:"moldAddress",dataIndex:"moldAddress",title:"存放位置",align:"center",checked:!0,ellipsis:!0},{key:"repealDate",dataIndex:"repealDate",title:"报废日期",align:"center",checked:!0,ellipsis:!0},{key:"moldInDate",dataIndex:"moldInDate",title:"入厂日期",align:"center",checked:!0,ellipsis:!0},{key:"supplier",dataIndex:"supplier",title:"供应商",align:"center",checked:!0,ellipsis:!0},{key:"repealRemark",dataIndex:"repealRemark",title:"报废原因",align:"center",checked:!0,ellipsis:!0},{key:"remark",dataIndex:"remark",title:"备注",align:"center",checked:!0,ellipsis:!0}];function T(){I.value.getData(1)}function Y(){v((()=>{M.value={keywords:null,noticeState:null},T()}))}const j=s("add"),C=s(!1),P=s(!1),S=s(null),F=s(null);function q(){C.value=!1}async function O(){const e={...F.value};await e.validateForm(),P.value=!0;const a={...e.model};var l;(l=a,r({url:"/qms/agv/frock/mold/record/save",method:"post",data:l})).then((({error:e})=>{e||(window.$message.success("新增成功"),q(),Y())})).finally((()=>P.value=!1))}function E(){var e;e={...R.value},l({url:"/qms/agv/frock/mold/record/ledger/export",params:e,method:"get",fileName:"冲压模具台账导出".concat(t().format("YYYY-MM-DD HH:mm:ss"),".xlsx")})}return s(null),(l,t)=>{const r=a,s=k,i=e;return n(),o("div",_,[d(f,{ref_key:"commonSearchRef",ref:b,searchParams:M.value,"onUpdate:searchParams":t[0]||(t[0]=e=>M.value=e),"form-list":D,"is-search":!0,onSearch:T,onReset:Y},null,8,["searchParams"]),d(g,{ref_key:"tableRef",ref:I,searchParams:R.value,"onUpdate:searchParams":t[2]||(t[2]=e=>R.value=e),column:N,"show-row-selection":!1,"row-key":"moldUuid",scroll:{y:"auto"},"is-init-get-data":"",url:"/qms/agv/frock/mold/record/list"},{tableTitle:c((()=>[d(s,{type:"primary",class:"mini-btn mr-8px",size:"small",ghost:"",onClick:t[1]||(t[1]=e=>{return a=null,S.value=a,C.value=!0,void(j.value="add");var a})},{icon:c((()=>[d(r,{class:"align-sub text-icon"})])),default:c((()=>[t[4]||(t[4]=u(" 新增 "))])),_:1}),d(s,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:E},{icon:c((()=>[d(i,{class:"align-sub text-icon"})])),default:c((()=>[t[5]||(t[5]=m("span",{class:"ml-3px"},"导出",-1))])),_:1})])),_:1},8,["searchParams"]),d(h,{visible:C.value,"onUpdate:visible":t[3]||(t[3]=e=>C.value=e),title:"模具台账".concat("add"===j.value?"新增":"修改"),width:"70vw",height:"500px",centered:!0,"destroy-on-close":!0,onClose:q},{footer:c((()=>[m("div",w,[d(s,{loading:P.value,type:"primary",onClick:O},{default:c((()=>[u(y("add"===j.value?"新增":"修改"),1)])),_:1},8,["loading"]),d(s,{onClick:q},{default:c((()=>t[6]||(t[6]=[u("关 闭")]))),_:1})])])),default:c((()=>[d(x,{ref_key:"addRef",ref:F,"row-data":S.value,"operate-type":j.value},null,8,["row-data","operate-type"])])),_:1},8,["visible","title"])])}}});export{I as default};
