import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{d as l,K as a,L as t,o as n,c as s,w as o,g as d,f as i,s as r,h as u,t as c,I as p,v as m,N as f,ad as v,ae as h,M as x,O as g,B as w,P as y,Q as b,F as k,r as _,p as N,a7 as I,a5 as S,af as C,S as U,e as z,ac as T}from"./index-B3PZsRwT.js";import{b as j,c as q}from"./printed-code-DrJSKY57.js";import{C as E}from"./index-BThgVJ70.js";const L={class:"w-full flex"},M={class:"flex"},R={class:"w-full flex-y-center justify-end gap-12px"},Y={class:"ml-3px"},A={class:"ml-3px"},D=l({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:a(["search"],["update:model"]),setup(e,{emit:l}){const a=l,_=t(e,"model");function N(){a("search",_.value)}function I(){_.value={prodNo:null,lotNo:null,printState:null,time:null},a("search",_.value)}return(e,l)=>{const a=p,t=m,S=f,C=v,U=h,z=x,T=g,j=w,q=y,D=b,K=k,P=E;return n(),s(P,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:o((()=>[d(K,{ref:"formRef",model:_.value,"label-col":{span:5,md:7},class:"search-form"},{default:o((()=>[i("div",L,[d(D,{gutter:[15,8],wrap:"",class:"w-full"},{default:o((()=>[d(S,{span:24,md:12,lg:6,xl:6,xxl:4},{default:o((()=>[d(t,{label:"生产批号",name:"lotNo",class:"m-0","label-col":{}},{default:o((()=>[d(a,{value:_.value.lotNo,"onUpdate:value":l[0]||(l[0]=e=>_.value.lotNo=e),placeholder:"请输入生产批号",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:r(N,["enter"])},null,8,["value"])])),_:1})])),_:1}),d(S,{span:24,md:12,lg:6,xl:6,xxl:4},{default:o((()=>[d(t,{label:"生产型号",name:"prodNo",class:"m-0","label-col":{}},{default:o((()=>[d(a,{value:_.value.prodNo,"onUpdate:value":l[1]||(l[1]=e=>_.value.prodNo=e),placeholder:"请输入生产型号",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:r(N,["enter"])},null,8,["value"])])),_:1})])),_:1}),d(S,{span:24,md:12,lg:6,xl:6,xxl:4},{default:o((()=>[d(t,{label:"打码状态",name:"model",class:"m-0","label-col":{}},{default:o((()=>[d(U,{value:_.value.printState,"onUpdate:value":l[2]||(l[2]=e=>_.value.printState=e),placeholder:"请选择打码状态",class:"min-form-control","allow-clear":""},{default:o((()=>[d(C,{value:"已打码"},{default:o((()=>l[4]||(l[4]=[u("已打码")]))),_:1}),d(C,{value:"已打码未完成"},{default:o((()=>l[5]||(l[5]=[u("已打码未完成")]))),_:1})])),_:1},8,["value"])])),_:1})])),_:1}),d(S,{span:24,md:12,lg:6,xl:6,xxl:4},{default:o((()=>[d(t,{label:"日期",name:"model",class:"m-0","label-col":{}},{default:o((()=>[d(z,{value:_.value.time,"onUpdate:value":l[3]||(l[3]=e=>_.value.time=e),"value-format":"YYYY-MM-DD",class:"min-form-control"},null,8,["value"])])),_:1})])),_:1}),i("div",M,[d(t,{class:"m-0"},{default:o((()=>[i("div",R,[d(j,{type:"primary",ghost:"",class:"mini-btn",onClick:N},{icon:o((()=>[d(T,{class:"align-sub text-icon"})])),default:o((()=>[i("span",Y,c(e.$t("common.search")),1)])),_:1}),d(j,{class:"mini-btn",onClick:I},{icon:o((()=>[d(q,{class:"align-sub text-icon"})])),default:o((()=>[i("span",A,c(e.$t("common.reset")),1)])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])])),_:1})}}}),K={class:"jl-main-page outer-printed-code h-full h-full min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},P=l({name:"code-management_outer-printed-code",__name:"index",setup(l){const a=_({pageNum:1,pageSize:200}),t=_({prodNo:null,lotNo:null,printState:null,time:null}),s=_(!1),i=N({current:a.value.pageNum,pageSize:a.value.pageSize,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{i.current=e,i.pageSize=l,a.value.pageNum=e,a.value.pageSize=l,s.value&&m()}}),r=_(null),u=_([]);_([]);const c=_([{key:"index",dataIndex:"index",title:"序号",width:20,align:"center",checked:!0},{key:"lotId",dataIndex:"lotId",title:"生产批号",width:80,align:"center",checked:!0,ellipsis:!0},{key:"productName",dataIndex:"productName",title:"产品型号",width:130,align:"center",checked:!0,ellipsis:!0},{key:"qty",dataIndex:"qty",title:"批次数量",width:60,align:"center",checked:!0,ellipsis:!0},{key:"printCount",dataIndex:"printCount",title:"打码数量",width:60,align:"center",checked:!0,ellipsis:!0},{key:"printedCodeState",dataIndex:"printedCodeState",title:"打码状态",width:80,align:"center",checked:!0,ellipsis:!0},{key:"customerCode",dataIndex:"customerCode",title:"客户代码",width:100,align:"center",checked:!0,ellipsis:!0},{key:"customerName",dataIndex:"customerName",title:"客户名称",width:200,align:"center",checked:!0,ellipsis:!0},{key:"createTime",dataIndex:"createTime",title:"下发时间",width:180,align:"center",checked:!0,ellipsis:!0}]),p=_(!1);function m(){var e;const{prodNo:l,lotNo:n,printState:o}=t.value,d={prodNo:l,lotNo:n,printState:o,...a.value};(null==(e=t.value.time)?void 0:e[0])&&(d.startTime=t.value.time[0],d.endTime=t.value.time[1]),p.value=!0,j(d).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1,e.tableUuid=I.genV4().hexNoDelim})),i.total=e.total,u.value=e.list)})).finally((()=>{p.value=!1,s.value=!0}))}function v(){a.value.pageNum=1,i.current=1,m()}function h(){a.value.pageNum=1,i.current=1,m()}m();const x=_(!1),g=_([]),w=_([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"pnlId",dataIndex:"pnlId",title:"PNL码",width:180,align:"center",checked:!0,ellipsis:!0},{key:"printStatus",dataIndex:"printStatus",title:"是否打码",width:100,align:"center",checked:!0,ellipsis:!0},{key:"printedTime",dataIndex:"printedTime",title:"打码时间",width:180,align:"center",checked:!0,ellipsis:!0},{key:"eqpId",dataIndex:"eqpId",title:"打码设备",width:130,align:"center",checked:!0,ellipsis:!0}]),y=e=>({style:{background:e.tableUuid===r.value?"#BAEAFA":""},class:e.tableUuid===r.value?"jl-table-row-selected":"",onClick:()=>{r.value=e.tableUuid,x.value=!0,q(e.lotId).then((({data:e,error:l})=>{l||(e.forEach(((e,l)=>{e.index=l+1})),g.value=e)})).finally((()=>x.value=!1))}}),k=_(42);return window.addEventListener("resize",(()=>{S((()=>{const e=document.querySelector(".outer-printed-code .search-box"),l=null==e?void 0:e.clientHeight;k.value=l||42}))})),C((()=>{window.removeEventListener("resize",(()=>{}))})),(l,a)=>{const s=e,r=U("STable"),m=E,_=f,N=b;return n(),z("div",K,[d(D,{model:t.value,"onUpdate:model":a[0]||(a[0]=e=>t.value=e),class:"search-box",onReset:v,onSearch:h},null,8,["model"]),d(N,{gutter:[15,8],wrap:"",class:"w-full",style:T({height:"calc(100% - ".concat(k.value,"px)")})},{default:o((()=>[d(_,{span:12,class:"h-full"},{default:o((()=>[d(m,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:o((()=>[d(s,{columns:c.value,"onUpdate:columns":a[1]||(a[1]=e=>c.value=e)},null,8,["columns"])])),default:o((()=>[d(r,{ref:"tableWrapperRef",columns:c.value,"data-source":u.value,bordered:"",size:"small",loading:p.value,"row-key":"tableUuid",pagination:i,"custom-row":y,scroll:{x:1500},class:"h-full","row-height":23},null,8,["columns","data-source","loading","pagination"])])),_:1})])),_:1}),d(_,{span:24,md:24,lg:24,xl:12,xxl:12,class:"h-fullmin-h-500px h-full flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},{default:o((()=>[d(m,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:o((()=>[d(s,{columns:w.value,"onUpdate:columns":a[2]||(a[2]=e=>w.value=e)},null,8,["columns"])])),default:o((()=>[d(r,{ref:"tableWrapperRef",columns:w.value,"data-source":g.value,bordered:"",size:"small",loading:x.value,"row-key":"pnlId",pagination:!1,scroll:{x:"auto",y:2e3},class:"h-full","row-height":23},null,8,["columns","data-source","loading"])])),_:1})])),_:1})])),_:1},8,["style"])])}}});export{P as default};
