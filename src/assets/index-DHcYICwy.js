import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{d as l,K as a,L as t,o as n,c as s,w as o,g as i,f as c,s as d,t as u,I as r,v as m,N as p,O as h,B as v,P as f,Q as x,F as g,r as y,p as w,db as _,a7 as k,S as b,e as N,h as C,W as T}from"./index-B3PZsRwT.js";import{h as I,i as D}from"./index-DqnulfE2.js";import{_ as S}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{C as j}from"./index-BThgVJ70.js";const z={class:"w-full flex"},U={class:"flex"},K={class:"w-full flex-y-center justify-end gap-12px"},R={class:"ml-3px"},A={class:"ml-3px"},E=l({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:a(["search","reset"],["update:model"]),setup(e,{emit:l}){const a=l,y=t(e,"model");function w(){a("search",y.value)}function _(){y.value.machineName=null,y.value.machineNo=null,y.value.deptCaption=null,y.value.beginTime=null,y.value.endTime=null,y.value.time=null,a("reset",y.value)}return(e,l)=>{const a=r,t=m,k=p,b=h,N=v,C=f,T=x,I=g,D=j;return n(),s(D,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:o((()=>[i(I,{model:y.value,"label-col":{span:5,md:7},class:"search-form"},{default:o((()=>[c("div",z,[i(T,{gutter:[15,8],wrap:"",class:"w-full"},{default:o((()=>[i(k,{span:24,md:12,lg:6,xl:8,xxl:4},{default:o((()=>[i(t,{label:"设备名称",name:"machineName",class:"m-0","label-col":{}},{default:o((()=>[i(a,{value:y.value.machineName,"onUpdate:value":l[0]||(l[0]=e=>y.value.machineName=e),placeholder:"请输入设备名称",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:d(w,["enter"])},null,8,["value"])])),_:1})])),_:1}),i(k,{span:24,md:12,lg:6,xl:8,xxl:4},{default:o((()=>[i(t,{label:"设备编码",name:"machineNo",class:"m-0","label-col":{}},{default:o((()=>[i(a,{value:y.value.machineNo,"onUpdate:value":l[1]||(l[1]=e=>y.value.machineNo=e),placeholder:"请输入设备编码",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:d(w,["enter"])},null,8,["value"])])),_:1})])),_:1}),i(k,{span:24,md:12,lg:6,xl:8,xxl:4},{default:o((()=>[i(t,{label:"使用部门",name:"deptCaption",class:"m-0","label-col":{}},{default:o((()=>[i(a,{value:y.value.deptCaption,"onUpdate:value":l[2]||(l[2]=e=>y.value.deptCaption=e),placeholder:"请输入使用部门",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:d(w,["enter"])},null,8,["value"])])),_:1})])),_:1}),c("div",U,[i(t,{class:"m-0"},{default:o((()=>[c("div",K,[i(N,{type:"primary",ghost:"",class:"mini-btn",onClick:w},{icon:o((()=>[i(b,{class:"align-sub text-icon"})])),default:o((()=>[c("span",R,u(e.$t("common.search")),1)])),_:1}),i(N,{class:"mini-btn",onClick:_},{icon:o((()=>[i(C,{class:"align-sub text-icon"})])),default:o((()=>[c("span",A,u(e.$t("common.reset")),1)])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])])),_:1})}}}),O={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},$={class:"event-form"},B={class:"modal-footer"},F=Object.assign({name:"erpdatasync_device-profile"},{__name:"index",setup(l){const a=y({machineNo:"",beginTime:"",endTime:"",deptCaption:"",machineName:""}),t=w({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","180","300","500"],showQuickJumper:!0,showTotal:e=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{t.current=e,t.pageSize=l,m()}}),s=y([{key:"index",dataIndex:"index",title:"序号",width:100,align:"center",checked:!0},{key:"machineName",dataIndex:"machineName",title:"设备名称",width:180,align:"center",checked:!0,ellipsis:!0},{key:"machineNo",dataIndex:"machineNo",title:"设备编码",width:100,align:"center",checked:!0,ellipsis:!0},{key:"machineType",dataIndex:"machineType",title:"设备类型",width:100,align:"center",checked:!0,ellipsis:!0},{key:"deptCaption",dataIndex:"deptCaption",title:"使用部门",width:100,align:"center",checked:!0,ellipsis:!0},{key:"modelNo",dataIndex:"modelNo",title:"设备型号",width:150,align:"center",checked:!0,ellipsis:!0},{key:"producer",dataIndex:"producer",title:"制造商",width:180,align:"center",checked:!0,ellipsis:!0},{key:"createDate",dataIndex:"createDate",title:"创建时间",width:120,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.createDate?null:_(e.createDate)},{key:"updateDate",dataIndex:"updateDate",title:"修改时间",width:120,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.updateDate?null:_(e.updateDate)},{key:"lmTime",dataIndex:"lmTime",title:"同步时间",width:120,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.lmTime?null:_(e.lmTime)}]),d=y([]),u=y(!1),r=y([]);function m(){u.value=!0,I({pageSize:t.pageSize,pageNum:t.current,...a.value}).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1,e.uid=k.genV4().hexNoDelim})),d.value=e.list,t.total=e.total)})).finally((()=>{u.value=!1}))}const p=y({}),h=y(!1),f=[{type:"input",key:"machineNo",label:"设备编码",placeholder:"请输入设备编码",span:24}];function x(){p.value={},h.value=!0}function g(){D(p.value).then((({data:e,error:l})=>{var a;l||(null==(a=window.$message)||a.success("手动同步成功"),h.value=!1,m())}))}function z(){t.current=1,m()}m();const U=y(null),K=e=>({style:{background:e.uid===U.value?"#BAEAFA":""},class:e.uid===U.value?"jl-table-row-selected":"",onClick:()=>{U.value=e.uid}});return(l,m)=>{const y=v,w=e,_=b("STable"),k=j;return n(),N("div",O,[i(E,{model:a.value,"onUpdate:model":m[0]||(m[0]=e=>a.value=e),onReset:m[1]||(m[1]=e=>z()),onSearch:m[2]||(m[2]=e=>z())},null,8,["model"]),i(k,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card flex-col-stretch sm:flex-1-hidden card-wrapper"},{title:o((()=>[i(y,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:x},{default:o((()=>m[7]||(m[7]=[c("span",{class:"ml-3px"},"手动同步",-1)]))),_:1})])),extra:o((()=>[i(w,{columns:s.value,"onUpdate:columns":m[3]||(m[3]=e=>s.value=e)},null,8,["columns"])])),default:o((()=>[i(_,{columns:s.value,"data-source":d.value,size:"small",bordered:"",loading:u.value,"default-expanded-row-keys":r.value,"row-key":"uid","default-expand-all-rows":!0,scroll:{x:"auto",y:"auto"},pagination:t,class:"h-full","custom-row":K,"row-height":23},null,8,["columns","data-source","loading","default-expanded-row-keys","pagination"]),i(S,{visible:h.value,"onUpdate:visible":m[6]||(m[6]=e=>h.value=e),"destroy-on-close":!0,title:"手动设备档案",width:"550px"},{footer:o((()=>[c("div",B,[i(y,{onClick:m[5]||(m[5]=e=>h.value=!1)},{default:o((()=>m[8]||(m[8]=[C("关闭")]))),_:1}),i(y,{type:"primary",onClick:g},{default:o((()=>m[9]||(m[9]=[C("保存")]))),_:1})])])),default:o((()=>[c("div",$,[i(T,{model:p.value,"onUpdate:model":m[4]||(m[4]=e=>p.value=e),"form-list":f},null,8,["model"])])])),_:1},8,["visible"])])),_:1})])}}});export{F as default};
