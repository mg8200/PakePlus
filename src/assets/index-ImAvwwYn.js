import{_ as e}from"./table-DoFSI9NT.js";import{_ as t}from"./common-search.vue_vue_type_script_setup_true_lang-BX9APgbN.js";import{r as a,b as l,aa as d,S as i,o as c,e as n,g as s,w as r,i as o,f as u,h as x,t as p,B as y}from"./index-B3PZsRwT.js";import{d as f}from"./downloadExcelByTable-DiiorCT4.js";import{D as m}from"./DownloadOutlined-CnXdrHEb.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import"./api-By23aosn.js";import"./index-BThgVJ70.js";const h={class:"jl-main-page min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},g=Object.assign({name:"collection-management_inner-yield-query"},{__name:"index",setup(g){const b=a(null),k=a({prodNo:null,time:null,isOuter:"0"}),v=[{type:"input",key:"prodNo",label:"生产型号",placeholder:"请输入生产型号",span:24,md:12,lg:8,xl:8,xxl:6},{type:"dateRangePicker",key:"time",label:"日期",span:24,md:12,lg:10,xl:8,xxl:6}],_=l((()=>{var e,t;const a={...k.value};return(null==(t=null==(e=k.value)?void 0:e.time)?void 0:t[0])?(a.startTime=d(k.value.time[0]).format("YYYY-MM-DD"),a.endTime=d(k.value.time[1]).format("YYYY-MM-DD")):(a.startTime=null,a.endTime=null),delete a.time,a})),P=a(null),Q=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,fixed:"left",align:"center",checked:!0,ellipsis:!0},{key:"partNo",dataIndex:"partNo",title:"生产型号",align:"center",width:160,fixed:"left",checked:!0,ellipsis:!0},{key:"layers",dataIndex:"layers",title:"层别",align:"center",width:105,checked:!0,ellipsis:!0},{key:"panelQty",dataIndex:"panelQty",title:"PNL数",align:"center",width:90,checked:!0,ellipsis:!0},{key:"setQty",dataIndex:"setQty",title:"SET数",align:"center",width:90,checked:!0,ellipsis:!0},{key:"pcsQty",dataIndex:"pcsQty",title:"PCS数",align:"center",width:90,checked:!0,ellipsis:!0},{key:"goodPanelQty",dataIndex:"goodPanelQty",title:"良品PNL数",align:"center",width:100,checked:!0,ellipsis:!0},{key:"goodPanelRate",dataIndex:"goodPanelRate",title:"PNL良率",align:"center",width:100,checked:!0,ellipsis:!0,customRender:({record:e})=>"".concat(Number.parseFloat(e.goodPanelRate).toFixed(2),"%")},{key:"goodSetQty",dataIndex:"goodSetQty",title:"良品SET数",align:"center",width:100,checked:!0,ellipsis:!0},{key:"goodPcsQty",dataIndex:"goodPcsQty",title:"良品PCS数",align:"center",width:100,checked:!0,ellipsis:!0},{key:"goodPcsRate",dataIndex:"goodPcsRate",title:"PCS良率",align:"center",width:100,checked:!0,ellipsis:!0,customRender:({record:e})=>"".concat(Number.parseFloat(e.goodPcsRate).toFixed(2),"%")},{key:"failTotalQty",dataIndex:"failTotalQty",title:"不良点数",align:"center",width:100,checked:!0,ellipsis:!0},{key:"failSetRate",dataIndex:"failSetRate",title:"SET不良率",align:"center",width:100,checked:!0,ellipsis:!0,customRender:({record:e})=>"".concat(Number.parseFloat(e.failSetRate).toFixed(2),"%")},{key:"failPcsRate",dataIndex:"failPcsRate",title:"PCS不良率",align:"center",width:100,checked:!0,ellipsis:!0,customRender:({record:e})=>"".concat(Number.parseFloat(e.failPcsRate).toFixed(2),"%")},{key:"failPanelQty",dataIndex:"failPanelQty",title:"PNL不良数",align:"center",width:100,checked:!0,ellipsis:!0},{key:"failSetQty",dataIndex:"failSetQty",title:"SET不良数",align:"center",width:100,checked:!0,ellipsis:!0},{key:"bad1",dataIndex:"bad1",title:"开路",align:"center",width:60,checked:!0,ellipsis:!0},{key:"bad2",dataIndex:"bad2",title:"短路",align:"center",width:60,checked:!0,ellipsis:!0},{key:"bad3",dataIndex:"bad3",title:"残铜",align:"center",width:60,checked:!0,ellipsis:!0},{key:"bad4",dataIndex:"bad4",title:"蚀刻不净",align:"center",width:90,checked:!0,ellipsis:!0},{key:"bad5",dataIndex:"bad5",title:"缺口",align:"center",width:60,checked:!0,ellipsis:!0},{key:"bad6",dataIndex:"bad6",title:"凹陷",align:"center",width:60,checked:!0,ellipsis:!0},{key:"bad7",dataIndex:"bad7",title:"油墨刮伤",align:"center",width:90,checked:!0,ellipsis:!0},{key:"bad8",dataIndex:"bad8",title:"曝光不良短路",align:"center",width:120,checked:!0,ellipsis:!0},{key:"bad9",dataIndex:"bad9",title:"线细",align:"center",width:60,checked:!0,ellipsis:!0},{key:"bad10",dataIndex:"bad10",title:"显影不洁",align:"center",width:100,checked:!0,ellipsis:!0},{key:"bad11",dataIndex:"bad11",title:"去膜不净",align:"center",width:100,checked:!0,ellipsis:!0},{key:"bad12",dataIndex:"bad12",title:"其它",align:"center",width:60,checked:!0,ellipsis:!0},{key:"startDate",dataIndex:"startDate",title:"操作开始时间",align:"center",width:170,checked:!0,ellipsis:!0},{key:"endDate",dataIndex:"endDate",title:"操作结束时间",align:"center",width:170,checked:!0,ellipsis:!0}];function w(){P.value.getData(1)}function R(){nextTick((()=>{k.value.prodNo=null,k.value.time=null,w()}))}const I=a(0),S=a(0),F=a(0),N=a([]);function D(e){N.value=e;const t=e.reduce(((e,t)=>e+t.panelQty),0),a=e.reduce(((e,t)=>e+t.goodPanelQty),0);I.value="".concat(Number.parseFloat(a/t*100).toFixed(2),"%");const l=e.reduce(((e,t)=>e+t.setQty),0),d=e.reduce(((e,t)=>e+t.goodSetQty),0);S.value="".concat(Number.parseFloat(d/l*100).toFixed(2),"%");const i=e.reduce(((e,t)=>e+t.pcsQty),0),c=e.reduce(((e,t)=>e+t.goodPcsQty),0);F.value="".concat(Number.parseFloat(c/i*100).toFixed(2),"%")}function T(){const e=[{partNo:"总计",layers:"--",panelQty:N.value.reduce(((e,t)=>e+t.panelQty),0),setQty:N.value.reduce(((e,t)=>e+t.setQty),0),pcsQty:N.value.reduce(((e,t)=>e+t.pcsQty),0),goodPanelQty:N.value.reduce(((e,t)=>e+t.goodPanelQty),0),goodPanelRate:I.value,goodSetQty:N.value.reduce(((e,t)=>e+t.goodSetQty),0),goodPcsQty:N.value.reduce(((e,t)=>e+t.goodPcsQty),0),goodPcsRate:F.value,failTotalQty:N.value.reduce(((e,t)=>e+t.failTotalQty),0),failSetRate:"--",failPcsRate:"--",failPanelQty:N.value.reduce(((e,t)=>e+t.failPanelQty),0),failSetQty:N.value.reduce(((e,t)=>e+t.failSetQty),0),bad1:N.value.reduce(((e,t)=>e+t.bad1),0),bad2:N.value.reduce(((e,t)=>e+t.bad2),0),bad3:N.value.reduce(((e,t)=>e+t.bad3),0),bad4:N.value.reduce(((e,t)=>e+t.bad4),0),bad5:N.value.reduce(((e,t)=>e+t.bad5),0),bad6:N.value.reduce(((e,t)=>e+t.bad6),0),bad7:N.value.reduce(((e,t)=>e+t.bad7),0),bad8:N.value.reduce(((e,t)=>e+t.bad8),0),bad9:N.value.reduce(((e,t)=>e+t.bad9),0),bad10:N.value.reduce(((e,t)=>e+t.bad10),0),bad11:N.value.reduce(((e,t)=>e+t.bad11),0),bad12:N.value.reduce(((e,t)=>e+t.bad12),0),startDate:"--",endDate:"--"}],t=N.value.map((e=>({...e,goodPanelRate:"".concat(Number.parseFloat(e.goodPanelRate).toFixed(2),"%"),goodPcsRate:"".concat(Number.parseFloat(e.goodPcsRate).toFixed(2),"%"),failSetRate:"".concat(Number.parseFloat(e.failSetRate).toFixed(2),"%"),failPcsRate:"".concat(Number.parseFloat(e.failPcsRate).toFixed(2),"%")}))),a=[{startCell:"A".concat(t.length+2),endCell:"B".concat(t.length+2),value:"合计"}];f({data:t,header:Q,fileName:"内层良率查询".concat(d().format("YYYY-MM-DD HH:mm:ss"),"导出.xlsx"),ortherData:e,mergeCellsArr:a})}return(a,l)=>{const d=t,f=y,g=i("STableSummaryCell"),S=i("STableSummaryRow"),N=e;return c(),n("div",h,[s(d,{ref_key:"commonSearchRef",ref:b,searchParams:k.value,"onUpdate:searchParams":l[0]||(l[0]=e=>k.value=e),"form-list":v,"is-search":!0,onSearch:w,onReset:R},null,8,["searchParams"]),s(N,{ref_key:"tableRef",ref:P,searchParams:_.value,"onUpdate:searchParams":l[1]||(l[1]=e=>_.value=e),column:Q,"show-row-selection":!1,"auto-generate-uuid":!0,"summary-fixed":!0,"is-pagination":!1,scroll:{y:"auto"},"is-init-get-data":"",url:"/qms/inOutYieldRate/inOutYieldRateList",onTableDataLoadSucess:D},{title:r((()=>[s(f,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:T},{icon:r((()=>[s(o(m))])),default:r((()=>[l[2]||(l[2]=u("span",{class:"ml-3px"},"导出",-1))])),_:1})])),summary:r((()=>[s(S,null,{default:r((()=>[s(g,{index:0,"col-span":2,class:"text-center"},{default:r((()=>l[3]||(l[3]=[x("总计")]))),_:1}),s(g,{index:2,class:"text-center"},{default:r((()=>l[4]||(l[4]=[x("--")]))),_:1}),s(g,{index:3,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:4,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:5,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:6,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:7,class:"text-center"},{default:r((()=>[x(p(I.value),1)])),_:1}),s(g,{index:8,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:9,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:10,class:"text-center"},{default:r((()=>[x(p(F.value),1)])),_:1}),s(g,{index:11,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:12,class:"text-center"},{default:r((()=>l[5]||(l[5]=[x("--")]))),_:1}),s(g,{index:13,class:"text-center"},{default:r((()=>l[6]||(l[6]=[x("--")]))),_:1}),s(g,{index:14,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:15,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:16,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:17,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:18,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:19,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:20,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:21,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:22,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:23,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:24,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:25,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:26,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:27,class:"text-center"},{default:r((({total:e})=>[x(p(e),1)])),_:1}),s(g,{index:28,class:"text-center"},{default:r((()=>l[7]||(l[7]=[x("--")]))),_:1}),s(g,{index:29,class:"text-center"},{default:r((()=>l[8]||(l[8]=[x("--")]))),_:1})])),_:1})])),_:1},8,["searchParams"])])}}});export{g as default};
