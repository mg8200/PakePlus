import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{d as l,K as a,L as t,o as s,c as n,w as o,g as d,f as i,s as r,t as c,I as u,v as p,N as m,O as v,B as f,P as h,Q as x,F as y,r as g,p as w,db as k,a7 as _,S as b,e as T,h as N,W as S}from"./index-B3PZsRwT.js";import{B as I,C}from"./index-DqnulfE2.js";import{_ as D}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{C as P}from"./index-BThgVJ70.js";const j={class:"w-full flex"},z={class:"flex"},U={class:"w-full flex-y-center justify-end gap-12px"},E={class:"ml-3px"},A={class:"ml-3px"},B=l({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:a(["search","reset"],["update:model"]),setup(e,{emit:l}){const a=l,g=t(e,"model");function w(){a("search",g.value)}function k(){g.value.prodNo=null,g.value.pnType=null,g.value.time=null,a("reset",g.value)}return(e,l)=>{const a=u,t=p,_=m,b=v,T=f,N=h,S=x,I=y,C=P;return s(),n(C,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:o((()=>[d(I,{model:g.value,"label-col":{span:5,md:7},class:"search-form"},{default:o((()=>[i("div",j,[d(S,{gutter:[15,8],wrap:"",class:"w-full"},{default:o((()=>[d(_,{span:24,md:12,lg:6,xl:8,xxl:4},{default:o((()=>[d(t,{label:"生产型号",name:"prodNo",class:"m-0","label-col":{}},{default:o((()=>[d(a,{value:g.value.prodNo,"onUpdate:value":l[0]||(l[0]=e=>g.value.prodNo=e),placeholder:"请输入生产型号",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:r(w,["enter"])},null,8,["value"])])),_:1})])),_:1}),d(_,{span:24,md:12,lg:6,xl:8,xxl:4},{default:o((()=>[d(t,{label:"型号类型",name:"pnType",class:"m-0","label-col":{}},{default:o((()=>[d(a,{value:g.value.pnType,"onUpdate:value":l[1]||(l[1]=e=>g.value.pnType=e),placeholder:"请输入型号类型",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:r(w,["enter"])},null,8,["value"])])),_:1})])),_:1}),i("div",z,[d(t,{class:"m-0"},{default:o((()=>[i("div",U,[d(T,{type:"primary",ghost:"",class:"mini-btn",onClick:w},{icon:o((()=>[d(b,{class:"align-sub text-icon"})])),default:o((()=>[i("span",E,c(e.$t("common.search")),1)])),_:1}),d(T,{class:"mini-btn",onClick:k},{icon:o((()=>[d(N,{class:"align-sub text-icon"})])),default:o((()=>[i("span",A,c(e.$t("common.reset")),1)])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])])),_:1})}}}),R={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},K={class:"event-form"},O={class:"modal-footer"},V=Object.assign({name:"erpdatasync_product-model"},{__name:"index",setup(l){const a=g({prodNo:"",pnType:""}),t=w({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:e=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{t.current=e,t.pageSize=l,h()}}),n=g([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0},{key:"prodNo",dataIndex:"prodNo",title:"生产型号",width:100,align:"center",checked:!0},{key:"showProdver",dataIndex:"showProdver",title:"版本号",width:60,align:"center",checked:!0,ellipsis:!0},{key:"prodVer",dataIndex:"prodVer",title:"AB拼板",width:60,align:"center",checked:!0},{key:"layer",dataIndex:"layer",title:"层数",width:60,align:"center",checked:!0},{key:"pnType",dataIndex:"pnType",title:"型号类型",width:60,align:"center",checked:!0,ellipsis:!0},{key:"pnlSet",dataIndex:"pnlSet",title:"PNL/SET",width:70,align:"center",checked:!0,ellipsis:!0},{key:"setPcs",dataIndex:"setPcs",title:"SET/PCS",width:70,align:"center",checked:!0,ellipsis:!0},{key:"custProdNo",dataIndex:"custProdNo",title:"客户型号",width:200,align:"center",checked:!0,ellipsis:!0},{key:"createDate",dataIndex:"createDate",title:"创建时间",width:160,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.createDate?null:k(e.createDate)},{key:"updateDate",dataIndex:"updateDate",title:"修改时间",width:160,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.updateDate?null:k(e.updateDate)},{key:"lmTime",dataIndex:"lmTime",title:"同步时间",width:160,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.lmTime?null:k(e.lmTime)}]),r=g({}),c=g(!1),u=[{type:"input",key:"moduleNo",label:"料号",placeholder:"请输入料号",span:24}],p=g([]),m=g(!1),v=g([]);function h(){var e;m.value=!0,(null==(e=a.value.time)?void 0:e.length)>0?(a.value.startTime=a.value.time[0],a.value.endTime=a.value.time[1]):delete a.value.time,I({pageSize:t.pageSize,pageNum:t.current,...a.value}).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1,e.uid=_.genV4().hexNoDelim})),p.value=e.list,t.total=e.total)})).finally((()=>{m.value=!1}))}function x(){r.value={},c.value=!0}function y(){C(r.value).then((({data:e,error:l})=>{var a;l||(null==(a=window.$message)||a.success("手动同步成功"),c.value=!1,h())}))}function j(){t.current=1,h()}h();const z=g(null),U=e=>({style:{background:e.uid===z.value?"#BAEAFA":""},class:e.uid===z.value?"jl-table-row-selected":"",onClick:()=>{z.value=e.uid}});return(l,h)=>{const g=f,w=e,k=b("STable"),_=P;return s(),T("div",R,[d(B,{model:a.value,"onUpdate:model":h[0]||(h[0]=e=>a.value=e),onReset:h[1]||(h[1]=e=>j()),onSearch:h[2]||(h[2]=e=>j())},null,8,["model"]),d(_,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card flex-col-stretch sm:flex-1-hidden card-wrapper"},{title:o((()=>[d(g,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:x},{default:o((()=>h[7]||(h[7]=[i("span",{class:"ml-3px"},"手动同步",-1)]))),_:1})])),extra:o((()=>[d(w,{columns:n.value,"onUpdate:columns":h[3]||(h[3]=e=>n.value=e)},null,8,["columns"])])),default:o((()=>[d(k,{columns:n.value,"data-source":p.value,size:"small",bordered:"",loading:m.value,"default-expanded-row-keys":v.value,"row-key":"uid","default-expand-all-rows":!0,scroll:{x:"auto",y:"auto"},pagination:t,class:"h-full","custom-row":U,"row-height":23},null,8,["columns","data-source","loading","default-expanded-row-keys","pagination"]),d(D,{visible:c.value,"onUpdate:visible":h[6]||(h[6]=e=>c.value=e),"destroy-on-close":!0,title:"手动产品型号",width:"550px"},{footer:o((()=>[i("div",O,[d(g,{onClick:h[5]||(h[5]=e=>c.value=!1)},{default:o((()=>h[8]||(h[8]=[N("关闭")]))),_:1}),d(g,{type:"primary",onClick:y},{default:o((()=>h[9]||(h[9]=[N("保存")]))),_:1})])])),default:o((()=>[i("div",K,[d(S,{model:r.value,"onUpdate:model":h[4]||(h[4]=e=>r.value=e),"form-list":u},null,8,["model"])])])),_:1},8,["visible"])])),_:1})])}}});export{V as default};
