import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{d as a,K as l,L as t,r as s,q as o,n as i,o as n,c as r,w as c,g as u,f as d,s as p,t as m,e as f,aj as v,al as h,h as g,ab as y,I as _,v as x,N as b,O as k,B as w,P as C,Q as q,F as P,ad as L,ae as j,U as R,p as I,a9 as N,b as S,S as B,J as K}from"./index-B3PZsRwT.js";import{g as U,p as z}from"./api-By23aosn.js";import{_ as E}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{C as F}from"./index-BThgVJ70.js";const O={class:"w-full flex"},A={class:"flex"},D={class:"w-full flex-y-center justify-end gap-12px"},J={class:"ml-3px"},M={class:"ml-3px"},Q=a({__name:"search",props:l({selectedRowKeys:{}},{model:{required:!0},modelModifiers:{}}),emits:l(["search","resetChecked"],["update:model"]),setup(e,{emit:a}){const l=e,R=a,I=t(e,"model");function N(){R("search",I.value)}function S(){I.value={materiel:"",status:""},R("search",I.value)}const B=s(0),K=s(!1),Q=s([{position:"选项1",positionName:"黄金糕"},{position:"选项2",positionName:"双皮奶"},{position:"选项3",positionName:"蚵仔煎"},{position:"选项4",positionName:"龙须面"},{position:"选项5",positionName:"北京烤鸭"}]),T=s({eqpPositionList:[]}),{createRequiredRule:$}=o(),{formRef:G,validate:H,resetFields:V}=i(),W={eqpPositionList:$("不能为空")};function X(e){B.value=e,K.value=!0}async function Y(){if(0==B.value){if(0==l.selectedRowKeys.length)return y.error("请选择数据");if(0==T.value.eqpPositionList.length)return y.error("请选择工位位置");const e={};e.eqpPositionList=T.value.eqpPositionList,e.positionList=l.selectedRowKeys,z("/mes/jlagv/machine/woker/downPinBatchByEqp",e).then((({data:e,error:a})=>{a||(y.success("操作成功",10),T.value.eqpPositionList=[],R("resetChecked"))}))}else{if(0==T.value.eqpPositionList.length)return y.error("请选择工位位置");const e={};e.eqpPositionList=T.value.eqpPositionList,z("/mes/jlagv/machine/woker/returnBatchByEqp",e).then((({data:e,error:a})=>{a||(y.success("操作成功",10),T.value.eqpPositionList=[])}))}}function Z(){T.value.eqpPositionList=[],0==B.value&&R("resetChecked")}function ee(){T.value.eqpPositionList=[]}return U("/mes/jlagv/machine/woker/getEqpPosition").then((({data:e,error:a})=>{a||(Q.value=e)})),(e,a)=>{const l=_,t=x,s=b,o=k,i=w,y=C,R=q,U=P,z=L,$=j,H=F;return n(),r(H,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:c((()=>[u(U,{ref_key:"formRef",ref:G,model:I.value,"label-col":{span:5,md:7},class:"search-form"},{default:c((()=>[d("div",O,[u(R,{gutter:[15,8],wrap:"",class:"w-full"},{default:c((()=>[u(s,{span:24,md:12,lg:6,xl:6,xxl:6},{default:c((()=>[u(t,{label:"料号",name:"materiel",class:"m-0","label-col":{}},{default:c((()=>[u(l,{value:I.value.materiel,"onUpdate:value":a[0]||(a[0]=e=>I.value.materiel=e),placeholder:"请输入料号",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:p(N,["enter"])},null,8,["value"])])),_:1})])),_:1}),d("div",A,[u(t,{class:"m-0"},{default:c((()=>[d("div",D,[u(i,{type:"primary",ghost:"",class:"mini-btn",onClick:N},{icon:c((()=>[u(o,{class:"align-sub text-icon"})])),default:c((()=>[d("span",J,m(e.$t("common.search")),1)])),_:1}),u(i,{class:"mini-btn",onClick:S},{icon:c((()=>[u(y,{class:"align-sub text-icon"})])),default:c((()=>[d("span",M,m(e.$t("common.reset")),1)])),_:1}),u(i,{type:"primary",ghost:"",class:"mini-btn",onClick:a[1]||(a[1]=e=>X(0))},{default:c((()=>a[5]||(a[5]=[d("span",{class:"ml-3px"},"批量退PIN取料",-1)]))),_:1}),u(i,{type:"primary",ghost:"",class:"mini-btn",onClick:a[2]||(a[2]=e=>X(1))},{default:c((()=>a[6]||(a[6]=[d("span",{class:"ml-3px"},"批量反空托",-1)]))),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"]),u(E,{visible:K.value,"onUpdate:visible":a[4]||(a[4]=e=>K.value=e),title:0==B.value?"批量退PIN取料":"批量反空托",width:"500px",height:"193px","destroy-on-close":"",onOk:Y,onClose:ee,onReset:Z},{default:c((()=>[u(U,{ref_key:"formRef",ref:G,model:T.value,rules:W,class:"search-form"},{default:c((()=>[u(t,{label:"工位位置",name:"upPinList",class:"m-0","label-col":{}},{default:c((()=>[u($,{value:T.value.eqpPositionList,"onUpdate:value":a[3]||(a[3]=e=>T.value.eqpPositionList=e),placeholder:"请选择工位位置",mode:"multiple","allow-clear":""},{default:c((()=>[(n(!0),f(v,null,h(Q.value,(e=>(n(),r(z,{key:e.position,value:e.position},{default:c((()=>[g(m(e.positionName),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title"])])),_:1})}}}),T={class:"jl-main-page one-code-ascend min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},$=K(a({name:"intelligent-iogistics_return-pin-temporary-store-list",__name:"index",setup(a){R((e=>({"014bb3b0":w.value})));const l=s({materiel:null}),t=I({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:e=>"共".concat(e,"条"),total:0,onChange:async(e,a)=>{t.current=e,t.pageSize=a,v()}}),o=s([]),i=s(!1),r=s([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"materialLot",dataIndex:"materialLot",title:"物料批次",align:"center",checked:!0,ellipsis:!0},{key:"podCode",dataIndex:"podCode",title:"货架编号",align:"center",checked:!0,ellipsis:!0},{key:"positionCode",dataIndex:"positionCode",title:"位置编号",align:"center",checked:!0,ellipsis:!0},{key:"areaCode",dataIndex:"areaCode",title:"区域编号",align:"center",checked:!0,ellipsis:!0},{key:"bindDate",dataIndex:"bindDate",title:"上架时间",align:"center",checked:!0,ellipsis:!0}]);function p(){m()}function m(){t.current=1,v()}function v(){i.value=!0,U("/mes/jlagv/machine/woker/selectOutMateriel?materiel=".concat(l.value.materiel)).then((({data:e,error:a})=>{a||(e.forEach(((e,a)=>{e.index=a+1})),o.value=e)})).finally((()=>i.value=!1))}v();const h=s(null),g=e=>({style:{background:e.positionCode===h.value?"#BAEAFA":"",backgroundColor:0===Number(e.timeOutFlag)?"rgb(244, 56, 56)":""},class:"".concat(e.positionCode===h.value?"jl-table-row-selected":""),onClick:()=>{h.value=e.positionCode}}),y=s([]);function _(e){y.value=e}function x(){y.value=[]}const b=s(null),{height:k}=N(b),w=S((()=>"".concat(k.value+20,"px")));return(a,s)=>{const v=e,h=B("STable"),k=F;return n(),f("div",T,[u(Q,{model:l.value,"onUpdate:model":s[0]||(s[0]=e=>l.value=e),"selected-row-keys":y.value,onResetChecked:x,onReset:p,onSearch:m},null,8,["model","selected-row-keys"]),u(k,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:c((()=>[u(v,{columns:r.value,"onUpdate:columns":s[1]||(s[1]=e=>r.value=e)},null,8,["columns"])])),default:c((()=>[u(h,{"row-selection":{selectedRowKeys:y.value,onChange:_},columns:r.value,"data-source":o.value,bordered:"",size:"small",loading:i.value,"row-key":"positionCode",pagination:t,"custom-row":g,scroll:{y:"auto"},class:"has-footer-table h-full","row-height":23},{footer:c((()=>[d("div",{ref_key:"tableFooterRef",ref:b,style:{display:"flex","align-items":"center"}},s[2]||(s[2]=[d("div",{style:{width:"20px",height:"14px","background-color":"rgb(244, 56, 56)"}},null,-1),d("span",null,"背景为物料上架时间超过8小时",-1)]),512)])),_:1},8,["row-selection","columns","data-source","loading","pagination"])])),_:1})])}}}),[["__scopeId","data-v-84b9d16f"]]);export{$ as default};
