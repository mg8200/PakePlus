import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{d as l,K as a,L as t,o as s,c as o,w as n,g as d,f as r,s as u,t as i,I as c,v as m,N as p,M as v,O as f,B as h,P as x,Q as y,F as g,r as _,p as w,db as k,a7 as b,S as N,e as T,h as C,W as D}from"./index-B3PZsRwT.js";import{F as I,G as O}from"./index-DqnulfE2.js";import{_ as S}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{C as j}from"./index-BThgVJ70.js";const z={class:"w-full flex"},U={class:"flex"},K={class:"w-full flex-y-center justify-end gap-12px"},M={class:"ml-3px"},R={class:"ml-3px"},Y=l({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:a(["search","reset"],["update:model"]),setup(e,{emit:l}){const a=l,_=t(e,"model");function w(){a("search",_.value)}function k(){_.value.prodOrderNo=null,_.value.moduleNo=null,_.value.pnType=null,_.value.time=null,a("reset",_.value)}return(e,l)=>{const a=c,t=m,b=p,N=v,T=f,C=h,D=x,I=y,O=g,S=j;return s(),o(S,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:n((()=>[d(O,{model:_.value,"label-col":{span:5,md:7},class:"search-form"},{default:n((()=>[r("div",z,[d(I,{gutter:[15,8],wrap:"",class:"w-full"},{default:n((()=>[d(b,{span:24,md:12,lg:6,xl:8,xxl:4},{default:n((()=>[d(t,{label:"工单号",name:"prodOrderNo",class:"m-0","label-col":{}},{default:n((()=>[d(a,{value:_.value.prodOrderNo,"onUpdate:value":l[0]||(l[0]=e=>_.value.prodOrderNo=e),placeholder:"请输入工单号",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:u(w,["enter"])},null,8,["value"])])),_:1})])),_:1}),d(b,{span:24,md:12,lg:6,xl:8,xxl:4},{default:n((()=>[d(t,{label:"生产型号",name:"moduleNo",class:"m-0","label-col":{}},{default:n((()=>[d(a,{value:_.value.moduleNo,"onUpdate:value":l[1]||(l[1]=e=>_.value.moduleNo=e),placeholder:"请输入生产型号",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:u(w,["enter"])},null,8,["value"])])),_:1})])),_:1}),d(b,{span:24,md:12,lg:6,xl:8,xxl:4},{default:n((()=>[d(t,{label:"批次类型",name:"pnType",class:"m-0","label-col":{}},{default:n((()=>[d(a,{value:_.value.pnType,"onUpdate:value":l[2]||(l[2]=e=>_.value.pnType=e),placeholder:"请输入批次类型",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:u(w,["enter"])},null,8,["value"])])),_:1})])),_:1}),d(b,{span:24,md:12,lg:8,xl:8,xxl:6},{default:n((()=>[d(t,{label:"时间范围",name:"time",class:"m-0","label-col":{}},{default:n((()=>[d(N,{value:_.value.time,"onUpdate:value":l[3]||(l[3]=e=>_.value.time=e),"show-time":"",class:"min-form-control","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["value"])])),_:1})])),_:1}),r("div",U,[d(t,{class:"m-0"},{default:n((()=>[r("div",K,[d(C,{type:"primary",ghost:"",class:"mini-btn",onClick:w},{icon:n((()=>[d(T,{class:"align-sub text-icon"})])),default:n((()=>[r("span",M,i(e.$t("common.search")),1)])),_:1}),d(C,{class:"mini-btn",onClick:k},{icon:n((()=>[d(D,{class:"align-sub text-icon"})])),default:n((()=>[r("span",R,i(e.$t("common.reset")),1)])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])])),_:1})}}}),A={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},E={class:"event-form"},F={class:"modal-footer"},P=Object.assign({name:"erpdatasync_ticket-information"},{__name:"index",setup(l){const a=_({prodOrderNo:"",moduleNo:"",pnType:""}),t=w({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","180","300","500"],showQuickJumper:!0,showTotal:e=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{t.current=e,t.pageSize=l,f()}}),o=_([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0},{key:"prodOrderNo",dataIndex:"prodOrderNo",title:"工单号",width:80,align:"center",checked:!0,ellipsis:!0},{key:"moduleNo",dataIndex:"moduleNo",title:"生产型号",width:80,align:"center",checked:!0,ellipsis:!0},{key:"pnType",dataIndex:"pnType",title:"批次类型",width:50,align:"center",checked:!0,ellipsis:!0},{key:"customerName",dataIndex:"customerName",title:"客户名称",width:300,align:"center",checked:!0,ellipsis:!0},{key:"customerCode",dataIndex:"customerCode",title:"客户编码",width:50,align:"center",checked:!0,ellipsis:!0},{key:"custProdNo",dataIndex:"custProdNo",title:"客户型号",width:200,align:"center",checked:!0,ellipsis:!0},{key:"createDate",dataIndex:"createDate",title:"创建时间",width:120,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.createDate?null:k(e.createDate)},{key:"updateDate",dataIndex:"updateDate",title:"修改时间",width:120,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.updateDate?null:k(e.updateDate)},{key:"lmTime",dataIndex:"lmTime",title:"同步时间",width:120,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.lmTime?null:k(e.lmTime)}]),u=_({}),i=_(!1),c=[{type:"input",key:"prodOrderNo",label:"工单号",placeholder:"请输入工单号",span:24}],m=_([]),p=_(!1),v=_([]);function f(){var e;p.value=!0;const l={...a.value};(null==(e=l.time)?void 0:e[0])&&(l.startTime=l.time[0],l.endTime=l.time[1],delete l.time),I({pageSize:t.pageSize,pageNum:t.current,...l}).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1,e.uid=b.genV4().hexNoDelim})),m.value=e.list,t.total=e.total)})).finally((()=>{p.value=!1}))}function x(){u.value={},i.value=!0}function y(){O(u.value).then((({data:e,error:l})=>{var a;l||(null==(a=window.$message)||a.success("手动同步成功"),i.value=!1,f())}))}function g(){t.current=1,f()}_([]),f();const z=_(null),U=e=>({style:{background:e.uid===z.value?"#BAEAFA":""},class:e.uid===z.value?"jl-table-row-selected":"",onClick:()=>{z.value=e.uid}});return(l,f)=>{const _=h,w=e,k=N("STable"),b=j;return s(),T("div",A,[d(Y,{model:a.value,"onUpdate:model":f[0]||(f[0]=e=>a.value=e),onReset:f[1]||(f[1]=e=>g()),onSearch:f[2]||(f[2]=e=>g())},null,8,["model"]),d(b,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card flex-col-stretch sm:flex-1-hidden card-wrapper"},{title:n((()=>[d(_,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:x},{default:n((()=>f[7]||(f[7]=[r("span",{class:"ml-3px"},"数据同步",-1)]))),_:1})])),extra:n((()=>[d(w,{columns:o.value,"onUpdate:columns":f[3]||(f[3]=e=>o.value=e)},null,8,["columns"])])),default:n((()=>[d(k,{columns:o.value,"data-source":m.value,size:"small",bordered:"",loading:p.value,"default-expanded-row-keys":v.value,"row-key":"uid","default-expand-all-rows":!0,scroll:{x:"auto",y:"auto"},pagination:t,class:"h-full","custom-row":U,"row-height":23},null,8,["columns","data-source","loading","default-expanded-row-keys","pagination"]),d(S,{visible:i.value,"onUpdate:visible":f[6]||(f[6]=e=>i.value=e),"destroy-on-close":!0,title:"手动同步工单信息",width:"550px"},{footer:n((()=>[r("div",F,[d(_,{onClick:f[5]||(f[5]=e=>i.value=!1)},{default:n((()=>f[8]||(f[8]=[C("关闭")]))),_:1}),d(_,{type:"primary",onClick:y},{default:n((()=>f[9]||(f[9]=[C("保存")]))),_:1})])])),default:n((()=>[r("div",E,[d(D,{model:u.value,"onUpdate:model":f[4]||(f[4]=e=>u.value=e),"form-list":c},null,8,["model"])])])),_:1},8,["visible"])])),_:1})])}}});export{P as default};
