import{r as e,a0 as t,o as a,e as l,g as i,w as n,f as c,h as s,_ as r,b as d,a1 as o,a3 as u,bh as p,a5 as h,N as m,Q as y,c as f,aa as v,cF as k,i as w,j as g,aj as I,al as x,t as b,J as N}from"./index-B3PZsRwT.js";import{u as P}from"./index-D59UbQ8m.js";import{g as D}from"./api-By23aosn.js";import{p as F,_,g as Q,d as C,a as S}from"./engineering-data-inquiry-BIeYOUOZ.js";import{_ as E}from"./table-DoFSI9NT.js";import{I as R}from"./index-I_sO5Oju.js";import{C as M}from"./index-BThgVJ70.js";import"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import"./pdf-viewer-DuGSG8WR.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import"./isNumber-v5vW-SxR.js";import"./SwapOutlined-WSjUvGaB.js";const T={class:"process-information h-full w-full"},B=["innerHTML"],L=["onClick"],j=["onClick"],H={__name:"process-information",props:{prodId:{type:String,required:!0},moduleData:{type:Object,default:()=>null},processList:{type:Array,default:()=>[]}},setup(d){const o=d,u=e(o.processList);t((()=>o.processList),(e=>{u.value=[...u.value,...e]}),{deep:!0});const p=e(null),h=e({prodId:o.prodId}),m={0:"编写",1:"更改",2:"待处理",3:"编写中",4:"暂停",5:"已回退",6:"反审核",7:"审核中",8:"已上网",9:"完成",10:"取消",11:"外部ECN",12:"外部ECN待处理",13:"内部ECN",19:"样板转生产",20:"ENC更改",25:"报废",27:"申请",28:"入库",29:"发放",34:"归还",35:"接收",36:"审核",37:"确认",100:"PPC审核"};function y(e){let t=Number(e);switch(140917104644e4===t||160913164544e4===t?t=2:140917104654e4===t||140919111754e4===t?t=3:161013095348e4!==t&&140919111738e4!==t||(t=4),Number(t)){case-1:return"#FF0000";case 0:return"#0080FF";case 1:return"#FFA500";case 2:return"#FF8000";case 3:return"#B15BFF";case 4:return"#73BF00";case 5:return"#8E8E8E";case 6:return"#BEBEBE";case 7:return"#FF0000";case 8:return"#4682B4";case 9:return"#0000FF";case 10:return"#007500";default:return"#0000FF"}}const f=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"state",dataIndex:"state",title:"状态",align:"center",checked:!0,ellipsis:!0,width:130,customRender:({record:e})=>{let t=Number(e.state);return 140917104644e4===t||160913164544e4===t?t=2:140917104654e4===t||140919111754e4===t?t=3:161013095348e4!==t&&140919111738e4!==t||(t=4),8===t?i("div",{class:"h-full w-full",title:"已上网",style:{color:y(e.state)}},[s("已上网")]):i("div",{class:"h-full w-full",title:m[t]||"",style:{color:y(e.state)}},[m[t]||""])}},{key:"techName",dataIndex:"techName",title:"工艺名称",align:"center",checked:!0,ellipsis:!0,width:130},{key:"repeatCount",dataIndex:"repeatCount",title:"工步",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipPnlQty",dataIndex:"wipPnlQty",title:"PNL结存",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipSetQty",dataIndex:"wipSetQty",title:"SET结存",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipScrapSet",dataIndex:"wipScrapSet",title:"含废SET",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipscrapPcs",dataIndex:"wipscrapPcs",title:"含废PCS",align:"center",checked:!0,ellipsis:!0,width:130},{key:"waitQty",dataIndex:"waitQty",title:"待产数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"workQty",dataIndex:"workQty",title:"在产数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"finishQty",dataIndex:"finishQty",title:"完成数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"applyScrapQty",dataIndex:"applyScrapQty",title:"报废申请",align:"center",checked:!0,ellipsis:!0,width:130},{key:"applyReworkQty",dataIndex:"applyReworkQty",title:"重工申请",align:"center",checked:!0,ellipsis:!0,width:130},{key:"assitQty",dataIndex:"assitQty",title:"外发数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"delayDate",dataIndex:"delayDate",title:"结存小时",align:"center",checked:!0,ellipsis:!0,width:130}],v=e("工艺备注"),k=e(null);function w(e){var t;v.value=null==(t=null==e?void 0:e.remark)?void 0:t.replace(/\n/g,"<br>"),k.value.getData({prodId:o.moduleData.prodId,techId:e.techId})}const g=e(!1),I=e(null),x=e(null),b="localhost"===window.location.hostname;return(e,t)=>{const d=r,m=E,y=_;return a(),l("div",T,[i(m,{ref_key:"tableRef",ref:p,searchParams:h.value,"onUpdate:searchParams":t[0]||(t[0]=e=>h.value=e),column:f,"show-row-selection":!1,"row-key":"flowId",scroll:{y:"auto"},"is-init-get-data":!1,url:"/erpsyncmes/Mi/findPubtechnology","auto-generate-uuid":!1,"is-pagination":!1,class:"h-full","data-source":u.value,onTableRowClick:w},{title:n((()=>t[2]||(t[2]=[c("span",{class:"color-#646cff"},"制作流程",-1)]))),footer:n((()=>[c("div",{class:"footer-content h-170px overflow-auto p-b-30px text-14px",innerHTML:v.value},null,8,B)])),"contextmenuPopup-orter":n((({args:e})=>[c("li",{class:"popup-item",onClick:t=>{return a=e,F({prodId:o.prodId,techId:a.record.techId},"".concat(o.moduleData.moduleNo,"-").concat(a.record.techName)),void a.hidePopup();var a}},[i(d,{"local-icon":"download",class:"text-16px"}),t[3]||(t[3]=s(" 下载 "))],8,L),c("li",{class:"popup-item",onClick:t=>{return a=e,g.value=!0,x.value="".concat(o.moduleData.moduleNo,"-").concat(a.record.techName,"工程指示数据.pdf 预览"),I.value="".concat(b?"http://192.168.166.169:9999/prod-api/":"/prod-api/","erpsyncmes/mi/print/getPdf?prodId=").concat(o.moduleData.prodId,"&techId=").concat(a.record.techId),void a.hidePopup();var a}},[i(d,{"local-icon":"preview",class:"text-16px"}),t[4]||(t[4]=s(" 预览 "))],8,j)])),_:1},8,["searchParams","data-source"]),i(y,{visible:g.value,"onUpdate:visible":t[1]||(t[1]=e=>g.value=e),url:I.value,type:"pdf","pdf-use-iframe":"",title:x.value},null,8,["visible","url","title"])])}}},Y={class:"h-full w-full"},U={class:"h-49.5%"},A={__name:"engineering-instruction-table",setup(t,{expose:s}){const r=e(null),m=e({prodId:null,techId:null}),y=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"miName",dataIndex:"miName",title:"项目名称",align:"center",checked:!0,ellipsis:!0},{key:"miData",dataIndex:"miData",title:"数据项",align:"center",checked:!0,ellipsis:!0,width:130},{key:"remark",dataIndex:"remark",title:"备注",align:"center",checked:!0,ellipsis:!0,width:130},{key:"createBy",dataIndex:"createBy",title:"编写",align:"center",checked:!0,ellipsis:!0,width:130},{key:"createDate",dataIndex:"createDate",title:"编写日期",align:"center",checked:!0,ellipsis:!0,width:160},{key:"updateDate",dataIndex:"updateDate",title:"最后修改日期",align:"center",checked:!0,ellipsis:!0,width:160}],f=e(null),v=e([]);const k=d((()=>v.value.length?"mb-1% h-49.5%":"h-full"));return s({getData:function(e){m.value=e,h((()=>{r.value.getData(1),f.value.getData(1),Q({techId:e.techId}).then((({data:e,error:t})=>{if(!t&&e.length){const t=e.map((e=>({key:e.fieldName,dataIndex:e.fieldName,title:e.caption,align:"center",checked:!0,ellipsis:!0,width:130})));v.value=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},...t]}else v.value=[]}))}))}}),(e,t)=>{const s=E;return a(),l("div",Y,[c("div",{class:o(k.value)},[i(s,{ref_key:"topTableRef",ref:r,searchParams:m.value,"onUpdate:searchParams":t[0]||(t[0]=e=>m.value=e),class:"h-full",column:y,"show-row-selection":!1,"row-key":"id",scroll:{y:"auto"},"is-init-get-data":!1,url:"/erpsyncmes/Mi/findMiData","auto-generate-uuid":!0,"is-pagination":!1},{title:n((()=>t[2]||(t[2]=[c("span",{class:"color-#646cff"},"工程指示",-1)]))),_:1},8,["searchParams"])],2),u(c("div",U,[i(s,{ref_key:"bottomTableRef",ref:f,searchParams:m.value,"onUpdate:searchParams":t[1]||(t[1]=e=>m.value=e),class:"h-full",column:v.value,"show-row-selection":!1,"row-key":"id",scroll:{y:"auto"},"is-init-get-data":!1,url:"/erpsyncmes/Mi/findMiData2","auto-generate-uuid":!0,"is-pagination":!1},{title:n((()=>t[3]||(t[3]=[c("span",{class:"color-#646cff"},"工程数据",-1)]))),_:1},8,["searchParams","column"])],512),[[p,v.value.length]])])}}},O={class:"process-information h-full w-full"},q=["innerHTML"],z=["onClick"],K=["onClick"],J={__name:"engineering-instruction",props:{prodId:{type:String,required:!0},moduleData:{type:Object,default:()=>null},processList:{type:Array,default:()=>[]}},setup(d){const o=d,u=e(o.processList);t((()=>o.processList),(e=>{u.value=[...u.value,...e]}),{deep:!0});const p=e(null),h=e({prodId:o.prodId}),f={0:"编写",1:"更改",2:"待处理",3:"编写中",4:"暂停",5:"已回退",6:"反审核",7:"审核中",8:"已上网",9:"完成",10:"取消",11:"外部ECN",12:"外部ECN待处理",13:"内部ECN",19:"样板转生产",20:"ENC更改",25:"报废",27:"申请",28:"入库",29:"发放",34:"归还",35:"接收",36:"审核",37:"确认",100:"PPC审核"};function v(e){let t=Number(e);switch(140917104644e4===t||160913164544e4===t?t=2:140917104654e4===t||140919111754e4===t?t=3:161013095348e4!==t&&140919111738e4!==t||(t=4),Number(t)){case-1:return"#FF0000";case 0:return"#0080FF";case 1:return"#FFA500";case 2:return"#FF8000";case 3:return"#B15BFF";case 4:return"#73BF00";case 5:return"#8E8E8E";case 6:return"#BEBEBE";case 7:return"#FF0000";case 8:return"#4682B4";case 9:return"#0000FF";case 10:return"#007500";default:return"#0000FF"}}const k=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"state",dataIndex:"state",title:"状态",align:"center",checked:!0,ellipsis:!0,width:130,customRender:({record:e})=>{let t=Number(e.state);return 140917104644e4===t||160913164544e4===t?t=2:140917104654e4===t||140919111754e4===t?t=3:161013095348e4!==t&&140919111738e4!==t||(t=4),8===t?i("div",{class:"h-full w-full",title:"已上网",style:{color:v(e.state)}},[s("已上网")]):i("div",{class:"h-full w-full",title:f[t]||"",style:{color:v(e.state)}},[f[t]||""])}},{key:"techName",dataIndex:"techName",title:"工艺名称",align:"center",checked:!0,ellipsis:!0,width:130},{key:"repeatCount",dataIndex:"repeatCount",title:"工步",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipPnlQty",dataIndex:"wipPnlQty",title:"PNL结存",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipSetQty",dataIndex:"wipSetQty",title:"SET结存",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipScrapSet",dataIndex:"wipScrapSet",title:"含废SET",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipscrapPcs",dataIndex:"wipscrapPcs",title:"含废PCS",align:"center",checked:!0,ellipsis:!0,width:130},{key:"waitQty",dataIndex:"waitQty",title:"待产数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"workQty",dataIndex:"workQty",title:"在产数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"finishQty",dataIndex:"finishQty",title:"完成数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"applyScrapQty",dataIndex:"applyScrapQty",title:"报废申请",align:"center",checked:!0,ellipsis:!0,width:130},{key:"applyReworkQty",dataIndex:"applyReworkQty",title:"重工申请",align:"center",checked:!0,ellipsis:!0,width:130},{key:"assitQty",dataIndex:"assitQty",title:"外发数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"delayDate",dataIndex:"delayDate",title:"结存小时",align:"center",checked:!0,ellipsis:!0,width:130}],w=e("工艺备注"),g=e(null);function I(e){e.length&&(p.value.setCurrentRowId(e[0]),x(e[0]))}function x(e){var t;w.value=null==(t=null==e?void 0:e.remark)?void 0:t.replace(/\n/g,"<br>"),g.value.getData({prodId:o.moduleData.prodId,techId:e.techId})}const b=e(!1),N=e(null),P=e(null),D="localhost"===window.location.hostname;return(e,t)=>{const d=r,f=E,v=m,Q=y,C=_;return a(),l("div",O,[i(Q,{class:"h-full w-full",gutter:16},{default:n((()=>[i(v,{span:8,class:"h-full"},{default:n((()=>[i(f,{ref_key:"tableRef",ref:p,searchParams:h.value,"onUpdate:searchParams":t[0]||(t[0]=e=>h.value=e),column:k,"show-row-selection":!1,"row-key":"flowId",scroll:{y:"auto"},"is-init-get-data":!1,url:"/erpsyncmes/Mi/findPubtechnology","auto-generate-uuid":!1,"is-pagination":!1,class:"h-full","data-source":u.value,onTableRowClick:x,onTableDataLoadSucess:I},{title:n((()=>t[2]||(t[2]=[c("span",{class:"color-#646cff"},"制作流程",-1)]))),footer:n((()=>[c("div",{class:"footer-content h-170px overflow-auto p-b-30px text-14px",innerHTML:w.value},null,8,q)])),"contextmenuPopup-orter":n((({args:e})=>[c("li",{class:"popup-item",onClick:t=>{return a=e,F({prodId:o.prodId,techId:a.record.techId},"".concat(o.moduleData.moduleNo,"-").concat(a.record.techName)),void a.hidePopup();var a}},[i(d,{"local-icon":"download",class:"text-16px"}),t[3]||(t[3]=s(" 下载 "))],8,z),c("li",{class:"popup-item",onClick:t=>{return a=e,b.value=!0,P.value="".concat(o.moduleData.moduleNo,"-").concat(a.record.techName,"工程指示数据.pdf 预览"),N.value="".concat(D?"http://192.168.166.169:9999/prod-api/":"/prod-api/","erpsyncmes/mi/print/getPdf?prodId=").concat(o.moduleData.prodId,"&techId=").concat(a.record.techId),void a.hidePopup();var a}},[i(d,{"local-icon":"preview",class:"text-16px"}),t[4]||(t[4]=s(" 预览 "))],8,K)])),_:1},8,["searchParams","data-source"])])),_:1}),i(v,{span:16,class:"h-full"},{default:n((()=>[i(A,{ref_key:"engineeringInstructionRef",ref:g},null,512)])),_:1})])),_:1}),i(C,{visible:b.value,"onUpdate:visible":t[1]||(t[1]=e=>b.value=e),url:N.value,type:"pdf","pdf-use-iframe":"",title:P.value},null,8,["visible","url","title"])])}}},G={__name:"production-tools-table",props:{prodId:{type:String,required:!0},moduleData:{type:Object,required:!0}},setup(t,{expose:l}){const i=e(null),s=e({}),r=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"toolsMouldName",dataIndex:"toolsMouldName",title:"项目名称",align:"center",checked:!0,ellipsis:!0},{key:"toolsData",dataIndex:"toolsData",title:"数据项",align:"center",checked:!0,ellipsis:!0},{key:"createBy",dataIndex:"createBy",title:"创建人",align:"center",checked:!0,ellipsis:!0,width:130},{key:"createDate",dataIndex:"createDate",title:"创建时间",align:"center",checked:!0,ellipsis:!0,width:160,customRender:({record:e})=>v(e.createDate).format("YYYY-MM-DD HH:mm:ss")},{key:"updateDate",dataIndex:"updateDate",title:"最后修改时间",align:"center",checked:!0,ellipsis:!0,width:160,customRender:({record:e})=>v(e.updateDate).format("YYYY-MM-DD HH:mm:ss")}];return l({getData:function(e){s.value=e,h((()=>{i.value.getData()}))}}),(e,t)=>{const l=E;return a(),f(l,{ref_key:"tableRef",ref:i,searchParams:s.value,"onUpdate:searchParams":t[0]||(t[0]=e=>s.value=e),class:"h-full",column:r,"show-row-selection":!1,"row-key":"id",scroll:{y:"auto"},"is-init-get-data":!1,url:"/erpsyncmes/mi/tools/mould/list","auto-generate-uuid":!0,"is-pagination":!1},{title:n((()=>t[1]||(t[1]=[c("span",{class:"color-#646cff"},"生产工具",-1)]))),_:1},8,["searchParams"])}}},V={class:"process-information h-full w-full"},W=["innerHTML"],X=["onClick"],Z=["onClick"],$={__name:"production-tools",props:{prodId:{type:String,required:!0},moduleData:{type:Object,default:()=>null},processList:{type:Array,default:()=>[]}},setup(d){const o=d,u=e(o.processList);t((()=>o.processList),(e=>{u.value=[...u.value,...e]}),{deep:!0});const p=e(null),h=e({prodId:o.prodId}),f={0:"编写",1:"更改",2:"待处理",3:"编写中",4:"暂停",5:"已回退",6:"反审核",7:"审核中",8:"已上网",9:"完成",10:"取消",11:"外部ECN",12:"外部ECN待处理",13:"内部ECN",19:"样板转生产",20:"ENC更改",25:"报废",27:"申请",28:"入库",29:"发放",34:"归还",35:"接收",36:"审核",37:"确认",100:"PPC审核"};function v(e){let t=Number(e);switch(140917104644e4===t||160913164544e4===t?t=2:140917104654e4===t||140919111754e4===t?t=3:161013095348e4!==t&&140919111738e4!==t||(t=4),Number(t)){case-1:return"#FF0000";case 0:return"#0080FF";case 1:return"#FFA500";case 2:return"#FF8000";case 3:return"#B15BFF";case 4:return"#73BF00";case 5:return"#8E8E8E";case 6:return"#BEBEBE";case 7:return"#FF0000";case 8:return"#4682B4";case 9:return"#0000FF";case 10:return"#007500";default:return"#0000FF"}}const k=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"state",dataIndex:"state",title:"状态",align:"center",checked:!0,ellipsis:!0,width:130,customRender:({record:e})=>{let t=Number(e.state);return 140917104644e4===t||160913164544e4===t?t=2:140917104654e4===t||140919111754e4===t?t=3:161013095348e4!==t&&140919111738e4!==t||(t=4),8===t?i("div",{class:"h-full w-full",title:"已上网",style:{color:v(e.state)}},[s("已上网")]):i("div",{class:"h-full w-full",title:f[t]||"",style:{color:v(e.state)}},[f[t]||""])}},{key:"techName",dataIndex:"techName",title:"工艺名称",align:"center",checked:!0,ellipsis:!0,width:130},{key:"repeatCount",dataIndex:"repeatCount",title:"工步",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipPnlQty",dataIndex:"wipPnlQty",title:"PNL结存",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipSetQty",dataIndex:"wipSetQty",title:"SET结存",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipScrapSet",dataIndex:"wipScrapSet",title:"含废SET",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipscrapPcs",dataIndex:"wipscrapPcs",title:"含废PCS",align:"center",checked:!0,ellipsis:!0,width:130},{key:"waitQty",dataIndex:"waitQty",title:"待产数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"workQty",dataIndex:"workQty",title:"在产数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"finishQty",dataIndex:"finishQty",title:"完成数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"applyScrapQty",dataIndex:"applyScrapQty",title:"报废申请",align:"center",checked:!0,ellipsis:!0,width:130},{key:"applyReworkQty",dataIndex:"applyReworkQty",title:"重工申请",align:"center",checked:!0,ellipsis:!0,width:130},{key:"assitQty",dataIndex:"assitQty",title:"外发数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"delayDate",dataIndex:"delayDate",title:"结存小时",align:"center",checked:!0,ellipsis:!0,width:130}],w=e("工艺备注"),g=e(null);function I(e){e.length&&(p.value.setCurrentRowId(e[0]),x(e[0]))}function x(e){var t;w.value=null==(t=null==e?void 0:e.remark)?void 0:t.replace(/\n/g,"<br>"),g.value.getData({prodId:o.moduleData.prodId,techId:e.techId})}const b=e(!1),N=e(null),P=e(null),D="localhost"===window.location.hostname;return(e,t)=>{const d=r,f=E,v=m,Q=y,C=_;return a(),l("div",V,[i(Q,{class:"h-full w-full",gutter:16},{default:n((()=>[i(v,{span:8,class:"h-full"},{default:n((()=>[i(f,{ref_key:"tableRef",ref:p,searchParams:h.value,"onUpdate:searchParams":t[0]||(t[0]=e=>h.value=e),column:k,"show-row-selection":!1,"row-key":"flowId",scroll:{y:"auto"},"is-init-get-data":!1,url:"/erpsyncmes/Mi/findPubtechnology","auto-generate-uuid":!1,"is-pagination":!1,class:"h-full","data-source":u.value,onTableRowClick:x,onTableDataLoadSucess:I},{title:n((()=>t[2]||(t[2]=[c("span",{class:"color-#646cff"},"制作流程",-1)]))),footer:n((()=>[c("div",{class:"footer-content h-170px overflow-auto p-b-30px text-14px",innerHTML:w.value},null,8,W)])),"contextmenuPopup-orter":n((({args:e})=>[c("li",{class:"popup-item",onClick:t=>{return a=e,F({prodId:o.prodId,techId:a.record.techId},"".concat(o.moduleData.moduleNo,"-").concat(a.record.techName)),void a.hidePopup();var a}},[i(d,{"local-icon":"download",class:"text-16px"}),t[3]||(t[3]=s(" 下载 "))],8,X),c("li",{class:"popup-item",onClick:t=>{return a=e,b.value=!0,P.value="".concat(o.moduleData.moduleNo,"-").concat(a.record.techName,"工程指示数据.pdf 预览"),N.value="".concat(D?"http://192.168.166.169:9999/prod-api/":"/prod-api/","erpsyncmes/mi/print/getPdf?prodId=").concat(o.moduleData.prodId,"&techId=").concat(a.record.techId),void a.hidePopup();var a}},[i(d,{"local-icon":"preview",class:"text-16px"}),t[4]||(t[4]=s(" 预览 "))],8,Z)])),_:1},8,["searchParams","data-source"])])),_:1}),i(v,{span:16,class:"h-full"},{default:n((()=>[i(G,{ref_key:"productionToolsTable",ref:g},null,512)])),_:1})])),_:1}),i(C,{visible:b.value,"onUpdate:visible":t[1]||(t[1]=e=>b.value=e),url:N.value,type:"pdf","pdf-use-iframe":"",title:P.value},null,8,["visible","url","title"])])}}},ee={__name:"process-engineering-document-table",setup(t,{expose:l}){const i=e(null),s=e({techId:null}),r=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"fileMouldName",dataIndex:"fileMouldName",title:"项目名称",align:"center",checked:!0,ellipsis:!0,width:130},{key:"fileName",dataIndex:"fileName",title:"文件名",align:"center",checked:!0,ellipsis:!0,width:130},{key:"createBy",dataIndex:"createBy",title:"创建人",align:"center",checked:!0,ellipsis:!0,width:130},{key:"createDate",dataIndex:"createDate",title:"创建时间",align:"center",checked:!0,ellipsis:!0,width:160,customRender:({record:e})=>v(e.createDate).format("YYYY-MM-DD HH:mm:ss")},{key:"updateDate",dataIndex:"updateDate",title:"最后修改时间",align:"center",checked:!0,ellipsis:!0,width:160,customRender:({record:e})=>v(e.updateDate).format("YYYY-MM-DD HH:mm:ss")}];return l({getData:function(e){s.value=e,h((()=>{i.value.getData()}))}}),(e,t)=>{const l=E;return a(),f(l,{ref_key:"tableRef",ref:i,searchParams:s.value,"onUpdate:searchParams":t[0]||(t[0]=e=>s.value=e),class:"h-full",column:r,"show-row-selection":!1,"row-key":"id",scroll:{y:"auto"},"is-init-get-data":!1,url:"/erpsyncmes/mi/file/mould/list","is-pagination":!1,"auto-generate-uuid":!0},{title:n((()=>t[1]||(t[1]=[c("span",{class:"color-#646cff"},"工艺工程文件",-1)]))),_:1},8,["searchParams"])}}},te={class:"process-information h-full w-full"},ae=["innerHTML"],le=["onClick"],ie=["onClick"],ne={__name:"process-engineering-document",props:{prodId:{type:String,required:!0},moduleData:{type:Object,default:()=>null},processList:{type:Array,default:()=>[]}},setup(d){const o=d,u=e(o.processList);t((()=>o.processList),(e=>{u.value=[...u.value,...e]}),{deep:!0});const p=e(null),h=e({prodId:o.prodId}),f={0:"编写",1:"更改",2:"待处理",3:"编写中",4:"暂停",5:"已回退",6:"反审核",7:"审核中",8:"已上网",9:"完成",10:"取消",11:"外部ECN",12:"外部ECN待处理",13:"内部ECN",19:"样板转生产",20:"ENC更改",25:"报废",27:"申请",28:"入库",29:"发放",34:"归还",35:"接收",36:"审核",37:"确认",100:"PPC审核"};function v(e){let t=Number(e);switch(140917104644e4===t||160913164544e4===t?t=2:140917104654e4===t||140919111754e4===t?t=3:161013095348e4!==t&&140919111738e4!==t||(t=4),Number(t)){case-1:return"#FF0000";case 0:return"#0080FF";case 1:return"#FFA500";case 2:return"#FF8000";case 3:return"#B15BFF";case 4:return"#73BF00";case 5:return"#8E8E8E";case 6:return"#BEBEBE";case 7:return"#FF0000";case 8:return"#4682B4";case 9:return"#0000FF";case 10:return"#007500";default:return"#0000FF"}}const k=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"state",dataIndex:"state",title:"状态",align:"center",checked:!0,ellipsis:!0,width:130,customRender:({record:e})=>{let t=Number(e.state);return 140917104644e4===t||160913164544e4===t?t=2:140917104654e4===t||140919111754e4===t?t=3:161013095348e4!==t&&140919111738e4!==t||(t=4),8===t?i("div",{class:"h-full w-full",title:"已上网",style:{color:v(e.state)}},[s("已上网")]):i("div",{class:"h-full w-full",title:f[t]||"",style:{color:v(e.state)}},[f[t]||""])}},{key:"techName",dataIndex:"techName",title:"工艺名称",align:"center",checked:!0,ellipsis:!0,width:130},{key:"repeatCount",dataIndex:"repeatCount",title:"工步",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipPnlQty",dataIndex:"wipPnlQty",title:"PNL结存",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipSetQty",dataIndex:"wipSetQty",title:"SET结存",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipScrapSet",dataIndex:"wipScrapSet",title:"含废SET",align:"center",checked:!0,ellipsis:!0,width:130},{key:"wipscrapPcs",dataIndex:"wipscrapPcs",title:"含废PCS",align:"center",checked:!0,ellipsis:!0,width:130},{key:"waitQty",dataIndex:"waitQty",title:"待产数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"workQty",dataIndex:"workQty",title:"在产数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"finishQty",dataIndex:"finishQty",title:"完成数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"applyScrapQty",dataIndex:"applyScrapQty",title:"报废申请",align:"center",checked:!0,ellipsis:!0,width:130},{key:"applyReworkQty",dataIndex:"applyReworkQty",title:"重工申请",align:"center",checked:!0,ellipsis:!0,width:130},{key:"assitQty",dataIndex:"assitQty",title:"外发数量",align:"center",checked:!0,ellipsis:!0,width:130},{key:"delayDate",dataIndex:"delayDate",title:"结存小时",align:"center",checked:!0,ellipsis:!0,width:130}],w=e("工艺备注"),g=e(null);function I(e){e.length&&(p.value.setCurrentRowId(e[0]),x(e[0]))}function x(e){var t;w.value=null==(t=null==e?void 0:e.remark)?void 0:t.replace(/\n/g,"<br>"),g.value.getData({prodId:o.moduleData.prodId,techId:e.techId})}const b=e(!1),N=e(null),P=e(null),D="localhost"===window.location.hostname;return(e,t)=>{const d=r,f=E,v=m,Q=y,C=_;return a(),l("div",te,[i(Q,{class:"h-full w-full",gutter:16},{default:n((()=>[i(v,{span:8,class:"h-full"},{default:n((()=>[i(f,{ref_key:"tableRef",ref:p,searchParams:h.value,"onUpdate:searchParams":t[0]||(t[0]=e=>h.value=e),column:k,"show-row-selection":!1,"row-key":"flowId",scroll:{y:"auto"},"is-init-get-data":!1,url:"/erpsyncmes/Mi/findPubtechnology","auto-generate-uuid":!1,"is-pagination":!1,class:"h-full","data-source":u.value,onTableRowClick:x,onTableDataLoadSucess:I},{title:n((()=>t[2]||(t[2]=[c("span",{class:"color-#646cff"},"制作流程",-1)]))),footer:n((()=>[c("div",{class:"footer-content h-170px overflow-auto p-b-30px text-14px",innerHTML:w.value},null,8,ae)])),"contextmenuPopup-orter":n((({args:e})=>[c("li",{class:"popup-item",onClick:t=>{return a=e,F({prodId:o.prodId,techId:a.record.techId},"".concat(o.moduleData.moduleNo,"-").concat(a.record.techName)),void a.hidePopup();var a}},[i(d,{"local-icon":"download",class:"text-16px"}),t[3]||(t[3]=s(" 下载 "))],8,le),c("li",{class:"popup-item",onClick:t=>{return a=e,b.value=!0,P.value="".concat(o.moduleData.moduleNo,"-").concat(a.record.techName,"工程指示数据.pdf 预览"),N.value="".concat(D?"http://192.168.166.169:9999/prod-api/":"/prod-api/","erpsyncmes/mi/print/getPdf?prodId=").concat(o.moduleData.prodId,"&techId=").concat(a.record.techId),void a.hidePopup();var a}},[i(d,{"local-icon":"preview",class:"text-16px"}),t[4]||(t[4]=s(" 预览 "))],8,ie)])),_:1},8,["searchParams","data-source"])])),_:1}),i(v,{span:16,class:"h-full"},{default:n((()=>[i(ee,{ref_key:"processEngineeringDocumentTableRef",ref:g},null,512)])),_:1})])),_:1}),i(C,{visible:b.value,"onUpdate:visible":t[1]||(t[1]=e=>b.value=e),url:N.value,type:"pdf","pdf-use-iframe":"",title:P.value},null,8,["visible","url","title"])])}}},ce={class:"h-full w-full"},se=["onClick"],re=["onClick"],de={__name:"engineering-document",props:{moduleData:{type:Object,default:()=>null}},setup(d){const o=d,u="localhost"===window.location.hostname,p=e(null),m=e({prodNo:null});t((()=>o.moduleData),(()=>{h((()=>{m.value.prodNo=o.moduleData.moduleNo,p.value.getData()}))}),{deep:!0});const y=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"fileName",dataIndex:"fileName",title:"文件名",align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>i("span",{class:"cursor-pointer color-blue",onClick:()=>k({record:e})},[e.fileName])},{key:"fileSizeKb",dataIndex:"fileSizeKb",title:"文件大小",align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>"".concat(e.fileSizeKb,"KB")},{key:"fileModifiedTime",dataIndex:"fileModifiedTime",title:"更改时间",align:"center",checked:!0,ellipsis:!0}];const f=e(!1),v=e(null);function k(e){f.value=!0,v.value="".concat(u?"http://192.168.166.169:9999/prod-api/":"/prod-api/","rcerp/erpMiFile/downMiFile?prodNo=").concat(e.record.prodNo,"&fileName=").concat(e.record.fileName),e.hidePopup()}return(e,t)=>{const d=r,o=E,u=_;return a(),l("div",ce,[i(o,{ref_key:"tableRef",ref:p,searchParams:m.value,"onUpdate:searchParams":t[0]||(t[0]=e=>m.value=e),class:"h-full",column:y,"show-row-selection":!1,"row-key":"id",scroll:{y:"auto"},"is-init-get-data":!1,url:"/rcerp/erpMiFile/getMiFileList","auto-generate-uuid":!0,"is-pagination":!1,onTableRowDblclick:t[1]||(t[1]=e=>k({record:e}))},{title:n((()=>t[3]||(t[3]=[c("span",{class:"color-#646cff"},"工程文件",-1)]))),"contextmenuPopup-orter":n((({args:e})=>[c("li",{class:"popup-item",onClick:t=>{return C({prodNo:(a=e).record.prodNo,fileName:a.record.fileName}),void a.hidePopup();var a}},[i(d,{"local-icon":"download",class:"text-16px"}),t[4]||(t[4]=s(" 下载 "))],8,se),c("li",{class:"popup-item",onClick:t=>k(e)},[i(d,{"local-icon":"preview",class:"text-16px"}),t[5]||(t[5]=s(" 预览 "))],8,re)])),_:1},8,["searchParams"]),i(u,{visible:f.value,"onUpdate:visible":t[2]||(t[2]=e=>f.value=e),url:v.value,"pdf-use-iframe":""},null,8,["visible","url"])])}}},oe={class:"h-full w-full"},ue={key:1,class:"h-full w-full flex-center"},pe={__name:"engineering-drawing",props:{moduleData:{type:Object,required:!0}},setup(n){const c=n,s=k.PRESENTED_IMAGE_SIMPLE,r=e(null),d="localhost"===window.location.hostname;return t((()=>c.moduleData),(()=>{h((()=>{S({prodNo:c.moduleData.moduleNo,techId:"1350000053540000"}).then((({data:e,error:t})=>{t||(e.image?r.value="".concat(d?"http://192.168.166.166/prod-api/":"/prod-api/").concat(e.image):r.value=null)}))}))}),{deep:!0}),(e,t)=>{const n=R,c=k;return a(),l("div",oe,[r.value?(a(),f(n,{key:0,src:r.value},null,8,["src"])):(a(),l("div",ue,[i(c,{image:w(s),description:"暂无工程图纸"},null,8,["image"])]))])}}},he={class:"h-full w-full flex p-10px"},me={class:"left-tabs"},ye={class:"tab-list"},fe=["onClick"],ve={class:"cotent h-full"},ke={class:"basic-information w-280px"},we={class:"basic-information-body"},ge={class:"basic-information-list"},Ie={class:"basic-information-item"},xe=["title"],be={class:"basic-information-item"},Ne=["title"],Pe={class:"basic-information-item"},De=["title"],Fe={class:"basic-information-item"},_e=["title"],Qe={class:"basic-information-item"},Ce=["title"],Se={class:"basic-information-item"},Ee=["title"],Re={class:"basic-information-item"},Me=["title"],Te=N(Object.assign({name:"mi-design_engineering-design"},{__name:"index",setup(t){const r=e(null),d=P("prodId");g((()=>{r.value=JSON.parse(sessionStorage.getItem("mi-data"))[d.value]}));const h=e("1"),m=[{key:"1",tab:"流程信息",icon:"icon-gongyiliucheng"},{key:"2",tab:"工程指示",icon:"icon-gongchengzhishi"},{key:"3",tab:"生产工具",icon:"icon-shengchangongju"},{key:"4",tab:"工艺文件",icon:"icon-gongyiwenjian"},{key:"5",tab:"工程文件",icon:"icon-gongchengwenjian"},{key:"6",tab:"工程图纸",icon:"icon-gongchengtuzhi"}];const y=e([]);return D("/erpsyncmes/Mi/findPubtechnology",{prodId:d.value}).then((({data:e,error:t})=>{t||(e.forEach(((e,t)=>{e.dataIndex=t+1})),y.value=e)})),(e,t)=>{const f=M;return a(),l("div",he,[c("div",me,[c("div",ye,[(a(),l(I,null,x(m,(e=>c("div",{key:e.key,class:o(["tab-item",{active:h.value===e.key}]),onClick:t=>{return a=e.key,void(h.value=a);var a}},[c("span",{class:o(["iconfont",e.icon])},null,2),s(" "+b(e.tab),1)],10,fe))),64))])]),c("div",ve,[u(i(H,{"prod-id":w(d),"module-data":r.value,"process-list":y.value},null,8,["prod-id","module-data","process-list"]),[[p,"1"===h.value]]),u(i(J,{"prod-id":w(d),"module-data":r.value,"process-list":y.value},null,8,["prod-id","module-data","process-list"]),[[p,"2"===h.value]]),u(i($,{"prod-id":w(d),"module-data":r.value,"process-list":y.value},null,8,["prod-id","module-data","process-list"]),[[p,"3"===h.value]]),u(i(ne,{"prod-id":w(d),"module-data":r.value,"process-list":y.value},null,8,["prod-id","module-data","process-list"]),[[p,"4"===h.value]]),u(i(de,{"module-data":r.value},null,8,["module-data"]),[[p,"5"===h.value]]),u(i(pe,{"module-data":r.value},null,8,["module-data"]),[[p,"6"===h.value]])]),c("div",ke,[i(f,{size:"small"},{title:n((()=>t[0]||(t[0]=[c("div",{class:"card-title"},"基础信息",-1)]))),default:n((()=>{var e,a,l,i,n,s,d,o,u,p,h,m,y,f;return[c("div",we,[c("div",ge,[c("div",Ie,[t[1]||(t[1]=c("div",{class:"basic-information-label"},"生产型号",-1)),c("div",{class:"basic-information-value",title:null==(e=r.value)?void 0:e.moduleNo},b(null==(a=r.value)?void 0:a.moduleNo),9,xe)]),c("div",be,[t[2]||(t[2]=c("div",{class:"basic-information-label"},"终端客户型号",-1)),c("div",{class:"basic-information-value",title:null==(l=r.value)?void 0:l.targetProdNo},b(null==(i=r.value)?void 0:i.targetProdNo),9,Ne)]),c("div",Pe,[t[3]||(t[3]=c("div",{class:"basic-information-label"},"客户型号",-1)),c("div",{class:"basic-information-value",title:null==(n=r.value)?void 0:n.custProdNo},b(null==(s=r.value)?void 0:s.custProdNo),9,De)]),c("div",Fe,[t[4]||(t[4]=c("div",{class:"basic-information-label"},"产品类型",-1)),c("div",{class:"basic-information-value",title:null==(d=r.value)?void 0:d.prodType},b(null==(o=r.value)?void 0:o.prodType),9,_e)]),c("div",Qe,[t[5]||(t[5]=c("div",{class:"basic-information-label"},"开发等级",-1)),c("div",{class:"basic-information-value",title:null==(u=r.value)?void 0:u.peDifficulty},b(null==(p=r.value)?void 0:p.peDifficulty),9,Ce)]),c("div",Se,[t[6]||(t[6]=c("div",{class:"basic-information-label"},"板上型号",-1)),c("div",{class:"basic-information-value",title:null==(h=r.value)?void 0:h.peTab},b(null==(m=r.value)?void 0:m.peTab),9,Ee)]),c("div",Re,[t[7]||(t[7]=c("div",{class:"basic-information-label"},"板子特性",-1)),c("div",{class:"basic-information-value",title:null==(y=r.value)?void 0:y.features},b(null==(f=r.value)?void 0:f.features),9,Me)])])])]})),_:1})])])}}}),[["__scopeId","data-v-70cb0333"]]);export{Te as default};
