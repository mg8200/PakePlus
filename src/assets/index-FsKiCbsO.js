import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{d as l,r as a,p as t,o as n,e as s,g as i,w as u,f as c,s as o,I as d,v as r,N as m,O as p,B as f,P as v,Q as x,F as h,K as g,L as y,h as _,t as w,aj as k,a5 as b,ak as I,M as q,a7 as T,S}from"./index-B3PZsRwT.js";import{g as z,a as C}from"./equipment-alarm-info-RrvTGqWc.js";import{_ as j}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{C as E}from"./index-BThgVJ70.js";import{_ as N}from"./index-Cn-BWYp5.js";import"./fromPairs-BI-MgVCs.js";const U={class:"jl-main-page h-full flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},O={class:"w-full flex"},K={class:"flex"},Q={class:"w-full flex-y-center justify-end gap-12px"},A=l({__name:"code-list",setup(l,{expose:g}){const y=a(null),_=a([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"equipmentId",dataIndex:"equipmentId",title:"设备代码",align:"center",checked:!0,ellipsis:!0},{key:"description",dataIndex:"description",title:"设备描述",align:"center",checked:!0,ellipsis:!0}]),w=a(null),k=a({type:"radio",onChange:e=>{w.value=e[0]}}),b=a([]),I=a(!1),q=t({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{q.current=e,q.pageSize=l,C()}});function T(){q.current=1,C()}function S(){y.value=null,q.current=1,C()}function C(){const e={equipmentId:y.value,pageSize:q.pageSize,pageNum:q.current};I.value=!0,z(e).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1})),q.total=e.total,b.value=e.list)})).finally((()=>I.value=!1))}return C(),g({currentSelect:w}),(l,a)=>{const t=d,g=r,w=m,z=p,C=f,j=v,A=x,M=h,B=E,F=e,J=N;return n(),s("div",U,[i(B,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:u((()=>[i(M,{"label-col":{span:5,md:7},class:"search-form"},{default:u((()=>[c("div",O,[i(A,{gutter:[15,8],wrap:"",class:"w-full"},{default:u((()=>[i(w,{span:24,md:12,lg:8,xl:8,xxl:8},{default:u((()=>[i(g,{label:"设备代码",name:"equipmentId",class:"m-0","label-col":{}},{default:u((()=>[i(t,{value:y.value,"onUpdate:value":a[0]||(a[0]=e=>y.value=e),placeholder:"请输入设备代码",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:o(T,["enter"])},null,8,["value"])])),_:1})])),_:1}),c("div",K,[i(g,{class:"m-0"},{default:u((()=>[c("div",Q,[i(C,{type:"primary",ghost:"",class:"mini-btn",onClick:T},{icon:u((()=>[i(z,{class:"align-sub text-icon"})])),default:u((()=>[a[2]||(a[2]=c("span",{class:"ml-3px"},"搜索",-1))])),_:1}),i(C,{class:"mini-btn",onClick:S},{icon:u((()=>[i(j,{class:"align-sub text-icon"})])),default:u((()=>[a[3]||(a[3]=c("span",{class:"ml-3px"},"重置",-1))])),_:1})])])),_:1})])])),_:1})])])),_:1})])),_:1}),i(B,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:u((()=>[i(F,{columns:_.value,"onUpdate:columns":a[1]||(a[1]=e=>_.value=e)},null,8,["columns"])])),default:u((()=>[i(J,{columns:_.value,"data-source":b.value,bordered:"","row-selection":k.value,size:"small",loading:I.value,"row-key":"equipmentId",pagination:q,scroll:{x:"auto",y:"auto"},class:"h-full"},null,8,["columns","data-source","row-selection","loading","pagination"])])),_:1})])}}}),M={class:"w-full flex"},B={class:"flex"},F={class:"w-full flex-y-center justify-end gap-12px"},J={class:"ml-3px"},L=l({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:g(["search"],["update:model"]),setup(e,{emit:l}){const t=l,g=y(e,"model"),T=a(!1),S=a(null);function z(){t("search",g.value)}function C(){g.value={equipmentId:null,alarmText:null,time:null},t("search",g.value)}function N(){T.value=!0}function U(){b((()=>{g.value.equipmentId=S.value.currentSelect,T.value=!1,t("search",g.value)}))}return(e,l)=>{const a=d,t=f,y=I,b=r,O=m,K=q,Q=p,L=v,P=x,R=h,D=E;return n(),s(k,null,[i(D,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:u((()=>[i(R,{model:g.value,"label-col":{span:5,md:7},class:"search-form"},{default:u((()=>[c("div",M,[i(P,{gutter:[15,8],wrap:"",class:"w-full"},{default:u((()=>[i(O,{span:24,md:12,lg:8,xl:8,xxl:6},{default:u((()=>[i(b,{label:"设备代码",name:"equipmentId",class:"m-0","label-col":{}},{default:u((()=>[i(y,{compact:""},{default:u((()=>[i(a,{value:g.value.equipmentId,"onUpdate:value":l[0]||(l[0]=e=>g.value.equipmentId=e),style:{width:"calc(100% - 63px)"},class:"min-form-control",autocomplete:"off",onKeypress:o(z,["enter"])},null,8,["value"]),i(t,{type:"primary",class:"mini-btn",onClick:N},{default:u((()=>l[4]||(l[4]=[_("搜索")]))),_:1})])),_:1})])),_:1})])),_:1}),i(O,{span:24,md:12,lg:8,xl:8,xxl:6},{default:u((()=>[i(b,{label:"告警内容",name:"alarmText",class:"m-0","label-col":{}},{default:u((()=>[i(a,{value:g.value.alarmText,"onUpdate:value":l[1]||(l[1]=e=>g.value.alarmText=e),placeholder:"请输入告警内容",class:"min-form-control",autocomplete:"off",onKeypress:o(z,["enter"])},null,8,["value"])])),_:1})])),_:1}),i(O,{span:24,md:12,lg:8,xl:8,xxl:6},{default:u((()=>[i(b,{label:"计划时间",name:"time",class:"m-0","label-col":{}},{default:u((()=>[i(K,{value:g.value.time,"onUpdate:value":l[2]||(l[2]=e=>g.value.time=e),"show-time":"",class:"min-form-control"},null,8,["value"])])),_:1})])),_:1}),c("div",B,[i(b,{class:"m-0"},{default:u((()=>[c("div",F,[i(t,{type:"primary",ghost:"",class:"mini-btn",onClick:z},{icon:u((()=>[i(Q,{class:"align-sub text-icon"})])),default:u((()=>[l[5]||(l[5]=c("span",{class:"ml-3px"},"查询",-1))])),_:1}),i(t,{class:"mini-btn",onClick:C},{icon:u((()=>[i(L,{class:"align-sub text-icon"})])),default:u((()=>[c("span",J,w(e.$t("common.reset")),1)])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])])),_:1}),i(j,{visible:T.value,"onUpdate:visible":l[3]||(l[3]=e=>T.value=e),title:"代码列表",height:"70vh",width:"800px",onOk:U},{default:u((()=>[i(A,{ref_key:"codeListRef",ref:S},null,512)])),_:1},8,["visible"])],64)}}}),P={class:"jl-main-page one-code-ascend min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},R=l({name:"collection-management_equipment-alarm-info",__name:"index",setup(l){const c=a({equipmentId:null,alarmText:null,time:null}),o=t({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{o.current=e,o.pageSize=l,v()}}),d=a([]),r=a(!1),m=a([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"mainEqpId",dataIndex:"mainEqpId",title:"线体代码",width:140,align:"center",checked:!0,ellipsis:!0},{key:"mainEqpName",dataIndex:"mainEqpName",title:"线体名称",width:160,align:"center",checked:!0,ellipsis:!0},{key:"subEqpId",dataIndex:"subEqpId",title:"设备",width:160,align:"center",checked:!0,ellipsis:!0},{key:"subEqpName",dataIndex:"subEqpName",title:"设备名称",width:160,align:"center",checked:!0,ellipsis:!0},{key:"dateTime",dataIndex:"dateTime",title:"建立时间",align:"center",checked:!0,ellipsis:!0},{key:"alarmId",dataIndex:"alarmId",title:"警报代码",align:"center",checked:!0,width:100,ellipsis:!0},{key:"alarmCategory",dataIndex:"alarmCategory",title:"警报类型",align:"center",width:100,checked:!0,ellipsis:!0},{key:"alarmText",dataIndex:"alarmText",title:"警报内容",align:"center",width:200,checked:!0,ellipsis:!0},{key:"startTime",dataIndex:"startTime",title:"开始时间",align:"center",checked:!0,ellipsis:!0},{key:"endTime",dataIndex:"endTime",title:"结束时间",align:"center",checked:!0,ellipsis:!0}]);function p(){f()}function f(){o.current=1,v()}function v(){var e;const l={pageNum:o.current,pageSize:o.pageSize,equipmentId:c.value.equipmentId,alarmText:c.value.alarmText};(null==(e=c.value.time)?void 0:e[0])&&(l.beginTime=c.value.time[0],l.endTime=c.value.time[1]),r.value=!0,C(l).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1,e.uid=T.genV4().hexNoDelim})),o.total=e.total,d.value=e.list)})).finally((()=>r.value=!1))}v();const x=a(null),h=e=>({style:{background:e.uid===x.value?"#BAEAFA":""},class:e.uid===x.value?"jl-table-row-selected":"",onClick:()=>{x.value=e.uid}});return(l,a)=>{const t=e,v=S("STable"),x=E;return n(),s("div",P,[i(L,{model:c.value,"onUpdate:model":a[0]||(a[0]=e=>c.value=e),onReset:p,onSearch:f},null,8,["model"]),i(x,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:u((()=>[i(t,{columns:m.value,"onUpdate:columns":a[1]||(a[1]=e=>m.value=e)},null,8,["columns"])])),default:u((()=>[i(v,{columns:m.value,"data-source":d.value,bordered:"",size:"small",loading:r.value,"row-key":"uid",pagination:o,"custom-row":h,scroll:{x:1680,y:"auto"},class:"h-full","row-height":23},null,8,["columns","data-source","loading","pagination"])])),_:1})])}}});export{R as default};
