import{_ as e}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{_ as a}from"./table-DoFSI9NT.js";import{Z as l,r as t,g as i,B as s,h as n,b as o,a0 as c,o as d,e as r,w as u,f as m,t as v,aj as p,W as h,J as f,a5 as x,af as g,al as y,c as k,O as b}from"./index-B3PZsRwT.js";import{_}from"./common-search.vue_vue_type_script_setup_true_lang-BX9APgbN.js";import{_ as I}from"./round-edit-DZi1TDWc.js";import{g as w}from"./api-By23aosn.js";import{_ as j}from"./round-add-MytOGm9O.js";import{I as C}from"./index-I_sO5Oju.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import"./index-BThgVJ70.js";import"./isNumber-v5vW-SxR.js";import"./SwapOutlined-WSjUvGaB.js";const P={style:{width:"100%",height:"100%","border-radius":"7.76px",display:"flex"}},T={class:"modal-footer"},U={class:"modal-footer"},z=f({__name:"timeclock",props:{visible:{type:Boolean,default:()=>!1}},emits:["close"],setup(f,{emit:x}){const g=t(null),y=t(null),k=t({deviceId:null}),b=t([{key:"dataIndex",dataIndex:"dataIndex",title:"序号",align:"center",checked:!0,width:80,ellipsis:!0},{key:"deviceId",dataIndex:"deviceId",title:"设备名称",align:"center",width:250,checked:!0,ellipsis:!0},{key:"time",dataIndex:"time",title:"锁定时间",align:"center",checked:!0,width:250,ellipsis:!0},{key:"table-cz",dataIndex:"table-cz",title:"操作",align:"center",width:175,checked:!0,ellipsis:!0,fixed:"right",customRender:({record:e})=>i("div",null,[i(s,{type:"link",danger:!0,class:"pl-3px pr-3px",onClick:()=>{var a;a=e,window.$modal.confirm({title:"确定删除?",onOk:()=>{var e;(e=a.id,l({url:"/mes/exposureCleaningTime/delete?id=".concat(e),method:"delete"})).then((({error:e})=>{e||(window.$message.success("删除成功"),J())}))},onCancel:()=>{}})}},{default:()=>[n("删除")]}),i(s,{type:"link",class:"pl-3px pr-3px",onClick:()=>{var a;a=e,N.value=a,q.value=!0,E.value=a?"edit":"add",a&&(A.value.deviceId=a.deviceId,A.value.time=a.time)}},{default:()=>[n("修改")]})])}]),_=o((()=>{const e={...k.value};return delete e.time,e})),I=f,w=x,C=t([]),z=[{type:"select",key:"deviceId",label:"设备名称",placeholder:"请选择设备名称",span:24,rule:{required:!0,message:"请选择设备名称",trigger:"blur"},selectOptions:C},{type:"timePicker",key:"time",label:"锁定时间",span:24,rule:{required:!0,message:"请选择锁定时间",trigger:"blur"}}];var B;l({url:"/mes/exposureDevice/selectByDeviceAndTime",method:"get",params:B}).then((({data:e,error:a})=>{a||(C.value=null==e?void 0:e.map((e=>({label:e.name,value:e.name}))))}));const A=t({}),R=t(I.visible),E=t("add"),q=t(!1),N=t(null),O=t(!1),D=t(null);function S(){q.value=!0,E.value="add",A.value={}}function H(){R.value=!1,L()}function L(){q.value=!1,w("close")}function $(){const e={deviceId:A.value.deviceId,time:A.value.time,...D.value};let a;O.value=!0;const t={deviceId:e.deviceId,time:e.time,...e.model};a="add"===E.value?l({url:"/mes/exposureCleaningTime/add",method:"post",data:t}):function(e){return l({url:"/mes/exposureCleaningTime/update",method:"post",data:e})}({...t,id:N.value.id}),a.then((({error:e})=>{e||(window.$message.success("".concat("add"===E.value?"新增":"修改","成功")),L(),J())})).finally((()=>O.value=!1))}function J(){g.value.getData(1)}return c((()=>I.visible),(e=>{R.value=e})),(l,t)=>{const o=j,c=s,f=a,x=h;return d(),r(p,null,[i(e,{visible:R.value,"onUpdate:visible":t[1]||(t[1]=e=>R.value=e),title:"时间锁定详情",width:"800px",height:"600px","destroy-on-close":!0,centered:!0,onClose:L},{footer:u((()=>[m("div",T,[i(c,{onClick:H},{default:u((()=>t[5]||(t[5]=[n("关 闭")]))),_:1})])])),default:u((()=>[m("div",P,[i(f,{ref_key:"leftTableRef",ref:g,searchParams:_.value,"onUpdate:searchParams":t[0]||(t[0]=e=>_.value=e),"show-row-selection":!1,column:b.value,"auto-generate-uuid":"",url:"/mes/exposureCleaningTime/selectAll",class:"h-full"},{title:u((()=>[i(c,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:S},{icon:u((()=>[i(o,{class:"align-sub text-icon"})])),default:u((()=>[t[4]||(t[4]=m("span",{class:"ml-3px"},"新增设备锁定",-1))])),_:1})])),_:1},8,["searchParams","column"])])])),_:1},8,["visible"]),i(e,{visible:q.value,"onUpdate:visible":t[3]||(t[3]=e=>q.value=e),title:"设备锁定".concat("add"===E.value?"新增":"修改"),width:"500px",height:"300px",centered:!0,"destroy-on-close":!0},{footer:u((()=>[m("div",U,[i(c,{loading:O.value,type:"primary",onClick:$},{default:u((()=>[n(v("add"===E.value?"新增":"修改"),1)])),_:1},8,["loading"]),i(c,{onClick:L},{default:u((()=>t[6]||(t[6]=[n("关 闭")]))),_:1})])])),default:u((()=>[i(x,{ref_key:"formRef",ref:y,model:A.value,"onUpdate:model":t[2]||(t[2]=e=>A.value=e),"form-list":z},null,8,["model"])])),_:1},8,["visible","title"])],64)}}},[["__scopeId","data-v-0c0e23b3"]]),B={class:"jl-main-page min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},A={style:{width:"100%",height:"100%",border:"1px solid rgb(172, 171, 171)","border-radius":"7.76px",display:"flex"}},R={class:"right-box"},E={class:"text-box"},q={class:"main-box"},N={class:"item-box"},O={class:"main-key"},D={class:"item-box"},S={class:"main-key"},H={class:"item-box"},L={class:"main-key"},$={class:"item-box"},J={class:"main-key"},G={class:"left-box"},W={class:"photo-box"},Z={key:1,class:"no-photo"},F={class:"modal-footer"},K=f(Object.assign({name:"collection-management_equipment-dynamic-rate-acquisition_exposure-machine-cleaning"},{__name:"index",setup(l){const c=t(null),h=t(null),f=t({name:null}),j=[{type:"input",key:"name",label:"设备名称",placeholder:"请输入设备名称",span:24,md:12,lg:8,xl:8,xxl:5}],P=t([{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"deviceId",dataIndex:"deviceId",title:"设备名称",align:"center",checked:!0,ellipsis:!0},{key:"unlockTime",dataIndex:"unlockTime",title:"解锁时间",align:"center",checked:!0,ellipsis:!0},{key:"unlockedBy",dataIndex:"unlockedBy",title:"解锁人",align:"center",checked:!0,ellipsis:!0},{key:"notes",dataIndex:"notes",title:"备注",align:"center",checked:!0,ellipsis:!0},{key:"operate",dataIndex:"operate",title:"操作",width:200,align:"center",checked:!0,ellipsis:!0,fixed:"right",customRender:({record:e})=>i(s,{type:"link",size:"small",onClick:()=>{return a=e,U.value=!0,x((()=>{const e=document.getElementsByClassName("ant-modal");e&&e.length>0&&Array.from(e).forEach((e=>{e.childNodes&&e.childNodes.length>0&&Array.from(e.childNodes).forEach((e=>{e.setAttribute&&e.setAttribute("aria-hidden","false")}))}))})),M.value={...a},M.value.notes=a.notes,void function(){Q.value=!0;const e={},a=M.value.id;w("/mes/exposureUnlockImage/getExposureUnlockImage?historyId=".concat(a),{...e}).then((({data:e,error:a})=>{if(!a){const a=e.map((e=>{const a="localhost"===location.hostname;return"".concat(a?"http://192.168.166.169:9999":"","/prod-api/mes/exposureUnlockImage/Inner1?filename=").concat(e.imagePath)}));M.value.images=a}})).catch((e=>{reject(e)})).finally((()=>{Q.value=!1}))}().then((e=>{M.value.images=e,U.value=!0})).catch((e=>{}));var a}},{default:()=>[i(I,{class:"align-sub text-icon"},null),n("详情")]})}]),T=o((()=>{const e={...f.value};return delete e.time,e})),U=t(!1),K=t(!1),M=t({}),Q=t(!1);function V(){K.value=!0}function X(){x((()=>{f.value={name:null,deviceId:null},Y()}))}function Y(){c.value.getData()}const ee=t(42);return window.addEventListener("resize",(()=>{x((()=>{const e=document.querySelector(".pr nted-code .search-box"),a=null==e?void 0:e.clientHeight;ee.value=a||42}))})),g((()=>{window.removeEventListener("resize",(()=>{}))})),(l,t)=>{const o=_,x=b,g=s,I=a,w=C,Q=e;return d(),r("div",B,[i(o,{ref_key:"commonSearchRef",ref:h,searchParams:f.value,"onUpdate:searchParams":t[0]||(t[0]=e=>f.value=e),"form-list":j,"is-search":!0,onSearch:Y,onReset:X},null,8,["searchParams"]),i(I,{ref_key:"leftTableRef",ref:c,searchParams:T.value,"onUpdate:searchParams":t[1]||(t[1]=e=>T.value=e),"show-row-selection":!1,column:P.value,scroll:{x:"1600",y:"auto"},"auto-generate-uuid":"",url:"/mes/exposureLockHistory/select",class:"h-full"},{title:u((()=>[i(g,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:V},{icon:u((()=>[i(x,{class:"align-sub text-icon"})])),default:u((()=>[t[5]||(t[5]=m("span",{class:"ml-3px"},"设备锁定时间",-1))])),_:1})])),_:1},8,["searchParams","column"]),i(Q,{visible:U.value,"onUpdate:visible":t[3]||(t[3]=e=>U.value=e),"destroy-on-close":!0,centered:!0,title:"曝光机详细",width:"1350px",height:"750px"},{footer:u((()=>[m("div",F,[i(g,{onClick:t[2]||(t[2]=e=>U.value=!1)},{default:u((()=>t[16]||(t[16]=[n("关闭")]))),_:1})])])),default:u((()=>[m("div",A,[m("div",R,[t[15]||(t[15]=m("div",{class:"iconclass"},[m("div",{class:"iconfont icon-hongruidayinshujucaiji iconfontclass"})],-1)),m("div",E,v(M.value.deviceId),1),m("div",q,[t[14]||(t[14]=m("div",{class:"item-box"},[m("span",{class:"message"},"图片为曝光机实拍")],-1)),m("div",N,[t[6]||(t[6]=m("div",{class:"item-box-left1"},[m("span",{class:"iconfont icon-picihao iconfontitem1"})],-1)),t[7]||(t[7]=m("i",null,"设备编号",-1)),m("span",O,v(M.value.deviceId),1)]),m("div",D,[t[8]||(t[8]=m("div",{class:"item-box-left1"},[m("span",{class:"iconfont icon-kehuxinxi- iconfontitem1"})],-1)),t[9]||(t[9]=m("i",null,"录入员",-1)),m("span",S,v(M.value.unlockedBy),1)]),m("div",H,[t[10]||(t[10]=m("div",{class:"item-box-left1"},[m("span",{class:"iconfont icon-denglurizhi iconfontitem2"})],-1)),t[11]||(t[11]=m("i",null,"录入时间",-1)),m("span",L,v(M.value.unlockTime),1)]),m("div",$,[t[12]||(t[12]=m("div",{class:"item-box-left1"},[m("span",{class:"iconfont icon-xinxicaiji1 iconfontitem3"})],-1)),t[13]||(t[13]=m("i",null,"备注",-1)),m("span",J,v(M.value.notes),1)])])]),m("div",G,[m("div",W,[M.value.images&&M.value.images.length>0?(d(!0),r(p,{key:0},y(M.value.images,((e,a)=>(d(),k(w,{key:a,src:e,class:"photo"},null,8,["src"])))),128)):(d(),r("div",Z,"未录入照片"))])])])])),_:1},8,["visible"]),i(z,{visible:K.value,onClose:t[4]||(t[4]=e=>K.value=!1)},null,8,["visible"])])}}}),[["__scopeId","data-v-20c7e57d"]]);export{K as default};
