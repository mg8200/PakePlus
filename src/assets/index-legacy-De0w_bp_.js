!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */n=function(){return r};var t,r={},a=Object.prototype,i=a.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},l="function"==typeof Symbol?Symbol:{},u=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",s=l.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(t){d=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var a=t&&t.prototype instanceof b?t:b,i=Object.create(a.prototype),l=new C(r||[]);return o(i,"_invoke",{value:Q(e,n,l)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=p;var v="suspendedStart",y="suspendedYield",h="executing",m="completed",g={};function b(){}function x(){}function k(){}var w={};d(w,u,(function(){return this}));var D=Object.getPrototypeOf,I=D&&D(D(M([])));I&&I!==a&&i.call(I,u)&&(w=I);var Y=k.prototype=b.prototype=Object.create(w);function _(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function T(t,n){function r(a,o,l,u){var c=f(t[a],t,o);if("throw"!==c.type){var s=c.arg,d=s.value;return d&&"object"==e(d)&&i.call(d,"__await")?n.resolve(d.__await).then((function(e){r("next",e,l,u)}),(function(e){r("throw",e,l,u)})):n.resolve(d).then((function(e){s.value=e,l(s)}),(function(e){return r("throw",e,l,u)}))}u(c.arg)}var a;o(this,"_invoke",{value:function(e,t){function i(){return new n((function(n,a){r(e,t,n,a)}))}return a=a?a.then(i,i):i()}})}function Q(e,n,r){var a=v;return function(i,o){if(a===h)throw Error("Generator is already running");if(a===m){if("throw"===i)throw o;return{value:t,done:!0}}for(r.method=i,r.arg=o;;){var l=r.delegate;if(l){var u=j(l,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===v)throw a=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=h;var c=f(e,n,r);if("normal"===c.type){if(a=r.done?m:y,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=m,r.method="throw",r.arg=c.arg)}}}function j(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,j(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=f(a,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function M(n){if(n||""===n){var r=n[u];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,o=function e(){for(;++a<n.length;)if(i.call(n,a))return e.value=n[a],e.done=!1,e;return e.value=t,e.done=!0,e};return o.next=o}}throw new TypeError(e(n)+" is not iterable")}return x.prototype=k,o(Y,"constructor",{value:k,configurable:!0}),o(k,"constructor",{value:x,configurable:!0}),x.displayName=d(k,s,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,d(e,s,"GeneratorFunction")),e.prototype=Object.create(Y),e},r.awrap=function(e){return{__await:e}},_(T.prototype),d(T.prototype,c,(function(){return this})),r.AsyncIterator=T,r.async=function(e,t,n,a,i){void 0===i&&(i=Promise);var o=new T(p(e,t,n,a),i);return r.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(Y),d(Y,s,"Generator"),d(Y,u,(function(){return this})),d(Y,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},r.values=M,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return l.type="throw",l.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],l=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var u=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:M(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},r}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n,r,a,i,o){try{var l=e[i](o),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){c(i,r,a,o,l,"next",e)}function l(e){c(i,r,a,o,l,"throw",e)}o(void 0)}))}}System.register(["./round-edit-legacy-DD_Y4W_I.js","./table-legacy-BfQK1xrs.js","./round-delete-legacy-cw3w4Lda.js","./round-add-legacy-B2OcZRb8.js","./common-search.vue_vue_type_script_setup_true_lang-legacy-BetNIGyO.js","./index-legacy-BH1Y34Mi.js","./api-legacy-B6UkH1eb.js","./form-setup-legacy-CnKkSCmx.js","./pp-trace-legacy-fRKIM8rf.js","./modal.vue_vue_type_style_index_0_lang-legacy-DP5xhvDE.js","./audited-legacy-ClhTwoPd.js","./index-legacy-oYChRqnr.js","./table-column-setting.vue_vue_type_script_setup_true_lang-legacy-zNkjfv7c.js","./index-legacy-JzSJVdOM.js","./fromPairs-legacy-A8Lh0tdr.js"],(function(e,r){"use strict";var l,u,c,d,p,f,v,y,h,m,g,b,x,k,w,D,I,Y,_,T,Q,j,P,S,C,M,O,N,E,R,L,A,z,q,B,F,U,G,W,$,V,H,J,K,X,Z,ee,te,ne;return{setters:[function(e){l=e._},function(e){u=e._},function(e){c=e._},function(e){d=e._},function(e){p=e._},function(e){f=e.K,v=e.L,y=e.r,h=e.u,m=e.aa,g=e.b,b=e.g,x=e.dJ,k=e.e0,w=e.ab,D=e.I,I=e.a0,Y=e.o,_=e.c,T=e.w,Q=e.f,j=e.h,P=e.a6,S=e.e,C=e.i,M=e.ah,O=e.ai,N=e.W,E=e.B,R=e.J,L=e.a9,A=e.j,z=e.a2,q=e.a3,B=e.ac,F=e.a5,U=e.N,G=e.Q},function(e){W=e.g,$=e.p},function(e){V=e.g},function(e){H=e.u,J=e.p,K=e.a},function(e){X=e._},function(e){Z=e.u,ee=e.a,te=e.b},function(e){ne=e._},null,null,null],execute:function(){var r=document.createElement("style");r.textContent=".fonttips[data-v-8fcf4fa8]{font-size:larger;font-weight:500;color:red}.add-v-cut-tool-record-form[data-v-8fcf4fa8]{border:1px solid #ccc;padding:36px 30px 15px;overflow:auto;position:relative}.add-v-cut-tool-record-form .state[data-v-8fcf4fa8]{position:absolute;top:0;right:100px}.add-v-cut-tool-record-form .state img[data-v-8fcf4fa8]{height:80px}.table-content[data-v-21bf9aaa]{padding:8px}\n",document.head.appendChild(r);var re={class:"add-v-cut-tool-record-form"},ae={key:0,class:"state"},ie=["src"],oe=["src"],le=["src"],ue={style:{"max-height":"403px","overflow-y":"auto"}},ce={class:"modal-footer"},se={__name:"add-pp-user",props:f({operateType:{type:String,default:"add"},rowData:{type:Object,default:null}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:f(["handleAddModalClose","postSuccess"],["update:visible"]),setup:function(e,t){var r=t.emit,l=v(e,"visible"),u=e,c=y(u.rowData),d=h(),p=r,f=y(!1),R=y([{type:"tabs",span:24,name:"状态信息"},{type:"datePicker",key:"createDate",label:"日期",span:6,rule:{required:!0,message:"请选择日期",trigger:"change"},disabled:f,defaultValue:m().format("YYYY-MM-DD")},{type:"input",key:"operator",label:"操作员",defaultValue:d.userInfo.user.nickName||d.userInfo.user.userName,disabled:!0,span:6},{type:"input",key:"foreman",label:"领班审核",disabled:!0,span:6},{type:"input",key:"examiner",label:"主管审核",disabled:!0,span:6}]),L=[{key:"ppSize",dataIndex:"ppSize",title:"PP规格",width:70,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return u.operateType,null==t?void 0:t.ppSize}},{key:"glueContent",dataIndex:"glueContent",title:"RC(%)",width:50,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return u.operateType,null==t?void 0:t.glueContent}}],A=g((function(){return"add"===u.operateType?[].concat(L,[{key:"produceDate",dataIndex:"produceDate",title:"生产日期",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return b("div",{style:{minWidth:"100px"}},[b(x,{value:t.produceDate,style:{width:"100%"},placeholder:"请选择日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:function(e){t.produceDate=e?m(e).format("YYYY-MM-DD"):null}},null)])}},{key:"expirationDate",dataIndex:"expirationDate",title:"有效期",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return b("div",{style:{minWidth:"100px"}},[b(x,{value:t.expirationDate,style:{width:"100%"},placeholder:"请选择日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:function(e){t.expirationDate=e?m(e).format("YYYY-MM-DD"):null}},null)])}},{key:"dateInventory",dataIndex:"dateInventory",title:"当日工序库存(卷)",align:"center",width:100,checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return"look"===u.operateType?b("div",{style:"min-width:150px"},[t.dateInventory]):b(D,{style:"height: 22px !important;",value:t.dateInventory,onChange:function(e){var n=e.target.value;t.dateInventory=Number(n),V(t)},onBlur:function(e){var n=e.target.value;if(!k(Number(n).toString())||!Number(n>=0))return w.error("请输入正数"),void(t.dateInventory=null);t.dateInventory=Number(n),V(t)}},null)}},{key:"receiveQty",dataIndex:"receiveQty",title:"领用数量(卷)",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return"look"===u.operateType?b("div",{style:"min-width:150px"},[t.receiveQty]):b(D,{style:"height: 22px !important;",value:t.receiveQty,onChange:function(e){var n=e.target.value;t.receiveQty=Number(n),V(t)},onBlur:function(e){var n=e.target.value;if(!k(Number(n).toString())||!Number(n>=0))return w.error("请输入正数"),void(t.receiveQty=null);t.receiveQty=Number(n),V(t)}},null)}},{key:"useQty",dataIndex:"useQty",title:"使用数量(卷)",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return"look"===u.operateType?b("div",{style:"min-width:150px"},[t.useQty]):b(D,{style:"height: 22px !important;",value:t.useQty,onChange:function(e){var n=e.target.value;t.useQty=Number(n),V(t)},onBlur:function(e){var n=e.target.value;if(!k(Number(n).toString())||!Number(n>=0))return w.error("请输入正数"),void(t.useQty=null);t.useQty=Number(n),V(t)}},null)}},{key:"inventoryQty",dataIndex:"inventoryQty",title:"库存数量(卷)",disabled:!0,width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return"look"===u.operateType?b("div",{style:"min-width:150px"},[t.inventoryQty]):b(D,{style:"height: 22px !important;",value:t.inventoryQty,disabled:!0},null)}},{key:"remark",dataIndex:"remark",title:"备注",width:130,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return"look"===u.operateType?b("div",{style:"min-width:150px"},[t.remark]):b(D,{style:"height: 22px !important;",value:t.remark,"onUpdate:value":function(e){return t.remark=e}},null)}}]):[].concat(L,[{key:"produceDate",dataIndex:"produceDate",title:"生产日期",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return b("div",{style:{minWidth:"100px"}},[b(x,{value:t.produceDate,style:{width:"100%"},placeholder:"请选择日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:function(e){t.produceDate=e?m(e).format("YYYY-MM-DD"):null}},null)])}},{key:"expirationDate",dataIndex:"expirationDate",title:"有效期",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return b("div",{style:{minWidth:"100px"}},[b(x,{value:t.expirationDate,style:{width:"100%"},placeholder:"请选择日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:function(e){t.expirationDate=e?m(e).format("YYYY-MM-DD"):null}},null)])}},{key:"dateInventory",dataIndex:"dateInventory",title:"当日工序库存(卷)",align:"center",width:100,checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return"look"===u.operateType?b("div",{style:"min-width:150px"},[t.dateInventory]):b(D,{style:"height: 22px !important;",value:t.dateInventory,onChange:function(e){var n=e.target.value;t.dateInventory=Number(n),V(t)},onBlur:function(e){var n=e.target.value;if(!k(Number(n).toString())||!Number(n>=0))return w.error("请输入正数"),void(t.dateInventory=null);t.dateInventory=Number(n),V(t)}},null)}},{key:"receiveQty",dataIndex:"receiveQty",title:"领用数量(卷)",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return"look"===u.operateType?b("div",{style:"min-width:150px"},[t.receiveQty]):b(D,{style:"height: 22px !important;",value:t.receiveQty,onChange:function(e){var n=e.target.value;t.receiveQty=Number(n),V(t)},onBlur:function(e){var n=e.target.value;if(!k(Number(n).toString())||!Number(n>=0))return w.error("请输入正数"),void(t.receiveQty=null);t.receiveQty=Number(n),V(t)}},null)}},{key:"useQty",dataIndex:"useQty",title:"使用数量(卷)",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return"look"===u.operateType?b("div",{style:"min-width:150px"},[t.useQty]):b(D,{style:"height: 22px !important;",value:t.useQty,onChange:function(e){var n=e.target.value;t.useQty=Number(n),V(t)},onBlur:function(e){var n=e.target.value;if(!k(Number(n).toString())||!Number(n>=0))return w.error("请输入正数"),void(t.useQty=null);t.useQty=Number(n),V(t)}},null)}},{key:"inventoryQty",dataIndex:"inventoryQty",title:"库存数量(卷)",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return"look"===u.operateType?b("div",{style:"min-width:150px"},[t.inventoryQty]):b(D,{style:"height: 22px !important;",value:t.inventoryQty,disabled:!0},null)}},{key:"remark",dataIndex:"remark",title:"备注",width:130,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return"look"===u.operateType?b("div",{style:"min-width:150px"},[t.remark]):b(D,{style:"height: 22px !important;",value:t.remark,onChange:function(e){t.remark=e.target.value}},null)}}])})),z=y([]),q=y(!1),B=y(!1),F=y(null),U=y(null),G=y($(R.value));function $(e){var t={};return e.forEach((function(e){var n;(t[e.key]=e.defaultValue||null,null!=u&&u.rowData&&"edit"===(null==u?void 0:u.operateType))&&(t[e.key]=null==u||null===(n=u.rowData)||void 0===n?void 0:n[e.key]);e.tansfromDisabled&&(e.disabled=e.tansfromDisabled(u.operateType))})),t}function V(e){null!==e.dateInventory&&null!==e.receiveQty&&null!==e.useQty&&(e.inventoryQty=e.dateInventory+e.receiveQty-e.useQty)}function K(){l.value=!1,G.value=$(R.value),p("handleAddModalClose")}function se(){return de.apply(this,arguments)}function de(){return(de=s(n().mark((function e(){var t,r,o,l,s,d,f,v,y,h;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a(a({},F.value),U.value),r=z.value.map((function(e){return a(a({},e),{},i(i({ppSize:e.ppSize,glueContent:e.glueContent,useDate:e.useDate,expirationDate:e.expirationDate,dateInventory:e.dateInventory,receiveQty:e.receiveQty,useQty:e.useQty,inventoryQty:e.inventoryQty,produceDate:e.produceDate},"expirationDate",e.expirationDate),"remark",e.remark))})),o=G.value,l=o.createDate,s=o.operator,d={createDate:l,operator:s,ppdata:r},e.next=6,t.validateForm();case 6:return f={add:"新增",edit:"修改"},e.next=9,t.validateForm();case 9:return q.value=!0,B.value=!0,v="edit"===u.operateType?H(a(a({},d),{},{id:null===(y=c.value)||void 0===y?void 0:y.leftTableId})):J(d),e.prev=12,e.next=15,v;case 15:h=e.sent,h.error||(w.success("".concat(f[u.operateType],"成功")),p("postSuccess"),K()),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(12),w.error("请求失败，请重试。");case 24:return e.prev=24,B.value=!1,q.value=!1,e.finish(24);case 28:case"end":return e.stop()}}),e,null,[[12,20,24,28]])})))).apply(this,arguments)}var pe=y(u.operateType);return I((function(){return[u.operateType,u.rowData]}),(function(e){var t=o(e,2),n=t[0],r=t[1];c.value=null,pe.value=n,"add"===n?(f.value=!1,l.value&&(q.value=!0,z.value=[],W("qms/press/PPout/selectPPoutIndex").then((function(e){var t=e.data;e.error||(t.forEach((function(e,t){e.index=t+1,e.expirationDate=e.expirationDate?m(e.expirationDate).format("YYYY-MM-DD"):null,e.produceDate=e.produceDate?m(e.produceDate).format("YYYY-MM-DD"):null})),z.value=t)})).finally((function(){q.value=!1})))):(c.value=r,f.value=!0,z.value=r.list),G.value=$(R.value)}),{deep:!0}),function(e,t){var n=M,r=O,a=ne,i=N,o=E;return Y(),_(X,{visible:l.value,"onUpdate:visible":t[3]||(t[3]=function(e){return l.value=e}),title:"".concat({add:"新增",edit:"编辑",look:"查看"}[u.operateType],"PP先进先出记录表"),height:"85vh",width:"75vw","destroy-on-close":!0,centered:!0,onClose:K},{footer:T((function(){return[Q("div",ce,["add"==u.operateType?(Y(),_(o,{key:0,type:"primary",loading:B.value,onClick:t[1]||(t[1]=function(e){return se("add")})},{default:T((function(){return t[4]||(t[4]=[j(" 保 存 ")])})),_:1},8,["loading"])):P("",!0),"edit"==u.operateType?(Y(),_(o,{key:1,type:"primary",loading:B.value,onClick:t[2]||(t[2]=function(e){return se("edit")})},{default:T((function(){return t[5]||(t[5]=[j(" 修 改 ")])})),_:1},8,["loading"])):P("",!0),b(o,{onClick:K},{default:T((function(){return t[6]||(t[6]=[j("关 闭")])})),_:1})])]})),default:T((function(){return[Q("div",re,["add"!==u.operateType?(Y(),S("div",ae,[0===u.rowData.state?(Y(),S("img",{key:0,src:C(Z),alt:"examine-icon"},null,8,ie)):P("",!0),2===u.rowData.state||4===u.rowData.state?(Y(),S("img",{key:1,src:C(ee),alt:"examine-icon"},null,8,oe)):P("",!0),3===u.rowData.state?(Y(),S("img",{key:2,src:C(te),alt:"examine-icon"},null,8,le)):P("",!0)])):P("",!0),b(r,null,{default:T((function(){return[b(n,{key:"1",tab:"基本信息"})]})),_:1}),Q("div",ue,[b(a,{columns:A.value,pagination:!1,"data-source":z.value,loading:q.value,size:"small",bordered:"","row-key":"id",scroll:{x:"auto"}},null,8,["columns","data-source","loading"])]),b(i,{ref_key:"topFormRef",ref:F,model:G.value,"onUpdate:model":t[0]||(t[0]=function(e){return G.value=e}),"form-list":R.value},null,8,["model","form-list"])])]})),_:1},8,["visible","title"])}}},de=R(se,[["__scopeId","data-v-8fcf4fa8"]]),pe={class:"check-inventory-records-page min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},fe=220,ve=Object.assign({name:"production-management_pp-requisition-record"},{__name:"index",setup:function(e){var r=y(null),i=y(null),o=y(!1),f=L(i).height,v=y([]),h=y({serialNum:null,state:null,shiftType:null,time:null}),x=y({});function k(){return(k=s(n().mark((function e(){var t,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V();case 2:t=e.sent,r=t.data,t.error||(x.value=null==r?void 0:r.find((function(e){return e.id===Number(fe)})),I(),Z());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D=y({add:"pp-requisition-record:".concat(fe,":add"),del:"pp-requisition-record:".concat(fe,":del"),foremanAudit:"pp-requisition-record:".concat(fe,":foremanAudit"),supervisorAudit:"pp-requisition-record:".concat(fe,":supervisorAudit"),withdrawTrial:"pp-requisition-record:".concat(fe,":withdrawTrial"),update:"pp-requisition-record:".concat(fe,":update"),edit:"pp-requisition-record:".concat(fe,":edit")});function I(){0===Number(x.value.hasFqa)&&(v.value=[{label:"待领班审核",value:0},{label:"待修改",value:1},{label:"待主管审核",value:2},{label:"审核完成",value:3}])}A((function(){!function(){k.apply(this,arguments)}()}));var j=[{type:"select",key:"state",label:"审核状态",placeholder:"请选择审核状态",span:24,md:12,lg:8,xl:8,xxl:5,selectOptions:[{value:"0",label:"待领班审核"},{value:"1",label:"待修改"},{value:"2",label:"待主管审核"},{value:"3",label:"审核完成"}]},{type:"dateRangePicker",key:"time",label:"日期",span:24,md:12,lg:10,xl:8,xxl:6}],P=y(null),M=g((function(){var e,t=a({},h.value);return null!==(e=h.value)&&void 0!==e&&null!==(e=e.time)&&void 0!==e&&e[0]&&(t.startTime=m(h.value.time[0]).format("YYYY-MM-DD"),t.endTime=m(h.value.time[1]).format("YYYY-MM-DD")),delete t.time,t})),O=y([]),N=y([]),R=y(null);function H(e){O.value=e}function J(e){N.value=e}var X=y([{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:60,align:"center",checked:!0,fixed:"left",ellipsis:!0},{key:"createDate",dataIndex:"createDate",title:"日期",width:120,fixed:"left",align:"center",checked:!0,ellipsis:!0},{key:"operator",dataIndex:"operator",title:"制表人",width:100,align:"center",checked:!0,ellipsis:!0},{key:"state",dataIndex:"state",title:"状态",width:120,align:"center",checked:!0,ellipsis:!0,customRender:function(e){return["待领班审核","待修改","待主管审核","审核完成"][e.record.state]}},{key:"foreman",dataIndex:"foreman",title:"领班审核",width:100,align:"center",checked:!0,ellipsis:!0},{key:"foremanTime",dataIndex:"foremanTime",title:"领班审核时间",width:160,align:"center",checked:!0,ellipsis:!0},{key:"examiner",dataIndex:"examiner",title:"主管审核",width:120,align:"center",checked:!0,ellipsis:!0},{key:"examinerTime",dataIndex:"examinerTime",title:"主管审核时间",width:180,align:"center",checked:!0,ellipsis:!0},{key:"createTime",dataIndex:"createTime",title:"创建时间",width:180,align:"center",checked:!0,ellipsis:!0},{key:"createBy",dataIndex:"createBy",title:"创建人",width:120,align:"center",checked:!0,ellipsis:!0},{key:"updateTime",dataIndex:"updateTime",title:"修改时间",width:180,align:"center",checked:!0,ellipsis:!0},{key:"updateBy",dataIndex:"updateBy",title:"修改人",width:120,align:"center",checked:!0,ellipsis:!0}]);function Z(){P.value.getData()}function ee(){F((function(){h.value.serialNum=null,h.value.state=null,h.value.shiftType=null,h.value.time=null,Z()}))}var te=y([]),ne=y(null),re=y("");function ae(){re.value="edit",ne.value={list:N.value,leftTableId:R.value.id,createDate:R.value.createDate,foreman:R.value.foreman,examiner:R.value.examiner,operator:R.value.operator},o.value=!0}function ie(){o.value=!1,P.value.getData(),w.success("修改成功!")}function oe(e){O.value.length||w.error("请选择要审核的数据!");var t={formId:220,list:O.value.map((function(e){return e.id})),state:e};window.$modal.confirm({title:"确定进行批量审核吗?",onOk:function(){$("/qms/agv/Exporter/updateBatch",t).then((function(e){e.data;e.error||(w.success("批量审核成功!"),Z(),P.value.tableSelectChange([]))}))},onCancel:function(){}})}function le(){O.value.length?window.$modal.confirm({title:"确定进行批量删除吗?",onOk:function(){K(t(O.value)).then((function(e){e.error||(w.success("批量删除成功!"),i.value.formReset(),P.value.tableSelectChange([]),te.value=[])}))},onCancel:function(){}}):w.error("请选择要删除的数据!")}function ue(){if(O.value.length){var e={formId:220,id:O.value[0].id};window.$modal.confirm({title:"确定进行撤审吗?",onOk:function(){W("/qms/agv/Exporter/Fallback",e).then((function(e){e.error||(w.success("撤审成功!"),Z(),P.value.tableSelectChange([]),P.value.getData(),R.value&&(R.value.state=1))}))},onCancel:function(){}})}else w.error("请选择要撤审的数据!")}var ce=y(null),se=y([{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:50,fixed:"left",align:"center",checked:!0,ellipsis:!0},{key:"ppSize",dataIndex:"ppSize",title:"PP规格",width:110,align:"center",checked:!0,ellipsis:!0},{key:"glueContent",dataIndex:"glueContent",title:"RC(%)",width:80,align:"center",checked:!0,ellipsis:!0},{key:"produceDate",dataIndex:"produceDate",title:"生产日期",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return t.produceDate?m(t.produceDate).format("YYYY-MM-DD"):""}},{key:"expirationDate",dataIndex:"expirationDate",title:"有效期",width:100,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return t.expirationDate?m(t.expirationDate).format("YYYY-MM-DD"):""}},{key:"dateInventory",dataIndex:"dateInventory",title:"当日工序库存(卷)",width:130,align:"center",checked:!0,ellipsis:!0},{key:"receiveQty",dataIndex:"receiveQty",title:"领用数量(卷)",width:120,align:"center",checked:!0,ellipsis:!0},{key:"useQty",dataIndex:"useQty",title:"使用数量(卷)",width:120,align:"center",checked:!0,ellipsis:!0},{key:"inventoryQty",dataIndex:"inventoryQty",title:"库存数量(卷)",width:120,align:"center",checked:!0,ellipsis:!0},{key:"remark",dataIndex:"remark",title:"备注",width:150,align:"center",checked:!0,ellipsis:!0}]),ve=y({id:null});function ye(e){R.value=e,ve.value.id=e.id,N.value=[],ve.value.operator=e.operator,ce.value.getData()}function he(e){e.length&&(P.value.setCurrentRowId(e[0]),ye(e[0]))}var me=function(){o.value=!0,re.value="add"};function ge(){o.value=!1}function be(){o.value=!1,"add"===re.value?Z():ce.value.getData()}return function(e,t){var n=p,a=d,s=E,v=c,y=u,m=U,g=l,x=G,k=z("hasAuth");return Y(),S("div",pe,[b(n,{ref_key:"commonSearchRef",ref:i,searchParams:h.value,"onUpdate:searchParams":t[0]||(t[0]=function(e){return h.value=e}),"form-list":j,"is-search":!0,onSearch:Z,onReset:ee},null,8,["searchParams"]),Q("div",{class:"table-content w-full",style:B({height:"calc(100% - ".concat(C(f),"px)")})},[b(x,{gutter:8,class:"h-full"},{default:T((function(){return[b(m,{span:8,class:"h-full"},{default:T((function(){return[b(y,{ref_key:"tableRef",ref:P,searchParams:M.value,"onUpdate:searchParams":t[3]||(t[3]=function(e){return M.value=e}),class:"h-full",column:X.value,"show-row-selection":"","row-key":"id",scroll:{y:"auto"},"is-init-get-data":!0,url:"/qms/press/PPout/selectPPoutMainAjax",onTableSelectChange:H,onTableRowClick:ye,onTableDataLoadSucess:he},{title:T((function(){return[q((Y(),_(s,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:me},{icon:T((function(){return[b(a,{class:"align-sub text-icon"})]})),default:T((function(){return[t[6]||(t[6]=Q("span",{class:"ml-3px"},"新增",-1))]})),_:1})),[[k,[D.value.add]]]),q((Y(),_(s,{type:"primary",size:"small",danger:"",ghost:"",class:"mini-btn mr-8px",disabled:!O.value.length,onClick:le},{icon:T((function(){return[b(v,{class:"align-sub text-icon"})]})),default:T((function(){return[t[7]||(t[7]=Q("span",{class:"ml-3px"},"删除",-1))]})),_:1},8,["disabled"])),[[k,[D.value.del]]]),q((Y(),_(s,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",disabled:!O.value.length,onClick:t[1]||(t[1]=function(e){return oe(2)})},{icon:T((function(){return t[8]||(t[8]=[Q("span",{class:"iconfont icon-shenhe",style:{"font-size":"14px"}},null,-1)])})),default:T((function(){return[t[9]||(t[9]=Q("span",{class:"ml-3px"},"领班审核",-1))]})),_:1},8,["disabled"])),[[k,[D.value.foremanAudit]]]),q((Y(),_(s,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",disabled:!O.value.length,onClick:t[2]||(t[2]=function(e){return oe(3)})},{icon:T((function(){return t[10]||(t[10]=[Q("span",{class:"iconfont icon-shenhe",style:{"font-size":"14px"}},null,-1)])})),default:T((function(){return[t[11]||(t[11]=Q("span",{class:"ml-3px"},"主管审核",-1))]})),_:1},8,["disabled"])),[[k,[D.value.supervisorAudit]]]),q((Y(),_(s,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",disabled:!O.value.length,onClick:ue},{icon:T((function(){return t[12]||(t[12]=[Q("span",{class:"iconfont icon-cheshenanniu",style:{"font-size":"14px"}},null,-1)])})),default:T((function(){return[t[13]||(t[13]=Q("span",{class:"ml-3px"},"撤审",-1))]})),_:1},8,["disabled"])),[[k,[D.value.withdrawTrial]]])]})),_:1},8,["searchParams","column"])]})),_:1}),b(m,{span:16,class:"h-full"},{default:T((function(){return[b(y,{ref_key:"rightTableRef",ref:ce,searchParams:ve.value,"onUpdate:searchParams":t[4]||(t[4]=function(e){return ve.value=e}),url:"/qms/press/PPout/selectPPoutData",class:"h-full","show-row-selection":"",column:se.value,"auto-generate-uuid":!0,"row-key":"tableUuid",scroll:{y:"auto"},"is-init-get-data":"","is-pagination":!1,onTableSelectChange:J},{title:T((function(){return[q((Y(),_(s,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",disabled:!N.value.length,onClick:ae},{icon:T((function(){return[b(g,{class:"align-sub text-icon"})]})),default:T((function(){return[t[14]||(t[14]=Q("span",{class:"ml-3px"},"修改",-1))]})),_:1},8,["disabled"])),[[k,[D.value.update]]])]})),_:1},8,["searchParams","column"])]})),_:1})]})),_:1}),b(de,{ref_key:"ppAddUserRef",ref:r,visible:o.value,"onUpdate:visible":t[5]||(t[5]=function(e){return o.value=e}),"operate-type":re.value,"row-data":ne.value,onHandleAddModalClose:ge,onPostSuccess:be,onEditSuccess:ie},null,8,["visible","operate-type","row-data"])],4)])}}});e("default",R(ve,[["__scopeId","data-v-21bf9aaa"]]))}}}))}();
