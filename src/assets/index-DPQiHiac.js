import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{d as l,r as a,p as t,o as n,e as i,g as s,w as d,f as o,s as c,I as u,v as r,N as p,O as m,B as h,P as f,Q as v,F as g,K as x,L as w,t as y,aj as k,a5 as I,a7 as b,af as _,S,ac as N}from"./index-B3PZsRwT.js";import{c as C,d as z,e as T,f as j}from"./batch-read-code-info-BrC2ykGO.js";import{_ as E}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{C as R}from"./index-BThgVJ70.js";import{_ as A}from"./index-Cn-BWYp5.js";import"./fromPairs-BI-MgVCs.js";const q={class:"jl-main-page h-full flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},U={class:"w-full flex"},D={class:"flex"},L={class:"w-full flex-y-center justify-end gap-12px"},O=l({__name:"code-list",setup(l,{expose:x}){const w=a(null),y=a([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"woId",dataIndex:"woId",title:"工单代码",width:140,align:"center",checked:!0,ellipsis:!0},{key:"woType",dataIndex:"woType",title:"工单类型",width:160,align:"center",checked:!0,ellipsis:!0},{key:"productName",dataIndex:"productName",title:"产品名称",width:160,align:"center",checked:!0,ellipsis:!0},{key:"routeName",dataIndex:"routeName",title:"制程名称",width:100,align:"center",checked:!0,ellipsis:!0},{key:"woStatus",dataIndex:"woStatus",title:"工单状态",width:100,align:"center",checked:!0,ellipsis:!0},{key:"siteId",dataIndex:"siteId",title:"工厂代码",width:100,align:"center",checked:!0,ellipsis:!0},{key:"description",dataIndex:"description",title:"描述",width:100,align:"center",checked:!0,ellipsis:!0}]),k=a(null),I=a({type:"radio",onChange:e=>{k.value=e[0]}}),b=a([]),_=a(!1),S=t({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{S.current=e,S.pageSize=l,T()}});function N(){S.current=1,T()}function z(){w.value=null,S.current=1,T()}function T(){const e={woId:w.value,pageSize:S.pageSize,pageNum:S.current};_.value=!0,C(e).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1})),S.total=e.total,b.value=e.list)})).finally((()=>_.value=!1))}return T(),x({currentSelect:k}),(l,a)=>{const t=u,x=r,k=p,C=m,T=h,j=f,E=v,O=g,K=R,B=e,F=A;return n(),i("div",q,[s(K,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:d((()=>[s(O,{"label-col":{span:5,md:7},class:"search-form"},{default:d((()=>[o("div",U,[s(E,{gutter:[15,8],wrap:"",class:"w-full"},{default:d((()=>[s(k,{span:24,md:12,lg:8,xl:8,xxl:8},{default:d((()=>[s(x,{label:"工单代码",name:"woId",class:"m-0","label-col":{}},{default:d((()=>[s(t,{value:w.value,"onUpdate:value":a[0]||(a[0]=e=>w.value=e),placeholder:"请输入工单代码",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:c(N,["enter"])},null,8,["value"])])),_:1})])),_:1}),o("div",D,[s(x,{class:"m-0"},{default:d((()=>[o("div",L,[s(T,{type:"primary",ghost:"",class:"mini-btn",onClick:N},{icon:d((()=>[s(C,{class:"align-sub text-icon"})])),default:d((()=>[a[2]||(a[2]=o("span",{class:"ml-3px"},"搜索",-1))])),_:1}),s(T,{class:"mini-btn",onClick:z},{icon:d((()=>[s(j,{class:"align-sub text-icon"})])),default:d((()=>[a[3]||(a[3]=o("span",{class:"ml-3px"},"重置",-1))])),_:1})])])),_:1})])])),_:1})])])),_:1})])),_:1}),s(K,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:d((()=>[s(B,{columns:y.value,"onUpdate:columns":a[1]||(a[1]=e=>y.value=e)},null,8,["columns"])])),default:d((()=>[s(F,{columns:y.value,"data-source":b.value,bordered:"","row-selection":I.value,size:"small",loading:_.value,"row-key":"woId",pagination:S,scroll:{x:"auto",y:"auto"},class:"h-full"},null,8,["columns","data-source","row-selection","loading","pagination"])])),_:1})])}}}),K={class:"w-full flex"},B={class:"flex"},F={class:"w-full flex-y-center justify-end gap-12px"},Q={class:"ml-3px"},J=l({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:x(["search"],["update:model"]),setup(e,{emit:l}){const t=l,x=w(e,"model"),b=a(!1),_=a(null);function S(){t("search",x.value)}function N(){x.value={menuName:"",status:""},t("search",x.value)}function C(){I((()=>{x.value.woId=_.value.currentSelect,b.value=!1,t("search",x.value)}))}return(e,l)=>{const a=u,t=r,w=p,I=m,z=h,T=f,j=v,A=g,q=R;return n(),i(k,null,[s(q,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:d((()=>[s(A,{ref:"formRef",model:x.value,"label-col":{span:5,md:7},class:"search-form"},{default:d((()=>[o("div",K,[s(j,{gutter:[15,8],wrap:"",class:"w-full"},{default:d((()=>[s(w,{span:24,md:12,lg:6,xl:6,xxl:4},{default:d((()=>[s(t,{label:"生产批号",name:"lotId",class:"m-0","label-col":{}},{default:d((()=>[s(a,{value:x.value.lotId,"onUpdate:value":l[0]||(l[0]=e=>x.value.lotId=e),placeholder:"请输入生产批号",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:c(S,["enter"])},null,8,["value"])])),_:1})])),_:1}),s(w,{span:24,md:12,lg:6,xl:6,xxl:4},{default:d((()=>[s(t,{label:"产品型号",name:"productName",class:"m-0","label-col":{}},{default:d((()=>[s(a,{value:x.value.productName,"onUpdate:value":l[1]||(l[1]=e=>x.value.productName=e),placeholder:"请输入产品型号",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:c(S,["enter"])},null,8,["value"])])),_:1})])),_:1}),o("div",B,[s(t,{class:"m-0"},{default:d((()=>[o("div",F,[s(z,{type:"primary",ghost:"",class:"mini-btn",onClick:S},{icon:d((()=>[s(I,{class:"align-sub text-icon"})])),default:d((()=>[l[3]||(l[3]=o("span",{class:"ml-3px"},"查询",-1))])),_:1}),s(z,{class:"mini-btn",onClick:N},{icon:d((()=>[s(T,{class:"align-sub text-icon"})])),default:d((()=>[o("span",Q,y(e.$t("common.reset")),1)])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])])),_:1}),s(E,{visible:b.value,"onUpdate:visible":l[2]||(l[2]=e=>b.value=e),title:"代码列表",height:"80vh",width:"80vw",onOk:C},{default:d((()=>[s(O,{ref_key:"codeListRef",ref:_},null,512)])),_:1},8,["visible"])],64)}}}),P={class:"jl-main-page batch-read-code-info min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},V=l({name:"trace_batch-read-code-infos",__name:"index",setup(l){const o=a({pageNum:1,pageSize:200}),c=a({lotId:null,woId:null,productName:null}),u=t({current:o.value.pageNum,pageSize:o.value.pageSize,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{u.current=e,u.pageSize=l,o.value.pageNum=e,o.value.pageSize=l,k()}}),r=a(null),m=a([]),h=a([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0},{key:"lotId",dataIndex:"lotId",title:"生产批号",width:130,align:"center",checked:!0,ellipsis:!0},{key:"productName",dataIndex:"productName",title:"产品型号",width:140,align:"center",checked:!0,ellipsis:!0},{key:"printedCodeState",dataIndex:"printedCodeState",title:"打码状态",width:120,align:"center",checked:!0,ellipsis:!0},{key:"qty",dataIndex:"qty",title:"批次数量",width:90,align:"center",checked:!0,ellipsis:!0},{key:"printCount",dataIndex:"printCount",title:"打码数量",width:90,align:"center",checked:!0,ellipsis:!0},{key:"customerCode",dataIndex:"customerCode",title:"客户代码",width:100,align:"center",checked:!0,ellipsis:!0},{key:"customerName",dataIndex:"customerName",title:"客户名称",width:250,align:"center",checked:!0,ellipsis:!0},{key:"createTime",dataIndex:"createTime",title:"下发时间",width:180,align:"center",checked:!0,ellipsis:!0}]),f=a([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0},{key:"pnlId",dataIndex:"pnlId",title:"PNL码",width:150,align:"center",checked:!0,ellipsis:!0},{key:"trackType",dataIndex:"trackType",title:"动作类型",width:100,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>({TRACKIN:"上机",TRACKOUT:"下机"}[e.trackType]||"")},{key:"sliceType",dataIndex:"sliceType",title:"片型",width:70,align:"center",checked:!0,ellipsis:!0},{key:"dateTime",dataIndex:"dateTime",title:"读码时间",width:150,align:"center",checked:!0,ellipsis:!0}]),g=a(!1),x=a(null),w=a(null),y=a(null);function k(){const e={...c.value,...o.value};g.value=!0,z(e).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1,e.uid=b.genV4().hexNoDelim})),u.total=e.total,m.value=e.list,x.value=e.list[0].uid,r.value=e.list[0].lotId,W())})).finally((()=>g.value=!1))}function C(){u.current=1,o.value.pageNum=1,k()}k();const E=a([]),A=a([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"modifiedEquipmentLineName",dataIndex:"modifiedEquipmentLineName",title:"线体名称",width:100,align:"center",checked:!0,ellipsis:!0},{key:"sumCode",dataIndex:"sumCode",title:"打码数量",width:80,align:"center",checked:!0,ellipsis:!0},{key:"readingCount",dataIndex:"readingCount",title:"读码数量",width:80,align:"center",checked:!0,ellipsis:!0},{key:"codeRate",dataIndex:"codeRate",title:"读码率",width:80,align:"center",checked:!0,ellipsis:!0},{key:"firstDate",dataIndex:"firstDate",title:"初次读码时间",width:150,align:"center",checked:!0,ellipsis:!0},{key:"lastDate",dataIndex:"lastDate",title:"最后读码时间",width:150,align:"center",checked:!0,ellipsis:!0}]),q=a(!1),U=e=>({style:{background:e.uid===x.value?"#BAEAFA":""},class:e.uid===r.value?"jl-table-row-selected":"",onClick:()=>{x.value=e.uid,r.value=e.lotId,W()}}),D=a(!1),L=a([]),O=a(null),K=e=>({style:{background:e.uid===O.value?"#BAEAFA":""},class:e.uid===O.value?"jl-table-row-selected":"",onClick:()=>{O.value=e.uid}}),B=a(null);function F(){const e={lotId:null,pageSize:"9999",pageNum:"1",equipmentId:null};e.lotId=y.value,e.equipmentId=w.value,D.value=!0,j(e).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1,e.uid=b.genV4().hexNoDelim})),L.value=e.list)})).finally((()=>D.value=!1))}const Q=e=>({style:{background:e.uid===B.value?"#BAEAFA":""},onClick:()=>{B.value=e.uid,y.value=e.lotId,w.value=e.mainEqpId,F()}}),V=t({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{u.current=e,u.pageSize=l,W()}});function W(){q.value=!0;const e={lotId:r.value,pageSize:V.pageSize,pageNum:V.current};T(e).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1,e.uid=b.genV4().hexNoDelim})),E.value=e.list,V.total=e.total,B.value=e.list[0].uid,y.value=e.list[0].lotId,w.value=e.list[0].mainEqpId,F())})).finally((()=>q.value=!1))}const M=a(42);return window.addEventListener("resize",(()=>{I((()=>{const e=document.querySelector(".batch-read-code-info .search-box"),l=null==e?void 0:e.clientHeight;M.value=l||42}))})),_((()=>{window.removeEventListener("resize",(()=>{}))})),(l,a)=>{const t=e,o=S("STable"),r=R,x=p,w=v;return n(),i("div",P,[s(J,{model:c.value,"onUpdate:model":a[0]||(a[0]=e=>c.value=e),onReset:l.reset,onSearch:C},null,8,["model","onReset"]),s(w,{gutter:[15,8],wrap:"",class:"w-full",style:N({height:"calc(100% - ".concat(M.value,"px)")})},{default:d((()=>[s(x,{span:8,class:"h-full",style:{"padding-right":"0 !important"}},{default:d((()=>[s(r,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:d((()=>[s(t,{columns:h.value,"onUpdate:columns":a[1]||(a[1]=e=>h.value=e)},null,8,["columns"])])),default:d((()=>[s(o,{ref:"tableWrapperRef",columns:h.value,"data-source":m.value,bordered:"",size:"small",loading:g.value,"row-key":"uid",pagination:u,"custom-row":U,"row-height":23,scroll:{x:"auto",y:"auto"},class:"h-full"},null,8,["columns","data-source","loading","pagination"])])),_:1})])),_:1}),s(x,{span:8,class:"h-full",style:{"padding-left":"0 !important"}},{default:d((()=>[s(r,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:d((()=>[s(t,{columns:A.value,"onUpdate:columns":a[2]||(a[2]=e=>A.value=e)},null,8,["columns"])])),default:d((()=>[s(o,{ref:"tableWrapperRef",columns:A.value,"data-source":E.value,bordered:"",size:"small",loading:q.value,"row-key":"uid",pagination:!1,class:"h-full","row-height":23,"custom-row":Q},null,8,["columns","data-source","loading"])])),_:1})])),_:1}),s(x,{span:8,class:"h-full",style:{"padding-left":"0 !important"}},{default:d((()=>[s(r,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:d((()=>[s(t,{columns:f.value,"onUpdate:columns":a[3]||(a[3]=e=>f.value=e)},null,8,["columns"])])),default:d((()=>[s(o,{ref:"tableWrapperRef",columns:f.value,"data-source":L.value,bordered:"",size:"small",loading:D.value,pagination:!1,"row-key":"uid",class:"h-full","row-height":23,"custom-row":K},null,8,["columns","data-source","loading"])])),_:1})])),_:1})])),_:1},8,["style"])])}}});export{V as default};
