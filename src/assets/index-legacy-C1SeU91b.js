!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function a(e){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?arguments[a]:{};a%2?t(Object(l),!0).forEach((function(t){n(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):t(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}function n(t,a,n){return(a=function(t){var a=function(t,a){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var l=n.call(t,a||"default");if("object"!=e(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(t)}(t,"string");return"symbol"==e(a)?a:a+""}(a))in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,l,i,r,c=[],s=!0,d=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;s=!1}else for(;!(s=(n=i.call(a)).done)&&(c.push(n.value),c.length!==t);s=!0);}catch(e){d=!0,l=e}finally{try{if(!s&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(d)throw l}}return c}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return c(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}System.register(["./modal.vue_vue_type_style_index_0_lang-legacy-DP5xhvDE.js","./table-legacy-BfQK1xrs.js","./common-search.vue_vue_type_script_setup_true_lang-legacy-BetNIGyO.js","./index-legacy-BH1Y34Mi.js","./resetTableRef-legacy-BB5avnzc.js","./searchData-legacy-CvCk-1Nw.js","./engineering-data-inquiry-legacy-dLfUXwjS.js","./pdf-viewer-legacy-DG9HKUu-.js","./index-legacy-CPUL4mwF.js","./index-legacy-JzSJVdOM.js","./table-column-setting.vue_vue_type_script_setup_true_lang-legacy-zNkjfv7c.js","./api-legacy-B6UkH1eb.js","./isNumber-legacy-CHb6J4gG.js","./SwapOutlined-legacy-DhbaWH6n.js"],(function(e,t){"use strict";var r,c,s,d,u,o,p,f,h,y,v,m,g,k,b,w,I,x,P,D,_,Q,N,T,S,R,C,O,M,j,E,B,U,F,L,q,Y,A,$,H,K,z,V;return{setters:[function(e){r=e._},function(e){c=e._},function(e){s=e._},function(e){d=e.Z,u=e.r,o=e.o,p=e.c,f=e.aa,h=e.e,y=e.g,v=e.w,m=e.f,g=e.h,k=e.aj,b=e.a5,w=e._,I=e.J,x=e.cF,P=e.i,D=e.a0,_=e.V,Q=e.N,N=e.Q,T=e.a7,S=e.a9,R=e.ac,C=e.X,O=e.t,M=e.I,j=e.dJ,E=e.W,B=e.B,U=e.ah,F=e.ai,L=e.da},function(e){q=e.u},function(e){Y=e.u},function(e){A=e.d,$=e._,H=e.g,K=e.a},null,function(e){z=e.I},function(e){V=e.C},null,null,null,null],execute:function(){var t=document.createElement("style");function W(e){return d({url:"/mes/BaseMaterial/selectRemarkByMaterialId",params:e})}function J(e){return d({url:"/mes/BaseInvsourceoutdetail/insert",method:"post",data:e})}t.textContent=".footer-content[data-v-478a9c4c],.footer-content[data-v-716dd3ce]{border-radius:8px;border:1px solid #f0f0f0}.add-modal-content[data-v-8bfd98df] .ant-card.modal-card .ant-card-head{min-height:30px}.add-modal-content[data-v-8bfd98df] .ant-form-item{margin-bottom:0!important}.add-modal-content[data-v-8bfd98df] .ant-tabs .ant-tabs-nav{margin-bottom:0}.add-modal-content[data-v-8bfd98df] .ant-tabs .ant-tabs-content-holder{height:calc(100% - 40px)}.add-modal-content[data-v-8bfd98df] .ant-tabs .ant-tabs-content-holder .ant-tabs-content,.add-modal-content[data-v-8bfd98df] .ant-tabs .ant-tabs-content-holder .ant-tabs-content .ant-tabs-tabpane{height:100%}.add-modal-content[data-v-8bfd98df] .ant-tabs .ant-tabs-nav-list .ant-tabs-tab{border-radius:6px 6px 0 0}.add-modal-content[data-v-8bfd98df] .ant-tabs .ant-tabs-nav-list .ant-tabs-tab-active{background:#646cff}.add-modal-content[data-v-8bfd98df] .ant-tabs .ant-tabs-nav-list .ant-tabs-tab-active .ant-tabs-tab-btn{color:#fff}.top[data-v-426d397e] .ant-tabs .ant-tabs-nav{margin-bottom:0}.top[data-v-426d397e] .ant-tabs .ant-tabs-content-holder{height:calc(100% - 40px)}.top[data-v-426d397e] .ant-tabs .ant-tabs-content-holder .ant-tabs-content,.top[data-v-426d397e] .ant-tabs .ant-tabs-content-holder .ant-tabs-content .ant-tabs-tabpane{height:100%}.top[data-v-426d397e] .ant-tabs .ant-tabs-nav-list .ant-tabs-tab{border-radius:6px 6px 0 0}.top[data-v-426d397e] .ant-tabs .ant-tabs-nav-list .ant-tabs-tab-active{background:#646cff}.top[data-v-426d397e] .ant-tabs .ant-tabs-nav-list .ant-tabs-tab-active .ant-tabs-tab-btn{color:#fff}\n",document.head.appendChild(t);var G={__name:"delivery-schedule",setup:function(e){var t=u(null),a=u({}),n=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"delivDate",dataIndex:"delivDate",title:"计划交期",width:120,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return f(t.delivDate).format("YYYY-MM-DD HH:mm:ss")}},{key:"qty",dataIndex:"qty",title:"计划数量",width:120,align:"center",checked:!0,ellipsis:!0},{key:"backupQty",dataIndex:"backupQty",title:"计划备品数量",width:150,align:"center",checked:!0,ellipsis:!0},{key:"workQty",dataIndex:"workQty",title:"WIP数量",width:120,align:"center",checked:!0,ellipsis:!0},{key:"invInQty",dataIndex:"invInQty",title:"入库数量",width:120,align:"center",checked:!0,ellipsis:!0}];return function(e,l){var i=c;return o(),p(i,{ref_key:"tableRef",ref:t,searchParams:a.value,"onUpdate:searchParams":l[0]||(l[0]=function(e){return a.value=e}),column:n,"show-row-selection":!1,"auto-generate-uuid":"","row-key":"screenId",scroll:{y:"auto"},"is-init-get-data":!1,url:"/qms/scrscreen/screenInfo/pageList",class:"h-full","is-pagination":!1},null,8,["searchParams"])}}},X=["onClick"],Z=["onClick"],ee={__name:"engineering-document",setup:function(e,t){var a=t.expose,n="localhost"===window.location.hostname,l=u(null),i=u({prodNo:null}),r=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"fileName",dataIndex:"fileName",title:"文件名",align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return y("span",{class:"cursor-pointer color-blue",onClick:function(){return p({record:t})}},[t.fileName])}},{key:"fileSizeKb",dataIndex:"fileSizeKb",title:"文件大小",align:"center",checked:!0,ellipsis:!0,width:130,customRender:function(e){var t=e.record;return"".concat(t.fileSizeKb,"KB")}},{key:"fileModifiedTime",dataIndex:"fileModifiedTime",title:"更改时间",align:"center",checked:!0,ellipsis:!0,width:160}];var s=u(!1),d=u(null);function p(e){s.value=!0,d.value="".concat(n?"http://192.168.166.169:9999/prod-api/":"/prod-api/","rcerp/erpMiFile/downMiFile?prodNo=").concat(e.record.prodNo,"&fileName=").concat(e.record.fileName),e.hidePopup()}return a({getData:function(e){i.value=e,b((function(){l.value.getData()}))}}),function(e,t){var a=w,n=c,u=$;return o(),h(k,null,[y(n,{ref_key:"tableRef",ref:l,searchParams:i.value,"onUpdate:searchParams":t[0]||(t[0]=function(e){return i.value=e}),class:"h-full",column:r,"show-row-selection":!1,"row-key":"id",scroll:{y:"auto"},"is-init-get-data":!1,url:"/rcerp/erpMiFile/getMiFileList","auto-generate-uuid":!0,"is-pagination":!1,onTableRowDblclick:t[1]||(t[1]=function(e){return p({record:e})})},{"contextmenuPopup-orter":v((function(e){var n=e.args;return[m("li",{class:"popup-item",onClick:function(e){return A({prodNo:(t=n).record.prodNo,fileName:t.record.fileName}),void t.hidePopup();var t}},[y(a,{"local-icon":"download",class:"text-16px"}),t[3]||(t[3]=g(" 下载 "))],8,X),m("li",{class:"popup-item",onClick:function(e){return p(n)}},[y(a,{"local-icon":"preview",class:"text-16px"}),t[4]||(t[4]=g(" 预览 "))],8,Z)]})),_:1},8,["searchParams"]),y(u,{visible:s.value,"onUpdate:visible":t[2]||(t[2]=function(e){return s.value=e}),url:d.value,"pdf-use-iframe":!0},null,8,["visible","url"])],64)}}},te={class:"h-full w-full"},ae={class:"h-49% w-full"},ne=["innerHTML"],le={class:"mb-0.5% mt-0.5% h-35% w-full"},ie=I({__name:"engineering-instruction",emits:["engineeringTableDataLoadSuccess","engineeringInstructionTableLoadSuccess"],setup:function(e,t){var a=t.expose,n=t.emit,l=u(null),r=u({prodId:null,techId:null}),s=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"miName",dataIndex:"miName",title:"项目名称",align:"center",checked:!0,ellipsis:!0,width:130},{key:"miData",dataIndex:"miData",title:"数据项",align:"center",checked:!0,ellipsis:!0,width:130},{key:"remark",dataIndex:"remark",title:"备注",align:"center",checked:!0,ellipsis:!0,width:130},{key:"createBy",dataIndex:"createBy",title:"编写",align:"center",checked:!0,ellipsis:!0,width:130},{key:"createDate",dataIndex:"createDate",title:"编写日期",align:"center",checked:!0,ellipsis:!0,width:160},{key:"updateDate",dataIndex:"updateDate",title:"最后修改日期",align:"center",checked:!0,ellipsis:!0,width:160}],d=u([]),p=u(null),f=u("工程备注");function k(e){n("engineeringTableDataLoadSuccess",e)}function w(e){n("engineeringInstructionTableLoadSuccess",e)}return a({getData:function(e){r.value=e,b((function(){l.value.getData(1),p.value.getData(1),W({prodId:r.value.prodId}).then((function(e){var t=e.data;e.error||(f.value=null==t?void 0:t.replace(/\n/g,"<br>"))})),H({techId:e.techId}).then((function(e){var t=e.data;if(!e.error&&t.length){var a=t.map((function(e){return{key:e.fieldName,dataIndex:e.fieldName,title:e.caption,align:"center",checked:!0,ellipsis:!0,width:130}}));d.value=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0}].concat(i(a))}else d.value=[]}))}))}}),function(e,t){var a=c;return o(),h("div",te,[m("div",ae,[y(a,{ref_key:"topTableRef",ref:l,searchParams:r.value,"onUpdate:searchParams":t[0]||(t[0]=function(e){return r.value=e}),column:s,"show-row-selection":!1,"auto-generate-uuid":"","row-key":"screenId",scroll:{y:"auto"},"is-init-get-data":!1,"is-pagination":!1,url:"/erpsyncmes/Mi/findMiData",class:"h-full",onTableDataLoadSucess:w},{title:v((function(){return t[2]||(t[2]=[m("span",{class:"color-#646cff"},"投料型号",-1)])})),_:1},8,["searchParams"])]),m("div",{class:"footer-content mb-0.5% mt-0.5% h-14.5% w-full overflow-auto p-15px text-12px",innerHTML:f.value},null,8,ne),m("div",le,[y(a,{ref_key:"bottomTableRef",ref:p,searchParams:r.value,"onUpdate:searchParams":t[1]||(t[1]=function(e){return r.value=e}),class:"h-full",column:d.value,"show-row-selection":!1,"row-key":"id",scroll:{y:"auto"},"is-init-get-data":!1,url:"/erpsyncmes/Mi/findMiData2","auto-generate-uuid":!0,"is-pagination":!1,onTableDataLoadSucess:k},{title:v((function(){return t[3]||(t[3]=[g("工程数据")])})),_:1},8,["searchParams","column"])])])}}},[["__scopeId","data-v-478a9c4c"]]),re={class:"h-full w-full flex-center"},ce={__name:"drawing",setup:function(e,t){var a=t.expose,n=x.PRESENTED_IMAGE_SIMPLE,l=u(null),i="localhost"===window.location.hostname;return a({getData:function(e){K(e).then((function(e){var t=e.data;e.error||(t.image?l.value="".concat(i?"http://192.168.166.166/prod-api/":"/prod-api/").concat(t.image):l.value=null)}))}}),function(e,t){var a=z,i=x;return o(),h("div",re,[l.value?(o(),p(a,{key:0,src:l.value},null,8,["src"])):(o(),p(i,{key:1,image:P(n),description:"暂无开料图"},null,8,["image"]))])}}},se={class:"h-full w-full"},de={class:"h-49% w-full"},ue=["innerHTML"],oe={class:"mb-0.5% mt-0.5% h-35% w-full"},pe=I({__name:"engineering-instruction-inner",props:{engineeringTableData:{type:Array,default:function(){return[]}}},emits:["planListLoadSuccess"],setup:function(e,t){var a=t.expose,n=t.emit,l=e,r=u(l.engineeringTableData);D((function(){return l.engineeringTableData}),(function(e){r.value=e}),{deep:!0});var s=u(null),d=u({prodId:null,techId:null}),p=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"miName",dataIndex:"miName",title:"项目名称",align:"center",checked:!0,ellipsis:!0,width:130},{key:"miData",dataIndex:"miData",title:"数据项",align:"center",checked:!0,ellipsis:!0,width:130},{key:"remark",dataIndex:"remark",title:"备注",align:"center",checked:!0,ellipsis:!0,width:130},{key:"createBy",dataIndex:"createBy",title:"编写",align:"center",checked:!0,ellipsis:!0,width:130},{key:"createDate",dataIndex:"createDate",title:"编写日期",align:"center",checked:!0,ellipsis:!0,width:160},{key:"updateDate",dataIndex:"updateDate",title:"最后修改日期",align:"center",checked:!0,ellipsis:!0,width:160}],f=n,k=u([]),w=u(null),I=u("工程备注");function x(e){f("planListLoadSuccess",e)}return a({getData:function(e,t){d.value=e,b((function(){s.value.getData(1),w.value.getData(1),W({prodId:d.value.prodId}).then((function(e){var t=e.data;e.error||(I.value=null==t?void 0:t.replace(/\n/g,"<br>"))})),H({techId:e.techId}).then((function(e){var t=e.data;if(!e.error&&t.length){var a=t.map((function(e){return{key:e.fieldName,dataIndex:e.fieldName,title:e.caption,align:"center",checked:!0,ellipsis:!0,width:130}}));k.value=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0}].concat(i(a))}else k.value=[]}))}))}}),function(e,t){var a=c;return o(),h("div",se,[m("div",de,[y(a,{ref_key:"topTableRef",ref:s,searchParams:d.value,"onUpdate:searchParams":t[0]||(t[0]=function(e){return d.value=e}),column:p,"show-row-selection":!1,"auto-generate-uuid":"","row-key":"screenId",scroll:{y:"auto"},"is-init-get-data":!1,"is-pagination":!1,url:"/mes/BaseVppcissueplanodr/getPlanList",class:"h-full",onTableDataLoadSucess:x},{title:v((function(){return t[2]||(t[2]=[m("span",{class:"color-#646cff"},"投料型号",-1)])})),_:1},8,["searchParams"])]),m("div",{class:"footer-content mb-0.5% mt-0.5% h-14.5% w-full overflow-auto p-15px text-12px",innerHTML:I.value},null,8,ue),m("div",oe,[y(a,{ref_key:"bottomTableRef",ref:w,searchParams:d.value,"onUpdate:searchParams":t[1]||(t[1]=function(e){return d.value=e}),class:"h-full",column:k.value,"show-row-selection":!1,"row-key":"id",scroll:{y:"auto"},"is-init-get-data":!1,url:"/erpsyncmes/Mi/findMiData2","auto-generate-uuid":!0,"is-pagination":!1},{title:v((function(){return t[3]||(t[3]=[g("工程数据")])})),_:1},8,["searchParams","column"])])])}}},[["__scopeId","data-v-716dd3ce"]]),fe={class:"h-full w-full"},he={__name:"add-sheet-metal",props:{rowData:{type:Object,required:!0},engineeringTableData:{type:Array,default:function(){return[]}},engineeringInstructionData:{type:Array,default:function(){return[]}}},emits:["saveData"],setup:function(e,t){var n=t.expose,i=(t.emit,e),r=i.rowData,p=u(null),m=l(q({specif7:null,specif6:null,specif3:null,color:null,height:null,specif10:null,specif8:null,specif9:null,width:null,length:null,specif14:null,specif15:null,special:null,matNo:null,specif:null,specif2:null,matReplace:null,materialType:0}),2),g=m[0],k=m[1],w=[{type:"input",key:"specif7",label:"底铜",span:6,placeholder:""},{type:"input",key:"specif6",label:"顶铜",span:6,placeholder:""},{type:"input",key:"specif3",label:"板材类型",span:6,placeholder:""},{type:"input",key:"color",label:"板材颜色",span:6,placeholder:""},{type:"input",key:"height",label:"板厚(mm)",span:6,placeholder:""},{type:"input",key:"specif10",label:"TG值",span:6,placeholder:""},{type:"input",key:"specif8",label:"CTI",span:6,placeholder:""},{type:"input",key:"specif9",label:"含铜",span:6,placeholder:""},{type:"input",key:"width",label:"宽",span:6,placeholder:""},{type:"input",key:"length",label:"长",span:6,placeholder:""},{type:"input",key:"specif14",label:"无卤素要求",span:6,placeholder:""},{type:"input",key:"specif15",label:"板料水印",span:6,placeholder:""},{type:"input",key:"special",label:"板料特殊要求",span:8,placeholder:""},{type:"input",key:"matNo",label:"物料编码",span:8,placeholder:""},{type:"input",key:"specif",label:"规格",span:8,placeholder:""},{type:"input",key:"specif2",label:"供应商",span:8,placeholder:""},{type:"checkbox",key:"matReplace",label:"",span:8,placeholder:"",selectOptions:[{label:"代料",value:!0}]}],I=u(null),x=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"matname",dataIndex:"matname",title:"板材名称",align:"center",checked:!0,ellipsis:!0,width:120},{key:"specif2",dataIndex:"specif2",title:"供应商",align:"center",checked:!0,ellipsis:!0,width:120},{key:"specif",dataIndex:"specif",title:"物料规格",align:"center",checked:!0,ellipsis:!0,width:400,customRender:function(e){var t,a=e.record;return null==a||null===(t=a.matSpecs)||void 0===t?void 0:t.replace(/黄料|黄色/g,"")}},{key:"invqty",dataIndex:"invqty",title:"库存数量",align:"center",checked:!0,ellipsis:!0,width:120},{key:"occupancyqty",dataIndex:"occupancyqty",title:"占用数量",align:"center",checked:!0,ellipsis:!0,width:120},{key:"invQty-occupancyQty",dataIndex:"invQty-occupancyQty",title:"可用库存数量",align:"center",checked:!0,ellipsis:!0,width:120,customRender:function(e){var t=e.record;return t.invqty-t.occupancyqty}},{key:"proddate",dataIndex:"proddate",title:"生产日期",align:"center",checked:!0,ellipsis:!0,width:120,customRender:function(e){var t=e.record;return t.proddate&&f(t.proddate).format("YYYY-MM-DD HH:mm:ss")}},{key:"createdate",dataIndex:"createdate",title:"入库日期",align:"center",checked:!0,ellipsis:!0,width:120,customRender:function(e){var t=e.record;return t.createdate&&f(t.createdate).format("YYYY-MM-DD HH:mm:ss")}},{key:"unit",dataIndex:"unit",title:"单位",align:"center",checked:!0,ellipsis:!0,width:120},{key:"matno",dataIndex:"matno",title:"板材编码",align:"center",checked:!0,ellipsis:!0,width:120},{key:"length",dataIndex:"length",title:"长",align:"center",checked:!0,ellipsis:!0,width:120},{key:"width",dataIndex:"width",title:"宽",align:"center",checked:!0,ellipsis:!0,width:120}];D((function(){return[i.engineeringTableData,i.engineeringInstructionData]}),(function(){!function(){var e,t,a=i.engineeringTableData[0];g.value.specif7=null===(e=a.data1)||void 0===e?void 0:e.trim().split("/")[0],g.value.specif6=null===(t=a.data1)||void 0===t?void 0:t.trim().split("/")[1],g.value.height=a.data2,g.value.specif9=a.data5;var n={specif3:"1350000048500041",color:"1350000048500044",specif10:"1350000048500051",specif8:"1350000048500053",width:"1350000048500012",length:"1350000048500011",special:"1350000048500040",specif14:"1350000048500088",specif15:"1350000048500045",specif2:"1350000048500037"};Object.keys(n).forEach((function(e){var t=i.engineeringInstructionData.find((function(t){return t.miMouldId===n[e]}));g.value[e]=("specif14"!==e||"/"!==(null==t?void 0:t.miData)&&"//"!==(null==t?void 0:t.miData))&&(null==t?void 0:t.miData)||null}))}()}),{deep:!0,immediate:!0});var S=u([]);function R(){var e;(e=a(a({},g.value),{},{specif2:void 0}),d({url:"/mes/BaseMaterial/SelectAll",method:"post",data:e})).then((function(e){var t=e.data;e.error||(t.forEach((function(e,t){e.dataIndex=t+1,e.tableUuid=T.genV4().hexNoDelim})),S.value=t)}))}function C(){R()}function O(){k(),C()}var M=u(null);b((function(){M.value.getData({prodId:r.prodID,techId:r.techid})}));var j=u([]);function E(e){j.value=e[0]}function B(){var e,t;if(!j.value)return window.$message.error("请选择需要保存的行!"),!1;if(null===(e=g.value)||void 0===e||null===(e=e.matReplace)||void 0===e||!e.includes(!0)){if(j.value.length!==g.value.length||j.value.width!==g.value.width||j.value.specif3!==g.value.specif3||j.value.specif6!==g.value.specif6||j.value.specif7!==g.value.specif7||j.value.height!==g.value.height||j.value.specif9!==g.value.specif9||j.value.specif10!==g.value.specif10)return window.$message.error("所选板材与MI信息不符,请重新选择!"),!1;if(((null===(t=j.value.specif8)||void 0===t?void 0:t.trim())||"175")!==(g.value.specif8||"175"))return window.$message.error("所选板材与CTI不符,请重新选择!"),!1;if(j.value.specif15!==(g.value.specif15||""))return window.$message.error("所选板材与板料水印不符,请重新选择!"),!1}return!0}return n({getData:function(e){g.value=a(a({},g.value),e),R()},saveData:function(){return B()?j.value:null}}),function(e,t){var a=s,n=c,l=Q,r=N;return o(),h("div",fe,[y(r,{gutter:16,class:"h-full w-full"},{default:v((function(){return[y(l,{span:14,class:"h-full min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},{default:v((function(){return[y(a,{ref_key:"commonSearchRef",ref:p,searchParams:P(g),"onUpdate:searchParams":t[0]||(t[0]=function(e){return _(g)?g.value=e:null}),"form-list":w,onSearch:C,onReset:O},null,8,["searchParams"]),y(n,{ref_key:"leftTableRef",ref:I,searchParams:P(g),"onUpdate:searchParams":t[1]||(t[1]=function(e){return _(g)?g.value=e:null}),"row-selection-type":"radio","show-card-header":!1,"data-source":S.value,column:x,"show-row-selection":!0,"auto-generate-uuid":!1,"row-key":"tableUuid",scroll:{y:"auto"},"is-init-get-data":"",url:"",class:"h-full","is-pagination":!1,onTableSelectChange:E},null,8,["searchParams","data-source"])]})),_:1}),y(l,{span:10,class:"h-full"},{default:v((function(){return[y(pe,{ref_key:"engineeringInstructionRef",ref:M,"engineering-table-data":i.engineeringTableData},null,8,["engineering-table-data"])]})),_:1})]})),_:1})])}}},ye={class:"add-modal-content h-full w-full"},ve=["onClick"],me={class:"add-sheet-metal-title pl-15px"},ge={class:"mr-8px color-#646cff"},ke={class:"color-#646cff"},be={class:"modal-footer"},we={__name:"add",props:{rowData:{type:Object,required:!0}},setup:function(e,t){var l=t.expose,s=e,p=s.rowData,k=u(null),I=u({prodId:p.prodID,tlqty:null}),x=u(null),D=u(null),_=u(n(n(n(n(n(n(n(n(n(n({liaohao:null,prodOrderNo:null,pedifficulty:null,mantissaPercent:null,invProvideQty:null,invQty:null,qty:null},"invQty",null),"issueType","投料"),"issPcsQty",null),"scrapRete",null),"sheetQty",null),"autoCalc",[!0]),"workType","正常"),"lotQty",120),"list",null),"remark",null));function T(){var e;(e={prodId:p.prodID,issPlanId:p.issPlanID,tlqty:_.value.issPcsQty},d({url:"/mes/BaseVppcissueplanodr/getLayout",params:e})).then((function(e){var t=e.data;e.error||(_.value.scrapRete=t.bestUtilization,_.value.sheetQty=t.worstUtilization)})),I.value.tlqty=_.value.issPcsQty,b((function(){k.value.getData()}))}var L=u([]);function q(e){L.value=e}b((function(){x.value.getData({prodId:p.prodID,techId:p.techid})})),s.rowData&&(_.value=p,_.value.editQty=_.value.qty,_.value.invProvideQty=_.value.invProvideQty||0,_.value.issueType=_.value.issueType||"投料",_.value.workType=_.value.workType||"正常",_.value.autoCalc=[!0],_.value.issPcsQty=_.value.editQty-_.value.invProvideQty,_.value.lotQty=_.value.lotQty||120,T());var Y=[{type:"input",key:"liaohao",label:"生产型号",span:12,placeholder:"",disabled:!0},{type:"input",key:"prodOrderNo",label:"工单号",span:12,placeholder:"",disabled:!0},{type:"input",key:"pedifficulty",label:"难度系数",span:12,placeholder:"",disabled:!0},{type:"input",key:"mantissaPercent",label:"尾数板比率",span:12,placeholder:"",disabled:!0},{type:"input",key:"invProvideQty",label:"使用库存数",span:6,placeholder:"请输入使用库存数",keypressEnter:function(){var e=_.value.issPcsQty-_.value.invProvideQty;e<0&&window.$message.error("投料数(PCS)必须大于0"),_.value.issPcsQty=e,_.value.autoCalc.includes(!0)&&T()},blur:function(){var e=_.value.issPcsQty-_.value.invProvideQty;e<0&&window.$message.error("投料数(PCS)必须大于0"),_.value.issPcsQty=e,_.value.autoCalc.includes(!0)&&T()},rule:[{required:!0,message:"请输入使用库存数",trigger:"change"}]},{type:"input",key:"invQty",label:"库存数量",span:6,placeholder:"",disabled:!0},{type:"input",key:"editQty",label:"待投数量",span:6,placeholder:"请输入待投数量"},{type:"input",key:"qty",label:"订单数量",span:6,placeholder:"",disabled:!0},{type:"select",key:"issueType",label:"投料类型",span:12,placeholder:"请选择投料类型",selectOptions:[{label:"投料",value:"投料"},{label:"补料",value:"补料"}]},{type:"input",key:"issPcsQty",label:"投料数(PCS)",span:12,placeholder:"请输入投料数(PCS)",keypressEnter:function(){var e=_.value.issPcsQty-_.value.invProvideQty;e<0&&window.$message.error("投料数(PCS)必须大于0"),_.value.issPcsQty=e,_.value.autoCalc.includes(!0)&&T()},blur:function(){var e=_.value.issPcsQty-_.value.invProvideQty;e<0&&window.$message.error("投料数(PCS)必须大于0"),_.value.issPcsQty=e,_.value.autoCalc.includes(!0)&&T()},rule:[{required:!0,message:"请输入投料数(PCS)",trigger:"change"}]},{type:"input",key:"scrapRete",label:"预投料率(%)",span:12,placeholder:"请输入预投料率(%)"},{type:"input",key:"sheetQty",label:"大料数",span:6,placeholder:"请输入大料数"},{type:"checkbox",key:"autoCalc",label:"",span:6,selectOptions:[{label:"自动计算",value:!0}]},{type:"select",key:"workType",label:"工单类型",span:12,placeholder:"请选择工单类型",selectOptions:[{label:"正常",value:"正常"},{label:"赶板",value:"赶板"},{label:"加急",value:"加急"}]},{type:"input",key:"lotQty",label:"每批卡数量",span:12,placeholder:"请输入每批卡数量"},{type:"textarea",key:"remark",label:"备注",span:24,placeholder:""}],A=u(null),$=S(A).height,H=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"liaohao",dataIndex:"liaohao",title:"生产型号",align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return y("div",{class:"fonw-800 color-#646cff"},[t.liaohao])}},{key:"sheetpnl",dataIndex:"sheetpnl",title:"1Sheet=?PNL",align:"center",checked:!0,ellipsis:!0},{key:"pnlset",dataIndex:"pnlset",title:"1PNL=?Set",align:"center",checked:!0,ellipsis:!0},{key:"setpcs",dataIndex:"setpcs",title:"1Set=?Pcs",align:"center",checked:!0,ellipsis:!0},{key:"pnl",dataIndex:"pnl",title:"PNL数",align:"center",checked:!0,ellipsis:!0}],K=function(e){return/^(\d+(\.\d+)?)$/.test(e)&&Number.parseFloat(e)>0},z=u(null),W=u({}),J=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"prodNo",dataIndex:"prodNo",title:"生产型号",align:"center",checked:!0,ellipsis:!0,width:150,customRender:function(e){var t=e.record;return y("div",{class:"fonw-800 color-#646cff"},[t.prodNo])}},{key:"matno",dataIndex:"matno",title:"板材编码",align:"center",checked:!0,ellipsis:!0,width:150},{key:"specif",dataIndex:"specif",title:"物料规格",align:"center",checked:!0,ellipsis:!0,width:200},{key:"invqty",dataIndex:"invqty",title:"库存数量",align:"center",checked:!0,ellipsis:!0,width:150},{key:"applyQty",dataIndex:"applyQty",title:"申请数量",align:"center",checked:!0,ellipsis:!0,width:150,customRender:function(e){var t=e.record;return y(M,{class:"w-full",value:t.applyQty,"onUpdate:value":function(e){return t.applyQty=e},onChange:function(e){return/^\d+$/.test(e.target.value)?e>Number(t.invqty)?(window.$message.error("申请数量不能大于库存数量"),t.applyQty=0,void(e.target.value=0)):(e.target.value=Number(e.target.value),void(t.applyQty=Number(e.target.value))):(window.$message.error("请输入正整数"),t.applyQty=0,void(e.target.value=0))}},null)}},{key:"unit",dataIndex:"unit",title:"单位",align:"center",checked:!0,ellipsis:!0,width:100},{key:"length",dataIndex:"length",title:"实开大料长(mm)",align:"center",checked:!0,ellipsis:!0,width:160,customRender:function(e){var t=e.record;return y(M,{class:"w-full",value:t.length,"onUpdate:value":function(e){return t.length=e},onChange:function(e){if(!K(e.target.value))return window.$message.error("请输入大于0的数字"),void(e.target.value=t.length);t.length=Number(e.target.value)}},null)}},{key:"width",dataIndex:"width",title:"实开大料宽(mm)",align:"center",checked:!0,ellipsis:!0,width:160,customRender:function(e){var t=e.record;return y(M,{class:"w-full",value:t.width,"onUpdate:value":function(e){return t.width=e},onChange:function(e){if(!K(e.target.value))return window.$message.error("请输入大于0的数字"),void(t.width=0);t.width=Number(e.target.value)}},null)}},{key:"remark",dataIndex:"remark",title:"备注",align:"center",checked:!0,ellipsis:!0,width:160,customRender:function(e){var t=e.record;return y(M,{class:"w-full",value:t.remark,"onUpdate:value":function(e){return t.remark=e},onChange:function(e){t.remark=e.target.value}},null)}},{key:"asheetPnl",dataIndex:"asheetPnl",title:"APNL/Sheet",align:"center",checked:!0,ellipsis:!0,width:160,customRender:function(e){var t=e.record;return y(M,{class:"w-full",value:t.asheetPnl,"onUpdate:value":function(e){return t.asheetPnl=e},onChange:function(e){if(!K(e.target.value))return window.$message.error("请输入大于0的数字"),t.asheetPnl=0,void(e.target.value=t.asheetPnl);t.asheetPnl=Number(e.target.value)}},null)}},{key:"APnlQty",dataIndex:"APnlQty",title:"开APNL",align:"center",checked:!0,ellipsis:!0,width:160,customRender:function(e){var t=e.record;return _.value.autoCalc.includes(!0)?t.applyQty*(t.asheetPnl||0):null}},{key:"bsheetPnl",dataIndex:"bsheetPnl",title:"BPNL/Sheet",align:"center",checked:!0,ellipsis:!0,width:160,customRender:function(e){var t=e.record;return y(M,{class:"w-full",value:t.bsheetPnl,"onUpdate:value":function(e){return t.bsheetPnl=e},onChange:function(e){if(!K(e.target.value))return window.$message.error("请输入大于0的数字"),void(t.bsheetPnl=0);e.target.value=Number(e.target.value),t.bsheetPnl=Number(e.target.value)}},null)}},{key:"BPnlQty",dataIndex:"BPnlQty",title:"开BPNL",align:"center",checked:!0,ellipsis:!0,width:160,customRender:function(e){var t=e.record;if(_.value.autoCalc.includes(!0))return t.applyQty*(t.bsheetPnl||0)}},{key:"needDate",dataIndex:"needDate",title:"需求日期",align:"center",checked:!0,ellipsis:!0,width:200,customRender:function(e){var t=e.record;return y(j,{value:t.needDate,format:"YYYY-MM-DD HH:mm:ss",onChange:function(e){return t.needDate=e}},null)}},{key:"proviQty",dataIndex:"proviQty",title:"发放数量",align:"center",checked:!0,ellipsis:!0,width:160}],G=u("1"),X=u(!1),Z=u([]),ee=u([]);function te(e){ee.value=e}var ae=u([]);function ne(e){ae.value=e}function le(){X.value=!0}var re=u(null);function se(){var e,t,n,l=re.value.saveData(),r=null,c=null;null!==(e=_.value)&&void 0!==e&&null!==(e=e.liaohao)&&void 0!==e&&e.includes("-")?(r=(null===(t=L.value.find((function(e){if("A"===(null==e?void 0:e.liaohao.split("-")[1]))return e})))||void 0===t?void 0:t.sheetpnl)||null,c=(null===(n=L.value.find((function(e){if("B"===(null==e?void 0:e.liaohao.split("-")[1]))return e})))||void 0===n?void 0:n.sheetpnl)||null):r=L.value[0].sheetpnl;if(l){var s=_.value.liaohao.split("-")[0];Z.value=[].concat(i(Z.value),[a(a({},l),{},{prodNo:s,applyQty:0,needDate:f(),asheetPnl:r,bsheetPnl:c,dataIndex:Z.value.length+1})]),X.value=!1}}function de(e){e&&(Z.value=[].concat(i(Z.value),[a(a({},e),{},{prodNo:prodNo,applyQty:0,needDate:f(),asheetPnl:asheetPnl,bsheetPnl:bsheetPnl})]),X.value=!1)}return l({saveData:function(){var e=_.value,t={moduleNo:e.liaohao,remark:e.remark,issueType:e.issueType,autoCalc:e.autoCalc[0],workType:e.workType,scrapRete:e.scrapRete,issPcsQty:e.issPcsQty,custProdNo:e.custProdNo,sheetQty:e.sheetQty,liveUint:e.liveUint||0,prodId:e.prodID,qty:e.qty,lotQty:e.lotQty,pedifficulty:e.pedifficulty,prodOrderNo:e.prodOrderNo},a=-1,n=Z.value.map((function(t){return 0===t.applyQty&&(a=t.dataIndex),{moduleNo:e.liaohao,type:t.type,matId:t.matid,matName:t.matname,qty:t.applyQty,prodOrderNo:e.prodOrderNo,unit:t.unit,specif:t.specif,outType:e.issueType}}));return n.length?a>-1?(window.$message.error("请先填写第".concat(a,"行板材申请数量")),!1):{data:t,list:n}:(window.$message.error("请选择板材"),!1)},resetTopModel:function(){_.value=n(n(n(n(n(n(n(n(n(n({liaohao:null,prodOrderNo:null,pedifficulty:null,mantissaPercent:null,invProvideQty:null,invQty:null,qty:null},"invQty",null),"issueType","投料"),"issPcsQty",null),"scrapRete",null),"sheetQty",null),"autoCalc",[!0]),"workType","正常"),"lotQty",120),"list",null),"remark",null)}}),function(e,t){var a=E,n=V,l=c,s=B,d=w,u=Q,f=U,b=F,T=r,S=N;return o(),h("div",ye,[y(S,{gutter:16,class:"h-full w-full"},{default:v((function(){return[y(u,{span:14,class:"h-full"},{default:v((function(){return[y(n,{ref_key:"topFormRef",ref:A,bordered:!1,class:"modal-card","body-style":{padding:"5px"}},{title:v((function(){return t[6]||(t[6]=[m("span",{class:"mr15px color-#646cff"},"投产输入",-1)])})),default:v((function(){return[y(a,{ref_key:"formRef",ref:D,model:_.value,"onUpdate:model":t[0]||(t[0]=function(e){return _.value=e}),class:"add-modal","form-list":Y},null,8,["model"])]})),_:1},512),m("div",{class:"bottom-table w-full",style:R({height:"calc(100% - ".concat(P($),"px)")})},[y(l,{ref_key:"topTableRef",ref:k,searchParams:I.value,"onUpdate:searchParams":t[1]||(t[1]=function(e){return I.value=e}),column:H,"show-row-selection":!1,"auto-generate-uuid":"","row-key":"screenId",scroll:{y:"auto"},"is-init-get-data":"",url:"/mes/BaseVppcissueplanodr/getModelList1",class:"h-50%","is-pagination":!1,onTableDataLoadSucess:q},{title:v((function(){return t[7]||(t[7]=[m("span",{class:"color-#646cff"},"投料型号",-1)])})),_:1},8,["searchParams"]),y(l,{ref_key:"bottomTableRef",ref:z,searchParams:W.value,"onUpdate:searchParams":t[2]||(t[2]=function(e){return W.value=e}),column:J,"show-row-selection":!1,"auto-generate-uuid":"","data-source":Z.value,"row-key":"screenId",scroll:{y:"auto"},"is-init-get-data":"",url:"",class:"h-50%","is-pagination":!1},{title:v((function(){return[t[9]||(t[9]=m("span",{class:"color-#646cff"},"投发板料",-1)),y(s,{type:"primary",class:"mini-btn ml-8px mr-8px",size:"small",ghost:"",onClick:le},{icon:v((function(){return[y(P(C),{class:"align-sub"})]})),default:v((function(){return[t[8]||(t[8]=g(" 添加 "))]})),_:1})]})),"contextmenuPopup-orter":v((function(e){var a=e.args;return[m("li",{class:"popup-item",onClick:function(e){return function(e){var t=e.index;Z.value.splice(t,1),Z.value.forEach((function(e,t){e.dataIndex=t+1})),Z.value=i(Z.value),e.hidePopup()}(a)}},[y(d,{"local-icon":"delete",class:"text-16px"}),t[10]||(t[10]=g(" 删除 "))],8,ve)]})),_:1},8,["searchParams","data-source"])],4)]})),_:1}),y(u,{span:10,class:"h-full"},{default:v((function(){return[y(b,{activeKey:G.value,"onUpdate:activeKey":t[3]||(t[3]=function(e){return G.value=e}),type:"card",class:"my-tabs h-full"},{default:v((function(){return[y(f,{key:"1","force-render":""},{tab:v((function(){return t[11]||(t[11]=[m("span",null,[m("span",{class:"iconfont icon-gongchengzhishi"}),g(" 工程指示 ")],-1)])})),default:v((function(){return[y(ie,{ref_key:"engineeringInstructionRef",ref:x,onEngineeringTableDataLoadSuccess:te,onEngineeringInstructionTableLoadSuccess:ne},null,512)]})),_:1}),y(f,{key:"2","force-render":""},{tab:v((function(){return t[12]||(t[12]=[m("span",null,[m("span",{class:"iconfont icon-gongchengtuzhi"}),g(" 开料图 ")],-1)])})),default:v((function(){return[y(ce)]})),_:1})]})),_:1},8,["activeKey"])]})),_:1}),y(T,{visible:X.value,"onUpdate:visible":t[5]||(t[5]=function(e){return X.value=e}),"destroy-on-close":!0,centered:!0,width:"90vw",height:"85vh",mask:"","modal-warp-style":{padding:"5px"}},{title:v((function(){return[m("div",me,[t[13]||(t[13]=g(" 请选择要投放的板材 型号： ")),m("span",ge,O(_.value.liaohao),1),t[14]||(t[14]=g(" 还可领数量： ")),m("span",ke,O(_.value.sheetQty),1)])]})),footer:v((function(){return[m("div",be,[y(s,{onClick:t[4]||(t[4]=function(e){return X.value=!1})},{default:v((function(){return t[15]||(t[15]=[g("关闭")])})),_:1}),y(s,{type:"primary",onClick:se},{default:v((function(){return t[16]||(t[16]=[g("确定")])})),_:1})])]})),default:v((function(){return[y(he,{ref_key:"addSheetMetalRef",ref:re,"row-data":P(p),"engineering-table-data":ee.value,"engineering-instruction-data":ae.value,onSaveData:de},null,8,["row-data","engineering-table-data","engineering-instruction-data"])]})),_:1},8,["visible"])]})),_:1})])}}},Ie=I(we,[["__scopeId","data-v-8bfd98df"]]),xe={class:"h-full min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},Pe={class:"top mb-0.5% h-59.5%"},De={class:"bottom h-40%"},_e={class:"modal-footer"};e("default",I(Object.assign({name:"work-order-management_production-feed"},{__name:"index",setup:function(e){var t=u(null),a=l(q({moduleNo:null,time:[f().set("hour",0).set("minute",0).set("second",0).set("millisecond",0),f().set("hour",23).set("minute",29).set("second",59).set("millisecond",999)],isFinish:null}),2),n=a[0],i=a[1],p={"-1":"无ICS",0:"新录入",1:"更改",2:"待处理",3:"处理中",4:"暂停",5:"拒审",6:"反审核",7:"审核中",8:"生效",9:"完成",10:"取消",11:"外部ECN",12:"外部ECN处理中",13:"内部ECN处",19:"样板转生产",21:"改变",22:"待投料",23:"已投料",25:"失效",999:"系统完成",150331113231e4:"初审"};function k(e){return p[e]||""}function w(e){switch(Number(e)){case 0:return"#0080FF";case 1:return"#E1E100";case 2:return"#FF8000";case 3:return"#B15BFF";case 4:return"#73BF00";case 5:return"#8E8E8E";case 6:case 8:return"#BEBEBE";case 7:return"#FF0000";case 9:default:return"#0000FF";case 10:return"#007500";case 21:return"#FF4500";case 25:return"#00CED1"}}function I(e){switch(Number(e)){case 0:return"新录入";case 1:return"更改";case 2:return"待处理";case 3:return"处理中";case 4:return"暂停";case 5:return"回退";case 6:return"反审核";case 7:return"审核中";case 8:return"生效";case 9:return"完成";case 10:return"取消";case 11:return"外部ECN";case 12:return"外部ECN处理中";case 13:return"内部ECN处";case 21:return"改变";case 22:return"待投料";case 23:return"已投料";default:return""}}function x(e){switch(Number(e)){case 0:return"#0080FF";case 1:return"#E1E100";case 2:return"#FF8000";case 3:return"#B15BFF";case 4:return"#73BF00";case 5:return"#8E8E8E";case 6:case 8:return"#BEBEBE";case 7:return"#FF0000";case 9:default:return"#0000FF";case 10:return"#007500";case 21:return"#FF4500"}}var D=[{type:"input",key:"moduleNo",label:"生产型号",span:6,placeholder:"请输入生产型号"},{type:"dateRangePicker",key:"time",label:"时间",span:9,showTime:!0},{type:"select",key:"isFinish",label:"是否投完",placeholder:"请选择是否投完",span:6,selectOptions:[{label:"是",value:0},{label:"否",value:1}]}],T=u(null),S=Y(n),R=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"ppcState",dataIndex:"ppcState",title:"状态",align:"center",checked:!0,ellipsis:!0,width:70,customRender:function(e){var t=e.record;return y("div",{style:{color:w(t.ppcState)},class:"h-full w-full font-800"},[k(t.ppcState)])}},{key:"faState",dataIndex:"faState",title:"财务审核状态",align:"center",checked:!0,ellipsis:!0,width:120,customRender:function(e){var t=e.record;return y("div",{style:{color:w(t.faState)},class:"h-full w-full font-800"},[k(t.faState)])}},{key:"prodOrderNo",dataIndex:"prodOrderNo",title:"工单号",width:120,align:"center",checked:!0,ellipsis:!0},{key:"odrType",dataIndex:"odrType",title:"订单类型",width:120,align:"center",checked:!0,ellipsis:!0},{key:"liaohao",dataIndex:"liaohao",title:"生产型号",width:120,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return y("div",{class:"fonw-800 color-#646cff"},[t.liaohao])}},{key:"odrProdType",dataIndex:"odrProdType",title:"加工类型",width:120,align:"center",checked:!0,ellipsis:!0},{key:"surfTrea1",dataIndex:"surfTrea1",title:"表面处理1",width:190,align:"center",checked:!0,ellipsis:!0},{key:"surfTrea2",dataIndex:"surfTrea2",title:"表面处理2",width:190,align:"center",checked:!0,ellipsis:!0},{key:"qty",dataIndex:"qty",title:"工单数量",width:120,align:"center",checked:!0,ellipsis:!0},{key:"prodOdrInvQty",dataIndex:"prodOdrInvQty",title:"使用库存",width:120,align:"center",checked:!0,ellipsis:!0},{key:"issueQty",dataIndex:"issueQty",title:"待投数量",width:120,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return t.qty-t.prodOdrInvQty-t.issPcsQty<0?0:t.qty-t.prodOdrInvQty-t.issPcsQty}},{key:"issPcsQty",dataIndex:"issPcsQty",title:"已投料数量",width:120,align:"center",checked:!0,ellipsis:!0},{key:"invInQty",dataIndex:"invInQty",title:"入库数量",width:120,align:"center",checked:!0,ellipsis:!0},{key:"invOutQty",dataIndex:"invOutQty",title:"交货数量",width:120,align:"center",checked:!0,ellipsis:!0},{key:"invQty",dataIndex:"invQty",title:"库存数量",width:120,align:"center",checked:!0,ellipsis:!0},{key:"mktDate",dataIndex:"mktDate",title:"要求交期",width:160,align:"center",checked:!0,ellipsis:!0},{key:"ppcDate",dataIndex:"ppcDate",title:"答复交期",width:160,align:"center",checked:!0,ellipsis:!0},{key:"planDate",dataIndex:"planDate",title:"计划投料日期",width:160,align:"center",checked:!0,ellipsis:!0},{key:"prodType",dataIndex:"prodType",title:"产品类型",width:120,align:"center",checked:!0,ellipsis:!0},{key:"remark",dataIndex:"remark",title:"计划备注",width:120,align:"center",checked:!0,ellipsis:!0},{key:"remark1",dataIndex:"remark1",title:"评审备注",width:120,align:"center",checked:!0,ellipsis:!0},{key:"batchType",dataIndex:"batchType",title:"批次类型",width:120,align:"center",checked:!0,ellipsis:!0},{key:"pedifficulty",dataIndex:"pedifficulty",title:"难度系数",width:120,align:"center",checked:!0,ellipsis:!0},{key:"custNo",dataIndex:"custNo",title:"客户编码",width:120,align:"center",checked:!0,ellipsis:!0},{key:"custName",dataIndex:"custName",title:"客户名称",width:120,align:"center",checked:!0,ellipsis:!0},{key:"custProdNo",dataIndex:"custProdNo",title:"客户型号",width:120,align:"center",checked:!0,ellipsis:!0},{key:"sellType",dataIndex:"sellType",title:"销售方式",width:120,align:"center",checked:!0,ellipsis:!0},{key:"concerned",dataIndex:"concerned",title:"安全投产",width:120,align:"center",checked:!0,ellipsis:!0},{key:"createBy",dataIndex:"createBy",title:"创建者",width:120,align:"center",checked:!0,ellipsis:!0},{key:"createDate",dataIndex:"createDate",title:"创建日期",width:160,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;f(t.createDate).format("YYYY-MM-DD HH:mm:ss")}},{key:"updateDate",dataIndex:"updateDate",title:"最后更改日期",width:160,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;f(t.updateDate).format("YYYY-MM-DD HH:mm:ss")}}],O=u("1"),M=u(null),j=u(null),E=u({}),A=u(null),$=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"state",dataIndex:"state",title:"状态",align:"center",checked:!0,ellipsis:!0,width:70,customRender:function(e){var t=e.record;return y("div",{style:{color:x(Number(t.state))},class:"h-full w-full font-800"},[I(Number(t.state))])}},{key:"issueNo",dataIndex:"issueNo",title:"投料单号",width:120,align:"center",checked:!0,ellipsis:!0},{key:"moduleNo",dataIndex:"moduleNo",title:"生产型号",width:120,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return y("div",{class:"fonw-800 color-#646cff"},[t.moduleNo])}},{key:"custProdNo",dataIndex:"custProdNo",title:"客户型号",width:120,align:"center",checked:!0,ellipsis:!0},{key:"issueType",dataIndex:"issueType",title:"发料类型",width:120,align:"center",checked:!0,ellipsis:!0},{key:"workType",dataIndex:"workType",title:"工单类型",width:120,align:"center",checked:!0,ellipsis:!0},{key:"qty",dataIndex:"qty",title:"交货数量(PCS)",width:120,align:"center",checked:!0,ellipsis:!0},{key:"sheetQty",dataIndex:"sheetQty",title:"大料数量(Sheet)",width:120,align:"center",checked:!0,ellipsis:!0},{key:"lotQty",dataIndex:"lotQty",title:"PNL数量",width:120,align:"center",checked:!0,ellipsis:!0},{key:"invProvideQty",dataIndex:"invProvideQty",title:"使用库存数量(PCS)",width:160,align:"center",checked:!0,ellipsis:!0},{key:"issPcsQty",dataIndex:"issPcsQty",title:"发料数量(PCS)",width:120,align:"center",checked:!0,ellipsis:!0},{key:"scrapRete",dataIndex:"scrapRete",title:"预投料率",width:120,align:"center",checked:!0,ellipsis:!0},{key:"liveUint",dataIndex:"liveUint",title:"有效单元数量(PCS)",width:160,align:"center",checked:!0,ellipsis:!0},{key:"invUnit",dataIndex:"invUnit",title:"入库数量(PCS)",width:140,align:"center",checked:!0,ellipsis:!0},{key:"practicalLength",dataIndex:"practicalLength",title:"实开大料长(mm)",width:140,align:"center",checked:!0,ellipsis:!0},{key:"practicalWidth",dataIndex:"practicalWidth",title:"实开大料宽(mm)",width:140,align:"center",checked:!0,ellipsis:!0},{key:"weight",dataIndex:"weight",title:"单元重量",width:120,align:"center",checked:!0,ellipsis:!0},{key:"pcsarea",dataIndex:"pcsarea",title:"单元面积(sq.ft)",width:140,align:"center",checked:!0,ellipsis:!0},{key:"remark",dataIndex:"remark",title:"备注",width:120,align:"center",checked:!0,ellipsis:!0},{key:"createDate",dataIndex:"createDate",title:"发料日期",width:120,align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;f(t.createDate).format("YYYY-MM-DD HH:mm:ss")}},{key:"createBy",dataIndex:"createBy",title:"发料人员",width:120,align:"center",checked:!0,ellipsis:!0},{key:"autoCalc",dataIndex:"autoCalc",title:"自动计算",width:120,align:"center",checked:!0,ellipsis:!0}];function H(){T.value.getData()}function K(){i(),b((function(){H()}))}var z=u(null);function V(e){z.value=L(e),E.value.prodId=e.prodID,b((function(){A.value.getData(),M.value.getData({prodNo:e.liaohao})}))}function W(e){e.length&&(T.value.setCurrentRowId(e[0]),V(e[0]))}var X=u(!1);function Z(){X.value=!0}var te=u(null);function ae(){var e,t=te.value.saveData();t&&Promise.all([(e=t.data,d({url:"/mes/BasePpcprodissue/insertBasePpcprodissue",method:"post",data:e})),J(t.list)]).then((function(e){var t=l(e,2),a=t[0],n=t[1];a.error||n.error||(window.$message.success("保存成功"),H())})).finally((function(){X.value=!1}))}function ne(){X.value=!1,te.value.resetTopModel()}return function(e,a){var l=s,i=c,d=Q,u=U,p=F,f=N,k=B,b=r;return o(),h("div",xe,[m("div",Pe,[y(f,{class:"h-full",gutter:16},{default:v((function(){return[y(d,{span:16,class:"h-full min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},{default:v((function(){return[y(l,{ref_key:"commonSearchRef",ref:t,searchParams:P(n),"onUpdate:searchParams":a[0]||(a[0]=function(e){return _(n)?n.value=e:null}),"form-list":D,onSearch:H,onReset:K},null,8,["searchParams"]),y(i,{ref_key:"topTableRef",ref:T,searchParams:P(S),"onUpdate:searchParams":a[1]||(a[1]=function(e){return _(S)?S.value=e:null}),column:R,"show-row-selection":!1,"auto-generate-uuid":"","row-key":"screenId",scroll:{y:"auto"},"is-init-get-data":"",url:"/mes/BaseVppcissueplanodr/select",onTableRowClick:V,onTableDataLoadSucess:W},{title:v((function(){return a[5]||(a[5]=[m("span",{class:"color-#646cff"},"生产工单",-1)])})),_:1},8,["searchParams"])]})),_:1}),y(d,{class:"h-full",span:8},{default:v((function(){return[y(p,{activeKey:O.value,"onUpdate:activeKey":a[2]||(a[2]=function(e){return O.value=e}),type:"card",class:"my-tabs h-full"},{default:v((function(){return[y(u,{key:"1","force-render":""},{tab:v((function(){return a[6]||(a[6]=[m("span",null,[m("span",{class:"iconfont icon-jiaohuojihua"}),g(" 交货计划 ")],-1)])})),default:v((function(){return[y(G,{ref_key:"deliveryScheduleRef",ref:j},null,512)]})),_:1}),y(u,{key:"2","force-render":""},{tab:v((function(){return a[7]||(a[7]=[m("span",null,[m("span",{class:"iconfont icon-gongchengwenjian"}),g(" 工程文件 ")],-1)])})),default:v((function(){return[y(ee,{ref_key:"engineeringDocumentRef",ref:M},null,512)]})),_:1})]})),_:1},8,["activeKey"])]})),_:1})]})),_:1})]),m("div",De,[y(i,{ref_key:"bottomTableRef",ref:A,searchParams:E.value,"onUpdate:searchParams":a[3]||(a[3]=function(e){return E.value=e}),class:"h-full",column:$,"show-row-selection":!1,"auto-generate-uuid":"","row-key":"screenId",scroll:{y:"auto"},"is-init-get-data":!1,"is-pagination":!1,url:"/mes/BasePpcprodissue/selectBasePpcprodissue"},{title:v((function(){return[a[9]||(a[9]=m("span",{class:"mr15px color-#646cff"},"投产明细",-1)),y(k,{type:"primary",class:"mini-btn mr-8px",size:"small",ghost:"",disabled:!z.value,onClick:Z},{icon:v((function(){return[y(P(C),{class:"align-sub"})]})),default:v((function(){return[a[8]||(a[8]=g(" 添加 "))]})),_:1},8,["disabled"])]})),_:1},8,["searchParams"])]),y(b,{visible:X.value,"onUpdate:visible":a[4]||(a[4]=function(e){return X.value=e}),"destroy-on-close":!0,centered:!0,title:"投料输入",width:"100%",height:"100vh","modal-warp-style":{padding:"5px"},onClose:ne},{footer:v((function(){return[m("div",_e,[y(k,{onClick:ne},{default:v((function(){return a[10]||(a[10]=[g("关闭")])})),_:1}),y(k,{type:"primary",onClick:ae},{default:v((function(){return a[11]||(a[11]=[g("保存")])})),_:1})])]})),default:v((function(){return[y(Ie,{ref_key:"addRef",ref:te,"row-data":z.value},null,8,["row-data"])]})),_:1},8,["visible"])])}}}),[["__scopeId","data-v-426d397e"]]))}}}))}();
