import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{d as a,K as l,L as t,o as n,c as s,w as o,g as i,f as u,t as r,M as d,v as c,N as p,O as m,B as v,P as f,Q as h,F as g,r as _,p as x,S as w,e as b,h as y,I as k}from"./index-B3PZsRwT.js";import{g as C,p as j,a as U}from"./api-By23aosn.js";import{_ as z}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{C as T}from"./index-BThgVJ70.js";import{_ as I}from"./index-Ct4ZGO_E.js";import"./_createAggregator-DK8mP78E.js";import"./DeleteOutlined-CWT7lRAZ.js";import"./DownloadOutlined-CnXdrHEb.js";import"./index-81pxjwat.js";const S={class:"w-full flex"},O={class:"flex"},Y={class:"w-full flex-y-center justify-end gap-12px"},D={class:"ml-3px"},R={class:"ml-3px"},M=a({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:l(["search","reset"],["update:model"]),setup(e,{emit:a}){const l=a,_=t(e,"model");function x(){l("search",_.value)}function w(){_.value.time=null}return(e,a)=>{const l=d,t=c,b=p,y=m,k=v,C=f,j=h,U=g,z=T;return n(),s(z,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:o((()=>[i(U,{model:_.value,"label-col":{span:5,md:7},class:"search-form"},{default:o((()=>[u("div",S,[i(j,{gutter:[15,8],wrap:"",class:"w-full"},{default:o((()=>[i(b,{span:24,md:12,lg:8,xl:8,xxl:6},{default:o((()=>[i(t,{label:"时间范围",name:"time",class:"m-0","label-col":{}},{default:o((()=>[i(l,{value:_.value.time,"onUpdate:value":a[0]||(a[0]=e=>_.value.time=e),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",class:"min-form-control"},null,8,["value"])])),_:1})])),_:1}),u("div",O,[i(t,{class:"m-0"},{default:o((()=>[u("div",Y,[i(k,{type:"primary",ghost:"",class:"mini-btn",onClick:x},{icon:o((()=>[i(y,{class:"align-sub text-icon"})])),default:o((()=>[u("span",D,r(e.$t("common.search")),1)])),_:1}),i(k,{class:"mini-btn",onClick:w},{icon:o((()=>[i(C,{class:"align-sub text-icon"})])),default:o((()=>[u("span",R,r(e.$t("common.reset")),1)])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])])),_:1})}}}),q={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},A=["src"],P={class:"modal-footer"},$={class:"event-form"},B={class:"modal-footer"},F=Object.assign({name:"administrative-manpower_drinking-water"},{__name:"index",setup(a){const l=_({time:null}),t=_({}),s=_([]),r="/prod-api",d=x({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:e=>"共".concat(e,"条"),total:0,onChange:async(e,a)=>{d.current=e,d.pageSize=a,F()}}),m=_([{key:"index",dataIndex:"index",title:"序号",width:100,align:"center",checked:!0},{key:"phone",dataIndex:"phone",title:"手机号码",width:150,align:"center",checked:!0,ellipsis:!0},{key:"phone2",dataIndex:"phone2",title:"手机号码2",width:150,align:"center",checked:!0,ellipsis:!0},{key:"phone3",dataIndex:"phone3",title:"手机号码3",width:150,align:"center",checked:!0,ellipsis:!0},{key:"phone4",dataIndex:"phone4",title:"手机号码4",width:150,align:"center",checked:!0,ellipsis:!0},{key:"passOver",dataIndex:"passOver",title:"上传文件",width:200,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>i(w("A"),{color:"blue",onClick:()=>{return a=e,Q.value="".concat(r,"/qms/hr/annualTestReport/preview?filePath=").concat(a.filePath),void(O.value=!0);var a}},{default:()=>[e.filePath]})},{key:"createTime",dataIndex:"createTime",title:"上传时间",width:180,align:"center",checked:!0,ellipsis:!0},{key:"createUser",dataIndex:"createUser",title:"修改人",width:100,align:"center",checked:!0,ellipsis:!0}]),f=_({}),S=_(!1),O=_(!1),Y=_([]),D=_(!1),R=_([]);function F(){var e;D.value=!0;const a={};(null==(e=l.value.time)?void 0:e[0])&&(a.startTime=l.value.time[0],a.endTime=l.value.time[1]),C("qms/hr/annualTestReport/potableWater/list",{pageSize:d.pageSize,pageNum:d.current,...a}).then((({data:e,error:l})=>{l||(a.value={},e.list.forEach(((e,a)=>{e.index=a+1})),Y.value=e.list,d.total=e.total)})).finally((()=>{D.value=!1}))}function E(){f.value={},S.value=!0}function K(){var e;if(W.value){[].push(W.value),j("qms/hr/annualTestReport/deleteBatch",W.value).then((e=>{var a;error||(null==(a=window.$message)||a.success("删除成功!"),W.value=[],F())}))}else null==(e=window.$message)||e.error("请先选择数据")}function L(){const e=new FormData;e.append("file",t.value.file),e.append("phone",t.value.phone),e.append("phone2",t.value.phone2),e.append("phone3",t.value.phone3),e.append("phone4",t.value.phone4),U("/qms/hr/annualTestReport/potableWater/add/new",e).then((e=>{var a;error||(S.value=!1,null==(a=window.$message)||a.success(e.data.msg),F(),t.value={})}))}function N(){d.current=1,F()}F();const Q=_("");const W=_([]),J=_(null),G=e=>({style:{background:e.uid===J.value?"#BAEAFA":""},class:e.uid===J.value?"jl-table-row-selected":"",onClick:()=>{J.value=e.uid}});function H(e){W.value=e}const V=e=>{"uploading"!==e.file.status&&(t.value.file=e.file),"done"===e.file.status?message.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&message.error("".concat(e.file.name," file upload failed."))};function X(e){return new Promise(((e,a)=>{a(!1)}))}return(a,r)=>{const f=v,_=e,x=w("STable"),C=k,j=c,U=p,F=w("UploadOutlined"),J=I,Z=h,ee=g,ae=T;return n(),b("div",q,[i(M,{model:l.value,"onUpdate:model":r[0]||(r[0]=e=>l.value=e),onReset:r[1]||(r[1]=e=>N()),onSearch:r[2]||(r[2]=e=>N())},null,8,["model"]),i(ae,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card flex-col-stretch sm:flex-1-hidden card-wrapper"},{title:o((()=>[i(f,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:E},{default:o((()=>r[13]||(r[13]=[u("span",{class:"ml-3px"},"新增",-1)]))),_:1}),i(f,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:K},{default:o((()=>r[14]||(r[14]=[u("span",{class:"ml-3px"},"删除",-1)]))),_:1})])),extra:o((()=>[i(_,{columns:m.value,"onUpdate:columns":r[3]||(r[3]=e=>m.value=e)},null,8,["columns"])])),default:o((()=>[i(x,{columns:m.value,"data-source":Y.value,size:"small",bordered:"",loading:D.value,"default-expanded-row-keys":R.value,"row-selection":{selectedRowKeys:W.value,onChange:H},"row-key":"id","default-expand-all-rows":!0,scroll:{x:"auto",y:"auto"},pagination:d,class:"h-full","custom-row":G,"row-height":23},null,8,["columns","data-source","loading","default-expanded-row-keys","row-selection","pagination"]),i(z,{visible:O.value,"onUpdate:visible":r[5]||(r[5]=e=>O.value=e),"destroy-on-close":!0,title:"预览生活饮用水检验文件",width:"700px"},{footer:o((()=>[u("div",P,[i(f,{onClick:r[4]||(r[4]=e=>O.value=!1)},{default:o((()=>r[15]||(r[15]=[y("关闭")]))),_:1})])])),default:o((()=>[u("iframe",{src:Q.value,width:"100%",style:{"min-height":"600px","min-width":"600px"},height:"100%",frameborder:"0"},null,8,A)])),_:1},8,["visible"]),i(z,{visible:S.value,"onUpdate:visible":r[12]||(r[12]=e=>S.value=e),"destroy-on-close":!0,title:"生活饮用水检验新增",width:"700px"},{footer:o((()=>[u("div",B,[i(f,{onClick:r[11]||(r[11]=e=>S.value=!1)},{default:o((()=>r[17]||(r[17]=[y("关闭")]))),_:1}),i(f,{type:"primary",onClick:L},{default:o((()=>r[18]||(r[18]=[y("保存")]))),_:1})])])),default:o((()=>[u("div",$,[i(ee,{model:t.value,name:"basic","label-col":{span:6}},{default:o((()=>[i(Z,{gutter:24},{default:o((()=>[i(U,{span:12},{default:o((()=>[i(j,{label:"手机号码",name:"phone"},{default:o((()=>[i(C,{value:t.value.phone,"onUpdate:value":r[6]||(r[6]=e=>t.value.phone=e)},null,8,["value"])])),_:1})])),_:1}),i(U,{span:12},{default:o((()=>[i(j,{label:"手机号码",name:"phone2"},{default:o((()=>[i(C,{value:t.value.phone2,"onUpdate:value":r[7]||(r[7]=e=>t.value.phone2=e)},null,8,["value"])])),_:1})])),_:1}),i(U,{span:12},{default:o((()=>[i(j,{label:"手机号码",name:"phone3"},{default:o((()=>[i(C,{value:t.value.phone3,"onUpdate:value":r[8]||(r[8]=e=>t.value.phone3=e)},null,8,["value"])])),_:1})])),_:1}),i(U,{span:12},{default:o((()=>[i(j,{label:"手机号码",name:"phone4"},{default:o((()=>[i(C,{value:t.value.phone4,"onUpdate:value":r[9]||(r[9]=e=>t.value.phone4=e)},null,8,["value"])])),_:1})])),_:1}),i(U,{span:24},{default:o((()=>[i(j,{label:"信息上传",name:"username","label-col":{span:0}},{default:o((()=>[i(J,{"file-list":s.value,"onUpdate:fileList":r[10]||(r[10]=e=>s.value=e),"before-upload":X,"max-count":1,name:"file",onChange:V},{default:o((()=>[i(f,null,{default:o((()=>[i(F),r[16]||(r[16]=y(" 点击上传 "))])),_:1})])),_:1},8,["file-list"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])])),_:1},8,["visible"])])),_:1})])}}});export{F as default};
