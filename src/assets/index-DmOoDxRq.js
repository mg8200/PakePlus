import{_ as e}from"./table-DoFSI9NT.js";import{_ as t}from"./common-search.vue_vue_type_script_setup_true_lang-BX9APgbN.js";import{_ as a}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{Z as l,r as n,o as s,c as d,w as i,g as r,aa as c,h as o,B as u,ah as p,ai as m,J as k,b as g,e as h,f as x,a5 as v}from"./index-B3PZsRwT.js";import{_ as y}from"./index-Cn-BWYp5.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import"./api-By23aosn.js";import"./index-BThgVJ70.js";import"./fromPairs-BI-MgVCs.js";const f=k({__name:"list",props:{testStandId:{type:String,default:null}},setup(e){const t=e,a=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,fixed:"left",align:"center",checked:!0,ellipsis:!0},{key:"prodNo",dataIndex:"prodNo",title:"生产型号",align:"center",checked:!0,ellipsis:!0,width:150},{key:"createTime",dataIndex:"createTime",title:"领取日期",align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c(e.createTime).format("YYYY-MM-DD HH:mm:ss")},{key:"receive",dataIndex:"receive",title:"领取人",align:"center",checked:!0,ellipsis:!0},{key:"remark",dataIndex:"remark",title:"备注",align:"center",checked:!0,ellipsis:!0},{key:"table-cz",dataIndex:"table-cz",title:"操作",align:"center",checked:!0,ellipsis:!0,width:100,customRender:({record:e})=>r(u,{type:"link",danger:!0,class:"pl-3px pr-3px",onClick:()=>{b(e,1)}},{default:()=>[o("删除")]})}],k=n([]),g=n(!1);function h(){var e;g.value=!0,(e={testStandId:t.testStandId},l({url:"/qms/agv/frock/testStand/record/list",method:"get",params:e})).then((({data:e,error:t})=>{t||(e.forEach(((e,t)=>{e.dataIndex=t+1})),k.value=e)})).finally((()=>g.value=!1))}h();const x=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,fixed:"left",align:"center",checked:!0,ellipsis:!0},{key:"lotNo",dataIndex:"lotNo",title:"LOT号",align:"center",checked:!0,ellipsis:!0,width:150},{key:"prodNo",dataIndex:"prodNo",title:"生产型号",align:"center",checked:!0,ellipsis:!0,width:150},{key:"testStandProdNo",dataIndex:"testStandProdNo",title:"测试架编号",align:"center",checked:!0,ellipsis:!0,width:180},{key:"testNum",dataIndex:"testNum",title:"使用次数",align:"center",checked:!0,ellipsis:!0},{key:"testInitTotal",dataIndex:"testInitTotal",title:"初始次数",align:"center",checked:!0,ellipsis:!0},{key:"createTime",dataIndex:"createTime",title:"录入时间",align:"center",checked:!0,ellipsis:!0,width:180},{key:"operator",dataIndex:"operator",title:"录入人",align:"center",checked:!0,ellipsis:!0},{key:"remark",dataIndex:"remark",title:"备注",align:"center",checked:!0,ellipsis:!0},{key:"table-cz",dataIndex:"table-cz",title:"操作",align:"center",checked:!0,ellipsis:!0,width:100,customRender:({record:e})=>r(u,{type:"link",danger:!0,class:"pl-3px pr-3px",onClick:()=>{b(e,2)}},{default:()=>[o("删除")]})}],v=n(!1),f=n([]);var I;function b(e,t){window.$modal.confirm({title:"确定删除?",onOk:()=>{let a;var n;1===t?(n=e.testStandReceiveUuid,a=l({url:"/qms/agv/frock/testStand/record/delete/".concat(n),method:"delete"})):a=function(e){return l({url:"/qms/agv/frock/testStand/use/delete/".concat(e),method:"delete"})}(e.testStandUseUuid),a.then((({error:e})=>{e||(window.$message.success("删除成功"),h())}))},onCancel:()=>{}})}v.value=!1,(I={testStandId:t.testStandId},l({url:"/qms/agv/frock/testStand/use/list",method:"get",params:I})).then((({data:e,error:t})=>{t||(e.forEach(((e,t)=>{e.dataIndex=t+1})),f.value=e)})).finally((()=>v.value=!1));const _=n("1");return(e,t)=>{const l=y,n=p,c=m;return s(),d(c,{activeKey:_.value,"onUpdate:activeKey":t[0]||(t[0]=e=>_.value=e),class:"test-rack-management-list-tabs h-full w-full"},{default:i((()=>[r(n,{key:"1",tab:"领取记录"},{default:i((()=>[r(l,{columns:a,"data-source":k.value,"row-key":"testStandReceiveUuid",scroll:{y:"auto"},loading:g.value,pagination:!1,class:"h-full",bordered:"",size:"small"},null,8,["data-source","loading"])])),_:1}),r(n,{key:"2",tab:"使用记录","force-render":""},{default:i((()=>[r(l,{columns:x,"data-source":f.value,"row-key":"testStandUseUuid",scroll:{y:"auto"},loading:v.value,pagination:!1,class:"h-full",bordered:"",size:"small"},null,8,["data-source","loading"])])),_:1})])),_:1},8,["activeKey"])}}},[["__scopeId","data-v-67e73689"]]),I={class:"mold-management-page min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},b=Object.assign({name:"workwear_test-rack-management"},{__name:"index",setup(l){const d=n(null),c=n(null),o=n({prodNo:null,time:null}),u=[{type:"input",key:"prodNo",label:"生产型号",placeholder:"请输入生产型号",span:24,md:12,lg:8,xl:8,xxl:6},{type:"dateRangePicker",key:"time",label:"日期",span:24,md:12,lg:10,xl:8,xxl:6}],p=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"prodNo",dataIndex:"prodNo",title:"生产型号",align:"center",checked:!0,ellipsis:!0,width:180,customRender:({record:e})=>r("a",{class:"color-blue",onClick:()=>{return t=e,w.value=t.testStandId,void(S.value=!0);var t}},[e.prodNo])},{key:"type",dataIndex:"type",title:"测试架类型",align:"center",checked:!0,ellipsis:!0},{key:"testStandId",dataIndex:"testStandId",title:"测试架编码",align:"center",checked:!0,ellipsis:!0},{key:"stateStr",dataIndex:"stateStr",title:"状态",align:"center",checked:!0,ellipsis:!0},{key:"totalCount",dataIndex:"totalCount",title:"总使用次数",align:"center",checked:!0,ellipsis:!0},{key:"location",dataIndex:"location",title:"存放位置",align:"center",checked:!0,ellipsis:!0},{key:"createBy",dataIndex:"createBy",title:"申请人",align:"center",checked:!0,ellipsis:!0},{key:"createDate",dataIndex:"createDate",title:"申请日期",align:"center",checked:!0,ellipsis:!0}],m=g((()=>{var e;const t={...o.value};return(null==(e=o.value)?void 0:e[0])&&(t.startTime=dayjs(o.value.time[0]).format("YYYY-MM-DD"),t.endTime=dayjs(o.value.time[1]).format("YYYY-MM-DD")),delete t.time,t}));function k(){c.value.getData(1)}function y(){v((()=>{o.value={keywords:null,noticeState:null},k()}))}function b(e){return e.totalCount>2e5?{backgroundColor:"rgb(155, 240, 217)"}:e.totalCount>19e4&&e.totalCount<195e3?{backgroundColor:"rgb(239, 239, 136)"}:e.totalCount>195e3&&e.totalCount<2e5?{backgroundColor:"rgb(247, 109, 109)"}:{}}const _=e=>({style:b(e)}),w=n(null),S=n(!1);function C(){S.value=!1}return(l,n)=>(s(),h("div",I,[r(t,{ref_key:"commonSearchRef",ref:d,searchParams:o.value,"onUpdate:searchParams":n[0]||(n[0]=e=>o.value=e),"form-list":u,"is-search":!0,onSearch:k,onReset:y},null,8,["searchParams"]),r(e,{ref_key:"tableRef",ref:c,searchParams:m.value,"onUpdate:searchParams":n[1]||(n[1]=e=>m.value=e),column:p,"show-row-selection":!1,"page-size":200,"row-key":"testStandId",class:"mold-management-table",scroll:{y:"auto"},"is-init-get-data":"","table-custom-row":_,url:"/qms/agv/frock/testStand/list"},{footer:i((()=>n[3]||(n[3]=[x("div",{class:"titClass w-full flex gap-15px"},[x("div",{class:"flex items-center"},[x("span",null,"背景色为"),x("span",{class:"bg-1 ml-3px mr-3px inline-block h20px w20px",style:{"background-color":"rgb(155, 240, 217)"}}),x("span",null,"是总使用次数大于200000次")]),x("div",{class:"flex items-center"},[x("span",null,"背景色为"),x("span",{class:"bg-2 ml-3px mr-3px inline-block h20px w20px",style:{"background-color":"rgb(239, 239, 136)"}}),x("span",null,"是总使用次数:190001-195000次")]),x("div",{class:"flex items-center"},[x("span",null,"背景色为"),x("span",{class:"bg-3 ml-3px mr-3px inline-block h20px w20px",style:{"background-color":"rgb(247, 109, 109)"}}),x("span",null,"是总使用次数195001-200000次")])],-1)]))),_:1},8,["searchParams"]),r(a,{visible:S.value,"onUpdate:visible":n[2]||(n[2]=e=>S.value=e),title:"记录",width:"80vw",height:"70vh",centered:!0,"destroy-on-close":!0,onClose:C},{footer:i((()=>n[4]||(n[4]=[x("div",null,null,-1)]))),default:i((()=>[r(f,{"test-stand-id":w.value},null,8,["test-stand-id"])])),_:1},8,["visible"])]))}});export{b as default};
