!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?t(Object(l),!0).forEach((function(t){r(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):t(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}function r(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var l=r.call(t,n||"default");if("object"!=e(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function l(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */l=function(){return n};var t,n={},r=Object.prototype,a=r.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",i=u.asyncIterator||"@@asyncIterator",s=u.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(t){f=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var l=t&&t.prototype instanceof b?t:b,a=Object.create(l.prototype),u=new I(r||[]);return o(a,"_invoke",{value:K(e,n,u)}),a}function v(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=d;var p="suspendedStart",h="suspendedYield",m="executing",y="completed",g={};function b(){}function x(){}function w(){}var k={};f(k,c,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&a.call(S,c)&&(k=S);var C=w.prototype=b.prototype=Object.create(k);function N(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function j(t,n){function r(l,o,u,c){var i=v(t[l],t,o);if("throw"!==i.type){var s=i.arg,f=s.value;return f&&"object"==e(f)&&a.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,u,c)}),(function(e){r("throw",e,u,c)})):n.resolve(f).then((function(e){s.value=e,u(s)}),(function(e){return r("throw",e,u,c)}))}c(i.arg)}var l;o(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,l){r(e,t,n,l)}))}return l=l?l.then(a,a):a()}})}function K(e,n,r){var l=p;return function(a,o){if(l===m)throw Error("Generator is already running");if(l===y){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var u=r.delegate;if(u){var c=O(u,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(l===p)throw l=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);l=m;var i=v(e,n,r);if("normal"===i.type){if(l=r.done?y:h,i.arg===g)continue;return{value:i.arg,done:r.done}}"throw"===i.type&&(l=y,r.method="throw",r.arg=i.arg)}}}function O(e,n){var r=n.method,l=e.iterator[r];if(l===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=v(l,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(n){if(n||""===n){var r=n[c];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var l=-1,o=function e(){for(;++l<n.length;)if(a.call(n,l))return e.value=n[l],e.done=!1,e;return e.value=t,e.done=!0,e};return o.next=o}}throw new TypeError(e(n)+" is not iterable")}return x.prototype=w,o(C,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:x,configurable:!0}),x.displayName=f(w,s,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,s,"GeneratorFunction")),e.prototype=Object.create(C),e},n.awrap=function(e){return{__await:e}},N(j.prototype),f(j.prototype,i,(function(){return this})),n.AsyncIterator=j,n.async=function(e,t,r,l,a){void 0===a&&(a=Promise);var o=new j(d(e,t,r,l),a);return n.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},N(C),f(C,s,"Generator"),f(C,c,(function(){return this})),f(C,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=P,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,l){return u.type="throw",u.arg=e,n.next=r,l&&(n.method="next",n.arg=t),!!l}for(var l=this.tryEntries.length-1;l>=0;--l){var o=this.tryEntries[l],u=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),i=a.call(o,"finallyLoc");if(c&&i){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!i)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var l=r;break}}l&&("break"===e||"continue"===e)&&l.tryLoc<=t&&t<=l.finallyLoc&&(l=null);var o=l?l.completion:{};return o.type=e,o.arg=t,l?(this.method="next",this.next=l.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var l=r.arg;L(n)}return l}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:P(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},n}function a(e,t,n,r,l,a,o){try{var u=e[a](o),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,l)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,l){var o=e.apply(t,n);function u(e){a(o,r,l,u,c,"next",e)}function c(e){a(o,r,l,u,c,"throw",e)}u(void 0)}))}}System.register(["./table-column-setting.vue_vue_type_script_setup_true_lang-legacy-zNkjfv7c.js","./round-download-legacy-CSJIDl7v.js","./round-delete-legacy-cw3w4Lda.js","./round-add-legacy-B2OcZRb8.js","./index-legacy-BH1Y34Mi.js","./system-manage-legacy-CjyLuZ_G.js","./modal.vue_vue_type_style_index_0_lang-legacy-DP5xhvDE.js","./index-legacy-JzSJVdOM.js","./index-legacy-CvPLLo6w.js","./use-form-common-props-legacy-CusgLcjV.js","./fromPairs-legacy-A8Lh0tdr.js"],(function(e,t){"use strict";var r,a,u,c,i,s,f,d,v,p,h,m,y,g,b,x,w,k,_,S,C,N,j,K,O,E,L,I,P,R,z,T,U,F,D,$,M,G,A,Y,B,q,H,Q,J,V,W,X,Z,ee,te,ne,re,le,ae,oe,ue,ce,ie,se,fe,de,ve;return{setters:[function(e){r=e._},function(e){a=e._},function(e){u=e._},function(e){c=e._},function(e){i=e.d,s=e.K,f=e.L,d=e.o,v=e.c,p=e.w,h=e.g,m=e.f,y=e.s,g=e.h,b=e.t,x=e.I,w=e.v,k=e.N,_=e.ad,S=e.ae,C=e.M,N=e.O,j=e.B,K=e.P,O=e.Q,E=e.F,L=e.e,I=e.bL,P=e.q,R=e.n,z=e.r,T=e.i,U=e.a5,F=e.aV,D=e.ds,$=e.cn,M=e.de,G=e.a$,A=e.d6,Y=e.a0,B=e.aj,q=e.al,H=e.a6,Q=e.a,J=e.p,V=e.dI,W=e.db,X=e.b1,Z=e.S},function(e){ee=e.x,te=e.y,ne=e.z,re=e.A,le=e.B,ae=e.C,oe=e.D,ue=e.E,ce=e.F,ie=e.G,se=e.H},function(e){fe=e._},function(e){de=e.C},function(e){ve=e.E},null,null],execute:function(){var t=document.createElement("style");t.textContent=".menu-tree .el-checkbox__input.is-checked .el-checkbox__inner,.menu-tree .el-checkbox__input.is-indeterminate .el-checkbox__inner{background-color:#646cff;border-color:#646cff}.menu-tree .el-checkbox__inner{width:16px;height:16px;text-align:center}\n",document.head.appendChild(t);var pe={class:"w-full flex"},he={class:"flex"},me={class:"w-full flex-y-center justify-end gap-12px"},ye={class:"ml-3px"},ge={class:"ml-3px"},be=i({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:s(["search"],["update:model"]),setup:function(e,t){var n=t.emit,r=f(e,"model");function l(){n("search",r.value)}function a(){r.value={menuName:null,status:null,roleKey:null,time:null},n("search",r.value)}return function(e,t){var n=x,o=w,u=k,c=_,i=S,s=C,f=N,L=j,I=K,P=O,R=E,z=de;return d(),v(z,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:p((function(){return[h(R,{ref:"formRef",model:r.value,"label-col":{span:5,md:7},class:"search-form"},{default:p((function(){return[m("div",pe,[h(P,{gutter:[15,8],wrap:"",class:"w-full"},{default:p((function(){return[h(u,{span:24,md:12,lg:6,xl:6,xxl:4},{default:p((function(){return[h(o,{label:"角色名称",name:"roleName",class:"m-0","label-col":{}},{default:p((function(){return[h(n,{value:r.value.roleName,"onUpdate:value":t[0]||(t[0]=function(e){return r.value.roleName=e}),placeholder:"请输入角色名称",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:y(l,["enter"])},null,8,["value"])]})),_:1})]})),_:1}),h(u,{span:24,md:12,lg:6,xl:6,xxl:4},{default:p((function(){return[h(o,{label:"权限字符",name:"roleKey",class:"m-0","label-col":{}},{default:p((function(){return[h(n,{value:r.value.roleKey,"onUpdate:value":t[1]||(t[1]=function(e){return r.value.roleKey=e}),placeholder:"请输入权限字符",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:y(l,["enter"])},null,8,["value"])]})),_:1})]})),_:1}),h(u,{span:24,md:12,lg:6,xl:6,xxl:4},{default:p((function(){return[h(o,{label:"状态",name:"status",class:"m-0","label-col":{}},{default:p((function(){return[h(i,{value:r.value.status,"onUpdate:value":t[2]||(t[2]=function(e){return r.value.status=e}),placeholder:"请选择状态",class:"min-form-control"},{default:p((function(){return[h(c,{value:"0"},{default:p((function(){return t[4]||(t[4]=[g("正常")])})),_:1}),h(c,{value:"1"},{default:p((function(){return t[5]||(t[5]=[g("异常")])})),_:1})]})),_:1},8,["value"])]})),_:1})]})),_:1}),h(u,{span:24,md:12,lg:6,xl:6,xxl:6},{default:p((function(){return[h(o,{label:"创建时间",name:"time",class:"m-0","label-col":{}},{default:p((function(){return[h(s,{value:r.value.time,"onUpdate:value":t[3]||(t[3]=function(e){return r.value.time=e}),class:"min-form-control","value-format":"YYYY-MM-DD"},null,8,["value"])]})),_:1})]})),_:1}),m("div",he,[h(o,{class:"m-0"},{default:p((function(){return[m("div",me,[h(L,{type:"primary",ghost:"",class:"mini-btn",onClick:l},{icon:p((function(){return[h(f,{class:"align-sub text-icon"})]})),default:p((function(){return[m("span",ye,b(e.$t("common.search")),1)]})),_:1}),h(L,{class:"mini-btn",onClick:a},{icon:p((function(){return[h(I,{class:"align-sub text-icon"})]})),default:p((function(){return[m("span",ge,b(e.$t("common.reset")),1)]})),_:1})])]})),_:1})])]})),_:1})])]})),_:1},8,["model"])]})),_:1})}}}),xe={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};var we={name:"ic-round-help",render:function(e,t){return d(),L("svg",xe,t[0]||(t[0]=[m("path",{fill:"currentColor",d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75l-.9.92c-.5.51-.86.97-1.04 1.69c-.08.32-.13.68-.13 1.14h-2v-.5a3.997 3.997 0 0 1 1.17-2.83l1.24-1.26c.46-.44.68-1.1.55-1.8a1.99 1.99 0 0 0-1.39-1.53c-1.11-.31-2.14.32-2.47 1.27c-.12.37-.43.65-.82.65h-.3C8.4 9 8 8.44 8.16 7.88a4.008 4.008 0 0 1 3.23-2.83c1.52-.24 2.97.55 3.87 1.8c1.18 1.63.83 3.38-.19 4.4"},null,-1)]))}},ke={class:"tree mt-8px max-h-200px w-full overflow-auto border-b-black"},_e=i({__name:"add-role-form",props:{operateType:{},rowData:{}},setup:function(e,t){var n=t.expose,r=I("refreshList"),a=e,u=P().createRequiredRule,c={roleName:u("角色名称不能为空"),roleKey:u("权限字符不能为空"),roleSort:u("角色顺序不能为空")},i=R(),s=i.formRef,f=(i.validate,i.resetFields),y=z({roleName:null,roleKey:null,roleSort:null,status:"0",remark:null,menuCheckStrictly:!0});var b=z(!1),_=z(!1),S=z([]),C=z(null),N={children:"children",label:"label"};function j(){return(j=o(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee();case 2:t=e.sent,n=t.data,t.error||(S.value=n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var K=z(null);return n({getMenuTree:function(){return j.apply(this,arguments)},resetForm:function(){f(),C.value.setCheckedNodes([])},submitForm:function(){var e,t,n,l=y.value,o=l.roleName,u=l.roleKey,c=l.roleSort,i=l.status,s=l.remark,f={roleName:o,roleKey:u,roleSort:c,status:i,menuIds:(e=C.value.getCheckedKeys(),t=C.value.getHalfCheckedKeys(),e.unshift.apply(e,t),e),deptIds:[],menuCheckStrictly:!0,deptCheckStrictly:!0,remark:s};"add"==a.operateType?n=te(f):(f.roleId=K.value.roleId,n=ne(f)),n.then((function(e){var t,n;e.data;e.error?null===(t=window.$message)||void 0===t||t.error("操作失败"):(null===(n=window.$message)||void 0===n||n.success("操作成功"),r(!0,1))}))},getEditData:function(e){K.value=e,re(e.roleId).then((function(t){var n=t.data,r=(t.error,n.roleName),l=n.roleKey,a=n.roleSort,o=n.status,u=n.remark,c=n.menuCheckStrictly;y.value={roleName:r,roleKey:l,roleSort:a,status:o,remark:u,menuCheckStrictly:c},le(e.roleId).then((function(e){var t=e.data;e.error;t.checkedKeys.forEach((function(e){U((function(){C.value.setChecked(e,!0,!1)}))}))}))}))}}),function(e,t){var n=x,r=w,l=k,a=we,o=F,u=D,i=$,f=M,j=G,K=A,L=O,I=E;return d(),v(I,{ref_key:"formRef",ref:s,model:y.value,rules:c,"label-col":{lg:8,xs:4},"label-wrap":""},{default:p((function(){return[h(L,{gutter:20},{default:p((function(){return[h(l,{lg:12,xs:24},{default:p((function(){return[h(r,{name:"roleName",label:"角色名称","label-col":{}},{default:p((function(){return[h(n,{value:y.value.roleName,"onUpdate:value":t[0]||(t[0]=function(e){return y.value.roleName=e}),placeholder:"请输入角色名称",autocomplete:"off"},null,8,["value"])]})),_:1})]})),_:1}),h(l,{lg:12,xs:24},{default:p((function(){return[h(r,{name:"roleKey","label-col":{}},{label:p((function(){return[h(o,null,{title:p((function(){return t[9]||(t[9]=[g("控制器中定义的权限字符，如：@PreAuthorize(`@ss.hasRole('admin')`)")])})),default:p((function(){return[h(a,{class:"align-sub text-icon"})]})),_:1}),t[10]||(t[10]=g(" 权限字符 "))]})),default:p((function(){return[h(n,{value:y.value.roleKey,"onUpdate:value":t[1]||(t[1]=function(e){return y.value.roleKey=e}),placeholder:"请输入角色名称",autocomplete:"off"},null,8,["value"])]})),_:1})]})),_:1}),h(l,{lg:12,xs:24},{default:p((function(){return[h(r,{name:"roleSort",label:"角色顺序","label-col":{}},{default:p((function(){return[h(u,{value:y.value.roleSort,"onUpdate:value":t[2]||(t[2]=function(e){return y.value.roleSort=e}),placeholder:"请输入角色顺序",class:"w-full",autocomplete:"off"},null,8,["value"])]})),_:1})]})),_:1}),h(l,{lg:12,xs:24},{default:p((function(){return[h(r,{name:"status",label:"状态","label-col":{}},{default:p((function(){return[h(f,{value:y.value.status,"onUpdate:value":t[3]||(t[3]=function(e){return y.value.status=e})},{default:p((function(){return[h(i,{value:"0"},{default:p((function(){return t[11]||(t[11]=[g("正常")])})),_:1}),h(i,{value:"1"},{default:p((function(){return t[12]||(t[12]=[g("停用")])})),_:1})]})),_:1},8,["value"])]})),_:1})]})),_:1}),h(l,{lg:12,xs:24},{default:p((function(){return[t[15]||(t[15]=m("div",{class:"lable w-full font-size-14px"},"菜单权限:",-1)),h(j,{checked:b.value,"onUpdate:checked":t[4]||(t[4]=function(e){return b.value=e}),class:"mt-5px",onChange:t[5]||(t[5]=function(e){return function(e){for(var t=0;t<S.value.length;t++)C.value.store.nodesMap[S.value[t].id].expanded=e.target.checked}(e)})},{default:p((function(){return t[13]||(t[13]=[g(" 展开/折叠 ")])})),_:1},8,["checked"]),h(j,{checked:_.value,"onUpdate:checked":t[6]||(t[6]=function(e){return _.value=e}),onChange:t[7]||(t[7]=function(e){return t=e,void C.value.setCheckedNodes(t.target.checked?S.value:[]);var t})},{default:p((function(){return t[14]||(t[14]=[g("全选/全不选")])})),_:1},8,["checked"]),m("div",ke,[h(T(ve),{ref_key:"menuRef",ref:C,class:"menu-tree","check-strictly":y.value.deptCheckStrictly,data:S.value,"show-checkbox":"","node-key":"id","empty-text":"加载中，请稍候",props:N},null,8,["check-strictly","data"])])]})),_:1}),h(l,{lg:12,xs:24}),h(l,{lg:24,xs:24,class:"mt-15px"},{default:p((function(){return[h(r,{name:"remark",label:"备注","label-col":{}},{default:p((function(){return[h(K,{value:y.value.remark,"onUpdate:value":t[8]||(t[8]=function(e){return y.value.remark=e}),placeholder:"请输入备注",rows:4,autocomplete:"off"},null,8,["value"])]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["model"])}}}),Se={class:"tree mt-8px max-h-200px w-full overflow-auto border-b-black"},Ce=i({__name:"data-permission-form",props:{rowData:{}},setup:function(e,t){var r=t.expose,l=I("refreshList"),a=e,o=P().createRequiredRule,u={roleName:o("角色名称不能为空"),roleKey:o("权限字符不能为空")},c=R(),i=c.formRef,s=(c.validate,c.resetFields),f=z({roleName:null,roleKey:null,dataScope:"1"});var y=z([{value:"1",label:"全部数据权限"},{value:"2",label:"自定数据权限"},{value:"3",label:"本部门数据权限"},{value:"4",label:"本部门及以下数据权限"},{value:"5",label:"仅本人数据权限"}]),C=z(null),N=z(!1),j=z(!1),K=z([]),F={children:"children",label:"label"};function D(){var e,t;(null===(e=C.value)||void 0===e?void 0:e.setCheckedNodes)&&(null===(t=C.value)||void 0===t||t.setCheckedNodes([]))}return Y((function(){return a.rowData}),(function(e){e&&(f.value={roleName:e.roleName,roleKey:e.roleKey,dataScope:e.dataScope},ae(a.rowData.roleId).then((function(e){var t=e.data;e.error||(K.value=t.depts,t.checkedKeys.forEach((function(e){U((function(){C.value.setChecked(e,!0,!1)}))})))})))}),{immediate:!0,deep:!0}),r({resetForm:function(){s()},submitForm:function(){var e,t,r=[];2==f.value.dataScope&&(e=C.value.getCheckedKeys(),t=C.value.getHalfCheckedKeys(),e.unshift.apply(e,t),r=e);var o=n(n(n({},a.rowData),f.value),{},{menuCheckStrictly:!0,deptCheckStrictly:!0,deptIds:r});oe(o).then((function(e){var t;e.data;e.error||(null===(t=window.$message)||void 0===t||t.success("操作成功"),l(!0,2))}))},handleDataScopeChange:D}),function(e,t){var n=x,r=w,l=k,a=_,o=S,c=G,s=O,I=E;return d(),v(I,{ref_key:"formRef",ref:i,model:f.value,rules:u,"label-col":{lg:8,xs:4},"label-wrap":""},{default:p((function(){return[h(s,{gutter:20},{default:p((function(){return[h(l,{lg:24,xs:24},{default:p((function(){return[h(r,{name:"roleName",label:"角色名称","label-col":{}},{default:p((function(){return[h(n,{value:f.value.roleName,"onUpdate:value":t[0]||(t[0]=function(e){return f.value.roleName=e}),placeholder:"请输入角色名称",autocomplete:"off",disabled:""},null,8,["value"])]})),_:1})]})),_:1}),h(l,{lg:24,xs:24},{default:p((function(){return[h(r,{name:"roleKey","label-col":{}},{label:p((function(){return t[7]||(t[7]=[g("权限字符")])})),default:p((function(){return[h(n,{value:f.value.roleKey,"onUpdate:value":t[1]||(t[1]=function(e){return f.value.roleKey=e}),placeholder:"请输入角色名称",autocomplete:"off",disabled:""},null,8,["value"])]})),_:1})]})),_:1}),h(l,{lg:24,xs:24},{default:p((function(){return[h(r,{name:"dataScope",label:"权限范围","label-col":{}},{default:p((function(){return[h(o,{value:f.value.dataScope,"onUpdate:value":t[2]||(t[2]=function(e){return f.value.dataScope=e}),placeholder:"请输入权限范围",onChange:D},{default:p((function(){return[(d(!0),L(B,null,q(y.value,(function(e){return d(),v(a,{key:e.value,value:e.value},{default:p((function(){return[g(b(e.label),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["value"])]})),_:1})]})),_:1}),2==f.value.dataScope?(d(),v(l,{key:0,lg:24,xs:24},{default:p((function(){return[t[10]||(t[10]=m("div",{class:"lable w-full font-size-14px"},"数据权限:",-1)),h(c,{checked:N.value,"onUpdate:checked":t[3]||(t[3]=function(e){return N.value=e}),class:"mt-5px",onChange:t[4]||(t[4]=function(e){return function(e){for(var t=0;t<K.value.length;t++)C.value.store.nodesMap[K.value[t].id].expanded=e.target.checked}(e)})},{default:p((function(){return t[8]||(t[8]=[g(" 展开/折叠 ")])})),_:1},8,["checked"]),h(c,{checked:j.value,"onUpdate:checked":t[5]||(t[5]=function(e){return j.value=e}),onChange:t[6]||(t[6]=function(e){return t=e,void C.value.setCheckedNodes(t.target.checked?K.value:[]);var t})},{default:p((function(){return t[9]||(t[9]=[g("全选/全不选")])})),_:1},8,["checked"]),m("div",Se,[h(T(ve),{ref_key:"treeRef",ref:C,class:"menu-tree","check-strictly":f.value.deptCheckStrictly,data:K.value,"show-checkbox":"","default-expand-all":"","node-key":"id","empty-text":"加载中，请稍候",props:F},null,8,["check-strictly","data"])])]})),_:1})):H("",!0)]})),_:1})]})),_:1},8,["model"])}}}),Ne={class:"jl-main-page one-code-ascend min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};e("default",i(n(n({},{name:"manage_role"}),{},{__name:"index",setup:function(e){var t,n=Q().routerPushByKey,i=z({roleName:null,roleKey:null,status:null,time:null}),s=J({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:function(e){return"共".concat(e,"条")},total:0,onChange:(t=o(l().mark((function e(t,n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.current=t,s.pageSize=n,w();case 3:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}),f=z([]),v=z(!1),y=z([{key:"index",dataIndex:"index",title:"序号",width:80,align:"center",checked:!0,ellipsis:!0},{key:"roleName",dataIndex:"roleName",title:"角色名称",align:"center",checked:!0,ellipsis:!0},{key:"roleKey",dataIndex:"roleKey",title:"权限字符",align:"center",checked:!0,ellipsis:!0},{key:"roleSort",dataIndex:"roleSort",title:"显示顺序",align:"center",checked:!0,ellipsis:!0},{key:"status",dataIndex:"status",title:"状态",align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;e.index;return t.rowStatusChecked=0==t.status,h(V,{checked:t.rowStatusChecked,onChange:function(e){var n;null===(n=window.$modal)||void 0===n||n.confirm({title:'确认要"'.concat(e?"启用":"停用",'""').concat(t.roleName,'"角色吗？'),onOk:function(){var n=e?"0":"1";ue(t.roleId,n).then((function(e){var t;e.data;e.error||(null===(t=window.$message)||void 0===t||t.success("操作成功"),x())}))},onCancel:function(){}})}},null)}},{key:"createTime",dataIndex:"createTime",title:"创建时间",align:"center",checked:!0,ellipsis:!0,customRender:function(e){var t=e.record;return W(t.createTime)}},{key:"cz",dataIndex:"cz",title:"操作",align:"center",checked:!0,ellipsis:!0,width:300,fixed:"right",customRender:function(e){var t=e.record;return 1==t.roleId?"":h("div",null,[h(j,{type:"primary",ghost:!0,size:"small",class:"m-r8px",onClick:function(){return I("edit",t)}},{default:function(){return[g("编辑")]}}),h(j,{danger:!0,ghost:!0,size:"small",class:"m-r8px",onClick:function(){return T(t.roleId)}},{default:function(){return[g("删除")]}}),h(j,{type:"primary",ghost:!0,size:"small",class:"m-r8px",onClick:function(){return e=t,D.value=!0,void($.value=e);var e}},{default:function(){return[g("数据权限")]}}),h(j,{type:"primary",ghost:!0,size:"small",class:"m-r8px",onClick:function(){var e;e=t.roleId,n("manage_role-user",{params:{id:e}})}},{default:function(){return[g("分配用户")]}})])}}]);function b(){x()}function x(){s.current=1,w()}function w(){var e=i.value,t=e.time,n=e.roleKey,r=e.roleName,l=e.status,a={pageNum:s.current,pageSize:s.pageSize,roleKey:n,status:l,roleName:r};null!=t&&t[0]&&(a["params[beginTime]"]=t[0],a["params[endTime]"]=t[1]),v.value=!0,ce(a).then((function(e){var t=e.data;e.error||(t.rows.forEach((function(e,t){e.index=t+1})),s.total=(null==t?void 0:t.total)||0,f.value=t.rows)})).finally((function(){return v.value=!1}))}w();var k=z(null),_=function(e){return{style:{background:e.roleId===k.value?"#BAEAFA":""},class:e.roleId===k.value?"jl-table-row-selected":"",onClick:function(){k.value=e.roleId}}},S=z([]);function C(e){S.value=e}var N=z(!1),K=z(null),O=z("add"),E=z(null);function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;O.value=e,E.value=t,N.value=!0,U((function(){K.value.getMenuTree(),"edit"===e&&K.value.getEditData(t)}))}function P(){K.value.submitForm()}function R(){K.value.resetForm(),E.value=null,N.value=!1}function T(e){var t;null===(t=window.$modal)||void 0===t||t.confirm({title:'是否确认删除角色编号为"'.concat(e,'"的数据项?'),onOk:function(){ie(e).then((function(e){var t,n;e.data;e.error?null===(t=window.$message)||void 0===t||t.error("删除失败!"):(null===(n=window.$message)||void 0===n||n.success("删除成功!"),b())}))},onCancel:function(){}})}function F(){T(S.value.join())}X("refreshList",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;b(),e&&(1===t&&R(),2===t&&A())}));var D=z(!1),$=z(null);var M=z(null);function G(){var e;null==M||null===(e=M.value)||void 0===e||e.submitForm()}function A(){null==M||M.value.handleDataScopeChange()}function Y(){var e=i.value,t=e.time,n=e.roleKey,r=e.roleName,l=e.status,a={pageNum:s.current,pageSize:s.pageSize,roleKey:n,status:l,roleName:r};null!=t&&t[0]&&(a["params[beginTime]"]=t[0],a["params[endTime]"]=t[1]),se(a)}return function(e,t){var n=c,l=j,o=u,g=a,w=r,k=Z("STable"),z=de;return d(),L("div",Ne,[h(be,{model:i.value,"onUpdate:model":t[0]||(t[0]=function(e){return i.value=e}),onReset:b,onSearch:x},null,8,["model"]),h(z,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card flex-col-stretch sm:flex-1-hidden card-wrapper"},{title:p((function(){return[h(l,{type:"primary",ghost:"",class:"mini-btn mr-8px"},{icon:p((function(){return[h(n,{class:"align-sub text-icon"})]})),default:p((function(){return[m("span",{class:"ml-3px",onClick:t[1]||(t[1]=function(e){return I("add")})},"新增")]})),_:1}),h(l,{type:"primary",ghost:"",class:"mini-btn mr-8px",disabled:0==S.value.length},{icon:p((function(){return[h(n,{class:"align-sub text-icon"})]})),default:p((function(){return[t[5]||(t[5]=m("span",{class:"ml-3px"},"编辑",-1))]})),_:1},8,["disabled"]),h(l,{danger:"",ghost:"",class:"mini-btn mr-8px",disabled:0==S.value.length,onClick:F},{icon:p((function(){return[h(o,{class:"align-sub text-icon"})]})),default:p((function(){return[t[6]||(t[6]=m("span",{class:"ml-3px"},"删除",-1))]})),_:1},8,["disabled"]),h(l,{ghost:"",type:"primary",class:"mini-btn mr-8px",onClick:Y},{icon:p((function(){return[h(g,{class:"align-sub text-icon"})]})),default:p((function(){return[t[7]||(t[7]=m("span",{class:"ml-3px"},"导出",-1))]})),_:1})]})),extra:p((function(){return[h(w,{columns:y.value,"onUpdate:columns":t[2]||(t[2]=function(e){return y.value=e})},null,8,["columns"])]})),default:p((function(){return[h(k,{columns:y.value,"data-source":f.value,bordered:"","row-selection":{selectedRowKeys:S.value,onChange:C},size:"small",loading:v.value,"row-key":"roleId",pagination:s,"custom-row":_,scroll:{x:1680,y:"auto"},class:"h-full"},null,8,["columns","data-source","row-selection","loading","pagination"])]})),_:1}),h(fe,{visible:N.value,"onUpdate:visible":t[3]||(t[3]=function(e){return N.value=e}),title:"add"==O.value?"新增":"修改角色",height:"70vh",width:"800px","destroy-on-close":!0,onOk:P,onClose:R},{default:p((function(){return[h(_e,{ref_key:"addRoleFormRef",ref:K,"row-data":E.value,"operate-type":O.value},null,8,["row-data","operate-type"])]})),_:1},8,["visible","title"]),h(fe,{visible:D.value,"onUpdate:visible":t[4]||(t[4]=function(e){return D.value=e}),title:"分配数据权限",height:"70vh",width:"800px",onOk:G,onClose:A},{default:p((function(){return[h(Ce,{ref_key:"dataPermissionFormRef",ref:M,"row-data":$.value},null,8,["row-data"])]})),_:1},8,["visible"])])}}})))}}}))}();
