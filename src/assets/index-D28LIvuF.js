import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{Z as l,d as a,K as t,L as n,o,c as d,w as i,f as s,g as c,s as r,t as u,I as p,v as m,N as v,O as f,B as h,Q as g,F as k,r as y,a0 as I,e as x,aj as b,al as w,p as _,a7 as S,ah as N,ai as z,b1 as C,S as P,J as T}from"./index-B3PZsRwT.js";import{C as U}from"./index-BThgVJ70.js";import{_ as q}from"./index-Cn-BWYp5.js";import"./fromPairs-BI-MgVCs.js";const j={class:"w-full flex"},E={class:"flex"},R={class:"w-full flex-y-center justify-end gap-12px"},K={class:"ml-3px"},O=a({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:t(["search"],["update:model"]),setup(e,{emit:l}){const a=l,t=n(e,"model");function y(){a("search",t.value)}return(e,l)=>{const a=p,n=m,I=v,x=f,b=h,w=g,_=k;return o(),d(_,{ref:"formRef",model:t.value,"label-col":{span:5,md:7},class:"search-form"},{default:i((()=>[s("div",j,[c(w,{gutter:[15,8],wrap:"",class:"w-full"},{default:i((()=>[c(I,{span:24,md:12,lg:6,xl:6,xxl:4},{default:i((()=>[c(n,{label:"条码ID",name:"pnlId",class:"m-0","label-col":{}},{default:i((()=>[c(a,{value:t.value.pnlId,"onUpdate:value":l[0]||(l[0]=e=>t.value.pnlId=e),placeholder:"请输入条码ID",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:r(y,["enter"])},null,8,["value"])])),_:1})])),_:1}),s("div",E,[c(n,{class:"m-0"},{default:i((()=>[s("div",R,[c(b,{type:"primary",ghost:"",class:"mini-btn",onClick:y},{icon:i((()=>[c(x,{class:"align-sub text-icon"})])),default:i((()=>[s("span",K,u(e.$t("common.search")),1)])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])}}}),Q=a({__name:"batch-information",props:{lotId:{required:!0},lotIdModifiers:{}},emits:["update:lotId"],setup(e){const a=n(e,"lotId"),t=[{key:"lotId",label:"生产批号"},{key:"lotStatus",label:"批次状态"},{key:"siteId",label:"工厂代码"},{key:"pnlId",label:"工单代码"},{key:"productName",label:"产品名称"},{key:"productVer",label:"产品版本"},{key:"routeName",label:"制程名称"},{key:"routeVer",label:"制程版本"},{key:"stepName",label:"站点名称"},{key:"stepVer",label:"站点版本"},{key:"waitingMoveInQty",label:"等待移入数量"},{key:"waitingTrackInQty",label:"等待上机数量"},{key:"waitingTrackOutQty",label:"等待下机数量"},{key:"waitingMoveOutQty",label:"等待移出数量"},{key:"priority",label:"优先权"},{key:"startDate",label:"开始日期"},{key:"areaId",label:"作业区域代码"},{key:"locationId",label:"工作位置代码"},{key:"customerCode",label:"客户代码"},{key:"customerPart",label:"客户料号"},{key:"abilityId",label:"能力代码"},{key:"equipmentId",label:"设备代码"}],s=y(function(){const e={};return t.forEach((l=>{e[l.key]=null})),e}());return I((()=>a.value),(e=>{e&&function(e){return l({url:"/mes/one-code-ascend/lot-info-subitem",params:{lotId:e}})}(e).then((({data:e,error:l})=>{l||(s.value=e)}))})),(e,l)=>{const a=p,n=m,r=v,u=g,f=k;return o(),d(f,{model:s.value,"label-col":{span:5,md:7},class:"search-form"},{default:i((()=>[c(u,{gutter:[15,8],wrap:"",class:"w-full"},{default:i((()=>[(o(),x(b,null,w(t,(e=>c(r,{key:e.key,span:8,md:8,lg:8,xl:6,xxl:6},{default:i((()=>[c(n,{label:e.label,name:e.key,class:"m-0","label-col":{}},{default:i((()=>[c(a,{value:s.value[e.key],"onUpdate:value":l=>s.value[e.key]=l,placeholder:"",class:"min-form-control","allow-clear":"",autocomplete:"off",disabled:""},null,8,["value","onUpdate:value"])])),_:2},1032,["label","name"])])),_:2},1024))),64))])),_:1})])),_:1},8,["model"])}}}),D=a({__name:"PNL-history",props:{componentId:{required:!0},componentIdModifiers:{}},emits:["update:componentId"],setup(a){const t=n(a,"componentId"),s=y({pageNum:1,pageSize:200}),r=_({current:s.value.pageNum,pageSize:s.value.pageSize,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{r.current=e,r.pageSize=l,s.value.pageNum=e,s.value.pageSize=l,h()}}),u=y([]),p=y(!1),m=y([{key:"index",dataIndex:"index",title:"序号",align:"center",width:70,checked:!0,ellipsis:!0},{key:"pnlId",dataIndex:"pnlId",title:"PNL ID",align:"center",checked:!0,ellipsis:!0},{key:"actionType",dataIndex:"actionType",title:"动作类型",align:"center",watch:120,checked:!0,ellipsis:!0,customRender:({record:e})=>({TRACKIN:"上机",TRACKOUT:"下机"}[e.actionType])},{key:"equipmentName",dataIndex:"equipmentName",title:"线体名称",align:"center",checked:!0,ellipsis:!0},{key:"equipmentId",dataIndex:"equipmentId",title:"设备代码",align:"center",checked:!0,ellipsis:!0},{key:"count",dataIndex:"count",title:"次数",align:"center",watch:120,checked:!0,ellipsis:!0},{key:"createTime",dataIndex:"createTime",title:"创建时间",align:"center",watch:180,checked:!0,ellipsis:!0}]),v=y(null),f=e=>({class:e.uid===v.value?"jl-table-row-selected":"",onClick:()=>{v.value=e.uid}});function h(){const e={...s.value,componentId:t.value};p.value=!0,function(e){return l({url:"/mes/one-code-ascend/component-info-subitem/child-one",params:e})}(e).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1,e.uid=S.genV4().hexNoDelim})),r.total=e.total,u.value=e.list)})).finally((()=>p.value=!1))}return I((()=>t.value),(e=>{e&&(s.value.pageNum=1,r.current=1,h())})),(l,a)=>{const t=e,n=q,s=U;return o(),d(s,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:i((()=>[c(t,{columns:m.value,"onUpdate:columns":a[0]||(a[0]=e=>m.value=e)},null,8,["columns"])])),default:i((()=>[c(n,{ref:"tableWrapperRef",columns:m.value,"data-source":u.value,bordered:"",size:"small",loading:p.value,"row-key":"uid",pagination:r,"custom-row":f,scroll:{y:"atuo"},class:"h-full"},null,8,["columns","data-source","loading","pagination"])])),_:1})}}}),M=a({__name:"set-pcs-list",props:{componentId:{required:!0},componentIdModifiers:{}},emits:["update:componentId"],setup(a){const t=n(a,"componentId"),s=y({pageNum:1,pageSize:200}),r=_({current:s.value.pageNum,pageSize:s.value.pageSize,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{r.current=e,r.pageSize=l,s.value.pageNum=e,s.value.pageSize=l,h()}}),u=y([]),p=y(!1),m=y([{key:"index",dataIndex:"index",title:"序号",align:"center",width:70,checked:!0,ellipsis:!0},{key:"subComponentId",dataIndex:"subComponentId",title:"SET/PCS ID",align:"center",checked:!0,ellipsis:!0},{key:"unit",dataIndex:"unit",title:"片型",align:"center",checked:!0,ellipsis:!0},{key:"lotId",dataIndex:"lotId",title:"批次",align:"center",checked:!0,ellipsis:!0}]),v=y(null),f=e=>({class:e.pnlId===v.value?"jl-table-row-selected":"",onClick:()=>{v.value=e.pnlId}});function h(){const e={...s.value,componentId:t.value};p.value=!0,function(e){return l({url:"/mes/one-code-ascend/component-info-subitem/child-two",params:e})}(e).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1})),r.total=e.total,u.value=e.list)})).finally((()=>p.value=!1))}return I((()=>t.value),(e=>{e&&(s.value.pageNum=1,r.current=1,h())})),(l,a)=>{const t=e,n=q,s=U;return o(),d(s,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:i((()=>[c(t,{columns:m.value,"onUpdate:columns":a[0]||(a[0]=e=>m.value=e)},null,8,["columns"])])),default:i((()=>[c(n,{ref:"tableWrapperRef",columns:m.value,"data-source":u.value,bordered:"",size:"small",loading:p.value,"row-key":"id",pagination:r,"custom-row":f,scroll:{y:"atuo"},class:"h-full"},null,8,["columns","data-source","loading","pagination"])])),_:1})}}}),L={class:"png-box h-full flex gap-15px"},J={class:"h-full w-40%"},V={class:"h-full w-60%"},A=a({__name:"PNL-list",props:{lotId:{required:!0},lotIdModifiers:{}},emits:["update:lotId"],setup(a){const t=n(a,"lotId"),d=y({pageNum:1,pageSize:200}),r=_({current:d.value.pageNum,pageSize:d.value.pageSize,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{r.current=e,r.pageSize=l,d.value.pageNum=e,d.value.pageSize=l,h()}}),u=y([]),p=y(!1),m=y([{key:"index",dataIndex:"index",title:"序号",align:"center",width:70,checked:!0,ellipsis:!0},{key:"componentId",dataIndex:"componentId",title:"PNL ID",align:"center",checked:!0,ellipsis:!0},{key:"isEqpPrint",dataIndex:"isEqpPrint",title:"是否打印",align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>"Y"==e.isEqpPrint?"已打印":"未打印"},{key:"dateTime",dataIndex:"dateTime",title:"打印时间",align:"center",checked:!0,ellipsis:!0}]),v=y(null),f=e=>({class:e.componentId===v.value?"jl-table-row-selected":"",onClick:()=>{v.value=e.componentId}});function h(){const e={...d.value,lotId:t.value};p.value=!0,function(e){return l({url:"/mes/one-code-ascend/component-info-subitem",params:e})}(e).then((({data:e,error:l})=>{e.list.forEach(((e,l)=>{e.index=l+1})),r.total=e.total,u.value=e.list})).finally((()=>p.value=!1))}I((()=>t.value),(e=>{e&&(d.value.pageNum=1,r.current=1,h())}));const g=y("1");return(l,a)=>{const t=e,n=q,d=U,h=N,k=z;return o(),x("div",L,[s("div",J,[c(d,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:i((()=>[c(t,{columns:m.value,"onUpdate:columns":a[0]||(a[0]=e=>m.value=e)},null,8,["columns"])])),default:i((()=>[c(n,{ref:"tableWrapperRef",columns:m.value,"data-source":u.value,bordered:"",size:"small",loading:p.value,"row-key":"id",pagination:r,"custom-row":f,scroll:{x:"auto",y:"atuo"},class:"h-full"},null,8,["columns","data-source","loading","pagination"])])),_:1})]),s("div",V,[c(k,{activeKey:g.value,"onUpdate:activeKey":a[3]||(a[3]=e=>g.value=e),class:"tags h-full w-full",type:"card"},{default:i((()=>[c(h,{key:"1",tab:"PNL 历史","force-render":""},{default:i((()=>[c(D,{"component-id":v.value,"onUpdate:componentId":a[1]||(a[1]=e=>v.value=e)},null,8,["component-id"])])),_:1}),c(h,{key:"2",tab:"SET/PCS清单","force-render":""},{default:i((()=>[c(M,{"component-id":v.value,"onUpdate:componentId":a[2]||(a[2]=e=>v.value=e)},null,8,["component-id"])])),_:1})])),_:1},8,["activeKey"])])])}}}),W=a({__name:"badness-list",props:{lotId:{required:!0},lotIdModifiers:{}},emits:["update:lotId"],setup(a){const t=n(a,"lotId"),s=y({pageNum:1,pageSize:200}),r=_({current:s.value.pageNum,pageSize:s.value.pageSize,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{r.current=e,r.pageSize=l,s.value.pageNum=e,s.value.pageSize=l,h()}}),u=y([]),p=y(!1),m=y([{key:"index",dataIndex:"index",title:"序号",align:"center",width:70,checked:!0,ellipsis:!0},{key:"scrapPnlId",dataIndex:"scrapPnlId",title:"PNL ID",align:"center",width:140,checked:!0,ellipsis:!0},{key:"lotId",dataIndex:"lotId",title:"生产批号",align:"center",width:140,checked:!0,ellipsis:!0},{key:"productName",dataIndex:"productName",title:"产品名称",align:"center",checked:!0,ellipsis:!0},{key:"productVer",dataIndex:"productVer",title:"产品版本",align:"center",checked:!0,ellipsis:!0},{key:"customerPart",dataIndex:"customerPart",title:"客户",align:"center",checked:!0,ellipsis:!0},{key:"createTime",dataIndex:"createTime",title:"建立时间",align:"center",width:180,checked:!0,ellipsis:!0},{key:"componentStatus",dataIndex:"componentStatus",title:"不良状态",align:"center",width:140,checked:!0,ellipsis:!0},{key:"note",dataIndex:"note",title:"报废原因",align:"center",width:140,checked:!0,ellipsis:!0},{key:"woId",dataIndex:"woId",title:"工单",align:"center",width:140,checked:!0,ellipsis:!0}]),v=y(null),f=e=>({class:e.scrapPnlId===v.value?"jl-table-row-selected":"",onClick:()=>{v.value=e.scrapPnlId}});function h(){const e={...s.value,lotId:t.value};p.value=!0,function(e){return l({url:"/mes/one-code-ascend/scrap-record-subitem",params:e})}(e).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1})),r.total=e.total,u.value=e.list)})).finally((()=>p.value=!1))}return I((()=>t.value),(e=>{e&&(s.value.pageNum=1,r.current=1,h())})),(l,a)=>{const t=e,n=q,s=U;return o(),d(s,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:i((()=>[c(t,{columns:m.value,"onUpdate:columns":a[0]||(a[0]=e=>m.value=e)},null,8,["columns"])])),default:i((()=>[c(n,{ref:"tableWrapperRef",columns:m.value,"data-source":u.value,bordered:"",size:"small",loading:p.value,"row-key":"id",pagination:r,"custom-row":f,scroll:{y:"atuo"},class:"h-full"},null,8,["columns","data-source","loading","pagination"])])),_:1})}}}),B={class:"jl-main-page one-code-ascend min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},F={class:"top-table h-40%"},$={class:"bottom-box mt-8px h-60%"},Y=T(a({name:"trace_one-code-ascend",__name:"index",setup(a){const t=y({pnlId:null}),n=y({pageNum:1,pageSize:200}),d=y([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"lotId",dataIndex:"lotId",title:"生产批号",width:140,align:"center",checked:!0,ellipsis:!0},{key:"productName",dataIndex:"productName",title:"产品名称",width:160,align:"center",checked:!0,ellipsis:!0},{key:"lotStatus",dataIndex:"lotStatus",title:"批次状态",width:100,align:"center",checked:!0,ellipsis:!0},{key:"pnlId",dataIndex:"pnlId",title:"工单",width:100,align:"center",checked:!0,ellipsis:!0},{key:"routeName",dataIndex:"routeName",title:"制程名称",width:100,align:"center",checked:!0,ellipsis:!0},{key:"siteId",dataIndex:"siteId",title:"工厂代码",width:100,align:"center",checked:!0,ellipsis:!0},{key:"customerName",dataIndex:"customerName",title:"客户名称",width:100,align:"center",checked:!0,ellipsis:!0},{key:"customerPart",dataIndex:"customerPart",title:"客户料号",width:100,align:"center",checked:!0,ellipsis:!0},{key:"codeCount",dataIndex:"codeCount",title:"批次数量",width:100,align:"center",checked:!0,ellipsis:!0},{key:"printCount",dataIndex:"printCount",title:"打码数量",width:100,align:"center",checked:!0,ellipsis:!0}]),r=y([]),u=y(!1);y([]);const p=_({current:n.value.pageNum,pageSize:n.value.pageSize,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{p.current=e,p.pageSize=l,n.value.pageNum=e,n.value.pageSize=l,h()}}),m=y(null);C("lotId",m);const v=y(null),f=e=>({style:{background:e.lotId===v.value?"#BAEAFA":""},class:e.lotId===v.value?"jl-table-row-selected":"",onClick:()=>{v.value=e.lotId}});function h(){var e;if(!t.value.pnlId)return void(null==(e=window.$message)||e.error("条码ID不能为空"));const a={...n.value,...t.value};u.value=!0,function(e){return l({url:"/mes/one-code-ascend/lot-for-traced-id",params:e})}(a).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1})),p.total=e.total,r.value=e.list)})).finally((()=>u.value=!1))}function g(){n.value.pageNum=1,p.current=1,h()}function k(){n.value.pageNum=1,p.current=1,h()}const I=y("1");return(l,a)=>{const n=e,m=P("STable"),h=U,y=N,b=z;return o(),x("div",B,[s("div",F,[c(h,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{title:i((()=>[c(O,{model:t.value,"onUpdate:model":a[0]||(a[0]=e=>t.value=e),class:"w-full",onReset:g,onSearch:k},null,8,["model"])])),extra:i((()=>[c(n,{columns:d.value,"onUpdate:columns":a[1]||(a[1]=e=>d.value=e)},null,8,["columns"])])),default:i((()=>[c(m,{ref:"tableWrapperRef",columns:d.value,"data-source":r.value,bordered:"",size:"small",loading:u.value,"row-key":"id",pagination:p,"custom-row":f,class:"h-full","row-height":23},null,8,["columns","data-source","loading","pagination"])])),_:1})]),s("div",$,[c(h,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{default:i((()=>[c(b,{activeKey:I.value,"onUpdate:activeKey":a[5]||(a[5]=e=>I.value=e),class:"tabs h-full w-full"},{default:i((()=>[c(y,{key:"1",tab:"批次信息","force-render":""},{default:i((()=>[c(Q,{"lot-id":v.value,"onUpdate:lotId":a[2]||(a[2]=e=>v.value=e)},null,8,["lot-id"])])),_:1}),c(y,{key:"2",tab:"PNL清单","force-render":""},{default:i((()=>[c(A,{"lot-id":v.value,"onUpdate:lotId":a[3]||(a[3]=e=>v.value=e)},null,8,["lot-id"])])),_:1}),c(y,{key:"3",tab:"ipqc","force-render":""}),c(y,{key:"4",tab:"不良","force-render":""},{default:i((()=>[c(W,{"lot-id":v.value,"onUpdate:lotId":a[4]||(a[4]=e=>v.value=e)},null,8,["lot-id"])])),_:1}),c(y,{key:"5",tab:"生产记录","force-render":""}),c(y,{key:"6",tab:"制程管制","force-render":""})])),_:1},8,["activeKey"])])),_:1})])])}}}),[["__scopeId","data-v-e53facea"]]);export{Y as default};
