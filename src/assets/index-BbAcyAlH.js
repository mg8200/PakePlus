import{Z as e,ag as a,aa as t,K as l,L as i,r,a0 as s,o as n,e as d,g as c,W as o,a2 as m,f as u,w as p,a3 as h,c as y,h as f,t as v,a5 as x,B as k,cH as g,J as w}from"./index-B3PZsRwT.js";import{_ as b}from"./common-search.vue_vue_type_script_setup_true_lang-BX9APgbN.js";import{_}from"./table-DoFSI9NT.js";import{_ as I}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import"./index-C0RlPYe-.js";import{u as R}from"./echarts-B3HHInsl.js";import{L as P}from"./installCanvasRenderer-Dfk03Uyn.js";import"./index-BThgVJ70.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import"./api-By23aosn.js";const Y={__name:"charts-temperature",props:l({chartData:{type:Array,default:()=>[]}},{searchParams:{required:!0},searchParamsModifiers:{}}),emits:["update:searchParams"],setup(e){const a=e,t=i(e,"searchParams"),l=r(a.chartData),c=r({title:{text:"".concat(t.value.warehouse,"温度趋势图")},tooltip:{trigger:"axis",formatter(e){let a="时间：".concat(e[0].axisValue,"<br>");return e.forEach((e=>{"温度"===e.seriesName&&e.value&&(a+="温度: ".concat(e.value,"℃<br>"))})),a}},legend:{data:["温度","预警上限","预警下限","管控上限","管控下限"]},xAxis:{type:"category",data:["01:00","05:00","09:00","13:00","17:00","21:00"]},yAxis:[{type:"value",name:"温度(℃)",axisLabel:{formatter:"{value} °C"},min:()=>0,max:()=>{var e,a,t,i;return(null==(a=null==(e=l.value)?void 0:e[2])?void 0:a.cmaxt)?(null==(i=null==(t=l.value)?void 0:t[2])?void 0:i.cmaxt)+1:24}}],series:[{name:"温度",type:"line",stack:"Total",data:[],lineStyle:{normal:{type:"solid",color:"rgb(55,162,218)"}}},{name:"预警上限",type:"line",show:!1,data:[],lineStyle:{normal:{type:"solid",color:"#FFA500"}}},{name:"预警下限",type:"line",show:!1,data:[],lineStyle:{normal:{type:"solid",color:"#FFA500"}}},{name:"管控上限",type:"line",show:!1,data:[],lineStyle:{normal:{type:"solid",color:"red"}}},{name:"管控下限",type:"line",show:!1,data:[],lineStyle:{normal:{type:"solid",color:"red"}}}],backgroundColor:new P(0,0,0,1,[{offset:0,color:"#e0f3ff"},{offset:1,color:"#80b8ff"}])}),{domRef:o,updateOptions:m}=R((()=>c.value),!1);return s((()=>a.chartData),(e=>{l.value=e,function(e){m((a=>(a.xAxis.data=["01:00","05:00","09:00","13:00","17:00","21:00"],a.yAxis[0].max=()=>e[2].cmaxt+1,a.series[0].data=e[0],a.series[1].data=[e[2].maxt,e[2].maxt,e[2].maxt,e[2].maxt,e[2].maxt,e[2].maxt],a.series[2].data=[e[2].mint,e[2].mint,e[2].mint,e[2].mint,e[2].mint,e[2].mint],a.series[3].data=[e[2].cmaxt,e[2].cmaxt,e[2].cmaxt,e[2].cmaxt,e[2].cmaxt,e[2].cmaxt],a.series[4].data=[e[2].cmint,e[2].cmint,e[2].cmint,e[2].cmint,e[2].cmint,e[2].cmint],a)))}(e)}),{deep:!0,immediate:!0}),s((()=>t.value.warehouse),((e,a)=>{e!==a&&m((a=>(a.title.text="".concat(e,"温度趋势图"),a)))})),(e,a)=>(n(),d("div",{ref_key:"domRef",ref:o,class:"temperature-chart"},null,512))}},C={__name:"charts-humidness",props:l({chartData:{type:Array,default:()=>[]}},{searchParams:{required:!0},searchParamsModifiers:{}}),emits:["update:searchParams"],setup(e){const a=e,t=i(e,"searchParams"),l=r(a.chartData),c=r({title:{text:"".concat(t.value.warehouse,"湿度趋势图")},tooltip:{trigger:"axis",formatter(e){let a="时间：".concat(e[0].axisValue,"<br>");return e.forEach((e=>{"湿度"===e.seriesName&&e.value&&(a+="湿度: ".concat(e.value,"%<br>"))})),a}},legend:{data:["湿度","预警上限","预警下限","管控上限","管控下限"]},xAxis:{type:"category",data:["01:00","05:00","09:00","13:00","17:00","21:00"]},yAxis:[{type:"value",name:"湿度(%)",axisLabel:{formatter:"{value} %"},min:()=>0,max:()=>{var e,a,t,i;return(null==(a=null==(e=l.value)?void 0:e[2])?void 0:a.cmaxh)?(null==(i=null==(t=l.value)?void 0:t[2])?void 0:i.cmaxh)+1:24}}],series:[{name:"湿度",type:"line",stack:"Total",data:[],lineStyle:{normal:{type:"solid",color:"rgb(55,162,218)"}}},{name:"预警上限",type:"line",show:!1,data:[],lineStyle:{normal:{type:"solid",color:"#FFA500"}}},{name:"预警下限",type:"line",show:!1,data:[],lineStyle:{normal:{type:"solid",color:"#FFA500"}}},{name:"管控上限",type:"line",show:!1,data:[],lineStyle:{normal:{type:"solid",color:"red"}}},{name:"管控下限",type:"line",show:!1,data:[],lineStyle:{normal:{type:"solid",color:"red"}}}],backgroundColor:new P(0,0,0,1,[{offset:0,color:"#e0f3ff"},{offset:1,color:"#80b8ff"}])}),{domRef:o,updateOptions:m}=R((()=>c.value),!1);return s((()=>a.chartData),(e=>{l.value=e,e.length&&function(e){m((a=>(a.xAxis.data=["01:00","05:00","09:00","13:00","17:00","21:00"],a.yAxis[0].max=()=>e[2].cmaxh+1,a.series[0].data=e[1],a.series[1].data=[e[2].maxh,e[2].maxh,e[2].maxh,e[2].maxh,e[2].maxh,e[2].maxh],a.series[2].data=[e[2].minh,e[2].minh,e[2].minh,e[2].minh,e[2].minh,e[2].minh],a.series[3].data=[e[2].cmaxh,e[2].cmaxh,e[2].cmaxh,e[2].cmaxh,e[2].cmaxh,e[2].cmaxh],a.series[4].data=[e[2].cminh,e[2].cminh,e[2].cminh,e[2].cminh,e[2].cminh,e[2].cminh],a)))}(e)}),{deep:!0,immediate:!0}),s((()=>t.value.warehouse),((e,a)=>{e!==a&&m((a=>(a.title.text="".concat(e,"湿度趋势图"),a)))})),(e,a)=>(n(),d("div",{ref_key:"domRef",ref:o},null,512))}},A={class:"event-form"},q={__name:"update",props:{rowData:{type:Object,default:()=>null}},setup(e,{expose:a}){const t=e,l=[{type:"input",key:"warehouse",label:"仓库",placeholder:"请输入仓库",span:12,disabled:!0},{type:"input",key:"date",label:"日期",placeholder:"请输入日期",span:12,disabled:!0},{type:"input",key:"data1",label:"01:00温度",placeholder:"请输入01:00温度",span:12},{type:"input",key:"data2",label:"01:00湿度",placeholder:"请输入01:00湿度",span:12},{type:"input",key:"data3",label:"05:00温度",placeholder:"请输入05:00温度",span:12},{type:"input",key:"data4",label:"05:00湿度",placeholder:"请输入05:00湿度",span:12},{type:"input",key:"data5",label:"09:00温度",placeholder:"请输入09:00温度",span:12},{type:"input",key:"data6",label:"09:00湿度",placeholder:"请输入09:00湿度",span:12},{type:"input",key:"data7",label:"13:00温度",placeholder:"请输入13:00温度",span:12},{type:"input",key:"data8",label:"13:00湿度",placeholder:"请输入13:00湿度",span:12},{type:"input",key:"data9",label:"17:00温度",placeholder:"请输入17:00温度",span:12},{type:"input",key:"data10",label:"17:00湿度",placeholder:"请输入17:00湿度",span:12},{type:"input",key:"data11",label:"21:00温度",placeholder:"请输入21:00温度",span:12},{type:"input",key:"data12",label:"21:00湿度",placeholder:"请输入21:00湿度",span:12}];const i=r(null),s=r(function(){const e={};return l.forEach((a=>{a.key&&a.span&&(e[a.key]=t.rowData[a.key])})),e}());return a({model:s.value,validateForm:function(){return i.value.validateForm()}}),(e,a)=>(n(),d("div",A,[c(o,{ref_key:"formRef",ref:i,model:s.value,"onUpdate:model":a[0]||(a[0]=e=>s.value=e),"form-list":l},null,8,["model"])]))}},D={class:"stash-temperature-humidness-page h-full flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},T={class:"content"},M={class:"h-50% w-full"},S={class:"ml-15px mr15px"},j={class:"chart-box h-50% w-full flex"},F={class:"modal-footer"},H=w(Object.assign({name:"material-management_stash-temperature-humidness"},{__name:"index",setup(l){const i=r({warehouse:"冷冻仓",time:t(new Date).format("YYYY-MM")}),s=r(null),o=[{type:"select",key:"warehouse",label:"仓库",placeholder:"请选择仓库",span:24,md:12,lg:8,xl:8,xxl:6,selectOptions:[{value:"冷冻仓",label:"冷冻仓"},{value:"冷冻仓一",label:"冷冻仓一"},{value:"冷冻仓二",label:"冷冻仓二"},{value:"板料仓一",label:"板料仓一"},{value:"板料仓二",label:"板料仓二"},{value:"板料仓三",label:"板料仓三"},{value:"干膜一期",label:"干膜一期"},{value:"干膜二期",label:"干膜二期"}],change(){A()}},{type:"datePicker",key:"time",label:"年月",placeholder:"请输入年月",span:24,md:12,lg:8,xl:8,xxl:6,picker:"month",format:"YYYY-MM",valueFormat:"YYYY-MM"}],w=[{key:"date",dataIndex:"date",title:"日期",width:140,fixed:"left",align:"center",checked:!0,ellipsis:!0},{key:"tscope2",dataIndex:"tscope2",title:"温度预警范围(℃)",width:150,align:"center",checked:!0,ellipsis:!0},{key:"tscope1",dataIndex:"tscope1",title:"温度管控范围(℃)",width:150,align:"center",checked:!0,ellipsis:!0},{key:"hscope2",dataIndex:"hscope2",title:"湿度预警范围(%)",width:150,align:"center",checked:!0,ellipsis:!0},{key:"hscope1",dataIndex:"hscope1",title:"湿度管控范围(%)",width:150,align:"center",checked:!0,ellipsis:!0},{key:"index",dataIndex:"index",title:"01:00",width:150,align:"center",checked:!0,ellipsis:!0,children:[{title:"温度",dataIndex:"data1",key:"data1",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color1}},[e.data1])},{title:"湿度",dataIndex:"data2",key:"data2",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color2}},[e.data2])}]},{key:"data",dataIndex:"data",title:"05:00",width:150,align:"center",checked:!0,ellipsis:!0,children:[{title:"温度",dataIndex:"data3",key:"data3",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color3}},[e.data3])},{title:"湿度",dataIndex:"data4",key:"data4",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color4}},[e.data4])}]},{key:"data-1",dataIndex:"data-1",title:"09:00",width:150,align:"center",checked:!0,ellipsis:!0,children:[{title:"温度",dataIndex:"data5",key:"data5",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color5}},[e.data5])},{title:"湿度",dataIndex:"data6",key:"data6",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color6}},[e.data6])}]},{key:"data-2",dataIndex:"data-2",title:"13:00",width:150,align:"center",checked:!0,ellipsis:!0,children:[{title:"温度",dataIndex:"data7",key:"data7",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color7}},[e.data7])},{title:"湿度",dataIndex:"data8",key:"data8",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color8}},[e.data8])}]},{key:"data-3",dataIndex:"data-3",title:"17:00",width:150,align:"center",checked:!0,ellipsis:!0,children:[{title:"温度",dataIndex:"data9",key:"data9",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color9}},[e.data9])},{title:"湿度",dataIndex:"data10",key:"data10",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color10}},[e.data10])}]},{key:"data-4",dataIndex:"data-4",title:"21:00",width:150,align:"center",checked:!0,ellipsis:!0,children:[{title:"温度",dataIndex:"data11",key:"data11",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color11}},[e.data11])},{title:"湿度",dataIndex:"data12",key:"data12",width:75,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>c("span",{style:{color:e.color12}},[e.data12])}]},{key:"checker",dataIndex:"checker",title:"仓库点检确认人",width:170,align:"center",checked:!0,ellipsis:!0},{key:"checkTime",dataIndex:"checkTime",title:"仓库点检确认时间",width:170,align:"center",checked:!0,ellipsis:!0},{key:"equip",dataIndex:"equip",title:"设备异常确认人",width:170,align:"center",checked:!0,ellipsis:!0},{key:"equipTime",dataIndex:"equipTime",title:"设备异常确认时间",width:170,align:"center",checked:!0,ellipsis:!0},{key:"repair",dataIndex:"repair",title:"维修完成确认人",width:170,align:"center",checked:!0,ellipsis:!0},{key:"repairTime",dataIndex:"repairTime",title:"维修完成确认时间",width:180,align:"center",checked:!0,ellipsis:!0},{key:"equipConfirm",dataIndex:"equipConfirm",title:"经理确认",width:170,align:"center",checked:!0,ellipsis:!0},{key:"equipConfirmTime",dataIndex:"equipConfirmTime",title:"经理确认时间",width:180,align:"center",checked:!0,ellipsis:!0}],R=r({t:null,h:null}),P=r(null);function A(){E(),P.value.getData(1)}function H(){x((()=>{i.value={warehouse:"冷冻仓",time:t(new Date).format("YYYY-MM")},A()}))}function z(){var a;(a={warehouse:i.value.warehouse},e({url:"/qms/agv/temperatureHumidity/findTest",method:"get",params:a})).then((({data:e,error:a})=>{a||(R.value=e)}))}z();const O=r([]),U=r(!1);function E(){var a;U.value=!0,(a={warehouse:i.value.warehouse},e({url:"/qms/agv/temperatureHumidity/findTreeArr",method:"get",params:a})).then((({data:e,error:a})=>{a||(O.value=e)})).finally((()=>U.value=!1))}E();const B=r([]);function L(e){B.value=e}function $(a){if(!B.value.length)return void window.$message.error("请选择数据");B.value.forEach((e=>{e.state1=a,e.warehouse=i.value.warehouse}));window.$modal.confirm({title:"是否进行".concat({0:"仓库点检确认",1:"设备异常确认",2:"维修完成确认",3:"经理确认"}[a],"?"),onOk:()=>{var a;(a=B.value,e({url:"/qms/agv/temperatureHumidity/check",method:"post",data:a})).then((({error:e})=>{e||(window.$message.success("确定成功"),H())}))},onCancel:()=>{}})}function N(){var e;e={...i.value},a({url:"/qms/agv/temperatureHumidity/exportExcel",method:"get",params:e,fileName:"温湿度记录表导出".concat(t().format("YYYY-MM-DD HH:mm:ss"),".xlsx")})}const V=r(!1),W=r({}),J=r(!1),K=r(null);function Z(){V.value=!1}function G(){const a={...K.value},t={...W.value,...a.model};J.value=!0,function(a){return e({url:"/qms/agv/temperatureHumidity/updateByDate",method:"post",data:a})}(t).then((({error:e})=>{e||(window.$message.success("修改成功"),H(),W.value=null,Z())})).finally((()=>J.value=!1))}function Q(){W.value=B.value[0],V.value=!0}return(e,a)=>{const t=k,l=g,r=m("hasAuth"),x=m("hsAuth");return n(),d("div",D,[c(b,{ref_key:"commonSearchRef",ref:s,searchParams:i.value,"onUpdate:searchParams":a[0]||(a[0]=e=>i.value=e),"form-list":o,"is-search":!0,onSearch:A,onReset:H},null,8,["searchParams"]),u("div",T,[u("div",M,[c(_,{ref_key:"tableRef",ref:P,searchParams:i.value,"onUpdate:searchParams":a[5]||(a[5]=e=>i.value=e),"is-pagination":!1,column:w,"show-row-selection":!0,"auto-generate-uuid":!0,scroll:{y:"auto"},"is-init-get-data":"",url:"/qms/agv/temperatureHumidity/findByMonth",class:"h-full",onTableSelectChange:L},{tableTitle:p((()=>[h((n(),y(t,{type:"primary",class:"mini-btn mr-8px",size:"small",ghost:"",onClick:a[1]||(a[1]=e=>$(0))},{default:p((()=>a[9]||(a[9]=[f(" 仓库点检确认 ")]))),_:1})),[[r,["material-management:stash-temperature-humidness:stash-check-confirm"]]]),h((n(),y(t,{type:"primary",class:"mini-btn mr-8px",size:"small",ghost:"",onClick:a[2]||(a[2]=e=>$(1))},{default:p((()=>a[10]||(a[10]=[f(" 设备异常确认 ")]))),_:1})),[[r,["material-management:stash-temperature-humidness:device-exception-confirmation"]]]),h((n(),y(t,{type:"primary",class:"mini-btn mr-8px",size:"small",ghost:"",onClick:a[3]||(a[3]=e=>$(2))},{default:p((()=>a[11]||(a[11]=[f(" 维修完成确认 ")]))),_:1})),[[r,["material-management:stash-temperature-humidness:maintenance-completion-confirmation"]]]),h((n(),y(t,{type:"primary",class:"mini-btn mr-8px",size:"small",ghost:"",onClick:a[4]||(a[4]=e=>$(3))},{default:p((()=>a[12]||(a[12]=[f(" 经理确认 ")]))),_:1})),[[x,["material-management:stash-temperature-humidness:warehouse-equipment-properly-confirmed"]]]),c(t,{type:"primary",class:"mini-btn mr-8px",size:"small",ghost:"",onClick:N},{default:p((()=>a[13]||(a[13]=[f("导出")]))),_:1}),h((n(),y(t,{type:"primary",class:"mini-btn mr-8px",size:"small",ghost:"",disabled:1!==B.value.length,onClick:Q},{default:p((()=>a[14]||(a[14]=[f(" 修改温湿度 ")]))),_:1},8,["disabled"])),[[r,["material-management:stash-temperature-humidness:modify-temperature-humidity"]]]),c(t,{type:"primary",class:"mini-btn mr-8px",size:"small",ghost:"",onClick:z},{default:p((()=>a[15]||(a[15]=[f(" 当前温湿度查询 ")]))),_:1}),u("div",S,"温度:"+v(R.value.t)+"℃",1),u("div",null,"湿度:"+v(R.value.h)+"%",1)])),_:1},8,["searchParams"])]),u("div",j,[c(l,{tip:"数据加载中...",spinning:U.value},{default:p((()=>[c(Y,{searchParams:i.value,"onUpdate:searchParams":a[6]||(a[6]=e=>i.value=e),"chart-data":O.value,class:"chart h-full w-full"},null,8,["searchParams","chart-data"])])),_:1},8,["spinning"]),c(l,{tip:"数据加载中...",spinning:U.value},{default:p((()=>[c(C,{searchParams:i.value,"onUpdate:searchParams":a[7]||(a[7]=e=>i.value=e),"chart-data":O.value,class:"chart h-full w-full"},null,8,["searchParams","chart-data"])])),_:1},8,["spinning"])])]),c(I,{visible:V.value,"onUpdate:visible":a[8]||(a[8]=e=>V.value=e),title:"修改温度",width:"700px",height:"500px",centered:!0,"destroy-on-close":!0,onClose:Z},{footer:p((()=>[u("div",F,[c(t,{loading:J.value,type:"primary",onClick:G},{default:p((()=>a[16]||(a[16]=[f("修改")]))),_:1},8,["loading"]),c(t,{onClick:Z},{default:p((()=>a[17]||(a[17]=[f("关 闭")]))),_:1})])])),default:p((()=>[c(q,{ref_key:"updateRef",ref:K,"row-data":W.value},null,8,["row-data"])])),_:1},8,["visible"])])}}}),[["__scopeId","data-v-c37f9bf3"]]);export{H as default};
