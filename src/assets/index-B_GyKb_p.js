import{r as e,b as a,l,m as o,d as n,u as s,a as r,n as d,p as t,q as c,o as u,c as i,w as p,g as m,s as f,i as g,h as v,I as w,v as h,B as _,F as b,x as z,$ as C,R as x,f as P,t as y,y as k,e as R,z as U,A as L,C as M,D as N,T as S,E as $,G as q,H as j,J as B}from"./index-B3PZsRwT.js";import{S as D}from"./index-BjkQiJDd.js";import{C as E}from"./index-BThgVJ70.js";const F=n({name:"PwdLogin",__name:"pwd-login",setup(l){const o=s();r();const{formRef:n,validate:z}=d(),C=t({userName:null,password:null});e(null);const x=a((()=>{const{formRules:e,createRequiredRule:a}=c();return{userName:e.userName,password:a("请输入密码!")}})),P=e("text");function y(){P.value="password"}async function k(){await o.login(C.userName,C.password)}function R(e){e.preventDefault()}return(e,a)=>{const l=w,s=h,r=_,d=D,t=b;return u(),i(t,{ref_key:"formRef",ref:n,model:C,rules:x.value,class:"login-form",onSubmit:R},{default:p((()=>[m(s,{name:"userName",label:"账号","label-col":{span:24},"wrapper-col":{span:24}},{default:p((()=>[m(l,{value:C.userName,"onUpdate:value":a[0]||(a[0]=e=>C.userName=e),size:"large",placeholder:"请输入账号",autocomplete:"off"},null,8,["value"])])),_:1}),m(s,{name:"password",label:"密码","label-col":{span:24},"wrapper-col":{span:24}},{default:p((()=>[m(l,{value:C.password,"onUpdate:value":a[1]||(a[1]=e=>C.password=e),type:P.value,size:"large",placeholder:"请输入密码",autocomplete:"off",onFocus:y,onKeypress:f(k,["enter"])},null,8,["value","type"])])),_:1}),m(d,{direction:"vertical",size:"large",class:"w-full"},{default:p((()=>[m(r,{type:"primary",block:"",size:"large",shape:"round",loading:g(o).loginLoading,onClick:k},{default:p((()=>a[2]||(a[2]=[v(" 登 入 系 统 ")]))),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules"])}}});function G(){const{loading:n,startLoading:s,endLoading:r}=z(),{count:d,start:t,stop:c,isCounting:u}=function(n){const s=e(0),r=a((()=>Math.ceil(s.value/60))),d=a((()=>s.value>0)),{pause:t,resume:c}=l((()=>{s.value>0?s.value-=1:t()}),{immediate:!1});return o((()=>{t()})),{count:r,isCounting:d,start:function(e=n){s.value=60*e,c()},stop:function(){s.value=0,t()}}}(10);return{label:a((()=>{let e=C("page.login.codeLogin.getCode");const a=C("page.login.codeLogin.reGetCode",{time:d.value});return n.value&&(e=""),u.value&&(e=a),e})),start:t,stop:c,isCounting:u,loading:n,getCaptcha:async function(e){var a,l;(function(e){var a,l,o,n;return""===e.trim()?(null==(l=null==(a=window.$message)?void 0:a.error)||l.call(a,C("form.phone.required")),!1):!!x.test(e)||(null==(n=null==(o=window.$message)?void 0:o.error)||n.call(o,C("form.phone.invalid")),!1)})(e)&&!n.value&&(s(),await new Promise((e=>{setTimeout(e,500)})),null==(l=null==(a=window.$message)?void 0:a.success)||l.call(a,C("page.login.codeLogin.sendCodeSuccess")),t(),r())}}}const I={class:"w-full flex-y-center gap-16px"},T=n({name:"CodeLogin",__name:"code-login",setup(e){const{toggleLoginModule:l}=r(),{formRef:o,validate:n}=d(),{label:s,isCounting:f,loading:z,getCaptcha:x}=G(),k=t({phone:"",code:""}),R=a((()=>{const{formRules:e}=c();return{phone:e.phone,code:e.code}}));async function U(){var e;await n(),null==(e=window.$message)||e.success(C("page.login.common.validateSuccess"))}return(e,a)=>{const n=w,r=h,d=_,t=D,c=b;return u(),i(c,{ref_key:"formRef",ref:o,model:k,rules:R.value},{default:p((()=>[m(r,{name:"phone"},{default:p((()=>[m(n,{value:k.phone,"onUpdate:value":a[0]||(a[0]=e=>k.phone=e),size:"large",placeholder:g(C)("page.login.common.phonePlaceholder")},null,8,["value","placeholder"])])),_:1}),m(r,{name:"code"},{default:p((()=>[P("div",I,[m(n,{value:k.code,"onUpdate:value":a[1]||(a[1]=e=>k.code=e),size:"large",placeholder:g(C)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),m(d,{size:"large",disabled:g(f),loading:g(z),onClick:a[2]||(a[2]=e=>g(x)(k.phone))},{default:p((()=>[v(y(g(s)),1)])),_:1},8,["disabled","loading"])])])),_:1}),m(t,{direction:"vertical",size:"large",class:"w-full"},{default:p((()=>[m(d,{type:"primary",block:"",size:"large",shape:"round",onClick:U},{default:p((()=>[v(y(g(C)("common.confirm")),1)])),_:1}),m(d,{block:"",size:"large",shape:"round",onClick:a[3]||(a[3]=e=>g(l)("pwd-login"))},{default:p((()=>[v(y(g(C)("page.login.common.back")),1)])),_:1})])),_:1})])),_:1},8,["model","rules"])}}}),A={class:"w-full flex-y-center gap-16px"},H=n({name:"Register",__name:"register",setup(e){const{toggleLoginModule:l}=r(),{formRef:o,validate:n}=d(),{label:s,isCounting:f,loading:z,getCaptcha:x}=G(),R=t({phone:"",code:"",password:"",confirmPassword:""}),U=a((()=>{const{formRules:e,createConfirmPwdRule:a}=c();return{phone:e.phone,code:e.code,password:e.pwd,confirmPassword:a(R.password)}}));async function L(){var e;await n(),null==(e=window.$message)||e.success(C("page.login.common.validateSuccess"))}return(e,a)=>{const n=w,r=h,d=_,t=k,c=D,M=b;return u(),i(M,{ref_key:"formRef",ref:o,model:R,rules:U.value},{default:p((()=>[m(r,{name:"phone"},{default:p((()=>[m(n,{value:R.phone,"onUpdate:value":a[0]||(a[0]=e=>R.phone=e),size:"large",placeholder:g(C)("page.login.common.phonePlaceholder")},null,8,["value","placeholder"])])),_:1}),m(r,{name:"code"},{default:p((()=>[P("div",A,[m(n,{value:R.code,"onUpdate:value":a[1]||(a[1]=e=>R.code=e),size:"large",placeholder:g(C)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),m(d,{size:"large",disabled:g(f),loading:g(z),onClick:a[2]||(a[2]=e=>g(x)(R.phone))},{default:p((()=>[v(y(g(s)),1)])),_:1},8,["disabled","loading"])])])),_:1}),m(r,{name:"password"},{default:p((()=>[m(t,{value:R.password,"onUpdate:value":a[3]||(a[3]=e=>R.password=e),size:"large",placeholder:g(C)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])])),_:1}),m(r,{name:"confirmPassword"},{default:p((()=>[m(t,{value:R.confirmPassword,"onUpdate:value":a[4]||(a[4]=e=>R.confirmPassword=e),size:"large",placeholder:g(C)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])])),_:1}),m(c,{direction:"vertical",size:"large",class:"w-full"},{default:p((()=>[m(d,{type:"primary",block:"",size:"large",shape:"round",onClick:L},{default:p((()=>[v(y(g(C)("common.confirm")),1)])),_:1}),m(d,{block:"",size:"large",shape:"round",onClick:a[5]||(a[5]=e=>g(l)("pwd-login"))},{default:p((()=>[v(y(g(C)("page.login.common.back")),1)])),_:1})])),_:1})])),_:1},8,["model","rules"])}}}),J=n({name:"ResetPwd",__name:"reset-pwd",setup(e){const{toggleLoginModule:l}=r(),{formRef:o,validate:n}=d(),s=t({phone:"",code:"",password:"",confirmPassword:""}),f=a((()=>{const{formRules:e,createConfirmPwdRule:a}=c();return{phone:e.phone,password:e.pwd,confirmPassword:a(s.password)}}));async function z(){var e;await n(),null==(e=window.$message)||e.success(C("page.login.common.validateSuccess"))}return(e,a)=>{const n=w,r=h,d=k,t=_,c=D,x=b;return u(),i(x,{ref_key:"formRef",ref:o,model:s,rules:f.value},{default:p((()=>[m(r,{name:"phone"},{default:p((()=>[m(n,{value:s.phone,"onUpdate:value":a[0]||(a[0]=e=>s.phone=e),size:"large",placeholder:g(C)("page.login.common.phonePlaceholder")},null,8,["value","placeholder"])])),_:1}),m(r,{name:"code"},{default:p((()=>[m(n,{value:s.code,"onUpdate:value":a[1]||(a[1]=e=>s.code=e),size:"large",placeholder:g(C)("page.login.common.codePlaceholder")},null,8,["value","placeholder"])])),_:1}),m(r,{name:"password"},{default:p((()=>[m(d,{value:s.password,"onUpdate:value":a[2]||(a[2]=e=>s.password=e),size:"large",placeholder:g(C)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])])),_:1}),m(r,{name:"confirmPassword"},{default:p((()=>[m(d,{value:s.confirmPassword,"onUpdate:value":a[3]||(a[3]=e=>s.confirmPassword=e),size:"large",placeholder:g(C)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])])),_:1}),m(c,{direction:"vertical",size:"large",class:"w-full"},{default:p((()=>[m(t,{type:"primary",block:"",size:"large",shape:"round",onClick:z},{default:p((()=>[v(y(g(C)("common.confirm")),1)])),_:1}),m(t,{block:"",size:"large",shape:"round",onClick:a[4]||(a[4]=e=>g(l)("pwd-login"))},{default:p((()=>[v(y(g(C)("page.login.common.back")),1)])),_:1})])),_:1})])),_:1},8,["model","rules"])}}}),K=n({name:"BindWechat",__name:"bind-wechat",setup:e=>(e,a)=>(u(),R("div"))}),W={class:"relative size-full flex bg-#fff"},O={class:"h-full w-full"},Q={class:"flex-center flex-y-center"},V={class:"animation-slide-in-left pt-24px"},X=B(n({name:"login",__name:"index",props:{module:{}},setup(e){const l=e;U();const o=L(),n={"pwd-login":{label:q["pwd-login"],component:F},"code-login":{label:q["code-login"],component:T},register:{label:q.register,component:H},"reset-pwd":{label:q["reset-pwd"],component:J},"bind-wechat":{label:q["bind-wechat"],component:K}},s=a((()=>n[l.module||"pwd-login"]));return a((()=>o.darkMode?M(o.themeColor,7):o.themeColor)),a((()=>{const e=o.darkMode?.5:.2;return N("#ffffff",o.themeColor,e)})),(e,a)=>{const l=j,n=E;return u(),R("div",W,[a[1]||(a[1]=P("div",{class:"bg h-full w-65%"},null,-1)),m(n,{class:"relative z-4 h-full w-35% flex flex-center border-0"},{default:p((()=>[P("div",O,[P("header",Q,[m(l,{class:"mr-5 text-64px text-primary lt-sm:text-48px"}),a[0]||(a[0]=P("h3",{class:"text-26px text-primary font-500 lt-sm:text-22px"},"金禄 MES生产执行系统",-1))]),P("main",null,[P("div",V,[m(S,{name:g(o).page.animateMode,mode:"out-in",appear:""},{default:p((()=>[(u(),i($(s.value.component)))])),_:1},8,["name"])])])])])),_:1})])}}}),[["__scopeId","data-v-6a795a6d"]]);export{X as default};
