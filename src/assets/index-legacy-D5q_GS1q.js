!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function n(e){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?t(Object(l),!0).forEach((function(t){a(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):t(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}function a(t,n,a){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var l=a.call(t,n||"default");if("object"!=e(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t}System.register(["./round-add-legacy-B2OcZRb8.js","./index-legacy-BH1Y34Mi.js","./table-legacy-BfQK1xrs.js","./common-search.vue_vue_type_script_setup_true_lang-legacy-BetNIGyO.js","./modal.vue_vue_type_style_index_0_lang-legacy-DP5xhvDE.js","./table-column-setting.vue_vue_type_script_setup_true_lang-legacy-zNkjfv7c.js","./api-legacy-B6UkH1eb.js","./index-legacy-JzSJVdOM.js"],(function(e,t){"use strict";var a,l,r,u,i,o,c,s,d,v,f,p,m,y,g,h,b,k,w,x,_,N,j,O,S,I;return{setters:[function(e){a=e._},function(e){l=e.Z,r=e.r,u=e.o,i=e.e,o=e.g,c=e.W,s=e.a2,d=e.w,v=e.a3,f=e.c,p=e.f,m=e.h,y=e.aj,g=e.al,h=e.t,b=e.aa,k=e.B,w=e.a5,x=e.ad,_=e.ae,N=e.v,j=e.F},function(e){O=e._},function(e){S=e._},function(e){I=e._},null,null,null],execute:function(){var t={class:"event-form"},P={__name:"edit",props:{rowData:{type:Object,default:function(){return null}}},setup:function(e,n){var a=n.expose,l=e;var s=r(function(){if(l.rowData){var e=l.rowData;return{eventName:e.eventName,eventType:e.eventType,eventTypeName:e.eventTypeName,remark:e.remark}}return{eventName:null,eventType:null,eventTypeName:null,remark:null}}()),d=[{type:"tabs",name:"基本信息",span:24},{type:"input",key:"eventName",label:"事件名称",placeholder:"请输入事件名称",span:12},{type:"select",key:"eventType",label:"事件类型",placeholder:"请输入事件类型",span:12,selectOptions:[{value:1,label:"通知消息"},{value:2,label:"预警消息"},{value:3,label:"任务消息"}],change:function(){s.value.eventTypeName=this.selectOptions.find((function(e){return e.value===s.value.eventType})).label}},{type:"textarea",key:"remark",label:"备注",placeholder:"请输入备注",span:24}];return a({model:s.value}),function(e,n){return u(),i("div",t,[o(c,{model:s.value,"onUpdate:model":n[0]||(n[0]=function(e){return s.value=e}),"form-list":d},null,8,["model"])])}}},T={class:"message jl-main-page min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},C={class:"modal-footer"},D={class:"bind-modal-content"},U={class:"modal-footer"};e("default",Object.assign({name:"manage_message-manage_event-list"},{__name:"index",setup:function(e){var t=r(null),c=r(null),R=r({keywords:null}),A=[{type:"input",key:"keywords",label:"事件名称",placeholder:"请输入事件名称",span:24,md:12,lg:8,xl:8,xxl:6}],q=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,fixed:"left",align:"center",checked:!0,ellipsis:!0},{key:"eventName",dataIndex:"eventName",title:"事件名称",align:"center",checked:!0,ellipsis:!0},{key:"eventTypeName",dataIndex:"eventTypeName",title:"事件类型",align:"center",checked:!0,ellipsis:!0},{key:"eventCode",dataIndex:"eventCode",title:"事件编码",align:"center",checked:!0,ellipsis:!0,width:300},{key:"eventStatusName",dataIndex:"eventStatusName",title:"状态",align:"center",checked:!0,ellipsis:!0},{key:"remark",dataIndex:"remark",title:"备注",align:"center",checked:!0,ellipsis:!0},{key:"userName",dataIndex:"userName",title:"绑定人",align:"center",checked:!0,ellipsis:!0,width:200},{key:"createBy",dataIndex:"createBy",title:"创建人",align:"center",checked:!0,ellipsis:!0,width:180},{key:"createTime",dataIndex:"createTime",title:"创建时间",align:"center",checked:!0,ellipsis:!0,width:180,customRender:function(e){var t=e.record;return b(t.createTime).format("YYYY-MM-DD HH:mm:ss")}},{key:"czRow",dataIndex:"czRow",title:"操作",align:"center",checked:!0,ellipsis:!0,width:180,customRender:function(e){var t=e.record;return o("div",null,[v(o(k,{class:"pl-3px pr-3px",type:"link",danger:!0,onClick:function(){var e;e=t,window.$modal.confirm({title:'确定删除"'.concat(e.eventName,'"吗?'),onOk:function(){var t;(t=e.eventNoticeUuid,l({url:"/qms/agv/notice/eventnotice/delete/".concat(t),method:"delete"})).then((function(e){e.error||(window.$message.success("删除成功"),$())}))},onCancel:function(){}})}},{default:function(){return[m("删除")]}}),[[s("hasAuth"),["manage:event:del"]]]),v(o(k,{type:"link",class:"pl-3px pr-3px",onClick:function(){M(t)}},{default:function(){return[m("修改")]}}),[[s("hasAuth"),["manage:event:update"]]]),v(o(k,{type:"link",class:"pl-3px pr-3px",onClick:function(){var e;e=t,Z.value=!0,Q.value=e.eventNoticeUuid,J.value=e.userIdArr||[]}},{default:function(){return[m("绑定")]}}),[[s("hasAuth"),["manage:event:bind"]]]),v(o(k,{type:"link",class:"pl-3px pr-3px",onClick:function(){var e;e=t,window.$modal.confirm({title:"确定".concat(1===e.eventStatus?"禁用":"启用",' "').concat(e.eventName,'" 吗?'),onOk:function(){var t;(t={eventNoticeId:e.eventNoticeUuid,eventStatus:1===e.eventStatus?2:1},l({url:"/qms/agv/notice/eventnotice/changeState",method:"put",data:t})).then((function(t){t.error||(window.$message.success("".concat(1===e.eventStatus?"禁用":"启用","成功")),$())}))},onCancel:function(){}})}},{default:function(){return[{1:"禁用",2:"启用"}[t.eventStatus]]}}),[[s("hasAuth"),["manage:event:changeStatus"]]])])}}];function $(){c.value.getData(1)}function z(){w((function(){R.value={keywords:null},$()}))}var B=r(!1),Y=r(!1);var E=r(null),H=r("add");function M(e){E.value=e,B.value=!0,H.value=e?"edit":"add"}var F=r(null);function L(){B.value=!1,E.value=null}function W(){var e,t,a=n({},F.value.model);Y.value=!0,"edit"===H.value?(t=n(n({},E.value),a),e=l({url:"/qms/agv/notice/eventnotice/update",method:"put",data:t})):e=function(e){return l({url:"/qms/agv/notice/eventnotice/save",method:"post",data:e})}(n({},a)),e.then((function(e){e.error||(window.$message.success("".concat("edit"===H.value?"修改":"新增","成功")),L(),$())})).finally((function(){return Y.value=!1}))}var Z=r(!1),G=r(!1),J=r([]),K=r([]);l({url:"/system/user/list/nest",method:"get",params:{pageNum:1,pageSize:999999}}).then((function(e){var t=e.data;e.error||(K.value=t.rows)}));var Q=r(null);function V(){Z.value=!1,Q.value=null,J.value=[]}var X=function(e,t){return t.label.includes(e)};function ee(){G.value=!0,function(e){return l({url:"/qms/agv/notice/event/user/ration/save",method:"post",data:e})}({userList:J.value,eventNoticeId:Q.value}).then((function(e){e.error||(window.$message.success("绑定成功"),V(),$())})).finally((function(){return G.value=!1}))}return function(e,n){var l=a,r=k,b=x,w=_,Q=N,te=j,ne=s("hasAuth");return u(),i("div",T,[o(S,{ref_key:"commonSearchRef",ref:t,searchParams:R.value,"onUpdate:searchParams":n[0]||(n[0]=function(e){return R.value=e}),"form-list":A,"is-search":!0,onSearch:$,onReset:z},null,8,["searchParams"]),o(O,{ref_key:"tableRef",ref:c,searchParams:R.value,"onUpdate:searchParams":n[2]||(n[2]=function(e){return R.value=e}),column:q,"show-row-selection":!1,"row-key":"tableUuid",scroll:{y:"auto"},"is-init-get-data":"",url:"/qms/agv/notice/eventnotice/list","auto-generate-uuid":!0},{tableTitle:d((function(){return[v((u(),f(r,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:n[1]||(n[1]=function(e){return M(null)})},{icon:d((function(){return[o(l,{class:"align-sub text-icon"})]})),default:d((function(){return[n[6]||(n[6]=p("span",{class:"ml-3px"},"新增",-1))]})),_:1})),[[ne,["manage:event:add"]]])]})),_:1},8,["searchParams"]),o(I,{visible:B.value,"onUpdate:visible":n[3]||(n[3]=function(e){return B.value=e}),title:"".concat("add"===H.value?"新增":"修改","事件信息"),width:"700px",height:"400px",centered:!0,"destroy-on-close":!0,onClose:L},{footer:d((function(){return[p("div",C,[o(r,{type:"primary",loading:Y.value,onClick:W},{default:d((function(){return n[7]||(n[7]=[m("保 存")])})),_:1},8,["loading"]),o(r,{onClick:L},{default:d((function(){return n[8]||(n[8]=[m("关 闭")])})),_:1})])]})),default:d((function(){return[o(P,{ref_key:"editRef",ref:F,"row-data":E.value},null,8,["row-data"])]})),_:1},8,["visible","title"]),o(I,{visible:Z.value,"onUpdate:visible":n[5]||(n[5]=function(e){return Z.value=e}),title:"绑定事件信息",width:"600px",height:"200px","destroy-on-close":!0,onClose:V},{footer:d((function(){return[p("div",U,[o(r,{type:"primary",loading:G.value,onClick:ee},{default:d((function(){return n[9]||(n[9]=[m("提 交")])})),_:1},8,["loading"]),o(r,{onClick:V},{default:d((function(){return n[10]||(n[10]=[m("关 闭")])})),_:1})])]})),default:d((function(){return[p("div",D,[o(te,{model:e.model,"label-col":{lg:8,xs:4},"label-wrap":""},{default:d((function(){return[o(Q,{label:"收件人",name:"userName","label-col":{}},{default:d((function(){return[o(w,{value:J.value,"onUpdate:value":n[4]||(n[4]=function(e){return J.value=e}),placeholder:"请选择收件人","show-search":"","filter-option":X,mode:"multiple","max-tag-count":5},{default:d((function(){return[(u(!0),i(y,null,g(K.value,(function(e){return u(),f(b,{key:e.userId,label:e.nickName,value:e.userId},{default:d((function(){return[m(h(e.nickName),1)]})),_:2},1032,["label","value"])})),128))]})),_:1},8,["value"])]})),_:1})]})),_:1},8,["model"])])]})),_:1},8,["visible"])])}}}))}}}))}();
