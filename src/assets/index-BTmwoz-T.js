import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{_ as l}from"./round-delete-DScxCu5A.js";import{_ as a}from"./round-edit-DZi1TDWc.js";import{_ as t}from"./round-add-MytOGm9O.js";import{Z as s,d as n,K as o,L as u,o as r,c,w as d,g as i,f as p,s as m,h as v,t as h,I as f,v as y,N as g,ad as w,ae as b,O as x,B as _,P as k,Q as N,F as T,r as C,a0 as D,e as I,W as O,p as S,db as U,S as j}from"./index-B3PZsRwT.js";import{p as z,e as R}from"./index-DqnulfE2.js";import{_ as $}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{C as P}from"./index-BThgVJ70.js";const F={class:"w-full flex"},E={class:"flex"},L={class:"w-full flex-y-center justify-end gap-12px"},K={class:"ml-3px"},q={class:"ml-3px"},A=n({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:o(["search","reset"],["update:model"]),setup(e,{emit:l}){const a=l,t=u(e,"model");function s(){a("search",t.value)}function n(){t.value.techName=null,t.value.techNo=null,t.value.techType=null,a("reset",t.value)}return(e,l)=>{const a=f,o=y,u=g,C=w,D=b,I=x,O=_,S=k,U=N,j=T,z=P;return r(),c(z,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:d((()=>[i(j,{model:t.value,"label-col":{span:5,md:7},class:"search-form"},{default:d((()=>[p("div",F,[i(U,{gutter:[15,8],wrap:"",class:"w-full"},{default:d((()=>[i(u,{span:24,md:12,lg:6,xl:8,xxl:4},{default:d((()=>[i(o,{label:"工艺名称",name:"techName",class:"m-0","label-col":{}},{default:d((()=>[i(a,{value:t.value.techName,"onUpdate:value":l[0]||(l[0]=e=>t.value.techName=e),placeholder:"请输入工艺名称",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:m(s,["enter"])},null,8,["value"])])),_:1})])),_:1}),i(u,{span:24,md:12,lg:6,xl:8,xxl:4},{default:d((()=>[i(o,{label:"工艺编码",name:"techNo",class:"m-0","label-col":{}},{default:d((()=>[i(a,{value:t.value.techNo,"onUpdate:value":l[1]||(l[1]=e=>t.value.techNo=e),placeholder:"请输入工艺编码",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:m(s,["enter"])},null,8,["value"])])),_:1})])),_:1}),i(u,{span:24,md:12,lg:6,xl:8,xxl:4},{default:d((()=>[i(o,{label:"工艺类型",name:"techType",class:"m-0","label-col":{}},{default:d((()=>[i(D,{value:t.value.techType,"onUpdate:value":l[2]||(l[2]=e=>t.value.techType=e),placeholder:"请选择工艺类型","allow-clear":"",class:"min-form-control"},{default:d((()=>[i(C,{value:"0"},{default:d((()=>l[3]||(l[3]=[v("一般工艺")]))),_:1}),i(C,{value:"1"},{default:d((()=>l[4]||(l[4]=[v("成型工艺")]))),_:1}),i(C,{value:"2"},{default:d((()=>l[5]||(l[5]=[v("压合工艺")]))),_:1}),i(C,{value:"3"},{default:d((()=>l[6]||(l[6]=[v("包装工艺")]))),_:1}),i(C,{value:"5"},{default:d((()=>l[7]||(l[7]=[v("钻孔工艺")]))),_:1}),i(C,{value:"6"},{default:d((()=>l[8]||(l[8]=[v("阻抗测试工艺")]))),_:1}),i(C,{value:"10"},{default:d((()=>l[9]||(l[9]=[v("空")]))),_:1})])),_:1},8,["value"])])),_:1})])),_:1}),p("div",E,[i(o,{class:"m-0"},{default:d((()=>[p("div",L,[i(O,{type:"primary",ghost:"",class:"mini-btn",onClick:s},{icon:d((()=>[i(I,{class:"align-sub text-icon"})])),default:d((()=>[p("span",K,h(e.$t("common.search")),1)])),_:1}),i(O,{class:"mini-btn",onClick:n},{icon:d((()=>[i(S,{class:"align-sub text-icon"})])),default:d((()=>[p("span",q,h(e.$t("common.reset")),1)])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])])),_:1})}}}),V={class:"container"},B={class:"event-form"},Q={__name:"add",props:{rowData:{type:Object,default:()=>({})},operateType:{type:String,default:()=>"add"}},setup(e,{expose:l}){const a=e,t=[{type:"input",key:"techNo",label:"工艺编码",placeholder:"请输入工艺编码",span:24,rule:{required:!0,message:"请输入工艺编码",trigger:"blur"}},{type:"input",key:"techName",label:"工艺名称",placeholder:"请输入工艺名称",span:24,rule:{required:!0,message:"请输入工艺名称",trigger:"blur"}},{type:"select",key:"techType",label:"工艺类型",placeholder:"请选择工艺类型",span:24,defaultValue:"0",selectOptions:[{value:"0",label:"一般工艺"},{value:"1",label:"成型工艺"},{value:"2",label:"压合工艺"},{value:"3",label:"包装工艺"},{value:"5",label:"钻孔工艺"},{value:"6",label:"阻抗测试工艺"},{value:"10",label:"空"}]},{type:"select",key:"workUnit",label:"出账单位",placeholder:"请选择出账单位",span:24,defaultValue:"PNL",selectOptions:[{value:"PNL",label:"PNL"},{value:"SET",label:"SET"},{value:"PCS",label:"PCS"}]},{type:"radio",key:"passOver",label:"需过数",span:24,defaultValue:"1",selectOptions:[{value:"1",label:"是"},{value:"0",label:"否"}]}],s=C(null),n=C({});return D((()=>a.rowData),(e=>{e&&"edit"===a.operateType?n.value={...e}:n.value={techNo:"",techName:"",techType:"0",workUnit:"PNL",passOver:"1"}}),{immediate:!0,deep:!0}),l({model:n.value,validateForm:function(){return s.value.validateForm()}}),(e,l)=>(r(),I("div",V,[p("div",B,[i(O,{ref_key:"formRef",ref:s,model:n.value,"onUpdate:model":l[0]||(l[0]=e=>n.value=e),"form-list":t},null,8,["model"])])]))}},G={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},H={class:"event-form"},J={class:"modal-footer"},M={class:"modal-footer"},W=Object.assign({name:"engineering-manage_process-flow"},{__name:"index",setup(n){const o=C({techName:"",techNo:""}),u=S({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:e=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{u.current=e,u.pageSize=l,D()}}),c=C([{key:"index",dataIndex:"index",title:"序号",width:100,align:"center",checked:!0},{key:"techName",dataIndex:"techName",title:"工艺名称",width:180,align:"center",checked:!0,ellipsis:!0},{key:"techNo",dataIndex:"techNo",title:"工艺编码",width:180,align:"center",checked:!0,ellipsis:!0},{key:"techType",dataIndex:"techType",title:"工艺类型",width:150,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>0==e.techType?"一般工艺":1==e.techType?"成型工艺":2==e.techType?"压合工艺":3==e.techType?"包装工艺":5==e.techType?"钻孔工艺":6==e.techType?"阻抗测试工艺":10==e.techType?"空":void 0},{key:"passOver",dataIndex:"passOver",title:"是否过数",width:100,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>0==e.passOver?"否":1==e.passOver?"是":void 0},{key:"workUnit",dataIndex:"workUnit",title:"出账单位",width:150,align:"center",checked:!0,ellipsis:!0},{key:"createDate",dataIndex:"createDate",title:"创建时间",width:180,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.createDate?null:U(e.createDate)},{key:"updateDate",dataIndex:"updateDate",title:"修改时间",width:180,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.updateDate?null:U(e.updateDate)},{key:"lmTime",dataIndex:"lmTime",title:"同步时间",width:180,align:"center",checked:!0,ellipsis:!0,customRender:({record:e})=>null==e.lmTime?null:U(e.lmTime)}]),m=C({}),h=C(!1),f=[{type:"input",key:"techName",label:"工艺名称",placeholder:"请输入工艺名称",span:24}],y=C([]),g=C(!1),w=C([]),b=C([]);function x(e){b.value=e}function k(){b.value=[]}const N=C(null),T=C(!1);function D(){g.value=!0,z({pageSize:u.pageSize,pageNum:u.current,...o.value}).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1})),y.value=e.list,u.total=e.total)})).finally((()=>{g.value=!1}))}const F=C(null),E=C(""),L=C("add");function K(){F.value=null,T.value=!0,E.value="工艺流程信息新增",L.value="add"}async function q(e){const l={...N.value};await l.validateForm();const a=l.model;var t;"工艺流程信息新增"===e?(t=a,s({url:"/erpsyncmes/pubtechnology/insert",method:"post",data:t})).then((({data:e,error:l})=>{var a;l||(null==(a=window.$message)||a.success("新增成功"),T.value=!1,D())})):function(e){return s({url:"/erpsyncmes/pubtechnology/update",method:"post",data:e})}({techID:b.value[0],...a}).then((({data:e,error:l})=>{var a;l||(null==(a=window.$message)||a.success("修改成功"),b.value=[],F.value=null,T.value=!1,D())})),model.value.deliverytarget=""}function V(){var e;if(1!==b.value.length)return null==(e=window.$message)?void 0:e.error("请选择一条数据");const l=y.value.find((e=>e.techID===b.value[0]));l&&(F.value=l,E.value="工艺流程信息修改",T.value=!0,L.value="edit")}function B(){var e;if(0==b.value.length)return null==(e=window.$message)?void 0:e.error("请选择数据");window.$modal.confirm({title:"提醒",content:"确认删除所选数据吗？",onOk:()=>{const e=b.value.map((e=>s({url:"/erpsyncmes/pubtechnology/delete",method:"post",data:{techID:e}})));Promise.all(e).then((e=>{var l,a;e.filter((e=>e.error)).length>0?null==(l=window.$message)||l.error("删除失败"):(null==(a=window.$message)||a.success("删除成功"),b.value=[],D())}))},onCancel:()=>{}})}function W(){m.value={},h.value=!0}function Z(){R(m.value).then((({data:e,error:l})=>{var a;l||(null==(a=window.$message)||a.success("手动同步成功"),h.value=!1,D())}))}function X(){u.current=1,D()}D(),D(),D();const Y=C(null),ee=e=>({style:{background:e.techID===Y.value?"#BAEAFA":""},class:e.techID===Y.value?"jl-table-row-selected":"",onClick:()=>{Y.value=e.techID}});return(s,n)=>{const C=_,D=t,S=a,U=l,z=e,R=j("STable"),Y=P;return r(),I("div",G,[i(A,{model:o.value,"onUpdate:model":n[0]||(n[0]=e=>o.value=e),"selected-row-keys":b.value,onReset:n[1]||(n[1]=e=>X()),onSearch:n[2]||(n[2]=e=>X()),onResetChecked:k},null,8,["model","selected-row-keys"]),i(Y,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card flex-col-stretch sm:flex-1-hidden card-wrapper"},{title:d((()=>[i(C,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:W},{default:d((()=>n[10]||(n[10]=[p("span",{class:"ml-3px"},"手动同步",-1)]))),_:1}),i(C,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:K},{icon:d((()=>[i(D,{class:"align-sub text-icon"})])),default:d((()=>[n[11]||(n[11]=p("span",{class:"ml-3px"},"新增",-1))])),_:1}),i(C,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",disabled:1!==b.value.length,onClick:V},{icon:d((()=>[i(S,{class:"align-sub text-icon"})])),default:d((()=>[n[12]||(n[12]=p("span",{class:"ml-3px"},"修改",-1))])),_:1},8,["disabled"]),i(C,{type:"primary",size:"small",ghost:"",class:"mini-btn mr-8px",onClick:B},{icon:d((()=>[i(U,{class:"align-sub text-icon"})])),default:d((()=>[n[13]||(n[13]=p("span",{class:"ml-3px"},"删除",-1))])),_:1})])),extra:d((()=>[i(z,{columns:c.value,"onUpdate:columns":n[3]||(n[3]=e=>c.value=e)},null,8,["columns"])])),default:d((()=>[i(R,{"row-selection":{selectedRowKeys:b.value,onChange:x},"default-expanded-row-keys":w.value,columns:c.value,"data-source":y.value,size:"small",bordered:"",loading:g.value,"row-key":"techID","default-expand-all-rows":!0,scroll:{x:"auto",y:"auto"},pagination:u,class:"h-full","custom-row":ee,"row-height":23},null,8,["row-selection","default-expanded-row-keys","columns","data-source","loading","pagination"]),i($,{visible:h.value,"onUpdate:visible":n[6]||(n[6]=e=>h.value=e),"destroy-on-close":!0,title:"手动工序流程信息",width:"550px"},{footer:d((()=>[p("div",J,[i(C,{onClick:n[5]||(n[5]=e=>h.value=!1)},{default:d((()=>n[14]||(n[14]=[v("关闭")]))),_:1}),i(C,{type:"primary",onClick:Z},{default:d((()=>n[15]||(n[15]=[v("保存")]))),_:1})])])),default:d((()=>[p("div",H,[i(O,{model:m.value,"onUpdate:model":n[4]||(n[4]=e=>m.value=e),"form-list":f},null,8,["model"])])])),_:1},8,["visible"]),i($,{visible:T.value,"onUpdate:visible":n[9]||(n[9]=e=>T.value=e),"destroy-on-close":!0,centered:!0,title:E.value,width:"500px",height:"470px"},{footer:d((()=>[p("div",M,[i(C,{onClick:n[7]||(n[7]=e=>T.value=!1)},{default:d((()=>n[16]||(n[16]=[v("关闭")]))),_:1}),i(C,{type:"primary",onClick:n[8]||(n[8]=e=>q(E.value))},{default:d((()=>n[17]||(n[17]=[v("保存")]))),_:1})])])),default:d((()=>[i(Q,{ref_key:"addFormRef",ref:N,"row-data":F.value,"operate-type":L.value},null,8,["row-data","operate-type"])])),_:1},8,["visible","title"])])),_:1})])}}});export{W as default};
