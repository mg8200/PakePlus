import{r as e,m as l,j as a}from"./menu-DzPI9oz5.js";import{d as t,r as s,o as n,e as o,f as u,h as i,g as r,P as c,J as d,af as f,a5 as p,q as v,n as m,w as h,aj as x,al as y,c as _,t as g,ab as b,ad as w,ae as k,v as P,N as j,I as N,Q as C,F as T,B as I,ah as L,ai as z}from"./index-B3PZsRwT.js";import{_ as D}from"./index-Cn-BWYp5.js";import{_ as U}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{g as q,p as E}from"./api-By23aosn.js";import"./fromPairs-BI-MgVCs.js";const R={class:"h-full w-full flex-col-stretch gap-5px"},A={class:"title font-size-16px color-blue font-bold"},G={title:"刷新列表",class:"ml8px"},O=d(t({__name:"top-table",props:{tableData:{}},emits:["getTopData"],setup(e,{emit:l}){const a=l,t=e,d=s([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",ellipsis:!0},{key:"podCode",width:120,dataIndex:"podCode",title:"货架编号",align:"center",ellipsis:!0},{key:"materialLot",dataIndex:"materialLot",title:"物料批次",align:"center",ellipsis:!0},{key:"bindDate",dataIndex:"bindDate",title:"时间",align:"center",ellipsis:!0}]),f=s(!1);function p(){a("getTopData")}return(e,l)=>{const a=c,s=D;return n(),o("div",R,[u("div",A,[l[0]||(l[0]=i(" 上PIN暂存物料列表: ")),u("span",G,[r(a,{class:"cursor-pointer align-sub text-icon",onClick:p})])]),r(s,{columns:d.value,"data-source":t.tableData,bordered:"",size:"small",loading:f.value,"row-key":"id",pagination:!1,scroll:{x:"auto",y:"auto"},class:"h-full"},null,8,["columns","data-source","loading"])])}}}),[["__scopeId","data-v-134964ca"]]);const S={class:"h-full w-full flex-col-stretch gap-5px"},B=d(t({__name:"bottom-table",setup(l){const a=s([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",ellipsis:!0},{key:"eqpNo",dataIndex:"eqpNo",width:120,title:"机台号",align:"center",ellipsis:!0},{key:"prodNo",dataIndex:"prodNo",title:"物料批次",align:"center",ellipsis:!0},{key:"createTime",dataIndex:"createTime",title:"时间日期",align:"center",ellipsis:!0},{width:120,key:"createBy",dataIndex:"createBy",title:"操作人",align:"center",ellipsis:!0}]),t=s([]);const i=s(!1),c=s(null),{scrollStart:d}=function(e){const l=s(null),a=s(null),t=s(!1);function n(){t.value||(a.value.scrollTop>=a.value.scrollHeight-a.value.clientHeight?a.value.scrollTop=0:a.value.scrollTop+=1,requestAnimationFrame(n))}function o(){t.value=!0,n()}return p((()=>{l.value=document.querySelector("".concat(e)),a.value=document.querySelector("".concat(e," .ant-table .ant-table-container .ant-table-body")),l.value.addEventListener("mouseleave",(()=>{t.value=!1,n()})),l.value.addEventListener("mouseenter",o)})),f((()=>{l.value.removeEventListener("mouseleave"),l.value.removeEventListener("mouseenter")})),{scrollStart:n,scrollStop:o,tableEle:a}}(".botton-table");return e().then((({data:e,error:l})=>{l||(e.forEach(((e,l)=>{e.index=l+1})),t.value=e)})),p((()=>{d()})),(e,l)=>{const s=D;return n(),o("div",S,[l[0]||(l[0]=u("div",{class:"title font-size-16px font-bold"},"机台叫料记录列表:",-1)),r(s,{ref_key:"tableRef",ref:c,columns:a.value,"data-source":t.value,bordered:"",size:"small",loading:i.value,"row-key":"id",pagination:!1,scroll:{x:"auto",y:"auto"},class:"botton-table"},null,8,["columns","data-source","loading"])])}}}),[["__scopeId","data-v-35d59220"]]),F={class:"right-content w-90% pb50px"},V={class:"content w-full"},K={class:"form p40px"},M={class:"w-full flex"},H={class:"btn w-full p50px"},$={class:"form p50px"},J={class:"w-full flex"},Q={class:"btn w-full p50px"},W={class:"btn min-h-300px w-full p50px pt100px"},X=d(t({__name:"right-content",props:{selectData:{}},setup(e){const a=e,t=s("1"),c=s({ProducType:null,machineNo:null}),d=s({ProducType:null,machineNo:null}),f=s(0),p=s(!1),D=s(!1),R=s({upPinList:null}),A=s({podCode:null});function G(){const e={};e.materialLot=c.value.ProducType,l(e).then((({data:e,error:l})=>{l||b.success("叫料成功",10)}))}function O(){A.value.podCode=null}function S(){q("/mes/jlagv/machine/woker/returnNull").then((({data:e,error:l})=>{l||b.success("操作成功",10)}))}function B(){const e={};if(null===d.value.ProducType)return b.error("请输入生产型号中间7位",10);7===d.value.ProducType.length?(e.materialLot=d.value.ProducType,E("/mes/jlagv/machine/woker/bindMaterialLot",e).then((({data:e,error:l})=>{l||b.success("操作成功",10)}))):b.error("请输入生产型号中间7位",10)}function X(){q("/mes/jlagv/machine/woker/sendMateriel?materiel=").then((({data:e,error:l})=>{l||b.success("退PIN成功",10)}))}function Y(){q("/mes/jlagv/machine/woker/callNull").then((({data:e,error:l})=>{l||b.success("退PIN返空托成功",10)}))}const{createRequiredRule:Z}=v(),{formRef:ee,validate:le,resetFields:ae}=m(),te={upPinList:Z("不能为空"),podCode:Z("不能为空")};function se(e){f.value=e,p.value=!0}function ne(){D.value=!0}async function oe(){if(0==f.value){const e={};e.machineNo=R.value.upPinList,E("/mes/jlagv/machine/woker/pointToPoint",e).then((({data:e,error:l})=>{l||(b.success("调料成功",10),R.value.upPinList=null)}))}else q("/mes/jlagv/machine/woker/returnFull?materiel=".concat(R.value.upPinList)).then((({data:e,error:l})=>{l||(b.success("操作成功",10),R.value.upPinList=null)}))}async function ue(){q("/mes/jlagv/machine/woker/bindPod?podCode=".concat(A.value.podCode)).then((({data:e,error:l})=>{l||(b.success("操作成功",10),A.value.podCode=null)}))}function ie(){R.value.upPinList=null,A.value.podCode=null}function re(){var e;null==(e=window.$modal)||e.confirm({title:"确定将钻咀待钻到已钻?",onOk:()=>{q("/mes/jlagv/machine/woker/waitToDone",{}).then((({error:e})=>{e||b.success("操作成功")}))}})}function ce(){var e;null==(e=window.$modal)||e.confirm({title:"确定将钻咀返回到研磨房?",onOk:()=>{q("/mes/jlagv/machine/woker/returnDrillBit",{}).then((({error:e})=>{e||b.success("操作成功")}))}})}return E("/mes/jlagv/machine/woker/machineNo","").then((({data:e,error:l})=>{l||(d.value.machineNo=e,c.value.machineNo=e)})),(e,l)=>{const s=w,v=k,m=P,b=j,q=N,E=C,Z=T,le=I,ae=L,de=z;return n(),o("div",F,[l[21]||(l[21]=u("div",{class:"title m-t50px h-100px text-align-center font-size-14 font-bold"},"AGV自动呼叫平台",-1)),u("div",V,[r(de,{activeKey:t.value,"onUpdate:activeKey":l[6]||(l[6]=e=>t.value=e),class:"h-full w-full"},{default:h((()=>[r(ae,{key:"1",tab:"AGV机台待钻位呼叫"},{default:h((()=>[u("div",K,[r(Z,{model:c.value,"label-col":{span:5,md:7},class:"search-form"},{default:h((()=>[u("div",M,[r(E,{gutter:[15,8],wrap:"",class:"w-full"},{default:h((()=>[r(b,{span:24,md:12,lg:12,xl:12,xxl:12},{default:h((()=>[r(m,{label:"叫料型号",name:"ProducType",class:"m-0","label-col":{}},{default:h((()=>[r(v,{value:c.value.ProducType,"onUpdate:value":l[0]||(l[0]=e=>c.value.ProducType=e),placeholder:"请选择叫料型号","allow-clear":"","show-search":""},{default:h((()=>[(n(!0),o(x,null,y(a.selectData,(e=>(n(),_(s,{key:e.index,value:e.materialLot},{default:h((()=>[i(g(e.materialLot),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})])),_:1}),r(b,{span:24,md:12,lg:12,xl:12,xxl:12},{default:h((()=>[r(m,{label:"机台号",name:"machineNo",class:"m-0","label-col":{}},{default:h((()=>[r(q,{value:c.value.machineNo,"onUpdate:value":l[1]||(l[1]=e=>c.value.machineNo=e),disabled:"",placeholder:"请输入机台号","allow-clear":"",autocomplete:"off"},null,8,["value"])])),_:1})])),_:1})])),_:1})])])),_:1},8,["model"]),u("div",H,[r(E,{gutter:[0,25]},{default:h((()=>[r(b,{span:12,class:"flex flex-justify-center"},{default:h((()=>[r(le,{type:"primary",size:"large",onClick:G},{default:h((()=>l[11]||(l[11]=[i("叫 料")]))),_:1})])),_:1}),r(b,{span:12,class:"flex flex-justify-center"},{default:h((()=>[r(le,{type:"primary",size:"large",onClick:l[2]||(l[2]=e=>se(0))},{default:h((()=>l[12]||(l[12]=[i("调 料")]))),_:1})])),_:1}),r(b,{span:12,class:"flex flex-justify-center"},{default:h((()=>[r(le,{type:"primary",size:"large",onClick:S},{default:h((()=>l[13]||(l[13]=[u("span",null,"空托返至上PIN区",-1)]))),_:1})])),_:1}),r(b,{span:12,class:"flex flex-justify-center"},{default:h((()=>[r(le,{type:"primary",size:"large",onClick:l[3]||(l[3]=e=>se(1))},{default:h((()=>l[14]||(l[14]=[u("span",null,"满托反至上PIN区",-1)]))),_:1})])),_:1})])),_:1})])])])),_:1}),r(ae,{key:"2",tab:"AGV机台已钻位呼叫"},{default:h((()=>[u("div",$,[r(Z,{model:c.value,"label-col":{span:5,md:7},class:"search-form"},{default:h((()=>[u("div",J,[r(E,{gutter:[15,8],wrap:"",class:"w-full"},{default:h((()=>[r(b,{span:24,md:12,lg:12,xl:12,xxl:12},{default:h((()=>[r(m,{label:"料号",name:"ProducType",class:"m-0","label-col":{}},{default:h((()=>[r(q,{value:d.value.ProducType,"onUpdate:value":l[4]||(l[4]=e=>d.value.ProducType=e),placeholder:"请输入料号","allow-clear":"",autocomplete:"off"},null,8,["value"])])),_:1})])),_:1}),r(b,{span:24,md:12,lg:12,xl:12,xxl:12},{default:h((()=>[r(m,{label:"机台号",name:"machineNo",class:"m-0","label-col":{}},{default:h((()=>[r(q,{value:d.value.machineNo,"onUpdate:value":l[5]||(l[5]=e=>d.value.machineNo=e),placeholder:"请输入机台号",disabled:"","allow-clear":"",autocomplete:"off"},null,8,["value"])])),_:1})])),_:1})])),_:1})])])),_:1},8,["model"]),u("div",Q,[r(E,{gutter:[0,25]},{default:h((()=>[r(b,{span:12,class:"flex flex-justify-center"},{default:h((()=>[r(le,{type:"primary",size:"large",onClick:B},{default:h((()=>l[15]||(l[15]=[i("物料绑定")]))),_:1})])),_:1}),r(b,{span:12,class:"flex flex-justify-center"},{default:h((()=>[r(le,{type:"primary",size:"large",onClick:X},{default:h((()=>l[16]||(l[16]=[i("换料退PIN")]))),_:1})])),_:1}),r(b,{span:12,class:"flex flex-justify-center"},{default:h((()=>[r(le,{type:"primary",size:"large",onClick:ne},{default:h((()=>l[17]||(l[17]=[i("托盘绑定")]))),_:1})])),_:1}),r(b,{span:12,class:"flex flex-justify-center"},{default:h((()=>[r(le,{type:"primary",size:"large",onClick:Y},{default:h((()=>l[18]||(l[18]=[i("退PIN返空托")]))),_:1})])),_:1})])),_:1})])])])),_:1}),r(ae,{key:"3",tab:"AGV机台钻咀操作"},{default:h((()=>[u("div",W,[r(E,{gutter:[0,25]},{default:h((()=>[r(b,{span:12,class:"flex flex-justify-center"},{default:h((()=>[r(le,{type:"primary",size:"large",onClick:re},{default:h((()=>l[19]||(l[19]=[i("钻咀待钻到已钻")]))),_:1})])),_:1}),r(b,{span:12,class:"flex flex-justify-center"},{default:h((()=>[r(le,{type:"primary",size:"large",onClick:ce},{default:h((()=>l[20]||(l[20]=[i("返回钻咀到研磨房")]))),_:1})])),_:1})])),_:1})])])),_:1})])),_:1},8,["activeKey"])]),r(U,{visible:p.value,"onUpdate:visible":l[8]||(l[8]=e=>p.value=e),title:0==f.value?"调料":"满托反至上PIN区",width:"500px",height:"193px","destroy-on-close":"",onOk:oe,onClose:ie},{default:h((()=>[r(Z,{ref_key:"formRef",ref:ee,model:R.value,rules:te,class:"search-form"},{default:h((()=>[r(m,{label:0==f.value?"机台号":"生产型号",name:"upPinList",class:"m-0","label-col":{}},{default:h((()=>[r(q,{value:R.value.upPinList,"onUpdate:value":l[7]||(l[7]=e=>R.value.upPinList=e),placeholder:"请输入".concat(0==f.value?"机台号":"生产型号"),"allow-clear":"",autocomplete:"off"},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])),_:1},8,["visible","title"]),r(U,{visible:D.value,"onUpdate:visible":l[10]||(l[10]=e=>D.value=e),title:"绑定托盘",width:"500px",height:"193px","destroy-on-close":"",onReset:O,onOk:ue,onClose:ie},{default:h((()=>[r(Z,{ref_key:"formRef",ref:ee,model:A.value,rules:te,class:"search-form"},{default:h((()=>[r(m,{label:"托盘编号",name:"podCode",class:"m-0","label-col":{}},{default:h((()=>[r(q,{value:A.value.podCode,"onUpdate:value":l[9]||(l[9]=e=>A.value.podCode=e),placeholder:"请输入托盘编号","allow-clear":"",autocomplete:"off"},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])])}}}),[["__scopeId","data-v-36f029f6"]]),Y={class:"w-full"},Z={class:"h-50%"},ee={class:"h-50%"},le=t({name:"intelligent-iogistics_agv-automatic-call-platform",__name:"index",setup(e){const l=s([]);function t(){a("").then((({data:e,error:a})=>{a||(e.forEach(((e,l)=>{e.index=l+1})),l.value=e)}))}return t(),(e,a)=>{const s=j,i=C;return n(),o("div",Y,[r(i,{class:"h-full w-full"},{default:h((()=>[r(s,{span:9,class:"h-full"},{default:h((()=>[u("div",Z,[r(O,{"table-data":l.value,onGetTopData:t},null,8,["table-data"])]),u("div",ee,[r(B)])])),_:1}),r(s,{span:15,class:"h-full flex-center"},{default:h((()=>[r(X,{"select-data":l.value},null,8,["select-data"])])),_:1})])),_:1})])}}});export{le as default};
