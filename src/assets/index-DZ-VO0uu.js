import{_ as e}from"./pdf-viewer-DuGSG8WR.js";import{_ as a}from"./common-search.vue_vue_type_script_setup_true_lang-BX9APgbN.js";import{_ as l}from"./table-DoFSI9NT.js";import{r as t,p as s,a9 as i,o as r,e as n,f as o,g as c,w as d,i as u,cs as p,h,V as m,c as f,a6 as g,a3 as k,bh as w,aa as y,a5 as v,Z as b,dp as x,I as _,B as I,J as C}from"./index-B3PZsRwT.js";import{u as N}from"./resetTableRef-DZjcvemm.js";import{u as D}from"./searchData-DpjdfxBw.js";import{C as R}from"./index-BThgVJ70.js";import"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import"./api-By23aosn.js";const T={class:"h-full w-full flex"},z={class:"left h-full w-430px"},P={class:"p-8px"},j={class:"right h-full flex flex-col-stretch gap-8px gap-8px overflow-hidden lt-sm:overflow-auto"},S={class:"top mb-0.5% h-50% w-full"},F={class:"print-btn"},L=C(Object.assign({name:"label-management_label-print"},{__name:"index",setup(C){const L=t(null),[B,U]=N({customerName:null}),W=D(B),Y=[{type:"dateRangePicker",key:"time",label:"时间",placeholder:"请输入时间",span:8,showTime:!0}],q=t(null),O=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"custName",dataIndex:"custName",title:"客户名称",align:"center",checked:!0,ellipsis:!0,customFilterDropdown:!0,onFilter:(e,a)=>a.custName.toString().toLowerCase().includes((null==e?void 0:e.toLowerCase())||null)},{key:"custNo",dataIndex:"custNo",title:"客户编码",align:"center",checked:!0,ellipsis:!0}],H=t(null),J=t({prodNo:null,time:null}),K=D(J),M=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"prodNo",dataIndex:"prodNo",title:"生产型号",align:"center",checked:!0,ellipsis:!0,width:160,customRender:({record:e})=>c("span",{class:"fonw-800 color-#646cFF"},[e.prodNo])},{key:"custProdNo",dataIndex:"custProdNo",title:"客户型号",align:"center",checked:!0,ellipsis:!0,width:160},{key:"packageInfo",dataIndex:"packageInfo",title:"包信息",align:"center",checked:!0,ellipsis:!0,children:[{title:"包编码",dataIndex:"labelNo",key:"labelNo",width:170,align:"center",checked:!0,ellipsis:!0,resizable:!0},{title:"装包员",dataIndex:"createBy",key:"createBy",width:140,align:"center",checked:!0,ellipsis:!0,resizable:!0},{title:"装包日期",dataIndex:"createDate",key:"createDate",width:170,align:"center",checked:!0,ellipsis:!0,resizable:!0,customRender:({record:e})=>e.createDate&&y(e.createDate).format("YYYY-MM-DD HH:mm:ss")},{title:"数量SET",dataIndex:"qty",key:"qty",width:140,align:"center",checked:!0,ellipsis:!0,resizable:!0},{title:"净重(kg)",dataIndex:"netWeight",key:"netWeight",width:140,align:"center",checked:!0,ellipsis:!0,resizable:!0},{title:"毛重(kg)",dataIndex:"grossWeight",key:"grossWeight",width:140,align:"center",checked:!0,ellipsis:!0,resizable:!0},{title:"周期",dataIndex:"dateCode",key:"dateCode",width:140,align:"center",checked:!0,ellipsis:!0,resizable:!0},{title:"客户周期",dataIndex:"custDateCode",key:"custDateCode",width:140,align:"center",checked:!0,ellipsis:!0,resizable:!0},{title:"备注",dataIndex:"remark",key:"remark",width:140,align:"center",checked:!0,ellipsis:!0,resizable:!0}]}],V=s({searchText:"",searchedColumn:""});function $(){J.value.prodNo?H.value.getData():window.$message.error("请选择客户名称")}function A(){J.value.time=null,v((()=>{$()}))}function E(e){var a;J.value.prodNo=null==(a=e.custNo)?void 0:a.substr(3),H.value.getData()}function Z(e){(null==e?void 0:e.length)&&(q.value.setCurrentRowId(e[0]),E(e[0]))}const G=t(null);function Q(e){const a=JSON.stringify(e);G.value="http://192.168.188.255:9528/test/download6-pdf?codeList=".concat(encodeURI(a))}const X=t(null);i(X);const ee=t(null);function ae(){ee.value.print()}const le=t([]);function te(e){le.value=e}const se=t(!1);function ie(){le.value.length||window.$message.error("请选择打印数据"),se.value=!0,b({url:"http://192.168.188.255:9528/test/download7-pdf",method:"POST",responseType:"arraybuffer",data:le.value}).then((({data:e,error:a})=>{a||(x(e),H.value.resetSelectRows())})).finally((()=>{se.value=!1}))}return(t,s)=>{const i=_,y=I,v=l,b=a,x=e,C=R;return r(),n("div",T,[o("div",z,[c(v,{ref_key:"leftTableRef",ref:q,searchParams:u(W),"onUpdate:searchParams":s[0]||(s[0]=e=>m(W)?W.value=e:null),class:"h-full",column:O,"show-row-selection":!1,"row-key":"id",scroll:{y:"auto"},"is-init-get-data":"",url:"/rcerp/probaglabel/getCustList","auto-generate-uuid":!0,"is-pagination":!1,onTableRowClick:E,onTableDataLoadSucess:Z},{filterDropdown:d((({setSelectedKeys:e,selectedKeys:a,confirm:l,clearFilters:t,column:r})=>[o("div",P,[c(i,{value:a[0],placeholder:"请输入客户名称",class:"mb-8px block w-188px",onInput:a=>{const l=a.target.value;e([l])}},null,8,["value","onInput"]),c(y,{type:"primary",size:"small",class:"mr-8px w-90px",onClick:e=>((e,a,l)=>{a(),V.searchText=e[0],V.searchedColumn=l})(a,l,r.dataIndex)},{icon:d((()=>[c(u(p))])),default:d((()=>[s[3]||(s[3]=h(" 搜索 "))])),_:2},1032,["onClick"]),c(y,{size:"small",class:"w-90px",onClick:e=>(e=>{e(),V.searchText=""})(t)},{default:d((()=>s[4]||(s[4]=[h("重置")]))),_:2},1032,["onClick"])])])),_:1},8,["searchParams"])]),o("div",j,[c(b,{ref_key:"commonSearchRef",ref:L,searchParams:J.value,"onUpdate:searchParams":s[1]||(s[1]=e=>J.value=e),"form-list":Y,onSearch:$,onReset:A},null,8,["searchParams"]),o("div",S,[c(v,{ref_key:"rightTableRef",ref:H,searchParams:u(K),"onUpdate:searchParams":s[2]||(s[2]=e=>m(K)?K.value=e:null),class:"h-full",column:M,"show-row-selection":!0,"row-key":"id",scroll:{y:"auto"},"is-init-get-data":!1,url:"/rcerp/probaglabel/getlist","auto-generate-uuid":!0,onTableRowClick:Q,onTableSelectChange:te},{title:d((()=>[c(y,{type:"primary",size:"small",class:"mr-8px w-90px",ghost:"",loading:se.value,onClick:ie},{icon:d((()=>s[5]||(s[5]=[o("span",{class:"iconfont icon-biaoqiandayin"},null,-1)]))),default:d((()=>[s[6]||(s[6]=h(" 批量打印 "))])),_:1},8,["loading"])])),_:1},8,["searchParams"])]),o("div",{ref_key:"viewContentRef",ref:X,class:"bottom-view h-49.5% w-full"},[c(C,{bordered:!1,title:null,"body-style":{width:"100%",height:"100%",padding:"15px",background:"rgb(186, 234, 250)"},class:"h-full w-full"},{default:d((()=>[G.value?(r(),f(x,{key:0,ref_key:"pdfViewerRef",ref:ee,url:G.value,"use-iframe":!1,"show-tools-bar":!1,"prd-scale":.38},null,8,["url"])):g("",!0)])),_:1}),k(o("div",F,[c(y,{type:"primary",size:"small",disabled:!G.value,onClick:ae},{default:d((()=>s[7]||(s[7]=[h("打印")]))),_:1},8,["disabled"])],512),[[w,G.value]])],512)])])}}}),[["__scopeId","data-v-1b4d7587"]]);export{L as default};
