import{_ as e}from"./count-to.vue_vue_type_script_setup_true_lang-B2gd1OWh.js";import{d as a,K as l,L as t,o as s,c as i,w as d,g as u,f as n,s as o,t as c,I as r,v,N as f,O as p,B as m,P as b,Q as h,F as g,cT as x,r as _,a0 as N,af as y,e as q,J as w,h as E,a1 as P,cF as T,b as S,aj as k,al as R,ac as C,i as O,cU as j,a7 as I,cH as W}from"./index-B3PZsRwT.js";import{g as A}from"./borehole-data-cz4qUDRg.js";import{C as L}from"./index-BThgVJ70.js";import{u as M}from"./echarts-B3HHInsl.js";import{D,a as F}from"./index-BrhnYIjA.js";import{_ as U}from"./index-81pxjwat.js";import"./installCanvasRenderer-Dfk03Uyn.js";const K={class:"w-full flex"},$={class:"flex"},z={class:"w-full flex-y-center justify-end gap-12px"},B={class:"ml-3px"},G={class:"ml-3px"},H=a({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:l(["search","reset"],["update:model"]),setup(e,{emit:a}){const l=a,x=t(e,"model");function _(){l("search",x.value)}function N(){x.value={subEqpName:null,pgmPathName:null},l("reset",x.value)}return(e,a)=>{const l=r,t=v,y=f,q=p,w=m,E=b,P=h,T=g,S=L;return s(),i(S,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:d((()=>[u(T,{ref:"formRef",model:x.value,"label-col":{span:5,md:7},class:"search-form"},{default:d((()=>[n("div",K,[u(P,{gutter:[15,8],wrap:"",class:"w-full"},{default:d((()=>[u(y,{span:24,md:16,lg:12,xl:8,xxl:6},{default:d((()=>[u(t,{label:"设备名称",name:"subEqpName",class:"m-0","label-col":{}},{default:d((()=>[u(l,{value:x.value.subEqpName,"onUpdate:value":a[0]||(a[0]=e=>x.value.subEqpName=e),placeholder:"请输入设备名称",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:o(_,["enter"])},null,8,["value"])])),_:1})])),_:1}),u(y,{span:24,md:16,lg:12,xl:8,xxl:6},{default:d((()=>[u(t,{label:"生产型号",name:"pgmPathName",class:"m-0","label-col":{}},{default:d((()=>[u(l,{value:x.value.pgmPathName,"onUpdate:value":a[1]||(a[1]=e=>x.value.pgmPathName=e),placeholder:"请输入生产型号",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:o(_,["enter"])},null,8,["value"])])),_:1})])),_:1}),n("div",$,[u(t,{class:"m-0"},{default:d((()=>[n("div",z,[u(w,{type:"primary",ghost:"",class:"mini-btn",onClick:_},{icon:d((()=>[u(q,{class:"align-sub text-icon"})])),default:d((()=>[n("span",B,c(e.$t("common.search")),1)])),_:1}),u(w,{class:"mini-btn",onClick:N},{icon:d((()=>[u(E,{class:"align-sub text-icon"})])),default:d((()=>[n("span",G,c(e.$t("common.reset")),1)])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])])),_:1})}}}),J={__name:"state-chart",props:{list:{type:Array,default:()=>[]}},setup(e){const a=e,{store:l}=x(),t=_([]),i=N((()=>l.drilling_equipment_state),(e=>{t.value=null==e?void 0:e.map((e=>({key:e.value,name:e.label,value:0})))}),{deep:!0}),{domRef:d,updateOptions:u}=M((()=>({tooltip:{trigger:"item"},title:{text:"设备状态统计",left:"center",top:"15",textStyle:{color:"#646cff",fontWeight:"bold",fontSize:"1.5rem"}},legend:{bottom:"1%",left:"center",itemStyle:{borderWidth:0}},series:[{color:["#1CD66C","#8e9dff","#FF3030","#26deca","#fedc69"],name:"设备状态",type:"pie",radius:["45%","70%"],avoidLabelOverlap:!1,center:["50%","50%"],itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:1},label:{show:!1,position:"center"},labelLine:{show:!1},data:t.value}]})),!1);return N((()=>a.list),(e=>{const a=e.reduce(((e,a)=>(a.equipmentStatus&&(e[a.equipmentStatus]=(e[a.equipmentStatus]||0)+1),e)),{});t.value.forEach((e=>{e.value=a[e.key]})),u((e=>(e.series[0].data=t.value,e)))}),{deep:!0}),y((()=>{i()})),(e,a)=>(s(),q("div",{ref_key:"domRef",ref:d,class:"h-360px overflow-hidden"},null,512))}},Q=w({__name:"details",props:{data:{type:Object,default:()=>({})},dataModifiers:{}},emits:["update:data"],setup(e){const a=t(e,"data"),{store:l}=x(),o=_({WORK:"",WAIT:"",ALARM:"",IDLE:"",STOP:""});return l.drilling_equipment_state.forEach((e=>{o.value[e.value]=e.label})),(e,l)=>{const t=D,r=U,v=F;return s(),i(v,{title:"",column:2,bordered:"",size:"small"},{default:d((()=>[u(t,{label:"设备名称"},{default:d((()=>[E(c(a.value.subEqpName),1)])),_:1}),u(t,{label:"时间"},{default:d((()=>[E(c(a.value.dateTime),1)])),_:1}),u(t,{label:"直径表名称"},{default:d((()=>[E(c(a.value.diaPath),1)])),_:1}),u(t,{label:"程序加工百分数"},{default:d((()=>[u(r,{percent:Number(a.value.runPresent),"stroke-color":{"0%":"#108ee9","100%":"#87d068"}},null,8,["percent"])])),_:1}),u(t,{label:"钻带名称"},{default:d((()=>[E(c(a.value.pgmPath),1)])),_:1}),u(t,{label:"稼动率"},{default:d((()=>[E(c(a.value.duty),1)])),_:1}),u(t,{label:"开机时间"},{default:d((()=>[E(c(a.value.shiftOperateTime),1)])),_:1}),u(t,{label:"加工时间"},{default:d((()=>[E(c(a.value.lotRunTime),1)])),_:1}),u(t,{label:"等待时间"},{default:d((()=>[E(c(a.value.shiftWaitTime),1)])),_:1}),u(t,{label:"错误时间"},{default:d((()=>[E(c(a.value.shiftErrorTime),1)])),_:1}),u(t,{label:"机台当前状态"},{default:d((()=>[n("span",{class:P(["equipment-status",a.value.equipmentStatus])},c(o.value[a.value.equipmentStatus]),3)])),_:1}),u(t,{label:"轴开启状态"},{default:d((()=>[E(c(a.value.axisStatus),1)])),_:1}),u(t,{label:"主轴开启数量"},{default:d((()=>[E(c(a.value.axisRunCount),1)])),_:1})])),_:1})}}},[["__scopeId","data-v-9be64a04"]]),V={class:"borehole-data-page h-full w-full flex"},X={class:"left-list min-h-500px flex-col-stretch gap-5px overflow-hidden lt-sm:overflow-auto"},Y={class:"list h-full w-full overflow-auto"},Z={key:0,class:"row flex flex-wrap"},ee={class:"device-data"},ae={class:"data"},le=["title"],te={class:"data"},se=["title"],ie={class:"data"},de=["title"],ue={class:"data"},ne=["title"],oe={class:"data"},ce=["title"],re=["onClick"],ve={class:"state w-full"},fe={class:"data flex"},pe={class:"value flex gap-3px color-#646cff"},me={class:"data"},be={class:"value progress w-full"},he={class:"right-msg"},ge={class:"right-card bg-#fff pb-30px pt10px"},xe={class:"card-content flex flex-center gap-15px"},_e={class:"right-card mt15px bg-#fff pb-30px pt10px"},Ne={class:"card-content"},ye={class:"right-card mt15px bg-#fff pb-30px pl10px pt15px"},qe={class:"card-content"},we={class:"text"},Ee=w(Object.assign({name:"collection-management_real-time-device-information_borehole-data"},{__name:"index",setup(a){const{getDict:l}=x(),t=_([]);l("drilling_equipment_state").then((e=>{t.value=e}));const o=T.PRESENTED_IMAGE_SIMPLE,r=_({subEqpName:null,pgmPathName:null}),v=_([]),f=_(!1),p=_([]),m=_(!1);function b(){m.value=!0,A(r.value).then((({data:e,error:a})=>{a||(null==e||e.forEach(((e,a)=>{e.index=a+1,e.TUuid=I.generate()})),v.value=e,p.value=e)})).finally((()=>m.value=!1))}function h(e){return p.value.filter((a=>e(a)))}function g(){v.value=r.value.subEqpName||r.value.pgmPathName?r.value.subEqpName&&r.value.pgmPathName?h((e=>{var a,l;return(null==(a=null==e?void 0:e.subEqpName)?void 0:a.includes(r.value.subEqpName))&&(null==(l=null==e?void 0:e.pgmPath)?void 0:l.includes(r.value.pgmPathName))})):r.value.subEqpName?h((e=>{var a;return null==(a=null==e?void 0:e.subEqpName)?void 0:a.includes(r.value.subEqpName)})):r.value.pgmPathName?h((e=>{var a;return null==(a=null==e?void 0:e.pgmPath)?void 0:a.includes(r.value.pgmPathName)})):[]:p.value}b();let w=null;N((()=>r.value),(()=>{w||(w=setTimeout((()=>{clearTimeout(w),w=null,g()}),500))}),{deep:!0});let L=setInterval((()=>{b()}),3e5);function M(){v.value=p.value}function D(e){return Number(e)>=100?"完成":"".concat(e,"%")}const F=S((()=>p.value.length.toString().padStart(3,"0").split(""))),K={WORK:"#1CD66C",WAIT:"#8e9dff",ALARM:"#FF3030",IDLE:"#26deca",STOP:"#fedc69"},$=_(null),{updateModalOptions:z,handleShow:B}=window.$useModal({modalOption:{title:"设备详情",showConfirmBtn:!1,confirmBtnText:"关闭",destroyOnClose:!0,width:"955px"},component:()=>u(Q,{data:$.value,"onUpdate:data":e=>$.value=e},null)});return y((()=>{clearInterval(L),L=null})),(a,l)=>{const m=U,b=T,h=W,x=e;return s(),q("div",V,[n("div",X,[u(H,{model:r.value,"onUpdate:model":l[0]||(l[0]=e=>r.value=e),onReset:M,onSearch:g},null,8,["model"]),n("div",Y,[u(h,{tip:"数据加载中...",spinning:f.value,class:"h-full w-full"},{default:d((()=>[v.value.length?(s(),q("div",Z,[(s(!0),q(k,null,R(v.value,((e,a)=>{var t;return s(),q("div",{key:a,class:"col col-md-24 col-lg-8 col-xxl-4_8"},[n("div",{class:"card",style:C({border:"2px solid ".concat(K[e.equipmentStatus])})},[n("div",ee,[n("div",ae,[l[1]||(l[1]=n("div",{class:"label"},"设备名称",-1)),n("div",{class:"value",title:e.subEqpName},c(e.subEqpName),9,le)]),n("div",te,[l[2]||(l[2]=n("div",{class:"label"},"时 间",-1)),n("div",{class:"value",title:e.dateTime},c(e.dateTime),9,se)]),n("div",ie,[l[3]||(l[3]=n("div",{class:"label"},"稼动率",-1)),n("div",{class:"value",title:e.duty},c(e.duty),9,de)]),n("div",ue,[l[4]||(l[4]=n("div",{class:"label"},"开机时间",-1)),n("div",{class:"value",title:e.startTime},c(e.shiftOperateTime),9,ne)]),n("div",oe,[l[5]||(l[5]=n("div",{class:"label"},"加工时间",-1)),n("div",{class:"value",title:e.lotRunTime},c(e.lotRunTime),9,ce)])]),n("div",{class:"view-device-data cursor-pointer color-#646cff",onClick:a=>function(e){z({title:"".concat(e.subEqpName,"设备详情")}),$.value=e,B()}(e)},"查看详情",8,re),n("div",ve,[n("div",fe,[l[6]||(l[6]=n("div",{class:"label font-bold"},"轴开启状态",-1)),n("div",pe,[(s(!0),q(k,null,R(null==(t=e.axisStatus)?void 0:t.split(""),((e,a)=>(s(),q("span",{key:a,class:P(["pl-3px pr-3px",1===Number(e)?"bg-green":"bg-#eee"])},c(a+1),3)))),128))])]),n("div",me,[l[7]||(l[7]=n("div",{class:"label"},"加工进度",-1)),n("div",be,[u(m,{percent:Number(e.runPresent),format:D,"stroke-color":{"0%":"#87d068","100%":"#108ee9"}},null,8,["percent"])])])])],4)])})),128))])):(s(),i(b,{key:1,image:O(o)},null,8,["image"]))])),_:1},8,["spinning"])])]),n("div",he,[n("div",ge,[l[8]||(l[8]=j('<div class="angle" data-v-c2f233ff><div class="left-top" data-v-c2f233ff></div><div class="right-top" data-v-c2f233ff></div><div class="left-bottom" data-v-c2f233ff></div><div class="right-bottom" data-v-c2f233ff></div></div><div class="card-title" data-v-c2f233ff>设备总数</div>',2)),n("div",xe,[(s(!0),q(k,null,R(F.value,((e,a)=>(s(),i(x,{key:a,"start-value":0,"end-value":Number(e),class:"device-count text-30px dark:text-dark"},null,8,["end-value"])))),128))])]),n("div",_e,[l[9]||(l[9]=j('<div class="angle" data-v-c2f233ff><div class="left-top" data-v-c2f233ff></div><div class="right-top" data-v-c2f233ff></div><div class="left-bottom" data-v-c2f233ff></div><div class="right-bottom" data-v-c2f233ff></div></div>',1)),n("div",Ne,[u(J,{list:p.value},null,8,["list"])])]),n("div",ye,[l[12]||(l[12]=j('<div class="angle" data-v-c2f233ff><div class="left-top" data-v-c2f233ff></div><div class="right-top" data-v-c2f233ff></div><div class="left-bottom" data-v-c2f233ff></div><div class="right-bottom" data-v-c2f233ff></div></div>',1)),n("div",qe,[l[11]||(l[11]=n("div",{class:"card-title"},"左侧设备状态说明",-1)),(s(!0),q(k,null,R(t.value,((e,a)=>(s(),q("div",{key:a,class:"card-instructions flex-center justify-start"},[l[10]||(l[10]=E(" 边框为 ")),n("div",{class:P(["equipment-status type h-14px w-14px",e.value])},null,2),n("div",we,"代表"+c(e.label)+"的设备",1)])))),128))])])])])}}}),[["__scopeId","data-v-c2f233ff"]]);export{Ee as default};
