import{d as e,b as t,bX as a,bN as s,o,e as n,a1 as l,i as r,f as i,ac as c,b3 as u,t as d,a6 as p,c as f,w as v,E as y,bO as m,b_ as g,r as h,aj as b,al as k,s as w,bS as x,g as F,bm as R,bL as E,be as S,dq as T,bK as L,bR as _,a0 as C,b7 as $,b1 as U,bu as P,b2 as B,bU as O}from"./index-B3PZsRwT.js";import{b as j,d as D,m as N,v as q,x as A,y as H,z as M,A as I,E as K,_ as z,w as W,B as X,C as G,t as J,h as V,D as Q,F as Y,G as Z,H as ee,j as te}from"./use-form-common-props-DQAdjfyv.js";const ae=j({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:D(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:D([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:D(Function),default:e=>"".concat(e,"%")}}),se=["aria-valuenow"],oe={viewBox:"0 0 100 100"},ne=["d","stroke","stroke-linecap","stroke-width"],le=["d","stroke","opacity","stroke-linecap","stroke-width"],re={key:0},ie=e({name:"ElProgress"});const ce=W(z(e({...ie,props:ae,setup(e){const m=e,g={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},h=N("progress"),b=t((()=>{const e={width:"".concat(m.percentage,"%"),animationDuration:"".concat(m.duration,"s")},t=U(m.percentage);return t.includes("gradient")?e.background=t:e.backgroundColor=t,e})),k=t((()=>(m.strokeWidth/m.width*100).toFixed(1))),w=t((()=>["circle","dashboard"].includes(m.type)?Number.parseInt("".concat(50-Number.parseFloat(k.value)/2),10):0)),x=t((()=>{const e=w.value,t="dashboard"===m.type;return"\n          M 50 50\n          m 0 ".concat(t?"":"-").concat(e,"\n          a ").concat(e," ").concat(e," 0 1 1 0 ").concat(t?"-":"").concat(2*e,"\n          a ").concat(e," ").concat(e," 0 1 1 0 ").concat(t?"":"-").concat(2*e,"\n          ")})),F=t((()=>2*Math.PI*w.value)),R=t((()=>"dashboard"===m.type?.75:1)),E=t((()=>{const e=-1*F.value*(1-R.value)/2;return"".concat(e,"px")})),S=t((()=>({strokeDasharray:"".concat(F.value*R.value,"px, ").concat(F.value,"px"),strokeDashoffset:E.value}))),T=t((()=>({strokeDasharray:"".concat(F.value*R.value*(m.percentage/100),"px, ").concat(F.value,"px"),strokeDashoffset:E.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"}))),L=t((()=>{let e;return e=m.color?U(m.percentage):g[m.status]||g.default,e})),_=t((()=>"warning"===m.status?q:"line"===m.type?"success"===m.status?A:H:"success"===m.status?M:I)),C=t((()=>"line"===m.type?12+.4*m.strokeWidth:.111111*m.width+2)),$=t((()=>m.format(m.percentage)));const U=e=>{var t;const{color:o}=m;if(a(o))return o(e);if(s(o))return o;{const a=function(e){const t=100/e.length;return e.map(((e,a)=>s(e)?{color:e,percentage:(a+1)*t}:e)).sort(((e,t)=>e.percentage-t.percentage))}(o);for(const t of a)if(t.percentage>e)return t.color;return null==(t=a[a.length-1])?void 0:t.color}};return(e,t)=>(o(),n("div",{class:l([r(h).b(),r(h).m(e.type),r(h).is(e.status),{[r(h).m("without-text")]:!e.showText,[r(h).m("text-inside")]:e.textInside}]),role:"progressbar","aria-valuenow":e.percentage,"aria-valuemin":"0","aria-valuemax":"100"},["line"===e.type?(o(),n("div",{key:0,class:l(r(h).b("bar"))},[i("div",{class:l(r(h).be("bar","outer")),style:c({height:"".concat(e.strokeWidth,"px")})},[i("div",{class:l([r(h).be("bar","inner"),{[r(h).bem("bar","inner","indeterminate")]:e.indeterminate},{[r(h).bem("bar","inner","striped")]:e.striped},{[r(h).bem("bar","inner","striped-flow")]:e.stripedFlow}]),style:c(r(b))},[(e.showText||e.$slots.default)&&e.textInside?(o(),n("div",{key:0,class:l(r(h).be("bar","innerText"))},[u(e.$slots,"default",{percentage:e.percentage},(()=>[i("span",null,d(r($)),1)]))],2)):p("v-if",!0)],6)],6)],2)):(o(),n("div",{key:1,class:l(r(h).b("circle")),style:c({height:"".concat(e.width,"px"),width:"".concat(e.width,"px")})},[(o(),n("svg",oe,[i("path",{class:l(r(h).be("circle","track")),d:r(x),stroke:"var(".concat(r(h).cssVarName("fill-color-light"),", #e5e9f2)"),"stroke-linecap":e.strokeLinecap,"stroke-width":r(k),fill:"none",style:c(r(S))},null,14,ne),i("path",{class:l(r(h).be("circle","path")),d:r(x),stroke:r(L),fill:"none",opacity:e.percentage?1:0,"stroke-linecap":e.strokeLinecap,"stroke-width":r(k),style:c(r(T))},null,14,le)]))],6)),!e.showText&&!e.$slots.default||e.textInside?p("v-if",!0):(o(),n("div",{key:2,class:l(r(h).e("text")),style:c({fontSize:"".concat(r(C),"px")})},[u(e.$slots,"default",{percentage:e.percentage},(()=>[e.status?(o(),f(r(K),{key:1},{default:v((()=>[(o(),f(y(r(_))))])),_:1})):(o(),n("span",re,d(r($)),1))]))],6))],10,se))}}),[["__file","progress.vue"]])),ue=Symbol("uploadContextKey");class de extends Error{constructor(e,t,a,s){super(e),this.name="UploadAjaxError",this.status=t,this.method=a,this.url=s}}function pe(e,t,a){let s;return s=a.response?"".concat(a.response.error||a.response):a.responseText?"".concat(a.responseText):"fail to ".concat(t.method," ").concat(e," ").concat(a.status),new de(s,a.status,t.method,e)}const fe=["text","picture","picture-card"];let ve=1;const ye=()=>Date.now()+ve++,me=j({action:{type:String,default:"#"},headers:{type:D(Object)},method:{type:String,default:"post"},data:{type:D([Object,Function,Promise]),default:()=>({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:D(Array),default:()=>[]},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:fe,default:"text"},httpRequest:{type:D(Function),default:e=>{"undefined"==typeof XMLHttpRequest&&X("ElUpload","XMLHttpRequest is undefined");const t=new XMLHttpRequest,a=e.action;t.upload&&t.upload.addEventListener("progress",(t=>{const a=t;a.percent=t.total>0?t.loaded/t.total*100:0,e.onProgress(a)}));const s=new FormData;if(e.data)for(const[n,l]of Object.entries(e.data))m(l)&&l.length?s.append(n,...l):s.append(n,l);s.append(e.filename,e.file,e.file.name),t.addEventListener("error",(()=>{e.onError(pe(a,e,t))})),t.addEventListener("load",(()=>{if(t.status<200||t.status>=300)return e.onError(pe(a,e,t));e.onSuccess(function(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(a){return t}}(t))})),t.open(e.method,a,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const o=e.headers||{};if(o instanceof Headers)o.forEach(((e,a)=>t.setRequestHeader(a,e)));else for(const[n,l]of Object.entries(o))G(l)||t.setRequestHeader(n,String(l));return t.send(s),t}},disabled:Boolean,limit:Number}),ge=j({...me,beforeUpload:{type:D(Function),default:g},beforeRemove:{type:D(Function)},onRemove:{type:D(Function),default:g},onChange:{type:D(Function),default:g},onPreview:{type:D(Function),default:g},onSuccess:{type:D(Function),default:g},onProgress:{type:D(Function),default:g},onError:{type:D(Function),default:g},onExceed:{type:D(Function),default:g},crossorigin:{type:D(String)}}),he=j({files:{type:D(Array),default:()=>[]},disabled:{type:Boolean,default:!1},handlePreview:{type:D(Function),default:g},listType:{type:String,values:fe,default:"text"},crossorigin:{type:D(String)}}),be=["onKeydown"],ke=["src","crossorigin"],we=["onClick"],xe=["title"],Fe=["onClick"],Re=["onClick"],Ee=e({name:"ElUploadList"});var Se=z(e({...Ee,props:he,emits:{remove:e=>!!e},setup(e,{emit:a}){const s=e,{t:y}=J(),m=N("upload"),g=N("icon"),E=N("list"),S=V(),T=h(!1),L=t((()=>[m.b("list"),m.bm("list",s.listType),m.is("disabled",s.disabled)])),_=e=>{a("remove",e)};return(e,t)=>(o(),f(R,{tag:"ul",class:l(r(L)),name:r(E).b()},{default:v((()=>[(o(!0),n(b,null,k(e.files,(a=>(o(),n("li",{key:a.uid||a.name,class:l([r(m).be("list","item"),r(m).is(a.status),{focusing:T.value}]),tabindex:"0",onKeydown:w((e=>!r(S)&&_(a)),["delete"]),onFocus:t[0]||(t[0]=e=>T.value=!0),onBlur:t[1]||(t[1]=e=>T.value=!1),onClick:t[2]||(t[2]=e=>T.value=!1)},[u(e.$slots,"default",{file:a},(()=>["picture"===e.listType||"uploading"!==a.status&&"picture-card"===e.listType?(o(),n("img",{key:0,class:l(r(m).be("list","item-thumbnail")),src:a.url,crossorigin:e.crossorigin,alt:""},null,10,ke)):p("v-if",!0),"uploading"===a.status||"picture-card"!==e.listType?(o(),n("div",{key:1,class:l(r(m).be("list","item-info"))},[i("a",{class:l(r(m).be("list","item-name")),onClick:x((t=>e.handlePreview(a)),["prevent"])},[F(r(K),{class:l(r(g).m("document"))},{default:v((()=>[F(r(Q))])),_:1},8,["class"]),i("span",{class:l(r(m).be("list","item-file-name")),title:a.name},d(a.name),11,xe)],10,we),"uploading"===a.status?(o(),f(r(ce),{key:0,type:"picture-card"===e.listType?"circle":"line","stroke-width":"picture-card"===e.listType?6:2,percentage:Number(a.percentage),style:c("picture-card"===e.listType?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):p("v-if",!0)],2)):p("v-if",!0),i("label",{class:l(r(m).be("list","item-status-label"))},["text"===e.listType?(o(),f(r(K),{key:0,class:l([r(g).m("upload-success"),r(g).m("circle-check")])},{default:v((()=>[F(r(A))])),_:1},8,["class"])):["picture-card","picture"].includes(e.listType)?(o(),f(r(K),{key:1,class:l([r(g).m("upload-success"),r(g).m("check")])},{default:v((()=>[F(r(M))])),_:1},8,["class"])):p("v-if",!0)],2),r(S)?p("v-if",!0):(o(),f(r(K),{key:2,class:l(r(g).m("close")),onClick:e=>_(a)},{default:v((()=>[F(r(I))])),_:2},1032,["class","onClick"])),p(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),p(" This is a bug which needs to be fixed "),p(" TODO: Fix the incorrect navigation interaction "),r(S)?p("v-if",!0):(o(),n("i",{key:3,class:l(r(g).m("close-tip"))},d(r(y)("el.upload.deleteTip")),3)),"picture-card"===e.listType?(o(),n("span",{key:4,class:l(r(m).be("list","item-actions"))},[i("span",{class:l(r(m).be("list","item-preview")),onClick:t=>e.handlePreview(a)},[F(r(K),{class:l(r(g).m("zoom-in"))},{default:v((()=>[F(r(Y))])),_:1},8,["class"])],10,Fe),r(S)?p("v-if",!0):(o(),n("span",{key:0,class:l(r(m).be("list","item-delete")),onClick:e=>_(a)},[F(r(K),{class:l(r(g).m("delete"))},{default:v((()=>[F(r(Z))])),_:1},8,["class"])],10,Re))],2)):p("v-if",!0)]))],42,be)))),128)),u(e.$slots,"append")])),_:3},8,["class","name"]))}}),[["__file","upload-list.vue"]]);const Te=j({disabled:{type:Boolean,default:!1}}),Le={file:e=>m(e)},_e=["onDrop","onDragover"],Ce="ElUploadDrag",$e=e({name:Ce});var Ue=z(e({...$e,props:Te,emits:Le,setup(e,{emit:t}){E(ue)||X(Ce,"usage: <el-upload><el-upload-dragger /></el-upload>");const a=N("upload"),s=h(!1),i=V(),c=e=>{if(i.value)return;s.value=!1,e.stopPropagation();const a=Array.from(e.dataTransfer.files);t("file",a)},d=()=>{i.value||(s.value=!0)};return(e,t)=>(o(),n("div",{class:l([r(a).b("dragger"),r(a).is("dragover",s.value)]),onDrop:x(c,["prevent"]),onDragover:x(d,["prevent"]),onDragleave:t[0]||(t[0]=x((e=>s.value=!1),["prevent"]))},[u(e.$slots,"default")],42,_e))}}),[["__file","upload-dragger.vue"]]);const Pe=j({...me,beforeUpload:{type:D(Function),default:g},onRemove:{type:D(Function),default:g},onStart:{type:D(Function),default:g},onSuccess:{type:D(Function),default:g},onProgress:{type:D(Function),default:g},onError:{type:D(Function),default:g},onExceed:{type:D(Function),default:g}}),Be=["onKeydown"],Oe=["name","multiple","accept"],je=e({name:"ElUploadContent",inheritAttrs:!1});var De=z(e({...je,props:Pe,setup(e,{expose:t}){const s=e,c=N("upload"),d=V(),p=S({}),y=S(),m=e=>{if(0===e.length)return;const{autoUpload:t,limit:a,fileList:o,multiple:n,onStart:l,onExceed:r}=s;if(a&&o.length+e.length>a)r(e,o);else{n||(e=e.slice(0,1));for(const a of e){const e=a;e.uid=ye(),l(e),t&&g(e)}}},g=async e=>{if(y.value.value="",!s.beforeUpload)return h(e);let t,a={};try{const o=s.data,n=s.beforeUpload(e);a=T(s.data)?L(s.data):s.data,t=await n,T(s.data)&&_(o,a)&&(a=L(s.data))}catch(n){t=!1}if(!1===t)return void s.onRemove(e);let o=e;t instanceof Blob&&(o=t instanceof File?t:new File([t],e.name,{type:e.type})),h(Object.assign(o,{uid:e.uid}),a)},h=async(e,t)=>{const{headers:o,data:n,method:l,withCredentials:r,name:i,action:c,onProgress:u,onSuccess:d,onError:f,httpRequest:v}=s;try{t=await(async(e,t)=>a(e)?e(t):e)(null!=t?t:n,e)}catch(h){return void s.onRemove(e)}const{uid:y}=e,m={headers:o||{},withCredentials:r,file:e,data:t,method:l,filename:i,action:c,onProgress:t=>{u(t,e)},onSuccess:t=>{d(t,e),delete p.value[y]},onError:t=>{f(t,e),delete p.value[y]}},g=v(m);p.value[y]=g,g instanceof Promise&&g.then(m.onSuccess,m.onError)},b=e=>{const t=e.target.files;t&&m(Array.from(t))},k=()=>{d.value||(y.value.value="",y.value.click())},F=()=>{k()};return t({abort:e=>{var t;(t=p.value,Object.entries(t)).filter(e?([t])=>String(e.uid)===t:()=>!0).forEach((([e,t])=>{t instanceof XMLHttpRequest&&t.abort(),delete p.value[e]}))},upload:g}),(e,t)=>(o(),n("div",{class:l([r(c).b(),r(c).m(e.listType),r(c).is("drag",e.drag)]),tabindex:"0",onClick:k,onKeydown:w(x(F,["self"]),["enter","space"])},[e.drag?(o(),f(Ue,{key:0,disabled:r(d),onFile:m},{default:v((()=>[u(e.$slots,"default")])),_:3},8,["disabled"])):u(e.$slots,"default",{key:1}),i("input",{ref_key:"inputRef",ref:y,class:l(r(c).e("input")),name:e.name,multiple:e.multiple,accept:e.accept,type:"file",onChange:b,onClick:t[0]||(t[0]=x((()=>{}),["stop"]))},null,42,Oe)],42,Be))}}),[["__file","upload-content.vue"]]);const Ne="ElUpload",qe=e=>{var t;(null==(t=e.url)?void 0:t.startsWith("blob:"))&&URL.revokeObjectURL(e.url)},Ae=e({name:"ElUpload"});const He=W(z(e({...Ae,props:ge,setup(e,{expose:a}){const s=e,l=V(),i=S(),{abort:c,submit:d,clearFiles:y,uploadFiles:m,handleStart:g,handleError:h,handleRemove:b,handleSuccess:k,handleProgress:w,revokeFileObjectURL:x}=((e,t)=>{const a=ee(e,"fileList",void 0,{passive:!0}),s=e=>a.value.find((t=>t.uid===e.uid));function o(e){var a;null==(a=t.value)||a.abort(e)}return C((()=>e.listType),(t=>{"picture-card"!==t&&"picture"!==t||(a.value=a.value.map((t=>{const{raw:s,url:o}=t;if(!o&&s)try{t.url=URL.createObjectURL(s)}catch(n){e.onError(n,t,a.value)}return t})))})),C(a,(e=>{for(const t of e)t.uid||(t.uid=ye()),t.status||(t.status="success")}),{immediate:!0,deep:!0}),{uploadFiles:a,abort:o,clearFiles:function(e=["ready","uploading","success","fail"]){a.value=a.value.filter((t=>!e.includes(t.status)))},handleError:(t,o)=>{const n=s(o);n&&(n.status="fail",a.value.splice(a.value.indexOf(n),1),e.onError(t,n,a.value),e.onChange(n,a.value))},handleProgress:(t,o)=>{const n=s(o);n&&(e.onProgress(t,n,a.value),n.status="uploading",n.percentage=Math.round(t.percent))},handleStart:t=>{G(t.uid)&&(t.uid=ye());const s={name:t.name,percentage:0,status:"ready",size:t.size,raw:t,uid:t.uid};if("picture-card"===e.listType||"picture"===e.listType)try{s.url=URL.createObjectURL(t)}catch(o){te(Ne,o.message),e.onError(o,s,a.value)}a.value=[...a.value,s],e.onChange(s,a.value)},handleSuccess:(t,o)=>{const n=s(o);n&&(n.status="success",n.response=t,e.onSuccess(t,n,a.value),e.onChange(n,a.value))},handleRemove:async t=>{const n=t instanceof File?s(t):t;n||X(Ne,"file to be removed not found");const l=t=>{o(t);const s=a.value;s.splice(s.indexOf(t),1),e.onRemove(t,s),qe(t)};e.beforeRemove?!1!==await e.beforeRemove(n,a.value)&&l(n):l(n)},submit:function(){a.value.filter((({status:e})=>"ready"===e)).forEach((({raw:e})=>{var a;return e&&(null==(a=t.value)?void 0:a.upload(e))}))},revokeFileObjectURL:qe}})(s,i),R=t((()=>"picture-card"===s.listType)),E=t((()=>({...s,fileList:m.value,onStart:g,onProgress:w,onSuccess:k,onError:h,onRemove:b})));return $((()=>{m.value.forEach(x)})),U(ue,{accept:P(s,"accept")}),a({abort:c,submit:d,clearFiles:y,handleStart:g,handleRemove:b}),(e,t)=>(o(),n("div",null,[r(R)&&e.showFileList?(o(),f(Se,{key:0,disabled:r(l),"list-type":e.listType,files:r(m),crossorigin:e.crossorigin,"handle-preview":e.onPreview,onRemove:r(b)},B({append:v((()=>[F(De,O({ref_key:"uploadRef",ref:i},r(E)),{default:v((()=>[e.$slots.trigger?u(e.$slots,"trigger",{key:0}):p("v-if",!0),!e.$slots.trigger&&e.$slots.default?u(e.$slots,"default",{key:1}):p("v-if",!0)])),_:3},16)])),_:2},[e.$slots.file?{name:"default",fn:v((({file:t})=>[u(e.$slots,"file",{file:t})]))}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):p("v-if",!0),!r(R)||r(R)&&!e.showFileList?(o(),f(De,O({key:1,ref_key:"uploadRef",ref:i},r(E)),{default:v((()=>[e.$slots.trigger?u(e.$slots,"trigger",{key:0}):p("v-if",!0),!e.$slots.trigger&&e.$slots.default?u(e.$slots,"default",{key:1}):p("v-if",!0)])),_:3},16)):p("v-if",!0),e.$slots.trigger?u(e.$slots,"default",{key:2}):p("v-if",!0),u(e.$slots,"tip"),!r(R)&&e.showFileList?(o(),f(Se,{key:3,disabled:r(l),"list-type":e.listType,files:r(m),crossorigin:e.crossorigin,"handle-preview":e.onPreview,onRemove:r(b)},B({_:2},[e.$slots.file?{name:"default",fn:v((({file:t})=>[u(e.$slots,"file",{file:t})]))}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):p("v-if",!0)]))}}),[["__file","upload.vue"]]));export{He as E};
