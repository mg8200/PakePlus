import{_ as e}from"./table-column-setting.vue_vue_type_script_setup_true_lang-DaxmPPHo.js";import{_ as l}from"./round-download-DUbhM0Ds.js";import{Z as a,ag as t,d as n,r as i,p as s,o as c,e as d,g as o,w as u,f as r,s as p,I as m,v as f,N as h,O as g,B as v,P as x,Q as k,F as y,K as w,L as _,h as b,aj as I,a5 as q,ak as C,M as S,a7 as j,S as z,aa as E}from"./index-B3PZsRwT.js";import{_ as N}from"./modal.vue_vue_type_style_index_0_lang-Gjmj9w7c.js";import{g as T}from"./equipment-alarm-info-RrvTGqWc.js";import{C as M}from"./index-BThgVJ70.js";import{_ as D}from"./index-Cn-BWYp5.js";import"./fromPairs-BI-MgVCs.js";const K={class:"jl-main-page h-full flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},P={class:"w-full flex"},U={class:"flex"},O={class:"w-full flex-y-center justify-end gap-12px"},R=n({__name:"code-list",setup(l,{expose:a}){const t=i(null),n=i([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"equipmentId",dataIndex:"equipmentId",title:"设备代码",align:"center",checked:!0,ellipsis:!0},{key:"description",dataIndex:"description",title:"设备描述",align:"center",checked:!0,ellipsis:!0}]),w=i(null),_=i({type:"radio",onChange:e=>{w.value=e[0]}}),b=i([]),I=i(!1),q=s({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{q.current=e,q.pageSize=l,j()}});function C(){q.current=1,j()}function S(){t.value=null,q.current=1,j()}function j(){const e={equipmentId:t.value,pageSize:q.pageSize,pageNum:q.current};I.value=!0,T(e).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1})),q.total=e.total,b.value=e.list)})).finally((()=>I.value=!1))}return j(),a({currentSelect:w}),(l,a)=>{const i=m,s=f,w=h,j=g,z=v,E=x,N=k,T=y,R=M,Q=e,Y=D;return c(),d("div",K,[o(R,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:u((()=>[o(T,{"label-col":{span:5,md:7},class:"search-form"},{default:u((()=>[r("div",P,[o(N,{gutter:[15,8],wrap:"",class:"w-full"},{default:u((()=>[o(w,{span:24,md:12,lg:8,xl:8,xxl:8},{default:u((()=>[o(s,{label:"设备代码",name:"equipmentId",class:"m-0","label-col":{}},{default:u((()=>[o(i,{value:t.value,"onUpdate:value":a[0]||(a[0]=e=>t.value=e),placeholder:"请输入设备代码",class:"min-form-control","allow-clear":"",autocomplete:"off",onKeypress:p(C,["enter"])},null,8,["value"])])),_:1})])),_:1}),r("div",U,[o(s,{class:"m-0"},{default:u((()=>[r("div",O,[o(z,{type:"primary",ghost:"",class:"mini-btn",onClick:C},{icon:u((()=>[o(j,{class:"align-sub text-icon"})])),default:u((()=>[a[2]||(a[2]=r("span",{class:"ml-3px"},"搜索",-1))])),_:1}),o(z,{class:"mini-btn",onClick:S},{icon:u((()=>[o(E,{class:"align-sub text-icon"})])),default:u((()=>[a[3]||(a[3]=r("span",{class:"ml-3px"},"重置",-1))])),_:1})])])),_:1})])])),_:1})])])),_:1})])),_:1}),o(R,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card h-full flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:u((()=>[o(Q,{columns:n.value,"onUpdate:columns":a[1]||(a[1]=e=>n.value=e)},null,8,["columns"])])),default:u((()=>[o(Y,{columns:n.value,"data-source":b.value,bordered:"","row-selection":_.value,size:"small",loading:I.value,"row-key":"equipmentId",pagination:q,scroll:{x:"auto",y:"auto"},class:"h-full"},null,8,["columns","data-source","row-selection","loading","pagination"])])),_:1})])}}}),Q={class:"w-full flex"},Y={class:"flex"},A={class:"w-full flex-y-center justify-end gap-12px"},B=n({__name:"search",props:{model:{required:!0},modelModifiers:{}},emits:w(["search"],["update:model"]),setup(e,{emit:l}){const a=l,t=_(e,"model"),n=i(!1),s=i(null);function x(){a("search",t.value)}function w(){n.value=!0}function j(){q((()=>{t.value.equipmentId=s.value.currentSelect,n.value=!1,a("search",t.value)}))}return(e,l)=>{const a=m,i=v,_=C,q=f,z=h,E=S,T=g,D=k,K=y,P=M;return c(),d(I,null,[o(P,{title:null,bordered:!1,class:"search-card card-wrapper"},{default:u((()=>[o(K,{model:t.value,"label-col":{span:5,md:7},class:"search-form"},{default:u((()=>[r("div",Q,[o(D,{gutter:[15,8],wrap:"",class:"w-full"},{default:u((()=>[o(z,{span:24,md:12,lg:8,xl:8,xxl:6},{default:u((()=>[o(q,{label:"设备代码",name:"equipmentId",class:"m-0","label-col":{}},{default:u((()=>[o(_,{compact:""},{default:u((()=>[o(a,{value:t.value.equipmentId,"onUpdate:value":l[0]||(l[0]=e=>t.value.equipmentId=e),style:{width:"calc(100% - 63px)"},class:"min-form-control",autocomplete:"off",onKeypress:p(x,["enter"])},null,8,["value"]),o(i,{type:"primary",class:"mini-btn",onClick:w},{default:u((()=>l[3]||(l[3]=[b("搜索")]))),_:1})])),_:1})])),_:1})])),_:1}),o(z,{span:24,md:12,lg:8,xl:8,xxl:6},{default:u((()=>[o(q,{label:"时间范围",name:"time",class:"m-0","label-col":{}},{default:u((()=>[o(E,{value:t.value.time,"onUpdate:value":l[1]||(l[1]=e=>t.value.time=e),"show-time":"",class:"min-form-control"},null,8,["value"])])),_:1})])),_:1}),r("div",Y,[o(q,{class:"m-0"},{default:u((()=>[r("div",A,[o(i,{type:"primary",ghost:"",class:"mini-btn",onClick:x},{icon:u((()=>[o(T,{class:"align-sub text-icon"})])),default:u((()=>[l[4]||(l[4]=r("span",{class:"ml-3px"},"查询",-1))])),_:1})])])),_:1})])])),_:1})])])),_:1},8,["model"])])),_:1}),o(N,{visible:n.value,"onUpdate:visible":l[2]||(l[2]=e=>n.value=e),title:"代码列表",height:"70vh",width:"800px",onOk:j},{default:u((()=>[o(R,{ref_key:"codeListRef",ref:s},null,512)])),_:1},8,["visible"])],64)}}}),F={class:"jl-main-page one-code-ascend min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},H=n({name:"collection-management_process-parameter-query",__name:"index",setup(n){const p=i({equipmentId:null,time:null}),m=s({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","200","300","500"],showQuickJumper:!0,showTotal:(e,l)=>"共".concat(e,"条"),total:0,onChange:async(e,l)=>{m.current=e,m.pageSize=l,y()}}),f=i([]),h=i(!1),g=i([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"mainEqpId",dataIndex:"mainEqpId",title:"线体代码",width:140,align:"center",checked:!0,ellipsis:!0},{key:"mainEqpName",dataIndex:"mainEqpName",title:"线体名称",width:160,align:"center",checked:!0,ellipsis:!0},{key:"subEqpId",dataIndex:"subEqpId",title:"设备",width:160,align:"center",checked:!0,ellipsis:!0},{key:"subEqpName",dataIndex:"subEqpName",title:"设备名称",width:160,align:"center",checked:!0,ellipsis:!0},{key:"dateTime",dataIndex:"dateTime",title:"创建时间",align:"center",width:180,checked:!0,ellipsis:!0},{key:"eqpId",dataIndex:"eqpId",title:"机台号",align:"center",checked:!0,width:100,ellipsis:!0},{key:"lotId",dataIndex:"lotId",title:"批号",align:"center",checked:!0,ellipsis:!0},{key:"recipeName",dataIndex:"recipeName",title:"料号",align:"center",width:120,checked:!0,ellipsis:!0},{key:"pgmPath",dataIndex:"pgmPath",title:"钻孔程式路径",align:"center",checked:!0,ellipsis:!0},{key:"diaPath",dataIndex:"diaPath",title:"配方参数路径",align:"center",checked:!0,ellipsis:!0},{key:"axisRunCount",dataIndex:"axisRunCount",title:"主轴开启数量",align:"center",checked:!0,ellipsis:!0},{key:"startDt",dataIndex:"startDt",title:"趟开始时间",align:"center",width:180,checked:!0,ellipsis:!0},{key:"endDt",dataIndex:"endDt",title:"趟结束时间",align:"center",width:180,checked:!0,ellipsis:!0},{key:"pickErrorCount",dataIndex:"pickErrorCount",title:"取放刀出错次数",align:"center",checked:!0,ellipsis:!0},{key:"brokeKnifeCount",dataIndex:"brokeKnifeCount",title:"断刀次数",align:"center",checked:!0,ellipsis:!0},{key:"brokeKnifeMsg",dataIndex:"brokeKnifeMsg",title:"断刀信息",align:"center",checked:!0,ellipsis:!0},{key:"diaChangeMsg",dataIndex:"diaChangeMsg",title:"刀具参数",align:"center",checked:!0,ellipsis:!0}]);function x(){k()}function k(){m.current=1,y()}function y(){var e;const l={pageNum:m.current,pageSize:m.pageSize,equipmentId:p.value.equipmentId};(null==(e=p.value.time)?void 0:e[0])&&(l.beginTime=p.value.time[0],l.endTime=p.value.time[1]),h.value=!0,function(e){return a({url:"/mes/collection-management/process-argument-info",params:e})}(l).then((({data:e,error:l})=>{l||(e.list.forEach(((e,l)=>{e.index=l+1,e.uid=j.genV4().hexNoDelim})),m.total=e.total,f.value=e.list)})).finally((()=>h.value=!1))}function w(){var e;const l={equipmentId:p.value.equipmentId};(null==(e=p.value.time)?void 0:e[0])&&(l.beginTime=p.value.time[0],l.endTime=p.value.time[1]),function(e,l){t({url:"/mes/collection-management/process-argument-info/export",method:"POST",params:e,fileName:l})}(l,"制程参数查询导出".concat(E().format("YYYY-MM-DD HH:mm:ss"),".xlsx"))}const _=i(null),b=e=>({style:{background:e.uid===_.value?"#BAEAFA":""},class:e.uid===_.value?"jl-table-row-selected":"",onClick:()=>{_.value=e.uid}});return(a,t)=>{const n=l,i=v,s=e,y=z("STable"),_=M;return c(),d("div",F,[o(B,{model:p.value,"onUpdate:model":t[0]||(t[0]=e=>p.value=e),onReset:x,onSearch:k},null,8,["model"]),o(_,{bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"table-card flex-col-stretch sm:flex-1-hidden card-wrapper"},{title:u((()=>[o(i,{type:"primary",ghost:"",class:"mini-btn",onClick:w},{icon:u((()=>[o(n,{class:"align-sub text-icon"})])),default:u((()=>[t[2]||(t[2]=r("span",{class:"ml-3px"},"导出Excel",-1))])),_:1})])),extra:u((()=>[o(s,{columns:g.value,"onUpdate:columns":t[1]||(t[1]=e=>g.value=e)},null,8,["columns"])])),default:u((()=>[o(y,{columns:g.value,"data-source":f.value,bordered:"",size:"small",loading:h.value,"row-key":"uid",pagination:m,scroll:{x:2800,y:"auto"},class:"h-full","custom-row":b,"row-height":23},null,8,["columns","data-source","loading","pagination"])])),_:1})])}}});export{H as default};
