!function(){function e(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return n};var t,n={},i=Object.prototype,r=i.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(t){c=function(e,t,n){return e[t]=n}}function h(e,t,n,i){var r=t&&t.prototype instanceof m?t:m,a=Object.create(r.prototype),s=new j(i||[]);return o(a,"_invoke",{value:M(e,n,s)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=h;var g="suspendedStart",d="suspendedYield",v="executing",p="completed",y={};function m(){}function k(){}function x(){}var w={};c(w,s,(function(){return this}));var P=Object.getPrototypeOf,C=P&&P(P(L([])));C&&C!==i&&r.call(C,s)&&(w=C);var A=x.prototype=m.prototype=Object.create(w);function O(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(i,o,a,s){var l=f(e[i],e,o);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==b(c)&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}})}function M(e,n,i){var r=g;return function(o,a){if(r===v)throw Error("Generator is already running");if(r===p){if("throw"===o)throw a;return{value:t,done:!0}}for(i.method=o,i.arg=a;;){var s=i.delegate;if(s){var l=S(s,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===g)throw r=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=v;var u=f(e,n,i);if("normal"===u.type){if(r=i.done?p:d,u.arg===y)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r=p,i.method="throw",i.arg=u.arg)}}}function S(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=f(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(b(e)+" is not iterable")}return k.prototype=x,o(A,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:k,configurable:!0}),k.displayName=c(x,u,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,u,"GeneratorFunction")),e.prototype=Object.create(A),e},n.awrap=function(e){return{__await:e}},O(E.prototype),c(E.prototype,l,(function(){return this})),n.AsyncIterator=E,n.async=function(e,t,i,r,o){void 0===o&&(o=Promise);var a=new E(h(e,t,i,r),o);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},n.values=L,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(i,r){return s.type="throw",s.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),N(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;N(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:L(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),y}},n}function t(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function n(e,t,n,r){var o=i(u(1&r?e.prototype:e),t,n);return 2&r?function(e){return o.apply(n,e)}:o}function i(){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},i.apply(null,arguments)}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,a,s=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(s.push(i.value),s.length!==t);l=!0);}catch(e){u=!0,r=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t,n){return t=u(t),s(e,l()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}function s(e,t){if(t&&("object"==b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function f(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,m(i.key),i)}}function y(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=b(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==b(t)?t:t+""}function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}System.register(["./index-legacy-BH1Y34Mi.js","./_createAggregator-legacy-C4Fw625u.js","./isNumber-legacy-CHb6J4gG.js","./tracking-code-acquisition-legacy-raF-jcAM.js","./modal.vue_vue_type_style_index_0_lang-legacy-DP5xhvDE.js","./table-legacy-BfQK1xrs.js","./api-legacy-B6UkH1eb.js","./table-column-setting.vue_vue_type_script_setup_true_lang-legacy-zNkjfv7c.js","./index-legacy-JzSJVdOM.js"],(function(i,l){"use strict";var u,h,d,p,m,k,x,w,P,C,A,O,E,M,S,T,N,j,L,D,I,R,V,B,z,F,G,q,H,_,U,W,J,X,Y,Z,K,Q,$,ee,te,ne,ie,re,oe,ae,se,le,ue,ce,he,fe,ge,de,ve,pe,ye,me,be,ke,xe,we,Pe,Ce,Ae,Oe,Ee,Me,Se,Te,Ne,je,Le,De,Ie,Re,Ve;return{setters:[function(e){u=e.e6,h=e.bF,d=e.e7,p=e.e8,m=e.e9,k=e.ea,x=e.eb,w=e.ec,P=e.ed,C=e.ee,A=e.ef,O=e.eg,E=e.eh,M=e.ei,S=e.bH,T=e.ej,N=e.ek,j=e.el,L=e.em,D=e.aF,I=e.en,R=e.eo,V=e.ep,B=e.eq,z=e.er,F=e.es,G=e.et,q=e.eu,H=e.ev,_=e.ew,U=e.ex,W=e.ey,J=e.ez,X=e.eA,Y=e.eB,Z=e.bG,K=e.eC,Q=e.bK,$=e.eD,ee=e.bR,te=e.e5,ne=e.eE,ie=e.Z,re=e.r,oe=e.a0,ae=e.cF,se=e.p,le=e.a7,ue=e.g,ce=e.S,he=e.o,fe=e.e,ge=e.f,de=e.c,ve=e.w,pe=e.aj,ye=e.al,me=e.ac,be=e.t,ke=e.a6,xe=e.i,we=e.h,Pe=e.N,Ce=e.Q,Ae=e.B,Oe=e.J,Ee=e.j,Me=e.ah,Se=e.ai},function(e){Te=e.b,Ne=e.a,je=e.c},function(e){Le=e.i},function(e){De=e.g},function(e){Ie=e._},function(e){Re=e._},function(e){Ve=e.g},null,null],execute:function(){var l=document.createElement("style");function Be(e,t,n){if(!u(n))return!1;var i=b(t);return!!("number"==i?h(n)&&d(t,n.length):"string"==i&&t in n)&&p(n[t],e)}function ze(e){return m((function(t,n){var i=-1,r=n.length,o=r>1?n[r-1]:void 0,a=r>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(r--,o):void 0,a&&Be(n[0],n[1],a)&&(o=r<3?void 0:o,r=1),t=Object(t);++i<r;){var s=n[i];s&&e(t,s,i,o)}return t}))}l.textContent='@charset "UTF-8";.jl-main-page .list[data-v-33740749]{height:calc(100% - 28px);overflow:auto}.jl-main-page .footer[data-v-33740749]{height:30px;background:#fff;box-shadow:0 0 10px 1px rgba(128,128,128,.2);border-radius:8px}.bgClor[data-v-33740749]{height:15px;width:24px;background-color:rgba(255,255,128,.13)}.listAllClass[data-v-33740749]{position:relative;display:flex;flex-wrap:wrap;align-content:center;margin-left:4%}.listClass[data-v-33740749]{width:100%;box-shadow:0 0 10px 1px rgba(128,128,128,.2);border-radius:10px;margin:10px;background:#fff;display:flex}.leftClass[data-v-33740749]{width:25%;margin-right:5%;text-align:center}.rightClass[data-v-33740749]{margin-top:1%}.titClass[data-v-33740749]{font-size:18px;color:#4747dd;font-weight:600;text-align:center;margin-left:10%}.rightImg[data-v-33740749]{background-image:url(/assets/dmt-DHeJhmO7.png);width:100px;height:70%;margin-left:3%;background-size:90% 90%;background-position:center;background-repeat:no-repeat}.rightImg1[data-v-33740749]{background-image:url(/assets/dmt1-BffDIIlV.jpeg);width:100px;height:70%;margin-left:3%;background-size:90% 90%;background-position:center;background-repeat:no-repeat}.diveice-search-list[data-v-33740749]{width:280px;box-shadow:0 0 10px 1px rgba(128,128,128,.2);border-radius:8px;background-color:#fff}.diveice-search-list .header[data-v-33740749]{text-align:center;color:#646cff;font-size:18px;font-weight:700;padding:5px}.diveice-search-list .header .title[data-v-33740749]{border-bottom:2px solid #646cff;padding:0 8px}.diveice-search-list .card-list[data-v-33740749]{height:calc(100% - 62px);overflow:auto}.diveice-search-list .card-list .card-item[data-v-33740749]{align-items:center;height:60px;background-color:#f5f7fb;padding:15px;border-radius:8px;font-size:16px;margin-top:15px;box-shadow:0 0 10px 1px rgba(128,128,128,.2)}.diveice-search-list .card-list .card-item[data-v-33740749]:first-child{margin-top:0}.diveice-search-list .card-list .card-item.active[data-v-33740749]{background-color:#fff;position:relative}.diveice-search-list .card-list .card-item.active[data-v-33740749]:before{content:"";position:absolute;display:inline-block;top:0;left:0;width:5px;height:100%;border-radius:8px;background-color:#646cff}.diveice-search-list .card-list .card-item.active .name[data-v-33740749]{color:#646cff}.diveice-search-list .card-list .card-item.error[data-v-33740749]{background-color:rgba(255,0,0,.1)}.diveice-list[data-v-33740749]{width:calc(100% - 280px)}.read-graph-page[data-v-1908b2b6] .ant-tabs{width:100%;height:100%}.read-graph-page[data-v-1908b2b6] .ant-tabs .ant-tabs-nav{margin-bottom:0}.read-graph-page[data-v-1908b2b6] .ant-tabs .ant-tabs-content-holder{height:calc(100% - 46px)}.read-graph-page[data-v-1908b2b6] .ant-tabs .ant-tabs-content-holder .ant-tabs-content{height:100%}.read-graph-page .container[data-v-1908b2b6]{height:calc(100% - 50px);width:100%!important;max-width:100%!important}.read-graph-page .container .x6-graph-background[data-v-1908b2b6]{width:100%!important}.read-graph-page .footer[data-v-1908b2b6]{height:50px;align-items:center}.read-graph-page .list[data-v-1908b2b6]{position:relative}.read-graph-page .list .return-btn[data-v-1908b2b6]{position:absolute;right:15px;top:8px;z-index:9999}\n',document.head.appendChild(l);var Fe=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function Ge(e){return Fe.test(e)}var qe="\\ud800-\\udfff",He="["+qe+"]",_e="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ue="\\ud83c[\\udffb-\\udfff]",We="[^"+qe+"]",Je="(?:\\ud83c[\\udde6-\\uddff]){2}",Xe="[\\ud800-\\udbff][\\udc00-\\udfff]",Ye="(?:"+_e+"|"+Ue+")"+"?",Ze="[\\ufe0e\\ufe0f]?",Ke=Ze+Ye+("(?:\\u200d(?:"+[We,Je,Xe].join("|")+")"+Ze+Ye+")*"),Qe="(?:"+[We+_e+"?",_e,Je,Xe,He].join("|")+")",$e=RegExp(Ue+"(?="+Ue+")|"+Qe+Ke,"g");function et(e){return Ge(e)?function(e){return e.match($e)||[]}(e):function(e){return e.split("")}(e)}function tt(e){return function(t){var n=Ge(t=x(t))?et(t):void 0,i=n?n[0]:t.charAt(0),r=n?function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:k(e,t,n)}(n,1).join(""):t.slice(1);return i[e]()+r}}var nt=tt("toUpperCase");var it,rt=(it={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},function(e){return null==it?void 0:it[e]}),ot=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,at=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var st=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var lt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var ut="\\ud800-\\udfff",ct="\\u2700-\\u27bf",ht="a-z\\xdf-\\xf6\\xf8-\\xff",ft="A-Z\\xc0-\\xd6\\xd8-\\xde",gt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",dt="["+gt+"]",vt="\\d+",pt="["+ct+"]",yt="["+ht+"]",mt="[^"+ut+gt+vt+ct+ht+ft+"]",bt="(?:\\ud83c[\\udde6-\\uddff]){2}",kt="[\\ud800-\\udbff][\\udc00-\\udfff]",xt="["+ft+"]",wt="(?:"+yt+"|"+mt+")",Pt="(?:"+xt+"|"+mt+")",Ct="(?:['’](?:d|ll|m|re|s|t|ve))?",At="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ot="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Et="[\\ufe0e\\ufe0f]?",Mt=Et+Ot+("(?:\\u200d(?:"+["[^"+ut+"]",bt,kt].join("|")+")"+Et+Ot+")*"),St="(?:"+[pt,bt,kt].join("|")+")"+Mt,Tt=RegExp([xt+"?"+yt+"+"+Ct+"(?="+[dt,xt,"$"].join("|")+")",Pt+"+"+At+"(?="+[dt,xt+wt,"$"].join("|")+")",xt+"?"+wt+"+"+Ct,xt+"+"+At,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",vt,St].join("|"),"g");function Nt(e,t,n){return e=x(e),void 0===t?function(e){return lt.test(e)}(e)?function(e){return e.match(Tt)||[]}(e):function(e){return e.match(st)||[]}(e):e.match(t)||[]}var jt=RegExp("['’]","g");function Lt(e){return function(t){return function(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)n=t(n,e[i],i,e);return n}(Nt(function(e){return(e=x(e))&&e.replace(ot,rt).replace(at,"")}(t).replace(jt,"")),e,"")}}var Dt=Lt((function(e,t,n){return t=t.toLowerCase(),e+(n?nt(x(t).toLowerCase()):t)}));function It(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=w(n))==n?n:0),void 0!==t&&(t=(t=w(t))==t?t:0),function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}(w(e),t,n)}function Rt(e){return P(e,4)}var Vt=Object.prototype,Bt=Vt.hasOwnProperty,zt=m((function(e,t){e=Object(e);var n=-1,i=t.length,r=i>2?t[2]:void 0;for(r&&Be(t[0],t[1],r)&&(i=1);++n<i;)for(var o=t[n],a=C(o),s=-1,l=a.length;++s<l;){var u=a[s],c=e[u];(void 0===c||p(c,Vt[u])&&!Bt.call(e,u))&&(e[u]=o[u])}return e}));function Ft(e,t,n){(void 0!==n&&!p(e[t],n)||void 0===n&&!(t in e))&&A(e,t,n)}function Gt(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function qt(e,t,n,i,r,o,a){var s=Gt(e,n),l=Gt(t,n),c=a.get(l);if(c)Ft(e,n,c);else{var h,f=o?o(s,l,n+"",e,t,a):void 0,g=void 0===f;if(g){var d=S(l),v=!d&&E(l),p=!d&&!v&&M(l);f=l,d||v||p?S(s)?f=s:T(s)?f=N(s):v?(g=!1,f=j(l,!0)):p?(g=!1,f=L(l,!0)):f=[]:D(l)||I(l)?(f=s,I(s)?f=O(h=s,C(h)):u(s)&&!R(s)||(f=V(l))):g=!1}g&&(a.set(l,f),r(f,l,i,o,a),a.delete(l)),Ft(e,n,f)}}function Ht(e,t,n,i,r){e!==t&&Te(t,(function(o,a){if(r||(r=new B),u(o))qt(e,t,a,n,Ht,i,r);else{var s=i?i(Gt(e,a),o,a+"",e,t,r):void 0;void 0===s&&(s=o),Ft(e,a,s)}}),C)}function _t(e,t,n,i,r,o){return u(e)&&u(t)&&(o.set(t,e),Ht(e,t,void 0,_t,o),o.delete(t)),e}var Ut=ze((function(e,t,n,i){Ht(e,t,n,i)})),Wt=m((function(e){return e.push(void 0,_t),z(Ut,void 0,e)}));var Jt=m((function(e,t){return T(e)?function(e,t,n,i){var r=-1,o=G,a=!0,s=e.length,l=[],u=t.length;if(!s)return l;t.length>=200&&(o=q,a=!1,t=new F(t));e:for(;++r<s;){var c=e[r],h=c;if(c=0!==c?c:0,a&&h==h){for(var f=u;f--;)if(t[f]===h)continue e;l.push(c)}else o(t,h,i)||l.push(c)}return l}(e,H(t,1,T,!0)):[]}));var Xt=Object.prototype.hasOwnProperty,Yt=je((function(e,t,n){Xt.call(e,n)?e[n].push(t):A(e,n,[t])}));function Zt(e,t){return e>t}var Kt=Object.prototype.hasOwnProperty;function Qt(e,t){return null!=e&&Kt.call(e,t)}function $t(e,t){return null!=e&&_(e,t,Qt)}var en=tt("toLowerCase");function tn(e){return e&&e.length?function(e,t,n){for(var i=-1,r=e.length;++i<r;){var o=e[i],a=t(o);if(null!=a&&(void 0===s?a==a&&!U(a):n(a,s)))var s=a,l=o}return l}(e,W,Zt):void 0}var nn=ze((function(e,t,n){Ht(e,t,n)}));function rn(e,t){if(e!==t){var n=void 0!==e,i=null===e,r=e==e,o=U(e),a=void 0!==t,s=null===t,l=t==t,u=U(t);if(!s&&!u&&!o&&e>t||o&&a&&l&&!s&&!u||i&&a&&l||!n&&l||!r)return 1;if(!i&&!o&&!u&&e<t||u&&n&&r&&!i&&!o||s&&n&&r||!a&&r||!l)return-1}return 0}function on(e,t,n){t=t.length?J(t,(function(e){return S(e)?function(t){return X(t,1===e.length?e[0]:e)}:e})):[W];var i=-1;t=J(t,Y(Z));var r=function(e,t){var n=-1,i=h(e)?Array(e.length):[];return Ne(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}(e,(function(e,n,r){return{criteria:J(t,(function(t){return t(e)})),index:++i,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(r,(function(e,t){return function(e,t,n){for(var i=-1,r=e.criteria,o=t.criteria,a=r.length,s=n.length;++i<a;){var l=rn(r[i],o[i]);if(l)return i>=s?l:l*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)}))}var an=m((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Be(e,t[0],t[1])?t=[]:n>2&&Be(t[0],t[1],t[2])&&(t=[t[0]]),on(e,H(t),[])})),sn=4294967294,ln=Math.floor,un=Math.min;function cn(e,t,n,i){var r=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=n(t))!=t,s=null===t,l=U(t),u=void 0===t;r<o;){var c=ln((r+o)/2),h=n(e[c]),f=void 0!==h,g=null===h,d=h==h,v=U(h);if(a)var p=d;else p=u?d&&f:s?d&&f&&!g:l?d&&f&&!g&&!v:!g&&!v&&h<t;p?r=c+1:o=c}return un(o,sn)}var hn=2147483647;function fn(e,t){return function(e,t){var n=0,i=null==e?n:e.length;if("number"==typeof t&&t==t&&i<=hn){for(;n<i;){var r=n+i>>>1,o=e[r];null!==o&&!U(o)&&o<t?n=r+1:i=r}return i}return cn(e,t,W)}(e,t)}var gn=Lt((function(e,t,n){return e+(n?" ":"")+nt(t)})),dn=m((function(e){return K(H(e,1,T,!0))}));"object"===("undefined"==typeof window?"undefined":b(window))&&window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"undefined"!=typeof window&&[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((function(e){Object.prototype.hasOwnProperty.call(e,"append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){for(var e=document.createDocumentFragment(),t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach((function(t){var n=t instanceof Node;e.appendChild(n?t:document.createTextNode(String(t)))})),this.appendChild(e)}})}));var vn=function(){return y((function e(){v(this,e)}),[{key:"disposed",get:function(){return!0===this._disposed}},{key:"dispose",value:function(){this._disposed=!0}}])}();!function(e){e.dispose=function(){return function(e,t,n){var i=n.value,r=e.__proto__;n.value=function(){if(!this.disposed){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.call.apply(i,[this].concat(t)),r.dispose.call(this)}}}}}(vn||(vn={}));var pn=function(){return y((function e(){v(this,e),this.isDisposed=!1,this.items=new Set}),[{key:"disposed",get:function(){return this.isDisposed}},{key:"dispose",value:function(){this.isDisposed||(this.isDisposed=!0,this.items.forEach((function(e){e.dispose()})),this.items.clear())}},{key:"contains",value:function(e){return this.items.has(e)}},{key:"add",value:function(e){this.items.add(e)}},{key:"remove",value:function(e){this.items.delete(e)}},{key:"clear",value:function(){this.items.clear()}}])}();function yn(e,t,n){if(n)switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2]);case 4:return e.call(t,n[0],n[1],n[2],n[3]);case 5:return e.call(t,n[0],n[1],n[2],n[3],n[4]);case 6:return e.call(t,n[0],n[1],n[2],n[3],n[4],n[5]);default:return e.apply(t,n)}return e.call(t)}function mn(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return yn(e,t,i)}function bn(e){return null!=e&&(e instanceof Promise||function(e){return"object"===b(e)&&e.then&&"function"==typeof e.then}(e))}function kn(){for(var e=[],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(n.forEach((function(t){Array.isArray(t)?e.push.apply(e,f(t)):e.push(t)})),e.some((function(e){return bn(e)}))){var r=e.map((function(e){return bn(e)?e:Promise.resolve(!1!==e)}));return Promise.all(r).then((function(e){return e.reduce((function(e,t){return!1!==t&&e}),!0)}))}return e.every((function(e){return!1!==e}))}function xn(e,t){for(var n=[],i=0;i<e.length;i+=2){var r=yn(e[i],e[i+1],Array.isArray(t)?t:[t]);n.push(r)}return kn(n)}!function(e){e.from=function(t){var n=new e;return t.forEach((function(e){n.add(e)})),n}}(pn||(pn={}));var wn=function(){return y((function e(){v(this,e),this.listeners={}}),[{key:"on",value:function(e,t,n){return null==t||(this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t,n)),this}},{key:"once",value:function(e,t,n){var i=this,r=function(){i.off(e,r);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return xn([t,n],a)};return this.on(e,r,this)}},{key:"off",value:function(e,t,n){if(!(e||t||n))return this.listeners={},this;var i=this.listeners;return(e?[e]:Object.keys(i)).forEach((function(e){var r=i[e];if(r)if(t||n)for(var o=r.length-2;o>=0;o-=2)t&&r[o]!==t||n&&r[o+1]!==n||r.splice(o,2);else delete i[e]})),this}},{key:"trigger",value:function(e){for(var t=!0,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];if("*"!==e){var o=this.listeners[e];null!=o&&(t=xn(f(o),i))}var a=this.listeners["*"];return null!=a?kn([t,xn(f(a),[e].concat(i))]):t}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.trigger.apply(this,[e].concat(n))}}])}();var Pn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};var Cn=/^\s*class\s+/.test("".concat(y((function e(){v(this,e)}))))||/^\s*class\s*\{/.test("".concat(y((function e(){v(this,e)}))));function An(e,t){var n;return Cn?n=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t)}(t):(n=function(){return t.apply(this,arguments)},function(e,t){function n(){this.constructor=e}Pn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(n,t)),Object.defineProperty(n,"name",{value:e}),n}function On(e){return"__proto__"===e}function En(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",r=Array.isArray(t)?t:t.split(i);if(r.length)for(n=e;r.length;){var o=r.shift();if(Object(n)!==n||!o||!(o in n))return;n=n[o]}return n}function Mn(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",r=Array.isArray(t)?t:t.split(i),o=r.pop();if(o&&!On(o)){var a=e;r.forEach((function(e){On(e)||(null==a[e]&&(a[e]={}),a=a[e])})),a[o]=n}return e}function Sn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",i=Array.isArray(t)?t.slice():t.split(n),r=i.pop();if(r)if(i.length>0){var o=En(e,i);o&&delete o[r]}else delete e[r];return e}var Tn=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Nn=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"dispose",value:function(){this.off()}}])}(wn);Tn([vn.dispose()],Nn.prototype,"dispose",null),function(e){e.dispose=vn.dispose}(Nn||(Nn={})),function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach((function(t){Object.getOwnPropertyNames(t.prototype).forEach((function(n){"constructor"!==n&&Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))}))}))}(Nn,vn);var jn=function(e){var t=Object.create(null);return function(n){return t[n]||(t[n]=e(n))}},Ln=jn((function(e){return e.replace(/\B([A-Z])/g,"-$1").toLowerCase()})),Dn=jn((function(e){return gn(Dt(e)).replace(/ /g,"")}));function In(e){for(var t=2166136261,n=!1,i=e,r=0,o=i.length;r<o;r+=1){var a=i.charCodeAt(r);a>127&&!n&&(a=(i=unescape(encodeURIComponent(i))).charCodeAt(r),n=!0),t^=a,t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24)}return t>>>0}function Rn(){for(var e="",t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n=0;n<36;n+=1){var i=t[n],r=16*Math.random()|0;e+=("x"===i?r:"y"===i?3&r|8:i).toString(16)}return e}function Vn(e,t,n){var i,r,o=Math.min(2,Math.floor(.34*e.length)),a=Math.floor(.4*e.length)+1,s=!1,l=e.toLowerCase(),u=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=g(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(u.s();!(r=u.n()).done;){var c=r.value,h=n(c);if(void 0!==h&&Math.abs(h.length-l.length)<=o){var f=h.toLowerCase();if(f===l){if(h===e)continue;return c}if(s)continue;if(h.length<3)continue;var d=Bn(l,f,a-1);if(void 0===d)continue;d<3?(s=!0,i=c):(a=d,i=c)}}}catch(v){u.e(v)}finally{u.f()}return i}function Bn(e,t,n){for(var i=new Array(t.length+1),r=new Array(t.length+1),o=n+1,a=0;a<=t.length;a+=1)i[a]=a;for(var s=1;s<=e.length;s+=1){var l=e.charCodeAt(s-1),u=s>n?s-n:1,c=t.length>n+s?n+s:t.length;r[0]=s;for(var h=s,f=1;f<u;f+=1)r[f]=o;for(var g=u;g<=c;g+=1){var d=l===t.charCodeAt(g-1)?i[g-1]:Math.min(i[g]+1,r[g-1]+1,i[g-1]+2);r[g]=d,h=Math.min(h,d)}for(var v=c+1;v<=t.length;v+=1)r[v]=o;if(h>n)return;var p=i;i=r,r=p}var y=i[t.length];return y>n?void 0:y}function zn(e){return"string"==typeof e&&"%"===e.slice(-1)}function Fn(e,t){if(null==e)return 0;var n;if("string"==typeof e){if(n=parseFloat(e),zn(e)&&(n/=100,Number.isFinite(n)))return n*t}else n=e;return Number.isFinite(n)?n>0&&n<1?n*t:n:0}function Gn(e){if("object"===b(e)){var t=0,n=0,i=0,r=0;return null!=e.vertical&&Number.isFinite(e.vertical)&&(n=r=e.vertical),null!=e.horizontal&&Number.isFinite(e.horizontal)&&(i=t=e.horizontal),null!=e.left&&Number.isFinite(e.left)&&(t=e.left),null!=e.top&&Number.isFinite(e.top)&&(n=e.top),null!=e.right&&Number.isFinite(e.right)&&(i=e.right),null!=e.bottom&&Number.isFinite(e.bottom)&&(r=e.bottom),{top:n,right:i,bottom:r,left:t}}var o=0;return null!=e&&Number.isFinite(e)&&(o=e),{top:o,right:o,bottom:o,left:o}}var qn,Hn=!1,_n=!1,Un=!1,Wn=!1,Jn=!1,Xn=!1,Yn=!1,Zn=!1,Kn=!1,Qn=!1,$n=!1,ei=!1,ti=!1,ni=!1,ii=!1,ri=!1;if("object"===("undefined"==typeof navigator?"undefined":b(navigator))){var oi=navigator.userAgent;Hn=oi.indexOf("Macintosh")>=0,_n=!!oi.match(/(iPad|iPhone|iPod)/g),Un=oi.indexOf("Windows")>=0,Wn=oi.indexOf("MSIE")>=0,Jn=!!oi.match(/Trident\/7\./),Xn=!!oi.match(/Edge\//),Yn=oi.indexOf("Mozilla/")>=0&&oi.indexOf("MSIE")<0&&oi.indexOf("Edge/")<0,Kn=oi.indexOf("Chrome/")>=0&&oi.indexOf("Edge/")<0,Qn=oi.indexOf("Opera/")>=0||oi.indexOf("OPR/")>=0,$n=oi.indexOf("Firefox/")>=0,ei=oi.indexOf("AppleWebKit/")>=0&&oi.indexOf("Chrome/")<0&&oi.indexOf("Edge/")<0,"object"===("undefined"==typeof document?"undefined":b(document))&&(ri=!document.createElementNS||"[object SVGForeignObjectElement]"!=="".concat(document.createElementNS("http://www.w3.org/2000/svg","foreignObject"))||oi.indexOf("Opera/")>=0)}if("object"===("undefined"==typeof window?"undefined":b(window))&&(Zn=null!=window.chrome&&null!=window.chrome.app&&null!=window.chrome.app.runtime,ni=null!=window.PointerEvent&&!Hn),"object"===("undefined"==typeof document?"undefined":b(document))){ti="ontouchstart"in document.documentElement;try{var ai=Object.defineProperty({},"passive",{get:function(){ii=!0}}),si=document.createElement("div");si.addEventListener&&si.addEventListener("click",(function(){}),ai)}catch(gh){}}!function(e){e.IS_MAC=Hn,e.IS_IOS=_n,e.IS_WINDOWS=Un,e.IS_IE=Wn,e.IS_IE11=Jn,e.IS_EDGE=Xn,e.IS_NETSCAPE=Yn,e.IS_CHROME_APP=Zn,e.IS_CHROME=Kn,e.IS_OPERA=Qn,e.IS_FIREFOX=$n,e.IS_SAFARI=ei,e.SUPPORT_TOUCH=ti,e.SUPPORT_POINTER=ni,e.SUPPORT_PASSIVE=ii,e.NO_FOREIGNOBJECT=ri,e.SUPPORT_FOREIGNOBJECT=!e.NO_FOREIGNOBJECT}(qn||(qn={})),function(e){function t(){var e=window.module;return null!=e&&null!=e.hot&&null!=e.hot.status?e.hot.status():"unkonwn"}e.getHMRStatus=t,e.isApplyingHMR=function(){return"apply"===t()};var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};e.isEventSupported=function(e){var t=document.createElement(n[e]||"div"),i="on".concat(e),r=i in t;return r||(t.setAttribute(i,"return;"),r="function"==typeof t[i]),r}}(qn||(qn={}));var li=/[\t\r\n\f]/g,ui=/\S+/g,ci=function(e){return" ".concat(e," ")};function hi(e){return e&&e.getAttribute&&e.getAttribute("class")||""}function fi(e,t){if(null==e||null==t)return!1;var n=ci(hi(e)),i=ci(t);return 1===e.nodeType&&n.replace(li," ").includes(i)}function gi(e,t){if(null!=e&&null!=t){if("function"==typeof t)return gi(e,t(hi(e)));if("string"==typeof t&&1===e.nodeType){var n=t.match(ui)||[],i=ci(hi(e)).replace(li," "),r=n.reduce((function(e,t){return e.indexOf(ci(t))<0?"".concat(e).concat(t," "):e}),i);i!==(r=r.trim())&&e.setAttribute("class",r)}}}function di(e,t){if(null!=e){if("function"==typeof t)return di(e,t(hi(e)));if((!t||"string"==typeof t)&&1===e.nodeType){var n=(t||"").match(ui)||[],i=ci(hi(e)).replace(li," "),r=n.reduce((function(e,t){var n=ci(t);return e.indexOf(n)>-1?e.replace(n," "):e}),i);i!==(r=t?r.trim():"")&&e.setAttribute("class",r)}}}function vi(e,t,n){if(null!=e&&null!=t)if(null==n||"string"!=typeof t){if("function"==typeof t)return vi(e,t(hi(e),n),n);if("string"==typeof t)(t.match(ui)||[]).forEach((function(t){fi(e,t)?di(e,t):gi(e,t)}))}else n?gi(e,t):di(e,t)}var pi=0;function yi(e){return null!=e.id&&""!==e.id||(e.id="v".concat(pi+=1)),e.id}function mi(e){return null!=e&&("function"==typeof e.getScreenCTM&&e instanceof SVGElement)}var bi={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"};function ki(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).createElement(e)}function xi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bi.xhtml;return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document).createElementNS(t,e)}function wi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return xi(e,bi.svg,t)}function Pi(e){if(e){var t=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var i=new DOMParser;if(null!=n.async)i.async=n.async;t=i.parseFromString(e,n.mimeType||"text/xml")}catch(r){t=void 0}if(!t||t.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: ".concat(e));return t}('<svg xmlns="'.concat(bi.svg,'" xmlns:xlink="').concat(bi.xlink,'" version="').concat("1.1",'">').concat(e,"</svg>"),{async:!1});return t.documentElement}var n=document.createElementNS(bi.svg,"svg");return n.setAttributeNS(bi.xmlns,"xmlns:xlink",bi.xlink),n.setAttribute("version","1.1"),n}function Ci(e){for(var t=0,n=e.previousSibling;n;)1===n.nodeType&&(t+=1),n=n.previousSibling;return t}function Ai(e,t,n){for(var i=e.ownerSVGElement,r=e.parentNode;r&&r!==n&&r!==i;){if(fi(r,t))return r;r=r.parentNode}return null}function Oi(e,t){var n=t&&t.parentNode;return e===n||!!(n&&1===n.nodeType&&16&e.compareDocumentPosition(n))}function Ei(e){e&&(Array.isArray(e)?e:[e]).forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}function Mi(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Si(e,t){(Array.isArray(t)?t:[t]).forEach((function(t){null!=t&&e.appendChild(t)}))}function Ti(e,t){var n=e.parentNode;n&&(Array.isArray(t)?t:[t]).forEach((function(t){null!=t&&n.insertBefore(t,e)}))}function Ni(e){try{return e instanceof HTMLElement}catch(t){return"object"===b(e)&&1===e.nodeType&&"object"===b(e.style)&&"object"===b(e.ownerDocument)}}var ji,Li,Di=["viewBox","attributeName","attributeType","repeatCount","textLength","lengthAdjust","gradientUnits"];function Ii(e,t){var n=zi(t);n.ns?e.hasAttributeNS(n.ns,n.local)&&e.removeAttributeNS(n.ns,n.local):e.hasAttribute(t)&&e.removeAttribute(t)}function Ri(e,t,n){if(null==n)return Ii(e,t);var i=zi(t);i.ns&&"string"==typeof n?e.setAttributeNS(i.ns,t,n):"id"===t?e.id="".concat(n):e.setAttribute(t,"".concat(n))}function Vi(e,t){Object.keys(t).forEach((function(n){Ri(e,n,t[n])}))}function Bi(e,t,n){if(null==t){for(var i=e.attributes,r={},o=0;o<i.length;o+=1)r[i[o].name]=i[o].value;return r}if("string"==typeof t&&void 0===n)return e.getAttribute(t);"object"===b(t)?Vi(e,t):Ri(e,t,n)}function zi(e){if(-1!==e.indexOf(":")){var t=e.split(":");return{ns:bi[t[0]],local:t[1]}}return{ns:null,local:e}}function Fi(e){var t={};return Object.keys(e).forEach((function(n){var i=Di.includes(n)?n:Ln(n);t[i]=e[n]})),t}function Gi(e){var t={};return e.split(";").forEach((function(e){var n=e.trim();if(n){var i=n.split("=");i.length&&(t[i[0].trim()]=i[1]?i[1].trim():"")}})),t}function qi(e,t){return Object.keys(t).forEach((function(n){if("class"===n)e[n]=e[n]?"".concat(e[n]," ").concat(t[n]):t[n];else if("style"===n){var i,r,o="object"===b(e[n]),a="object"===b(t[n]);o&&a?(i=e[n],r=t[n]):o?(i=e[n],r=Gi(t[n])):a?(i=Gi(e[n]),r=t[n]):(i=Gi(e[n]),r=Gi(t[n])),e[n]=qi(i,r)}else e[n]=t[n]})),e}function Hi(e,t){for(var n,i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.offset||0,a=[],s=[],l=null,c=0;c<e.length;c+=1){n=s[c]=e[c];for(var h=0,f=t.length;h<f;h+=1){var g=t[h],d=g.start+o,v=g.end+o;c>=d&&c<v&&("string"==typeof n?n=s[c]={t:e[c],attrs:g.attrs}:n.attrs=qi(qi({},n.attrs),g.attrs),r.includeAnnotationIndices&&(null==n.annotations&&(n.annotations=[]),n.annotations.push(h)))}(i=s[c-1])?u(n)&&u(i)?JSON.stringify(n.attrs)===JSON.stringify(i.attrs)?l.t+=n.t:(a.push(l),l=n):u(n)||u(i)?(a.push(l),l=n):l=(l||"")+n:l=n}return null!=l&&a.push(l),a}!function(e){function t(e){var t="data:";return e.substr(0,5)===t}function n(e){var t,n=e.replace(/\s/g,""),i=(n=decodeURIComponent(n)).indexOf(","),r=n.slice(0,i),o=r.split(":")[1].split(";")[0],a=n.slice(i+1);t=r.indexOf("base64")>=0?atob(a):unescape(encodeURIComponent(a));for(var s=new Uint8Array(t.length),l=0;l<t.length;l+=1)s[l]=t.charCodeAt(l);return new Blob([s],{type:o})}function i(e,t){var n=window.navigator.msSaveBlob;if(n)n(e,t);else{var i=window.URL.createObjectURL(e),r=document.createElement("a");r.href=i,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i)}}function r(e){var t=parseFloat(e);return Number.isNaN(t)?null:t}e.isDataUrl=t,e.imageToDataUri=function(e,n){if(e&&!t(e)){var i=function(){n(new Error("Failed to load image: ".concat(e)))},r=window.FileReader?function(e){if(200===e.status){var t=new FileReader;t.onload=function(e){var t=e.target.result;n(null,t)},t.onerror=i,t.readAsDataURL(e.response)}else i()}:function(t){if(200===t.status){var r=e.split(".").pop()||"png";"svg"===r&&(r="svg+xml");var o="data:image/".concat(r,";base64,"),a=new Uint8Array(t.response),s=o+btoa(function(e){for(var t=[],n=0;n<e.length;n+=32768)t.push(String.fromCharCode.apply(null,e.subarray(n,n+32768)));return t.join("")}(a));n(null,s)}else i()},o=new XMLHttpRequest;o.responseType=window.FileReader?"blob":"arraybuffer",o.open("GET",e,!0),o.addEventListener("error",i),o.addEventListener("load",(function(){return r(o)})),o.send()}else setTimeout((function(){return n(null,e)}))},e.dataUriToBlob=n,e.downloadBlob=i,e.downloadDataUri=function(e,t){i(n(e),t)},e.svgToDataUrl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=function(t){return null==n&&(n=function(e){var t=e.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return t&&t[2]?t[2].replace(/\s+/," ").split(" "):null}(e)),null!=n?r(n[t]):null},o=function(t){var n=e.match(t);return n&&n[2]?r(n[2]):null},a=t.width;if(null==a&&(a=o(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==a&&(a=i(2)),null==a)throw new Error("Can not parse width from svg string");var s=t.height;if(null==s&&(s=o(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==s&&(s=i(3)),null==s)throw new Error("Can not parse height from svg string");var l=encodeURIComponent(e).replace(/'/g,"%27").replace(/"/g,"%22");return"".concat("data:image/svg+xml",",").concat(l)}}(ji||(ji={}));var _i,Ui={px:function(e){return e},mm:function(e){return Li*e},cm:function(e){return Li*e*10},in:function(e){return Li*e*25.4},pt:function(e){return Li*(25.4*e/72)},pc:function(e){return Li*(25.4*e/6)}};!function(e){function t(e,t,n){var i=document.createElement("div"),r=i.style;r.display="inline-block",r.position="absolute",r.left="-15000px",r.top="-15000px",r.width=e+(n||"px"),r.height=t+(n||"px"),document.body.appendChild(i);var o=i.getBoundingClientRect(),a={width:o.width||0,height:o.height||0};return document.body.removeChild(i),a}e.measure=t,e.toPx=function(e,n){null==Li&&(Li=t("1","1","mm").width);var i=n?Ui[n]:null;return i?i(e):e}}(_i||(_i={}));var Wi=/-(.)/g;var Ji={},Xi=["webkit","ms","moz","o"],Yi="undefined"!=typeof document?document.createElement("div").style:{};function Zi(e){var t=e.replace(Wi,(function(e,t){return t.toUpperCase()}));if(null==Ji[t]){var n=t.charAt(0).toUpperCase()+t.slice(1);Ji[t]=t in Yi?t:function(e){for(var t=0;t<Xi.length;t+=1){var n=Xi[t]+e;if(n in Yi)return n}return null}(n)}return Ji[t]}function Ki(e,t){var n=e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):window.getComputedStyle(e,null);return n&&t?n.getPropertyValue(t)||n[t]:n}var Qi={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function $i(e,t,n){if("string"!=typeof t)for(var i in t)$i(e,i,t[i]);else{var r=function(e){return/^--/.test(e)}(t);if(r||(t=Zi(t)),void 0===n)return function(e,t,n){var i=window.getComputedStyle(e,null);return n?i.getPropertyValue(t)||void 0:i[t]||e.style[t]}(e,t,r);r||(n=function(e,t){return Qi[e]||"number"!=typeof t?t:"".concat(t,"px")}(t,n));var o=e.style;r?o.setProperty(t,n):o[t]=n}}var er=new WeakMap;function tr(e,t){var n=Dt(t),i=er.get(e);if(i)return i[n]}function nr(e,t,n){if(!t){var i={};return Object.keys(er).forEach((function(t){i[t]=tr(e,t)})),i}if("string"==typeof t)return void 0===n?tr(e,t):void function(e,t,n){var i=Dt(t),r=er.get(e);r?r[i]=n:er.set(e,o({},i,n))}(e,t,n);for(var r in t)nr(e,r,t[r])}var ir=function(){function e(t,n,i){if(v(this,e),!t)throw new TypeError("Invalid element to create vector");var r;if(e.isVector(t))r=t.node;else if("string"==typeof t)if("svg"===t.toLowerCase())r=Pi();else if("<"===t[0]){var o=Pi(t);r=document.importNode(o.firstChild,!0)}else r=document.createElementNS(bi.svg,t);else r=t;this.node=r,n&&this.setAttributes(n),i&&this.append(i)}return y(e,[{key:Symbol.toStringTag,get:function(){return e.toStringTag}},{key:"type",get:function(){return this.node.nodeName}},{key:"id",get:function(){return this.node.id},set:function(e){this.node.id=e}},{key:"transform",value:function(e,t){return null==e?Sr(this.node):(Sr(this.node,e,t),this)}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return null==e?Tr(this.node):(Tr(this.node,e,t,n),this)}},{key:"rotate",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return null==e?Nr(this.node):(Nr(this.node,e,t,n,i),this)}},{key:"scale",value:function(e,t){return null==e?jr(this.node):(jr(this.node,e,t),this)}},{key:"getTransformToElement",value:function(t){var n=e.toNode(t);return Lr(this.node,n)}},{key:"removeAttribute",value:function(e){return Ii(this.node,e),this}},{key:"getAttribute",value:function(e){return function(e,t){return e.getAttribute(t)}(this.node,e)}},{key:"setAttribute",value:function(e,t){return Ri(this.node,e,t),this}},{key:"setAttributes",value:function(e){return Vi(this.node,e),this}},{key:"attr",value:function(e,t){return null==e?Bi(this.node):"string"==typeof e&&void 0===t?Bi(this.node,e):("object"===b(e)?Bi(this.node,e):Bi(this.node,e,t),this)}},{key:"svg",value:function(){return this.node instanceof SVGSVGElement?this:e.create(this.node.ownerSVGElement)}},{key:"defs",value:function(){var t=this.svg()||this,n=t.node.getElementsByTagName("defs")[0];return n?e.create(n):e.create("defs").appendTo(t)}},{key:"text",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return sr(this.node,e,t),this}},{key:"tagName",value:function(){return function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.nodeName;return t?n.toLowerCase():n.toUpperCase()}(this.node)}},{key:"clone",value:function(){return e.create(this.node.cloneNode(!0))}},{key:"remove",value:function(){return Ei(this.node),this}},{key:"empty",value:function(){return Mi(this.node),this}},{key:"append",value:function(t){return Si(this.node,e.toNodes(t)),this}},{key:"appendTo",value:function(t){return function(e,t){null!=t&&t.appendChild(e)}(this.node,e.isVector(t)?t.node:t),this}},{key:"prepend",value:function(t){return function(e,t){var n=e.firstChild;n?Ti(n,t):Si(e,t)}(this.node,e.toNodes(t)),this}},{key:"before",value:function(t){return Ti(this.node,e.toNodes(t)),this}},{key:"replace",value:function(t){return this.node.parentNode&&this.node.parentNode.replaceChild(e.toNode(t),this.node),e.create(t)}},{key:"first",value:function(){return this.node.firstChild?e.create(this.node.firstChild):null}},{key:"last",value:function(){return this.node.lastChild?e.create(this.node.lastChild):null}},{key:"get",value:function(t){var n=this.node.childNodes[t];return n?e.create(n):null}},{key:"indexOf",value:function(t){return Array.prototype.slice.call(this.node.childNodes).indexOf(e.toNode(t))}},{key:"find",value:function(t){var n=[],i=function(e,t){return e.querySelectorAll(t)}(this.node,t);if(i)for(var r=0,o=i.length;r<o;r+=1)n.push(e.create(i[r]));return n}},{key:"findOne",value:function(t){var n=function(e,t){return e.querySelector(t)}(this.node,t);return n?e.create(n):null}},{key:"findParentByClass",value:function(t,n){var i=Ai(this.node,t,n);return i?e.create(i):null}},{key:"matches",value:function(e){var t=this.node;this.node.matches;var n=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||null;return n&&n.call(t,e)}},{key:"contains",value:function(t){return Oi(this.node,e.isVector(t)?t.node:t)}},{key:"wrap",value:function(t){var n=e.create(t),i=this.node.parentNode;return null!=i&&i.insertBefore(n.node,this.node),n.append(this)}},{key:"parent",value:function(t){var n=this;if(null==n.node.parentNode)return null;if(n=e.create(n.node.parentNode),null==t)return n;do{if("string"==typeof t?n.matches(t):n instanceof t)return n}while(n=e.create(n.node.parentNode));return n}},{key:"children",value:function(){for(var t=this.node.childNodes,n=[],i=0;i<t.length;i+=1){1===t[i].nodeType&&n.push(e.create(t[i]))}return n}},{key:"eachChild",value:function(e,t){for(var n=this.children(),i=0,r=n.length;i<r;i+=1)e.call(n[i],n[i],i,n),t&&n[i].eachChild(e,t);return this}},{key:"index",value:function(){return Ci(this.node)}},{key:"hasClass",value:function(e){return fi(this.node,e)}},{key:"addClass",value:function(e){return gi(this.node,e),this}},{key:"removeClass",value:function(e){return di(this.node,e),this}},{key:"toggleClass",value:function(e,t){return vi(this.node,e,t),this}},{key:"toLocalPoint",value:function(e,t){return function(e,t,n){var i=e instanceof SVGSVGElement?e:e.ownerSVGElement,r=i.createSVGPoint();r.x=t,r.y=n;try{var o=i.getScreenCTM(),a=r.matrixTransform(o.inverse()),s=Lr(e,i).inverse();return a.matrixTransform(s)}catch(l){return r}}(this.node,e,t)}},{key:"sample",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.node instanceof SVGPathElement?function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=e.getTotalLength(),r=[],o=0;for(;o<i;)t=e.getPointAtLength(o),r.push({distance:o,x:t.x,y:t.y}),o+=n;return r}(this.node,e):[]}},{key:"toPath",value:function(){return e.create(function(e){var t=wi("path");Bi(t,Bi(e));var n=pr(e);n&&t.setAttribute("d",n);return t}(this.node))}},{key:"toPathData",value:function(){return pr(this.node)}}])}();function rr(e,t,n){for(var i,r=n.eol,o=n.baseSize,a=n.lineHeight,s=0,l={},u=t.length-1,c=0;c<=u;c+=1){var h=t[c],f=null;if("object"===b(h)){var g=h.attrs,d=ir.create("tspan",g);i=d.node;var v=h.t;r&&c===u&&(v+=r),i.textContent=v;var p=g.class;p&&d.addClass(p),n.includeAnnotationIndices&&d.attr("annotations",h.annotations.join(",")),void 0===(f=parseFloat(g["font-size"]))&&(f=o),f&&f>s&&(s=f)}else r&&c===u&&(h+=r),i=document.createTextNode(h||" "),o&&o>s&&(s=o);e.appendChild(i)}return s&&(l.maxFontSize=s),a?l.lineHeight=a:s&&(l.lineHeight=1.2*s),l}!function(e){function t(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&i.node instanceof SVGElement&&"function"==typeof i.sample&&"function"==typeof i.toPath}function n(t,n,i){return new e(t,n,i)}function i(e){return t(e)?e.node:e}e.toStringTag="X6.".concat(e.name),e.isVector=t,e.create=n,e.createVectors=function(e){if("<"===e[0]){for(var t=Pi(e),i=[],r=0,o=t.childNodes.length;r<o;r+=1){var a=t.childNodes[r];i.push(n(document.importNode(a,!0)))}return i}return[n(e)]},e.toNode=i,e.toNodes=function(e){return Array.isArray(e)?e.map((function(e){return i(e)})):[i(e)]}}(ir||(ir={}));var or=/em$/;function ar(e,t){var n=parseFloat(e);return or.test(e)?n*t:n}function sr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=function(e){return e.replace(/ /g," ")}(t);var i=n.eol,r=n.textPath,o=n.textVerticalAnchor,a="middle"===o||"bottom"===o||"top"===o,s=n.x;void 0===s&&(s=e.getAttribute("x")||0);var l=n.includeAnnotationIndices,u=n.annotations;u&&!Array.isArray(u)&&(u=[u]);var c=n.lineHeight,h="auto"===c,f=h?"1.5em":c||"1em",g=!0,d=e.childNodes;if(1===d.length){var v=d[0];v&&"TITLE"===v.tagName.toUpperCase()&&(g=!1)}g&&Mi(e),Bi(e,{"xml:space":"preserve",display:t||n.displayEmpty?null:"none"});var p,y,m=Bi(e,"font-size"),k=parseFloat(m);k||(k=16,!a&&!u||m||Bi(e,"font-size","".concat(k))),r?("string"==typeof r&&(r={d:r}),p=function(e,t){var n=ir.create(t),i=ir.create("textPath"),r=e.d;if(r&&void 0===e["xlink:href"]){var o=ir.create("path").attr("d",r).appendTo(n.defs());i.attr("xlink:href","#".concat(o.id))}return"object"===b(e)&&i.attr(e),i.node}(r,e)):p=document.createDocumentFragment();for(var x,w=0,P=t.split("\n"),C=[],A=P.length-1,O=0;O<=A;O+=1){y=f;var E="v-line",M=wi("tspan"),S=void 0,T=P[O];if(T)if(u){var N=(S=rr(M,Hi(T,u,{offset:-w,includeAnnotationIndices:l}),{eol:O!==A&&i,baseSize:k,lineHeight:h?null:f,includeAnnotationIndices:l})).lineHeight;N&&h&&0!==O&&(y=N),0===O&&(x=.8*S.maxFontSize)}else i&&O!==A&&(T+=i),M.textContent=T;else{M.textContent="-",E+=" v-empty-line";var j=M.style;j.fillOpacity=0,j.strokeOpacity=0,u&&(S={})}S&&C.push(S),O>0&&M.setAttribute("dy",y),(O>0||r)&&M.setAttribute("x",s),M.className.baseVal=E,p.appendChild(M),w+=T.length+1}if(a)if(u)y=function(e,t,n,i){if(!Array.isArray(t))return 0;var r=t.length;if(!r)return 0;for(var o=t[0],a=ar(o.maxFontSize,n)||n,s=0,l=ar(i,n),u=1;u<r;u+=1)s+=ar((o=t[u]).lineHeight,n)||l;var c,h=ar(o.maxFontSize,n)||n;switch(e){case"middle":c=a/2-.15*h-s/2;break;case"bottom":c=-.25*h-s;break;default:c=.8*a}return c}(o,C,k,f);else if("top"===o)y="0.8em";else{var L;switch(A>0?(L=parseFloat(f)||1,L*=A,or.test(f)||(L/=k)):L=0,o){case"middle":y="".concat(.3-L/2,"em");break;case"bottom":y="".concat(-L-.3,"em")}}else 0===o?y="0em":o?y=o:(y=0,null==e.getAttribute("y")&&e.setAttribute("y","".concat(x||"0.8em")));p.firstChild.setAttribute("dy",y),e.appendChild(p)}function lr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement("canvas").getContext("2d");if(!e)return{width:0};var i=[],r=t["font-size"]?"".concat(parseFloat(t["font-size"]),"px"):"14px";return i.push(t["font-style"]||"normal"),i.push(t["font-variant"]||"normal"),i.push(t["font-weight"]||400),i.push(r),i.push(t["font-family"]||"sans-serif"),n.font=i.join(" "),n.measureText(e)}function ur(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t>=n)return[e,""];var r=e.length,o={},a=Math.round(t/n*r-1);for(a<0&&(a=0);a>=0&&a<r;){var s=e.slice(0,a),l=o[s]||lr(s,i).width,u=e.slice(0,a+1),c=o[u]||lr(u,i).width;if(o[s]=l,o[u]=c,l>t)a-=1;else{if(!(c<=t))break;a+=1}}return[e.slice(0,a),e.slice(a)]}function cr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=t.width,a=t.height,s=i.eol||"\n",l=n.fontSize||14,u=n.lineHeight?parseFloat(n.lineHeight):Math.ceil(1.4*l),c=Math.floor(a/u);if(e.indexOf(s)>-1){var h=Rn(),g=[];return e.split(s).map((function(e){var r=cr(e,Object.assign(Object.assign({},t),{height:Number.MAX_SAFE_INTEGER}),n,Object.assign(Object.assign({},i),{eol:h}));r&&g.push.apply(g,f(r.split(h)))})),g.slice(0,c).join(s)}var d=lr(e,n).width;if(d<o)return e;var v=[],p=e,y=d,m=i.ellipsis,b=0;m&&("string"!=typeof m&&(m="…"),b=lr(m,n).width);for(var k=0;k<c;k+=1){if(!(y>o)){v.push(p);break}if(k===c-1){var x=r(ur(p,o-b,y,n),1)[0];v.push(m?"".concat(x).concat(m):x)}else{var w=r(ur(p,o,y,n),2),P=w[0],C=w[1];v.push(P),y=lr(p=C,n).width}}return v.join(s)}var hr=.551784;function fr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN,i=e.getAttribute(t);if(null==i)return n;var r=parseFloat(i);return Number.isNaN(r)?n:r}function gr(e){var t=e.map((function(e){return"".concat(e.x," ").concat(e.y)}));return"M ".concat(t.join(" L"))}function dr(e){var t=[],n=e.points;if(n)for(var i=0,r=n.numberOfItems;i<r;i+=1)t.push(n.getItem(i));return t}function vr(e){var t=e.x,n=e.y,i=e.width,r=e.height,o=Math.min(e.rx||e["top-rx"]||0,i/2),a=Math.min(e.rx||e["bottom-rx"]||0,i/2),s=Math.min(e.ry||e["top-ry"]||0,r/2),l=Math.min(e.ry||e["bottom-ry"]||0,r/2);return(o||a||s||l?["M",t,n+s,"v",r-s-l,"a",a,l,0,0,0,a,l,"h",i-2*a,"a",a,l,0,0,0,a,-l,"v",-(r-l-s),"a",o,s,0,0,0,-o,-s,"h",-(i-2*o),"a",o,s,0,0,0,-o,s,"Z"]:["M",t,n,"H",t+i,"V",n+r,"H",t,"V",n,"Z"]).join(" ")}function pr(e){var t,n=e.tagName.toLowerCase();switch(n){case"path":return e.getAttribute("d");case"line":return function(e){return["M",fr(e,"x1"),fr(e,"y1"),"L",fr(e,"x2"),fr(e,"y2")].join(" ")}(e);case"polygon":return 0===(t=dr(e)).length?null:"".concat(gr(t)," Z");case"polyline":return function(e){var t=dr(e);return 0===t.length?null:gr(t)}(e);case"ellipse":return function(e){var t=fr(e,"cx",0),n=fr(e,"cy",0),i=fr(e,"rx"),r=fr(e,"ry")||i,o=i*hr,a=r*hr;return["M",t,n-r,"C",t+o,n-r,t+i,n-a,t+i,n,"C",t+i,n+a,t+o,n+r,t,n+r,"C",t-o,n+r,t-i,n+a,t-i,n,"C",t-i,n-a,t-o,n-r,t,n-r,"Z"].join(" ")}(e);case"circle":return function(e){var t=fr(e,"cx",0),n=fr(e,"cy",0),i=fr(e,"r"),r=i*hr;return["M",t,n-i,"C",t+r,n-i,t+i,n-r,t+i,n,"C",t+i,n+r,t+r,n+i,t,n+i,"C",t-r,n+i,t-i,n+r,t-i,n,"C",t-i,n-r,t-r,n-i,t,n-i,"Z"].join(" ")}(e);case"rect":return function(e){return vr({x:fr(e,"x",0),y:fr(e,"y",0),width:fr(e,"width",0),height:fr(e,"height",0),rx:fr(e,"rx",0),ry:fr(e,"ry",0)})}(e)}throw new Error('"'.concat(n,'" cannot be converted to svg path element.'))}var yr,mr,br,kr=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,xr=/[ ,]+/,wr=/^(\w+)\((.*)\)/;function Pr(e){var t=wi("svg").createSVGMatrix();if(null!=e){var n=e,i=t;for(var r in n)i[r]=n[r]}return t}function Cr(e){var t=wi("svg");return null!=e?(e instanceof DOMMatrix||(e=Pr(e)),t.createSVGTransformFromMatrix(e)):t.createSVGTransform()}function Ar(e){var t=Pr(),n=null!=e&&e.match(kr);if(!n)return t;for(var i=0,r=n.length;i<r;i+=1){var o=n[i].match(wr);if(o){var a=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=Pr(),f=o[2].split(xr);switch(o[1].toLowerCase()){case"scale":a=parseFloat(f[0]),s=void 0===f[1]?a:parseFloat(f[1]),h=h.scaleNonUniform(a,s);break;case"translate":l=parseFloat(f[0]),u=parseFloat(f[1]),h=h.translate(l,u);break;case"rotate":c=parseFloat(f[0]),l=parseFloat(f[1])||0,u=parseFloat(f[2])||0,h=0!==l||0!==u?h.translate(l,u).rotate(c).translate(-l,-u):h.rotate(c);break;case"skewx":c=parseFloat(f[0]),h=h.skewX(c);break;case"skewy":c=parseFloat(f[0]),h=h.skewY(c);break;case"matrix":h.a=parseFloat(f[0]),h.b=parseFloat(f[1]),h.c=parseFloat(f[2]),h.d=parseFloat(f[3]),h.e=parseFloat(f[4]),h.f=parseFloat(f[5]);break;default:continue}t=t.multiply(h)}}return t}function Or(e){var t=e||{},n=null!=t.a?t.a:1,i=null!=t.b?t.b:0,r=null!=t.c?t.c:0,o=null!=t.d?t.d:1,a=null!=t.e?t.e:0,s=null!=t.f?t.f:0;return"matrix(".concat(n,",").concat(i,",").concat(r,",").concat(o,",").concat(a,",").concat(s,")")}function Er(e){var t,n,i;if(e){var r=xr;if(e.trim().indexOf("matrix")>=0){var o=function(e){var t=Mr(e,{x:0,y:1}),n=Mr(e,{x:1,y:0}),i=180/Math.PI*Math.atan2(t.y,t.x)-90,r=180/Math.PI*Math.atan2(n.y,n.x);return{skewX:i,skewY:r,translateX:e.e,translateY:e.f,scaleX:Math.sqrt(e.a*e.a+e.b*e.b),scaleY:Math.sqrt(e.c*e.c+e.d*e.d),rotation:i}}(Ar(e));t=[o.translateX,o.translateY],n=[o.rotation],i=[o.scaleX,o.scaleY];var a=[];0===t[0]&&0===t[1]||a.push("translate(".concat(t.join(","),")")),1===i[0]&&1===i[1]||a.push("scale(".concat(i.join(","),")")),0!==n[0]&&a.push("rotate(".concat(n[0],")")),e=a.join(" ")}else{var s=e.match(/translate\((.*?)\)/);s&&(t=s[1].split(r));var l=e.match(/rotate\((.*?)\)/);l&&(n=l[1].split(r));var u=e.match(/scale\((.*?)\)/);u&&(i=u[1].split(r))}}var c=i&&i[0]?parseFloat(i[0]):1;return{raw:e||"",translation:{tx:t&&t[0]?parseInt(t[0],10):0,ty:t&&t[1]?parseInt(t[1],10):0},rotation:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:c,sy:i&&i[1]?parseFloat(i[1]):c}}}function Mr(e,t){return{x:t.x*e.a+t.y*e.c+0,y:t.x*e.b+t.y*e.d+0}}function Sr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==t)return Ar(Bi(e,"transform"));if(n.absolute)e.setAttribute("transform",Or(t));else{var i=e.transform,r=Cr(t);i.baseVal.appendItem(r)}}function Tr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=Bi(e,"transform"),o=Er(r);if(null==t)return o.translation;r=(r=o.raw).replace(/translate\([^)]*\)/g,"").trim();var a=i.absolute?t:o.translation.tx+t,s=i.absolute?n:o.translation.ty+n,l="translate(".concat(a,",").concat(s,")");e.setAttribute("transform","".concat(l," ").concat(r).trim())}function Nr(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=Bi(e,"transform"),a=Er(o);if(null==t)return a.rotation;o=(o=a.raw).replace(/rotate\([^)]*\)/g,"").trim(),t%=360;var s=r.absolute?t:a.rotation.angle+t,l=null!=n&&null!=i?",".concat(n,",").concat(i):"",u="rotate(".concat(s).concat(l,")");e.setAttribute("transform","".concat(o," ").concat(u).trim())}function jr(e,t,n){var i=Bi(e,"transform"),r=Er(i);if(null==t)return r.scale;n=null==n?t:n,i=(i=r.raw).replace(/scale\([^)]*\)/g,"").trim();var o="scale(".concat(t,",").concat(n,")");e.setAttribute("transform","".concat(i," ").concat(o).trim())}function Lr(e,t){if(mi(t)&&mi(e)){var n=t.getScreenCTM(),i=e.getScreenCTM();if(n&&i)return n.inverse().multiply(i)}return Pr()}!function(e){var t={};e.get=function(e){return t[e]||{}},e.register=function(e,n){t[e]=n},e.unregister=function(e){delete t[e]}}(yr||(yr={})),function(e){var t=new WeakMap;e.ensure=function(e){return t.has(e)||t.set(e,{events:Object.create(null)}),t.get(e)},e.get=function(e){return t.get(e)},e.remove=function(e){return t.delete(e)}}(mr||(mr={})),function(e){e.returnTrue=function(){return!0},e.returnFalse=function(){return!1},e.stopPropagationCallback=function(e){e.stopPropagation()},e.addEventListener=function(e,t,n){null!=e.addEventListener&&e.addEventListener(t,n)},e.removeEventListener=function(e,t,n){null!=e.removeEventListener&&e.removeEventListener(t,n)}}(br||(br={})),function(e){var t=/[^\x20\t\r\n\f]+/g,n=/^([^.]*)(?:\.(.+)|)/;e.splitType=function(e){return(e||"").match(t)||[""]},e.normalizeType=function(e){var t=n.exec(e)||[];return{originType:t[1]?t[1].trim():t[1],namespaces:t[2]?t[2].split(".").map((function(e){return e.trim()})).sort():[]}},e.isValidTarget=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},e.isValidSelector=function(e,t){if(t){var n=e;return null!=n.querySelector&&null!=n.querySelector(t)}return!0}}(br||(br={})),function(e){var t=0,n=new WeakMap;e.ensureHandlerId=function(e){return n.has(e)||(n.set(e,t),t+=1),n.get(e)},e.getHandlerId=function(e){return n.get(e)},e.removeHandlerId=function(e){return n.delete(e)},e.setHandlerId=function(e,t){return n.set(e,t)}}(br||(br={})),function(e){e.getHandlerQueue=function(e,t){var n=[],i=mr.get(e),r=i&&i.events&&i.events[t.type],o=r&&r.handlers||[],a=r?r.delegateCount:0;if(a>0&&!("click"===t.type&&"number"==typeof t.button&&t.button>=1))for(var s=t.target;s!==e;s=s.parentNode||e)if(1===s.nodeType&&("click"!==t.type||!0!==s.disabled)){for(var l=[],u={},c=function(){var t=o[h],n=t.selector;if(null!=n&&null==u[n]){var i=[];e.querySelectorAll(n).forEach((function(e){i.push(e)})),u[n]=i.includes(s)}u[n]&&l.push(t)},h=0;h<a;h+=1)c();l.length&&n.push({elem:s,handlers:l})}return a<o.length&&n.push({elem:e,handlers:o.slice(a)}),n}}(br||(br={})),function(e){e.isWindow=function(e){return null!=e&&e===e.window}}(br||(br={})),function(e){e.contains=function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}}(br||(br={}));var Dr=y((function e(t,n){var i=this;v(this,e),this.isDefaultPrevented=br.returnFalse,this.isPropagationStopped=br.returnFalse,this.isImmediatePropagationStopped=br.returnFalse,this.isSimulated=!1,this.preventDefault=function(){var e=i.originalEvent;i.isDefaultPrevented=br.returnTrue,e&&!i.isSimulated&&e.preventDefault()},this.stopPropagation=function(){var e=i.originalEvent;i.isPropagationStopped=br.returnTrue,e&&!i.isSimulated&&e.stopPropagation()},this.stopImmediatePropagation=function(){var e=i.originalEvent;i.isImmediatePropagationStopped=br.returnTrue,e&&!i.isSimulated&&e.stopImmediatePropagation(),i.stopPropagation()},"string"==typeof t?this.type=t:t.type&&(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?br.returnTrue:br.returnFalse,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.timeStamp=t.timeStamp),n&&Object.assign(this,n),this.timeStamp||(this.timeStamp=Date.now())}));!function(e){e.create=function(t){return t instanceof e?t:new e(t)}}(Dr||(Dr={})),function(e){e.addProperty=function(t,n){Object.defineProperty(e.prototype,t,{enumerable:!0,configurable:!0,get:"function"==typeof n?function(){if(this.originalEvent)return n(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})}}(Dr||(Dr={})),function(e){var t={bubbles:!0,cancelable:!0,eventPhase:!0,detail:!0,view:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pageX:!0,pageY:!0,screenX:!0,screenY:!0,toElement:!0,pointerId:!0,pointerType:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,touches:!0,changedTouches:!0,targetTouches:!0,which:!0,altKey:!0,ctrlKey:!0,metaKey:!0,shiftKey:!0};Object.keys(t).forEach((function(n){return e.addProperty(n,t[n])}))}(Dr||(Dr={})),yr.register("load",{noBubble:!0}),yr.register("beforeunload",{postDispatch:function(e,t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}),yr.register("mouseenter",{delegateType:"mouseover",bindType:"mouseover",handle:function(e,t){var n,i=t.relatedTarget,r=t.handleObj;return i&&(i===e||br.contains(e,i))||(t.type=r.originType,n=r.handler.call(e,t),t.type="mouseover"),n}}),yr.register("mouseleave",{delegateType:"mouseout",bindType:"mouseout",handle:function(e,t){var n,i=t.relatedTarget,r=t.handleObj;return i&&(i===e||br.contains(e,i))||(t.type=r.originType,n=r.handler.call(e,t),t.type="mouseout"),n}});var Ir,Rr,Vr,Br=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};!function(e){var t;function n(e,t){var n=Dr.create(t);n.delegateTarget=e;var i=yr.get(n.type);if(!i.preDispatch||!1!==i.preDispatch(e,n)){for(var r=br.getHandlerQueue(e,n),o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];for(var l=0,u=r.length;l<u&&!n.isPropagationStopped();l+=1){var c=r[l];n.currentTarget=c.elem;for(var h=0,f=c.handlers.length;h<f&&!n.isImmediatePropagationStopped();h+=1){var g=c.handlers[h];if(null==n.rnamespace||g.namespace&&n.rnamespace.test(g.namespace)){var d;n.handleObj=g,n.data=g.data;var v=yr.get(g.originType).handle,p=v?v.apply(void 0,[c.elem,n].concat(a)):(d=g.handler).call.apply(d,[c.elem,n].concat(a));void 0!==p&&(n.result=p,!1===p&&(n.preventDefault(),n.stopPropagation()))}}}return i.postDispatch&&i.postDispatch(e,n),n.result}}e.on=function(e,i,r,o,a){if(br.isValidTarget(e)){var s;if("function"!=typeof r){var l=r,u=l.handler,c=l.selector,h=Br(r,["handler","selector"]);r=u,a=c,s=h}var f=mr.ensure(e),g=f.handler;null==g&&(g=f.handler=function(i){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return t!==i.type?n.apply(void 0,[e,i].concat(o)):void 0});var d=br.ensureHandlerId(r);br.splitType(i).forEach((function(t){var n=br.normalizeType(t),i=n.originType,l=n.namespaces;if(i){var u=i,c=yr.get(u);u=(a?c.delegateType:c.bindType)||u,c=yr.get(u);var h=Object.assign({type:u,originType:i,data:o,selector:a,guid:d,handler:r,namespace:l.join(".")},s),v=f.events,p=v[u];p||(p=v[u]={handlers:[],delegateCount:0},c.setup&&!1!==c.setup(e,o,l,g)||br.addEventListener(e,u,g)),c.add&&(br.removeHandlerId(h.handler),c.add(e,h),br.setHandlerId(h.handler,d)),a?(p.handlers.splice(p.delegateCount,0,h),p.delegateCount+=1):p.handlers.push(h)}}))}},e.off=function e(t,n,i,r,o){var a=mr.get(t);if(a){var s=a.events;s&&(br.splitType(n).forEach((function(n){var l=br.normalizeType(n),u=l.originType,c=l.namespaces;if(u){var h=u,f=yr.get(h);h=(r?f.delegateType:f.bindType)||h;var g=s[h];if(g){for(var d=c.length>0?new RegExp("(^|\\.)".concat(c.join("\\.(?:.*\\.|)"),"(\\.|$)")):null,v=g.handlers.length,p=g.handlers.length-1;p>=0;p-=1){var y=g.handlers[p];!o&&u!==y.originType||i&&br.getHandlerId(i)!==y.guid||!(null==d||y.namespace&&d.test(y.namespace))||!(null==r||r===y.selector||"**"===r&&y.selector)||(g.handlers.splice(p,1),y.selector&&(g.delegateCount-=1),f.remove&&f.remove(t,y))}v&&0===g.handlers.length&&(f.teardown&&!1!==f.teardown(t,c,a.handler)||br.removeEventListener(t,h,a.handler),delete s[h])}}else Object.keys(s).forEach((function(o){e(t,o+n,i,r,!0)}))})),0===Object.keys(s).length&&mr.remove(t))}},e.dispatch=n,e.trigger=function(e,n,i,r){var o=e,a="string"==typeof e?e:e.type,s="string"==typeof e||null==o.namespace?[]:o.namespace.split("."),l=i;if(3!==l.nodeType&&8!==l.nodeType){a.indexOf(".")>-1&&(s=a.split("."),a=s.shift(),s.sort());var u=a.indexOf(":")<0&&"on".concat(a);(o=e instanceof Dr?e:new Dr(a,"object"===b(e)?e:null)).namespace=s.join("."),o.rnamespace=o.namespace?new RegExp("(^|\\.)".concat(s.join("\\.(?:.*\\.|)"),"(\\.|$)")):null,o.result=void 0,o.target||(o.target=l);var c=[o];Array.isArray(n)?c.push.apply(c,f(n)):c.push(n);var h=yr.get(a);if(r||!h.trigger||!1!==h.trigger(l,o,n)){var g,d=[l];if(!r&&!h.noBubble&&!br.isWindow(l)){g=h.delegateType||a;for(var v=l,p=l.parentNode;null!=p;)d.push(p),v=p,p=p.parentNode;if(v===(l.ownerDocument||document)){var y=v.defaultView||v.parentWindow||window;d.push(y)}}for(var m=l,k=0,x=d.length;k<x&&!o.isPropagationStopped();k+=1){var w=d[k];m=w,o.type=k>1?g:h.bindType||a;var P,C=mr.get(w);if(C)if(C.events[o.type]&&C.handler)(P=C.handler).call.apply(P,[w].concat(c));var A=u&&w[u]||null;A&&br.isValidTarget(w)&&(o.result=A.call.apply(A,[w].concat(c)),!1===o.result&&o.preventDefault())}if(o.type=a,!r&&!o.isDefaultPrevented()){var O=h.preventDefault;if((null==O||!1===O(d.pop(),o,n))&&br.isValidTarget(l)&&u&&"function"==typeof l[a]&&!br.isWindow(l)){var E=l[u];E&&(l[u]=null),t=a,o.isPropagationStopped()&&m.addEventListener(a,br.stopPropagationCallback),l[a](),o.isPropagationStopped()&&m.removeEventListener(a,br.stopPropagationCallback),t=void 0,E&&(l[u]=E)}}return o.result}}}}(Ir||(Ir={})),function(e){e.on=function(e,t,n,i,r){return Vr.on(e,t,n,i,r),e},e.once=function(e,t,n,i,r){return Vr.on(e,t,n,i,r,!0),e},e.off=function(e,t,n,i){return Vr.off(e,t,n,i),e},e.trigger=function(e,t,n,i){return Ir.trigger(t,n,e,i),e}}(Rr||(Rr={})),function(e){e.on=function t(n,i,r,o,a,s){if("object"===b(i))return"string"!=typeof r&&(o=o||r,r=void 0),void Object.keys(i).forEach((function(e){return t(n,e,r,o,i[e],s)}));if(null==o&&null==a?(a=r,o=r=void 0):null==a&&("string"==typeof r?(a=o,o=void 0):(a=o,o=r,r=void 0)),!1===a)a=br.returnFalse;else if(!a)return;if(s){var l=a;a=function(t){e.off(n,t);for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return l.call.apply(l,[this,t].concat(r))},br.setHandlerId(a,br.ensureHandlerId(l))}Ir.on(n,i,a,o,r)},e.off=function e(t,n,i,r){var o=n;if(o&&null!=o.preventDefault&&null!=o.handleObj){var a=o.handleObj;e(o.delegateTarget,a.namespace?"".concat(a.originType,".").concat(a.namespace):a.originType,a.selector,a.handler)}else if("object"!==b(n))!1!==i&&"function"!=typeof i||(r=i,i=void 0),!1===r&&(r=br.returnFalse),Ir.off(t,n,r,i);else{var s=n;Object.keys(s).forEach((function(n){return e(t,n,i,s[n])}))}}}(Vr||(Vr={}));var zr=function(){return y((function e(t,n,i){v(this,e),this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=qn.isEventSupported("wheel")?"wheel":"mousewheel",this.target=t,this.onWheelCallback=n,this.onWheelGuard=i,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}),[{key:"enable",value:function(){this.target.addEventListener(this.eventName,this.onWheel,{passive:!1})}},{key:"disable",value:function(){this.target.removeEventListener(this.eventName,this.onWheel)}},{key:"onWheel",value:function(e){var t,n=this;(null==this.onWheelGuard||this.onWheelGuard(e))&&(this.deltaX+=e.deltaX,this.deltaY+=e.deltaY,e.preventDefault(),0===this.deltaX&&0===this.deltaY||(e.stopPropagation(),t=!0),!0===t&&0===this.animationFrameId&&(this.animationFrameId=requestAnimationFrame((function(){n.didWheel(e)}))))}},{key:"didWheel",value:function(e){this.animationFrameId=0,this.onWheelCallback(e,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}])}();function Fr(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,i=null;return function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];i&&clearTimeout(i),i=window.setTimeout((function(){e.apply(t,o)}),n)}}var Gr,qr="undefined"!=typeof ResizeObserver?function(e){var t=null,n=[],i=Fr((function(){n.forEach((function(t){t(e)}))})),r=function(){t&&(t.disconnect(),n=[],t=null)};return{element:e,bind:function(r){var o;t||((o=new ResizeObserver(i)).observe(e),i(),t=o),-1===n.indexOf(r)&&n.push(r)},destroy:r,unbind:function(e){var i=n.indexOf(e);-1!==i&&n.splice(i,1),0===n.length&&t&&r()}}}:function(e){var t=null,n=[],i=Fr((function(){n.forEach((function(t){return t(e)}))})),r=function(){t&&t.parentNode&&(t.contentDocument&&t.contentDocument.defaultView.removeEventListener("resize",i),t.parentNode.removeChild(t),t=null,n=[])};return{element:e,bind:function(r){t||(t=function(){"static"===getComputedStyle(e).position&&(e.style.position="relative");var t=document.createElement("object");return t.onload=function(){t.contentDocument.defaultView.addEventListener("resize",i),i()},t.style.display="block",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.height="100%",t.style.width="100%",t.style.overflow="hidden",t.style.pointerEvents="none",t.style.zIndex="-1",t.style.opacity="0",t.setAttribute("tabindex","-1"),t.type="text/html",e.appendChild(t),t.data="about:blank",t}()),-1===n.indexOf(r)&&n.push(r)},destroy:r,unbind:function(e){var i=n.indexOf(e);-1!==i&&n.splice(i,1),0===n.length&&t&&r()}}};!function(e){var t=new WeakMap;function n(e){var n=t.get(e);return n||(n=qr(e),t.set(e,n),n)}e.bind=function(e,t){var i=n(e);return i.bind(t),function(){return i.unbind(t)}},e.clear=function(e){!function(e){e.destroy(),t.delete(e.element)}(n(e))}}(Gr||(Gr={}));var Hr,_r=function(){return y((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,e),this.comparator=t.comparator||e.defaultComparator,this.index={},this.data=t.data||[],this.heapify()}),[{key:"isEmpty",value:function(){return 0===this.data.length}},{key:"insert",value:function(e,t,n){var i={priority:e,value:t},r=this.data.length;return n&&(i.id=n,this.index[n]=r),this.data.push(i),this.bubbleUp(r),this}},{key:"peek",value:function(){return this.data[0]?this.data[0].value:null}},{key:"peekPriority",value:function(){return this.data[0]?this.data[0].priority:null}},{key:"updatePriority",value:function(e,t){var n=this.index[e];if(void 0===n)throw new Error("Node with id '".concat(e,"' was not found in the heap."));var i=this.data,r=i[n].priority,o=this.comparator(t,r);o<0?(i[n].priority=t,this.bubbleUp(n)):o>0&&(i[n].priority=t,this.bubbleDown(n))}},{key:"remove",value:function(){var e=this.data,t=e[0],n=e.pop();return t.id&&delete this.index[t.id],e.length>0&&(e[0]=n,n.id&&(this.index[n.id]=0),this.bubbleDown(0)),t?t.value:null}},{key:"heapify",value:function(){for(var e=0;e<this.data.length;e+=1)this.bubbleUp(e)}},{key:"bubbleUp",value:function(e){for(var t,n,i=this.data,r=e;r>0&&(n=r-1>>>1,this.comparator(i[r].priority,i[n].priority)<0);){t=i[n],i[n]=i[r];var o=i[r].id;null!=o&&(this.index[o]=n),i[r]=t,null!=(o=i[r].id)&&(this.index[o]=r),r=n}}},{key:"bubbleDown",value:function(e){for(var t=this.data,n=t.length-1,i=e;;){var r=1+(i<<1),o=r+1,a=i;if(r<=n&&this.comparator(t[r].priority,t[a].priority)<0&&(a=r),o<=n&&this.comparator(t[o].priority,t[a].priority)<0&&(a=o),a===i)break;var s=t[a];t[a]=t[i];var l=t[i].id;null!=l&&(this.index[l]=a),t[i]=s,null!=(l=t[i].id)&&(this.index[l]=i),i=a}}}])}();!function(e){e.defaultComparator=function(e,t){return e-t}}(_r||(_r={})),function(e){e.run=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return 1},i={},r={},o={},a=new _r;for(i[t]=0,Object.keys(e).forEach((function(e){e!==t&&(i[e]=1/0),a.insert(i[e],e,e)}));!a.isEmpty();){var s=a.remove();o[s]=!0;for(var l=e[s]||[],u=0;u<l.length;u+=1){var c=l[u];if(!o[c]){var h=i[s]+n(s,c);h<i[c]&&(i[c]=h,r[c]=s,a.updatePriority(c,h))}}}return r}}(Hr||(Hr={}));var Ur=function(){function e(t,n,i,r){return v(this,e),null==t?this.set(255,255,255,1):"number"==typeof t?this.set(t,n,i,r):"string"==typeof t?e.fromString(t)||this:Array.isArray(t)?this.set(t):void this.set(t.r,t.g,t.b,null==t.a?1:t.a)}return y(e,[{key:"blend",value:function(e,t,n){this.set(e.r+(t.r-e.r)*n,e.g+(t.g-e.g)*n,e.b+(t.b-e.b)*n,e.a+(t.a-e.a)*n)}},{key:"lighten",value:function(t){var n=e.lighten(this.toArray(),t);this.r=n[0],this.g=n[1],this.b=n[2],this.a=n[3]}},{key:"darken",value:function(e){this.lighten(-e)}},{key:"set",value:function(e,t,n,i){var r=Array.isArray(e)?e[0]:e,o=Array.isArray(e)?e[1]:t,a=Array.isArray(e)?e[2]:n,s=Array.isArray(e)?e[3]:i;return this.r=Math.round(It(r,0,255)),this.g=Math.round(It(o,0,255)),this.b=Math.round(It(a,0,255)),this.a=null==s?1:It(s,0,1),this}},{key:"toHex",value:function(){var e=this,t=["r","g","b"].map((function(t){var n=e[t].toString(16);return n.length<2?"0".concat(n):n}));return"#".concat(t.join(""))}},{key:"toRGBA",value:function(){return this.toArray()}},{key:"toHSLA",value:function(){return e.rgba2hsla(this.r,this.g,this.b,this.a)}},{key:"toCSS",value:function(e){var t="".concat(this.r,",").concat(this.g,",").concat(this.b,",");return e?"rgb(".concat(t,")"):"rgba(".concat(t,",").concat(this.a,")")}},{key:"toGrey",value:function(){return e.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}},{key:"toArray",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"toString",value:function(){return this.toCSS()}}])}();!function(e){function t(t){return new e([].concat(f(l(t)),[1]))}function n(t){var n=t.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(n){var i=n[1].split(/\s*,\s*/).map((function(e){return parseInt(e,10)}));return new e(i)}return null}function i(e,t,n){n<0&&++n,n>1&&--n;var i=6*n;return i<1?e+(t-e)*i:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function o(t){var n=t.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(n){var i=n[2].split(/\s*,\s*/),r=(parseFloat(i[0])%360+360)%360/360,o=parseFloat(i[1])/100,s=parseFloat(i[2])/100,l=null==i[3]?1:parseInt(i[3],10);return new e(a(r,o,s,l))}return null}function a(e,t,n,r){var o=Array.isArray(e)?e[0]:e,a=Array.isArray(e)?e[1]:t,s=Array.isArray(e)?e[2]:n,l=Array.isArray(e)?e[3]:r,u=s<=.5?s*(a+1):s+a-s*a,c=2*s-u;return[256*i(c,u,o+1/3),256*i(c,u,o),256*i(c,u,o-1/3),null==l?1:l]}function s(t){return new e(Math.round(256*Math.random()),Math.round(256*Math.random()),Math.round(256*Math.random()),t?void 0:parseFloat(Math.random().toFixed(2)))}function l(e){var t=0===e.indexOf("#")?e:"#".concat(e),n=Number("0x".concat(t.substr(1)));if(4!==t.length&&7!==t.length||Number.isNaN(n))throw new Error("Invalid hex color.");var i=4===t.length?4:8,r=(1<<i)-1,o=["b","g","r"].map((function(){var e=n&r;return n>>=i,4===i?17*e:e}));return[o[2],o[1],o[0]]}function u(e,t,n){var i=function(e){return e.length<2?"0".concat(e):e};return"".concat(i(e.toString(16))).concat(i(t.toString(16))).concat(i(n.toString(16)))}function c(e,t){if("string"==typeof e){var n="#"===e[0],i=parseInt(n?e.substr(1):e,16),r=It((i>>16)+t,0,255),o=It((i>>8&255)+t,0,255),a=It((255&i)+t,0,255);return"".concat(n?"#":"").concat((a|o<<8|r<<16).toString(16))}var s=l(c(u(e[0],e[1],e[2]),t));return[s[0],s[1],s[2],e[3]]}e.fromArray=function(t){return new e(t)},e.fromHex=t,e.fromRGBA=n,e.fromHSLA=o,e.fromString=function(i){if(i.startsWith("#"))return t(i);if(i.startsWith("rgb"))return n(i);var r=e.named[i];return r?t(r):o(i)},e.makeGrey=function(t,n){return e.fromArray([t,t,t,n])},e.rgba2hsla=function(e,t,n,i){var r=Array.isArray(e)?e[0]:e,o=Array.isArray(e)?e[1]:t,a=Array.isArray(e)?e[2]:n,s=Array.isArray(e)?e[3]:i,l=Math.max(r,o,a),u=Math.min(r,o,a),c=(l+u)/2,h=0,f=0;if(u!==l){var g=l-u;switch(f=c>.5?g/(2-l-u):g/(l+u),l){case r:h=(o-a)/g+(o<a?6:0);break;case o:h=(a-r)/g+2;break;case a:h=(r-o)/g+4}h/=6}return[h,f,c,null==s?1:s]},e.hsla2rgba=a,e.random=s,e.randomHex=function(){for(var e="#",t=0;t<6;t+=1)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},e.randomRGBA=function(e){return s(e).toString()},e.invert=function(e,t){if("string"==typeof e){var n="#"===e[0],i=r(l(e),3),o=i[0],a=i[1],s=i[2];return t?.299*o+.587*a+.114*s>186?"#000000":"#ffffff":"".concat(n?"#":"").concat(u(255-o,255-a,255-s))}var c=e[0],h=e[1],f=e[2],g=e[3];return t?.299*c+.587*h+.114*f>186?[0,0,0,g]:[255,255,255,g]:[255-c,255-h,255-f,g]},e.lighten=function(e,t){return c(e,t)},e.darken=function(e,t){return c(e,-t)}}(Ur||(Ur={})),function(e){e.named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}(Ur||(Ur={}));var Wr,Jr,Xr,Yr=function(){return y((function e(){v(this,e),this.clear()}),[{key:"clear",value:function(){this.map=new WeakMap,this.arr=[]}},{key:"has",value:function(e){return this.map.has(e)}},{key:"get",value:function(e){return this.map.get(e)}},{key:"set",value:function(e,t){this.map.set(e,t),this.arr.push(e)}},{key:"delete",value:function(e){var t=this.arr.indexOf(e);t>=0&&this.arr.splice(t,1);var n=this.map.get(e);return this.map.delete(e),n}},{key:"each",value:function(e){var t=this;this.arr.forEach((function(n){var i=t.map.get(n);e(i,n)}))}},{key:"dispose",value:function(){this.clear()}}])}();!function(e){function t(e){var t=[],n=[];return Array.isArray(e)?t.push.apply(t,f(e)):e.split("|").forEach((function(e){-1===e.indexOf("&")?t.push(e):n.push.apply(n,f(e.split("&")))})),{or:t,and:n}}e.parse=t,e.equals=function(e,n){if(null!=e&&null!=n){var i=t(e),r=t(n),o=i.or.sort(),a=r.or.sort(),s=i.and.sort(),l=r.and.sort(),u=function(e,t){return e.length===t.length&&(0===e.length||e.every((function(e,n){return e===t[n]})))};return u(o,a)&&u(s,l)}return null==e&&null==n},e.isMatch=function(e,n,i){if(null==n||Array.isArray(n)&&0===n.length)return!i||!0!==e.altKey&&!0!==e.ctrlKey&&!0!==e.metaKey&&!0!==e.shiftKey;var r=t(n),o=r.or,a=r.and,s=function(t){var n="".concat(t.toLowerCase(),"Key");return!0===e[n]};return o.some((function(e){return s(e)}))&&a.every((function(e){return s(e)}))}}(Wr||(Wr={})),function(e){e.linear=function(e){return e},e.quad=function(e){return e*e},e.cubic=function(e){return e*e*e},e.inout=function(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)},e.exponential=function(e){return Math.pow(2,10*(e-1))},e.bounce=function(e){for(var t=0,n=1;;t+=n,n/=2)if(e>=(7-4*t)/11){var i=(11-6*t-11*e)/4;return-i*i+n*n}}}(Jr||(Jr={})),function(e){e.decorators={reverse:function(e){return function(t){return 1-e(1-t)}},reflect:function(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}},clamp:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(i){var r=e(i);return r<t?t:r>n?n:r}},back:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.70158;return function(t){return t*t*((e+1)*t-e)}},elastic:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.5;return function(t){return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e/3*t)}}}}(Jr||(Jr={})),function(e){function t(e){var t=e/1;if(t<1/2.75)return 7.5625*t*t;if(t<2/2.75){var n=t-1.5/2.75;return 7.5625*n*n+.75}if(t<2.5/2.75){var i=t-2.25/2.75;return 7.5625*i*i+.9375}var r=t-2.625/2.75;return 7.5625*r*r+.984375}function n(e){return 1-t(1-e)}e.easeInSine=function(e){return-1*Math.cos(e*(Math.PI/2))+1},e.easeOutSine=function(e){return Math.sin(e*(Math.PI/2))},e.easeInOutSine=function(e){return-.5*(Math.cos(Math.PI*e)-1)},e.easeInQuad=function(e){return e*e},e.easeOutQuad=function(e){return e*(2-e)},e.easeInOutQuad=function(e){return e<.5?2*e*e:(4-2*e)*e-1},e.easeInCubic=function(e){return e*e*e},e.easeOutCubic=function(e){var t=e-1;return t*t*t+1},e.easeInOutCubic=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},e.easeInQuart=function(e){return e*e*e*e},e.easeOutQuart=function(e){var t=e-1;return 1-t*t*t*t},e.easeInOutQuart=function(e){var t=e-1;return e<.5?8*e*e*e*e:1-8*t*t*t*t},e.easeInQuint=function(e){return e*e*e*e*e},e.easeOutQuint=function(e){var t=e-1;return 1+t*t*t*t*t},e.easeInOutQuint=function(e){var t=e-1;return e<.5?16*e*e*e*e*e:1+16*t*t*t*t*t},e.easeInExpo=function(e){return 0===e?0:Math.pow(2,10*(e-1))},e.easeOutExpo=function(e){return 1===e?1:1-Math.pow(2,-10*e)},e.easeInOutExpo=function(e){if(0===e||1===e)return e;var t=2*e,n=t-1;return t<1?.5*Math.pow(2,10*n):.5*(2-Math.pow(2,-10*n))},e.easeInCirc=function(e){var t=e/1;return-1*(Math.sqrt(1-t*e)-1)},e.easeOutCirc=function(e){var t=e-1;return Math.sqrt(1-t*t)},e.easeInOutCirc=function(e){var t=2*e,n=t-2;return t<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-n*n)+1)},e.easeInBack=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.70158;return e*e*((t+1)*e-t)},e.easeOutBack=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.70158,n=e/1-1;return n*n*((t+1)*n+t)+1},e.easeInOutBack=function(e){var t=2*e,n=t-2,i=1.525*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.70158);return t<1?.5*t*t*((i+1)*t-i):.5*(n*n*((i+1)*n+i)+2)},e.easeInElastic=function(e){if(0===e||1===e)return e;var t=e/1-1,n=1-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:.7),i=n/(2*Math.PI)*Math.asin(1);return-Math.pow(2,10*t)*Math.sin((t-i)*(2*Math.PI)/n)},e.easeOutElastic=function(e){var t=1-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:.7),n=2*e;if(0===e||1===e)return e;var i=t/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*n)*Math.sin((n-i)*(2*Math.PI)/t)+1},e.easeInOutElastic=function(e){var t=1-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:.65);if(0===e||1===e)return e;var n=2*e,i=n-1,r=t/(2*Math.PI)*Math.asin(1);return n<1?Math.pow(2,10*i)*Math.sin((i-r)*(2*Math.PI)/t)*-.5:Math.pow(2,-10*i)*Math.sin((i-r)*(2*Math.PI)/t)*.5+1},e.easeOutBounce=t,e.easeInBounce=n,e.easeInOutBounce=function(e){return e<.5?.5*n(2*e):.5*t(2*e-1)+.5}}(Jr||(Jr={})),function(e){e.number=function(e,t){var n=t-e;return function(t){return e+n*t}},e.object=function(e,t){var n=Object.keys(e);return function(i){for(var r={},o=n.length-1;-1!==o;o-=1){var a=n[o];r[a]=e[a]+(t[a]-e[a])*i}return r}},e.unit=function(e,t){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,i=n.exec(e),r=n.exec(t),o=r?r[1]:"",a=i?+i[1]:0,s=r?+r[1]:0,l=o.indexOf("."),u=l>0?o[1].length-l-1:0,c=s-a,h=i?i[2]:"";return function(e){return(a+c*e).toFixed(u)+h}},e.color=function(e,t){var n=parseInt(e.slice(1),16),i=parseInt(t.slice(1),16),r=255&n,o=(255&i)-r,a=65280&n,s=(65280&i)-a,l=16711680&n,u=(16711680&i)-l;return function(e){return"#".concat((1<<24|r+o*e&255|a+s*e&65280|l+u*e&16711680).toString(16).slice(1))}}}(Xr||(Xr={}));var Zr,Kr,Qr=[];!function(e){e.toDeg=function(e){return 180*e/Math.PI%360},e.toRad=function(e){return(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:e%360)*Math.PI/180},e.normalize=function(e){return e%360+(e<0?360:0)}}(Zr||(Zr={})),function(e){e.round=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Number.isInteger(e)?e:+e.toFixed(t)},e.random=function(e,t){var n,i;if(null==t?(i=null==e?1:e,n=0):(i=t,n=null==e?0:e),i<n){var r=n;n=i,i=r}return Math.floor(Math.random()*(i-n+1)+n)},e.clamp=function(e,t,n){return Number.isNaN(e)?NaN:Number.isNaN(t)||Number.isNaN(n)?0:t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e},e.snapToGrid=function(e,t){return t*Math.round(e/t)},e.containsPoint=function(e,t){return null!=t&&null!=e&&t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},e.squaredLength=function(e,t){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}}(Kr||(Kr={}));var $r=function(){return y((function e(){v(this,e)}),[{key:"valueOf",value:function(){return this.toJSON()}},{key:"toString",value:function(){return JSON.stringify(this.toJSON())}}])}(),eo=function(e){function t(e,n){var i;return v(this,t),(i=a(this,t)).x=null==e?0:e,i.y=null==n?0:n,i}return c(t,e),y(t,[{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x=Kr.round(this.x,e),this.y=Kr.round(this.y,e),this}},{key:"add",value:function(e,n){var i=t.create(e,n);return this.x+=i.x,this.y+=i.y,this}},{key:"update",value:function(e,n){var i=t.create(e,n);return this.x=i.x,this.y=i.y,this}},{key:"translate",value:function(e,n){var i=t.create(e,n);return this.x+=i.x,this.y+=i.y,this}},{key:"rotate",value:function(e,n){var i=t.rotate(this,e,n);return this.x=i.x,this.y=i.y,this}},{key:"scale",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t,r=t.create(i);return this.x=r.x+e*(this.x-r.x),this.y=r.y+n*(this.y-r.y),this}},{key:"closest",value:function(e){var n=this;if(1===e.length)return t.create(e[0]);var i=null,r=1/0;return e.forEach((function(e){var t=n.squaredDistance(e);t<r&&(i=e,r=t)})),i?t.create(i):null}},{key:"distance",value:function(e){return Math.sqrt(this.squaredDistance(e))}},{key:"squaredDistance",value:function(e){var n=t.create(e),i=this.x-n.x,r=this.y-n.y;return i*i+r*r}},{key:"manhattanDistance",value:function(e){var n=t.create(e);return Math.abs(n.x-this.x)+Math.abs(n.y-this.y)}},{key:"magnitude",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}},{key:"theta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t,n=t.create(e),i=-(n.y-this.y),r=n.x-this.x,o=Math.atan2(i,r);return o<0&&(o=2*Math.PI+o),180*o/Math.PI}},{key:"angleBetween",value:function(e,t){if(this.equals(e)||this.equals(t))return NaN;var n=this.theta(t)-this.theta(e);return n<0&&(n+=360),n}},{key:"vectorAngle",value:function(e){return new t(0,0).angleBetween(this,e)}},{key:"toPolar",value:function(e){return this.update(t.toPolar(this,e)),this}},{key:"changeInAngle",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t;return this.clone().translate(-e,-n).theta(i)-this.theta(i)}},{key:"adhereToRect",value:function(e){return Kr.containsPoint(e,this)||(this.x=Math.min(Math.max(this.x,e.x),e.x+e.width),this.y=Math.min(Math.max(this.y,e.y),e.y+e.height)),this}},{key:"bearing",value:function(e){var n=t.create(e),i=Zr.toRad(this.y),r=Zr.toRad(n.y),o=this.x,a=n.x,s=Zr.toRad(a-o),l=Math.sin(s)*Math.cos(r),u=Math.cos(i)*Math.sin(r)-Math.sin(i)*Math.cos(r)*Math.cos(s),c=Zr.toDeg(Math.atan2(l,u))-22.5;return c<0&&(c+=360),["NE","E","SE","S","SW","W","NW","N"][c=parseInt(c/45,10)]}},{key:"cross",value:function(e,n){if(null!=e&&null!=n){var i=t.create(e),r=t.create(n);return(r.x-this.x)*(i.y-this.y)-(r.y-this.y)*(i.x-this.x)}return NaN}},{key:"dot",value:function(e){var n=t.create(e);return this.x*n.x+this.y*n.y}},{key:"diff",value:function(e,n){if("number"==typeof e)return new t(this.x-e,this.y-n);var i=t.create(e);return new t(this.x-i.x,this.y-i.y)}},{key:"lerp",value:function(e,n){var i=t.create(e);return new t((1-n)*this.x+n*i.x,(1-n)*this.y+n*i.y)}},{key:"normalize",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1)/this.magnitude();return this.scale(e,e)}},{key:"move",value:function(e,n){var i=t.create(e),r=Zr.toRad(i.theta(this));return this.translate(Math.cos(r)*n,-Math.sin(r)*n)}},{key:"reflection",value:function(e){return t.create(e).move(this,this.distance(e))}},{key:"snapToGrid",value:function(e,t){return this.x=Kr.snapToGrid(this.x,e),this.y=Kr.snapToGrid(this.y,null==t?e:t),this}},{key:"equals",value:function(e){var n=t.create(e);return null!=n&&n.x===this.x&&n.y===this.y}},{key:"clone",value:function(){return t.clone(this)}},{key:"toJSON",value:function(){return t.toJSON(this)}},{key:"serialize",value:function(){return"".concat(this.x," ").concat(this.y)}}])}($r);!function(e){e.isPoint=function(t){return null!=t&&t instanceof e}}(eo||(eo={})),function(e){e.isPointLike=function(e){return null!=e&&"object"===b(e)&&"number"==typeof e.x&&"number"==typeof e.y},e.isPointData=function(e){return null!=e&&Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}}(eo||(eo={})),function(e){function t(t){return e.isPoint(t)?new e(t.x,t.y):Array.isArray(t)?new e(t[0],t[1]):new e(t.x,t.y)}function n(e,t){return e===t||null!=e&&null!=t&&(e.x===t.x&&e.y===t.y)}function i(n,i,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e,a=t(n),s=t(o),l=a.x-s.x,u=a.y-s.y,c=u*i+l*r;return new e(l*i-u*r+s.x,c+s.y)}e.create=function(n,i){return null==n||"number"==typeof n?new e(n,i):t(n)},e.clone=t,e.toJSON=function(t){return e.isPoint(t)?{x:t.x,y:t.y}:Array.isArray(t)?{x:t[0],y:t[1]}:{x:t.x,y:t.y}},e.fromPolar=function(n,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e,o=Math.abs(n*Math.cos(i)),a=Math.abs(n*Math.sin(i)),s=t(r),l=Zr.normalize(Zr.toDeg(i));return l<90?a=-a:l<180?(o=-o,a=-a):l<270&&(o=-o),new e(s.x+o,s.y+a)},e.toPolar=function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=t(n),o=t(i),a=r.x-o.x,s=r.y-o.y;return new e(Math.sqrt(a*a+s*s),Zr.toRad(o.theta(r)))},e.equals=n,e.equalPoints=function(e,t){if(null==e&&null!=t||null!=e&&null==t||null!=e&&null!=t&&e.length!==t.length)return!1;if(null!=e&&null!=t)for(var i=0,r=e.length;i<r;i+=1)if(!n(e[i],t[i]))return!1;return!0},e.random=function(t,n,i,r){return new e(Kr.random(t,n),Kr.random(i,r))},e.rotate=function(e,t,n){var r=Zr.toRad(Zr.normalize(-t)),o=Math.sin(r);return i(e,Math.cos(r),o,n)},e.rotateEx=i}(eo||(eo={}));var to=function(e){function t(e,n,i,r){var o;return v(this,t),(o=a(this,t)).x=null==e?0:e,o.y=null==n?0:n,o.width=null==i?0:i,o.height=null==r?0:r,o}return c(t,e),y(t,[{key:"left",get:function(){return this.x}},{key:"top",get:function(){return this.y}},{key:"right",get:function(){return this.x+this.width}},{key:"bottom",get:function(){return this.y+this.height}},{key:"origin",get:function(){return new eo(this.x,this.y)}},{key:"topLeft",get:function(){return new eo(this.x,this.y)}},{key:"topCenter",get:function(){return new eo(this.x+this.width/2,this.y)}},{key:"topRight",get:function(){return new eo(this.x+this.width,this.y)}},{key:"center",get:function(){return new eo(this.x+this.width/2,this.y+this.height/2)}},{key:"bottomLeft",get:function(){return new eo(this.x,this.y+this.height)}},{key:"bottomCenter",get:function(){return new eo(this.x+this.width/2,this.y+this.height)}},{key:"bottomRight",get:function(){return new eo(this.x+this.width,this.y+this.height)}},{key:"corner",get:function(){return new eo(this.x+this.width,this.y+this.height)}},{key:"rightMiddle",get:function(){return new eo(this.x+this.width,this.y+this.height/2)}},{key:"leftMiddle",get:function(){return new eo(this.x,this.y+this.height/2)}},{key:"topLine",get:function(){return new no(this.topLeft,this.topRight)}},{key:"rightLine",get:function(){return new no(this.topRight,this.bottomRight)}},{key:"bottomLine",get:function(){return new no(this.bottomLeft,this.bottomRight)}},{key:"leftLine",get:function(){return new no(this.topLeft,this.bottomLeft)}},{key:"getOrigin",value:function(){return this.origin}},{key:"getTopLeft",value:function(){return this.topLeft}},{key:"getTopCenter",value:function(){return this.topCenter}},{key:"getTopRight",value:function(){return this.topRight}},{key:"getCenter",value:function(){return this.center}},{key:"getCenterX",value:function(){return this.x+this.width/2}},{key:"getCenterY",value:function(){return this.y+this.height/2}},{key:"getBottomLeft",value:function(){return this.bottomLeft}},{key:"getBottomCenter",value:function(){return this.bottomCenter}},{key:"getBottomRight",value:function(){return this.bottomRight}},{key:"getCorner",value:function(){return this.corner}},{key:"getRightMiddle",value:function(){return this.rightMiddle}},{key:"getLeftMiddle",value:function(){return this.leftMiddle}},{key:"getTopLine",value:function(){return this.topLine}},{key:"getRightLine",value:function(){return this.rightLine}},{key:"getBottomLine",value:function(){return this.bottomLine}},{key:"getLeftLine",value:function(){return this.leftLine}},{key:"bbox",value:function(e){if(!e)return this.clone();var n=Zr.toRad(e),i=Math.abs(Math.sin(n)),r=Math.abs(Math.cos(n)),o=this.width*r+this.height*i,a=this.width*i+this.height*r;return new t(this.x+(this.width-o)/2,this.y+(this.height-a)/2,o,a)}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x=Kr.round(this.x,e),this.y=Kr.round(this.y,e),this.width=Kr.round(this.width,e),this.height=Kr.round(this.height,e),this}},{key:"add",value:function(e,n,i,r){var o=t.create(e,n,i,r),a=Math.min(this.x,o.x),s=Math.min(this.y,o.y),l=Math.max(this.x+this.width,o.x+o.width),u=Math.max(this.y+this.height,o.y+o.height);return this.x=a,this.y=s,this.width=l-a,this.height=u-s,this}},{key:"update",value:function(e,n,i,r){var o=t.create(e,n,i,r);return this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height,this}},{key:"inflate",value:function(e,t){var n=e,i=null!=t?t:e;return this.x-=n,this.y-=i,this.width+=2*n,this.height+=2*i,this}},{key:"snapToGrid",value:function(e,t){var n=this.origin.snapToGrid(e,t),i=this.corner.snapToGrid(e,t);return this.x=n.x,this.y=n.y,this.width=i.x-n.x,this.height=i.y-n.y,this}},{key:"translate",value:function(e,t){var n=eo.create(e,t);return this.x+=n.x,this.y+=n.y,this}},{key:"scale",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new eo,i=this.origin.scale(e,t,n);return this.x=i.x,this.y=i.y,this.width*=e,this.height*=t,this}},{key:"rotate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCenter();if(0!==e){var i=Zr.toRad(e),r=Math.cos(i),o=Math.sin(i),a=this.getOrigin(),s=this.getTopRight(),l=this.getBottomRight(),u=this.getBottomLeft();a=eo.rotateEx(a,r,o,n),s=eo.rotateEx(s,r,o,n),l=eo.rotateEx(l,r,o,n),u=eo.rotateEx(u,r,o,n);var c=new t(a.x,a.y,0,0);c.add(s.x,s.y,0,0),c.add(l.x,l.y,0,0),c.add(u.x,u.y,0,0),this.update(c)}return this}},{key:"rotate90",value:function(){var e=(this.width-this.height)/2;this.x+=e,this.y-=e;var t=this.width;return this.width=this.height,this.height=t,this}},{key:"moveAndExpand",value:function(e){var n=t.clone(e);return this.x+=n.x||0,this.y+=n.y||0,this.width+=n.width||0,this.height+=n.height||0,this}},{key:"getMaxScaleToFit",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.center,i=t.clone(e),r=n.x,o=n.y,a=1/0,s=1/0,l=1/0,u=1/0,c=1/0,h=1/0,f=1/0,g=1/0,d=i.topLeft;d.x<r&&(a=(this.x-r)/(d.x-r)),d.y<o&&(c=(this.y-o)/(d.y-o));var v=i.bottomRight;v.x>r&&(s=(this.x+this.width-r)/(v.x-r)),v.y>o&&(h=(this.y+this.height-o)/(v.y-o));var p=i.topRight;p.x>r&&(l=(this.x+this.width-r)/(p.x-r)),p.y<o&&(f=(this.y-o)/(p.y-o));var y=i.bottomLeft;return y.x<r&&(u=(this.x-r)/(y.x-r)),y.y>o&&(g=(this.y+this.height-o)/(y.y-o)),{sx:Math.min(a,s,l,u),sy:Math.min(c,h,f,g)}}},{key:"getMaxUniformScaleToFit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.center,n=this.getMaxScaleToFit(e,t);return Math.min(n.sx,n.sy)}},{key:"containsPoint",value:function(e,t){return Kr.containsPoint(this,eo.create(e,t))}},{key:"containsRect",value:function(e,n,i,r){var o=t.create(e,n,i,r),a=this.x,s=this.y,l=this.width,u=this.height,c=o.x,h=o.y,f=o.width,g=o.height;return 0!==l&&0!==u&&0!==f&&0!==g&&(c>=a&&h>=s&&c+f<=a+l&&h+g<=s+u)}},{key:"intersectsWithLine",value:function(e){var t=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],n=[],i=[];return t.forEach((function(t){var r=e.intersectsWithLine(t);null!==r&&i.indexOf(r.toString())<0&&(n.push(r),i.push(r.toString()))})),n.length>0?n:null}},{key:"intersectsWithLineFromCenterToPoint",value:function(e,t){var n=eo.clone(e),i=this.center,r=null;null!=t&&0!==t&&n.rotate(t,i);for(var o=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],a=new no(i,n),s=o.length-1;s>=0;s-=1){var l=o[s].intersectsWithLine(a);if(null!==l){r=l;break}}return r&&null!=t&&0!==t&&r.rotate(-t,i),r}},{key:"intersectsWithRect",value:function(e,n,i,r){var o=t.create(e,n,i,r);if(!this.isIntersectWithRect(o))return null;var a=this.origin,s=this.corner,l=o.origin,u=o.corner,c=Math.max(a.x,l.x),h=Math.max(a.y,l.y);return new t(c,h,Math.min(s.x,u.x)-c,Math.min(s.y,u.y)-h)}},{key:"isIntersectWithRect",value:function(e,n,i,r){var o=t.create(e,n,i,r),a=this.origin,s=this.corner,l=o.origin,u=o.corner;return!(u.x<=a.x||u.y<=a.y||l.x>=s.x||l.y>=s.y)}},{key:"normalize",value:function(){var e=this.x,t=this.y,n=this.width,i=this.height;return this.width<0&&(e=this.x+this.width,n=-this.width),this.height<0&&(t=this.y+this.height,i=-this.height),this.x=e,this.y=t,this.width=n,this.height=i,this}},{key:"union",value:function(e){var n=t.clone(e),i=this.origin,r=this.corner,o=n.origin,a=n.corner,s=Math.min(i.x,o.x),l=Math.min(i.y,o.y);return new t(s,l,Math.max(r.x,a.x)-s,Math.max(r.y,a.y)-l)}},{key:"getNearestSideToPoint",value:function(e){var t=eo.clone(e),n=t.x-this.x,i=this.x+this.width-t.x,r=t.y-this.y,o=n,a="left";return i<o&&(o=i,a="right"),r<o&&(o=r,a="top"),this.y+this.height-t.y<o&&(a="bottom"),a}},{key:"getNearestPointToPoint",value:function(e){var t=eo.clone(e);if(this.containsPoint(t)){var n=this.getNearestSideToPoint(t);if("left"===n)return new eo(this.x,t.y);if("top"===n)return new eo(t.x,this.y);if("right"===n)return new eo(this.x+this.width,t.y);if("bottom"===n)return new eo(t.x,this.y+this.height)}return t.adhereToRect(this)}},{key:"equals",value:function(e){return null!=e&&e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height}},{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},{key:"serialize",value:function(){return"".concat(this.x," ").concat(this.y," ").concat(this.width," ").concat(this.height)}}])}($r);!function(e){e.isRectangle=function(t){return null!=t&&t instanceof e}}(to||(to={})),function(e){e.isRectangleLike=function(e){return null!=e&&"object"===b(e)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.width&&"number"==typeof e.height}}(to||(to={})),function(e){function t(t){return e.isRectangle(t)?t.clone():Array.isArray(t)?new e(t[0],t[1],t[2],t[3]):new e(t.x,t.y,t.width,t.height)}e.create=function(n,i,r,o){return null==n||"number"==typeof n?new e(n,i,r,o):t(n)},e.clone=t,e.fromEllipse=function(t){return new e(t.x-t.a,t.y-t.b,2*t.a,2*t.b)},e.fromSize=function(t){return new e(0,0,t.width,t.height)},e.fromPositionAndSize=function(t,n){return new e(t.x,t.y,n.width,n.height)}}(to||(to={}));var no=function(e){function t(e,n,i,r){var o;return v(this,t),o=a(this,t),"number"==typeof e&&"number"==typeof n?(o.start=new eo(e,n),o.end=new eo(i,r)):(o.start=eo.create(e),o.end=eo.create(n)),o}return c(t,e),y(t,[{key:"center",get:function(){return new eo((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}},{key:"getCenter",value:function(){return this.center}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.start.round(e),this.end.round(e),this}},{key:"translate",value:function(e,t){return"number"==typeof e?(this.start.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.end.translate(e)),this}},{key:"rotate",value:function(e,t){return this.start.rotate(e,t),this.end.rotate(e,t),this}},{key:"scale",value:function(e,t,n){return this.start.scale(e,t,n),this.end.scale(e,t,n),this}},{key:"length",value:function(){return Math.sqrt(this.squaredLength())}},{key:"squaredLength",value:function(){var e=this.start.x-this.end.x,t=this.start.y-this.end.y;return e*e+t*t}},{key:"setLength",value:function(e){var t=this.length();if(!t)return this;var n=e/t;return this.scale(n,n,this.start)}},{key:"parallel",value:function(e){var t=this.clone();if(!t.isDifferentiable())return t;var n=t.start,i=t.end,r=n.clone().rotate(270,i),o=i.clone().rotate(90,n);return n.move(o,e),i.move(r,e),t}},{key:"vector",value:function(){return new eo(this.end.x-this.start.x,this.end.y-this.start.y)}},{key:"angle",value:function(){var e=new eo(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,e)}},{key:"bbox",value:function(){var e=Math.min(this.start.x,this.end.x),t=Math.min(this.start.y,this.end.y),n=Math.max(this.start.x,this.end.x),i=Math.max(this.start.y,this.end.y);return new to(e,t,n-e,i-t)}},{key:"bearing",value:function(){return this.start.bearing(this.end)}},{key:"closestPoint",value:function(e){return this.pointAt(this.closestPointNormalizedLength(e))}},{key:"closestPointLength",value:function(e){return this.closestPointNormalizedLength(e)*this.length()}},{key:"closestPointTangent",value:function(e){return this.tangentAt(this.closestPointNormalizedLength(e))}},{key:"closestPointNormalizedLength",value:function(e){var n=this.vector().dot(new t(this.start,e).vector()),i=Math.min(1,Math.max(0,n/this.squaredLength()));return Number.isNaN(i)?0:i}},{key:"pointAt",value:function(e){var t=this.start,n=this.end;return e<=0?t.clone():e>=1?n.clone():t.lerp(n,e)}},{key:"pointAtLength",value:function(e){var t=this.start,n=this.end,i=!0;e<0&&(i=!1,e=-e);var r=this.length();if(e>=r)return i?n.clone():t.clone();var o=(i?e:r-e)/r;return this.pointAt(o)}},{key:"divideAt",value:function(e){var n=this.pointAt(e);return[new t(this.start,n),new t(n,this.end)]}},{key:"divideAtLength",value:function(e){var n=this.pointAtLength(e);return[new t(this.start,n),new t(n,this.end)]}},{key:"containsPoint",value:function(e){var n=this.start,i=this.end;if(0!==n.cross(e,i))return!1;var r=this.length();return!(new t(n,e).length()>r)&&!(new t(e,i).length()>r)}},{key:"intersect",value:function(e,t){var n=e.intersectsWithLine(this,t);return n?Array.isArray(n)?n:[n]:null}},{key:"intersectsWithLine",value:function(e){var t=new eo(this.end.x-this.start.x,this.end.y-this.start.y),n=new eo(e.end.x-e.start.x,e.end.y-e.start.y),i=t.x*n.y-t.y*n.x,r=new eo(e.start.x-this.start.x,e.start.y-this.start.y),o=r.x*n.y-r.y*n.x,a=r.x*t.y-r.y*t.x;if(0===i||o*i<0||a*i<0)return null;if(i>0){if(o>i||a>i)return null}else if(o<i||a<i)return null;return new eo(this.start.x+o*t.x/i,this.start.y+o*t.y/i)}},{key:"isDifferentiable",value:function(){return!this.start.equals(this.end)}},{key:"pointOffset",value:function(e){var t=eo.clone(e),n=this.start,i=this.end;return((i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x))/this.length()}},{key:"pointSquaredDistance",value:function(e,t){var n=eo.create(e,t);return this.closestPoint(n).squaredDistance(n)}},{key:"pointDistance",value:function(e,t){var n=eo.create(e,t);return this.closestPoint(n).distance(n)}},{key:"tangentAt",value:function(e){if(!this.isDifferentiable())return null;var n=this.start,i=this.end,r=this.pointAt(e),o=new t(n,i);return o.translate(r.x-n.x,r.y-n.y),o}},{key:"tangentAtLength",value:function(e){if(!this.isDifferentiable())return null;var n=this.start,i=this.end,r=this.pointAtLength(e),o=new t(n,i);return o.translate(r.x-n.x,r.y-n.y),o}},{key:"relativeCcw",value:function(e,t){var n=eo.create(e,t),i=n.x-this.start.x,r=n.y-this.start.y,o=this.end.x-this.start.x,a=this.end.y-this.start.y,s=i*a-r*o;return 0===s&&(s=i*o+r*a)>0&&(s=(i-=o)*o+(r-=a)*a)<0&&(s=0),s<0?-1:s>0?1:0}},{key:"equals",value:function(e){return null!=e&&this.start.x===e.start.x&&this.start.y===e.start.y&&this.end.x===e.end.x&&this.end.y===e.end.y}},{key:"clone",value:function(){return new t(this.start,this.end)}},{key:"toJSON",value:function(){return{start:this.start.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){return[this.start.serialize(),this.end.serialize()].join(" ")}}])}($r);!function(e){e.isLine=function(t){return null!=t&&t instanceof e}}(no||(no={}));var io=function(e){function t(e,n,i,r){var o;return v(this,t),(o=a(this,t)).x=null==e?0:e,o.y=null==n?0:n,o.a=null==i?0:i,o.b=null==r?0:r,o}return c(t,e),y(t,[{key:"center",get:function(){return new eo(this.x,this.y)}},{key:"bbox",value:function(){return to.fromEllipse(this)}},{key:"getCenter",value:function(){return this.center}},{key:"inflate",value:function(e,t){var n=e,i=null!=t?t:e;return this.a+=2*n,this.b+=2*i,this}},{key:"normalizedDistance",value:function(e,t){var n=eo.create(e,t),i=n.x-this.x,r=n.y-this.y,o=this.a,a=this.b;return i*i/(o*o)+r*r/(a*a)}},{key:"containsPoint",value:function(e,t){return this.normalizedDistance(e,t)<=1}},{key:"intersectsWithLine",value:function(e){var t=[],n=this.a,i=this.b,r=e.start,o=e.end,a=e.vector(),s=r.diff(new eo(this.x,this.y)),l=new eo(a.x/(n*n),a.y/(i*i)),u=new eo(s.x/(n*n),s.y/(i*i)),c=a.dot(l),h=a.dot(u),f=h*h-c*(s.dot(u)-1);if(f<0)return null;if(f>0){var g=Math.sqrt(f),d=(-h-g)/c,v=(-h+g)/c;if((d<0||d>1)&&(v<0||v>1))return null;d>=0&&d<=1&&t.push(r.lerp(o,d)),v>=0&&v<=1&&t.push(r.lerp(o,v))}else{var p=-h/c;if(!(p>=0&&p<=1))return null;t.push(r.lerp(o,p))}return t}},{key:"intersectsWithLineFromCenterToPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=eo.clone(e);t&&n.rotate(t,this.getCenter());var i,r=n.x-this.x,o=n.y-this.y;if(0===r)return i=this.bbox().getNearestPointToPoint(n),t?i.rotate(-t,this.getCenter()):i;var a=o/r,s=a*a,l=this.a*this.a,u=this.b*this.b,c=Math.sqrt(1/(1/l+s/u)),h=a*(c=r<0?-c:c);return i=new eo(this.x+c,this.y+h),t?i.rotate(-t,this.getCenter()):i}},{key:"tangentTheta",value:function(e){var t,n,i=eo.clone(e),r=i.x,o=i.y,a=this.a,s=this.b,l=this.bbox().center,u=l.x,c=l.y,h=r>l.x+a/2,f=r<l.x-a/2;return h||f?t=a*a/(r-u)-a*a*(o-c)*((n=r>l.x?o-30:o+30)-c)/(s*s*(r-u))+u:n=s*s/(o-c)-s*s*(r-u)*((t=o>l.y?r+30:r-30)-u)/(a*a*(o-c))+c,new eo(t,n).theta(i)}},{key:"scale",value:function(e,t){return this.a*=e,this.b*=t,this}},{key:"rotate",value:function(e,n){var i=to.fromEllipse(this);i.rotate(e,n);var r=t.fromRect(i);return this.a=r.a,this.b=r.b,this.x=r.x,this.y=r.y,this}},{key:"translate",value:function(e,t){var n=eo.create(e,t);return this.x+=n.x,this.y+=n.y,this}},{key:"equals",value:function(e){return null!=e&&e.x===this.x&&e.y===this.y&&e.a===this.a&&e.b===this.b}},{key:"clone",value:function(){return new t(this.x,this.y,this.a,this.b)}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,a:this.a,b:this.b}}},{key:"serialize",value:function(){return"".concat(this.x," ").concat(this.y," ").concat(this.a," ").concat(this.b)}}])}($r);!function(e){e.isEllipse=function(t){return null!=t&&t instanceof e}}(io||(io={})),function(e){function t(t){return e.isEllipse(t)?t.clone():Array.isArray(t)?new e(t[0],t[1],t[2],t[3]):new e(t.x,t.y,t.a,t.b)}e.create=function(n,i,r,o){return null==n||"number"==typeof n?new e(n,i,r,o):t(n)},e.parse=t,e.fromRect=function(t){var n=t.center;return new e(n.x,n.y,t.width/2,t.height/2)}}(io||(io={}));var ro=new RegExp("^[\\s\\dLMCZz,.]*$");function oo(e){return"string"==typeof e&&ro.test(e)}function ao(e,t){return(e%t+t)%t}function so(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return e&&e.length&&e.forEach((function(e){Array.isArray(e)?n.push({x:e[0],y:e[1]}):n.push({x:e.x,y:e.y})})),function(e,t,n,i,r){var o=[],a=e[e.length-1],s=null!=t&&t>0,l=t||0;if(i&&s){var u=(e=e.slice())[0],c=new eo(a.x+(u.x-a.x)/2,a.y+(u.y-a.y)/2);e.splice(0,0,c)}var h=e[0],f=1;for(n?o.push("M",h.x,h.y):o.push("L",h.x,h.y);f<(i?e.length:e.length-1);){var g=e[ao(f,e.length)],d=h.x-g.x,v=h.y-g.y;if(s&&(0!==d||0!==v)&&(null==r||r.indexOf(f-1)<0)){var p=Math.sqrt(d*d+v*v),y=d*Math.min(l,p/2)/p,m=v*Math.min(l,p/2)/p,b=g.x+y,k=g.y+m;o.push("L",b,k);for(var x=e[ao(f+1,e.length)];f<e.length-2&&0===Math.round(x.x-g.x)&&0===Math.round(x.y-g.y);)x=e[ao(f+2,e.length)],f+=1;d=x.x-g.x,v=x.y-g.y,p=Math.max(1,Math.sqrt(d*d+v*v));var w=d*Math.min(l,p/2)/p,P=v*Math.min(l,p/2)/p,C=g.x+w,A=g.y+P;o.push("Q",g.x,g.y,C,A),g=new eo(C,A)}else o.push("L",g.x,g.y);h=g,f+=1}return i?o.push("Z"):o.push("L",a.x,a.y),o.map((function(e){return"string"==typeof e?e:+e.toFixed(3)})).join(" ")}(n,t.round,null==t.initialMove||t.initialMove,t.close,t.exclude)}function lo(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0;if(0===n||0===i)return[];s-=e,l-=t,n=Math.abs(n),i=Math.abs(i);var u,c=-s/2,h=-l/2,f=Math.cos(r*Math.PI/180),g=Math.sin(r*Math.PI/180),d=f*c+g*h,v=-1*g*c+f*h,p=d*d,y=v*v,m=n*n,b=i*i,k=p/m+y/b;if(k>1)n=Math.sqrt(k)*n,i=Math.sqrt(k)*i,u=0;else{var x=1;o===a&&(x=-1),u=x*Math.sqrt((m*b-m*y-b*p)/(m*y+b*p))}var w=u*n*v/i,P=-1*u*i*d/n,C=f*w-g*P+s/2,A=g*w+f*P+l/2,O=Math.atan2((v-P)/i,(d-w)/n)-Math.atan2(0,1),E=O>=0?O:2*Math.PI+O,M=(O=Math.atan2((-v-P)/i,(-d-w)/n)-Math.atan2((v-P)/i,(d-w)/n))>=0?O:2*Math.PI+O;0===a&&M>0?M-=2*Math.PI:0!==a&&M<0&&(M+=2*Math.PI);for(var S=2*M/Math.PI,T=Math.ceil(S<0?-1*S:S),N=M/T,j=8/3*Math.sin(N/4)*Math.sin(N/4)/Math.sin(N/2),L=f*n,D=f*i,I=g*n,R=g*i,V=Math.cos(E),B=Math.sin(E),z=-j*(L*B+R*V),F=-j*(I*B-D*V),G=0,q=0,H=[],_=0;_<T;_+=1){E+=N,G=L*(V=Math.cos(E))-R*(B=Math.sin(E))+C,q=I*V+D*B+A;var U=-j*(L*B+R*V),W=-j*(I*B-D*V),J=6*_;H[J]=Number(z+e),H[J+1]=Number(F+t),H[J+2]=Number(G-U+e),H[J+3]=Number(q-W+t),H[J+4]=Number(G+e),H[J+5]=Number(q+t),z=G+U,F=q+W}return H.map((function(e){return+e.toFixed(2)}))}function uo(e,t,n,i){var r=[],o=lo(e,t,n,i,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0);if(null!=o)for(var a=0,s=o.length;a<s;a+=6)r.push("C",o[a],o[a+1],o[a+2],o[a+3],o[a+4],o[a+5]);return r.join(" ")}var co=function(e){function t(e){var n;if(v(this,t),n=a(this,t),null!=e){if("string"==typeof e)return s(n,t.parse(e));n.points=e.map((function(e){return eo.create(e)}))}else n.points=[];return n}return c(t,e),y(t,[{key:"start",get:function(){return this.points[0]||null}},{key:"end",get:function(){return this.points[this.points.length-1]||null}},{key:"scale",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new eo;return this.points.forEach((function(i){return i.scale(e,t,n)})),this}},{key:"rotate",value:function(e,t){return this.points.forEach((function(n){return n.rotate(e,t)})),this}},{key:"translate",value:function(e,t){var n=eo.create(e,t);return this.points.forEach((function(e){return e.translate(n.x,n.y)})),this}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.points.forEach((function(t){return t.round(e)})),this}},{key:"bbox",value:function(){if(0===this.points.length)return new to;for(var e=1/0,t=-1/0,n=1/0,i=-1/0,r=this.points,o=0,a=r.length;o<a;o+=1){var s=r[o],l=s.x,u=s.y;l<e&&(e=l),l>t&&(t=l),u<n&&(n=u),u>i&&(i=u)}return new to(e,n,t-e,i-n)}},{key:"closestPoint",value:function(e){var t=this.closestPointLength(e);return this.pointAtLength(t)}},{key:"closestPointLength",value:function(e){var t=this.points,n=t.length;if(0===n||1===n)return 0;for(var i=0,r=0,o=1/0,a=0,s=n-1;a<s;a+=1){var l=new no(t[a],t[a+1]),u=l.length(),c=l.closestPointNormalizedLength(e),h=l.pointAt(c).squaredDistance(e);h<o&&(o=h,r=i+c*u),i+=u}return r}},{key:"closestPointNormalizedLength",value:function(e){var t=this.length();return 0===t?0:this.closestPointLength(e)/t}},{key:"closestPointTangent",value:function(e){var t=this.closestPointLength(e);return this.tangentAtLength(t)}},{key:"containsPoint",value:function(e){if(0===this.points.length)return!1;for(var t=eo.clone(e),n=t.x,i=t.y,r=this.points,o=r.length,a=o-1,s=0,l=0;l<o;l+=1){var u=r[a],c=r[l];if(t.equals(u))return!0;var h=new no(u,c);if(h.containsPoint(e))return!0;if(i<=u.y&&i>c.y||i>u.y&&i<=c.y){var f=u.x-n>c.x-n?u.x-n:c.x-n;if(f>=0){var g=new eo(n+f,i),d=new no(e,g);h.intersectsWithLine(d)&&(s+=1)}}a=l}return s%2==1}},{key:"intersectsWithLine",value:function(e){for(var t=[],n=0,i=this.points.length-1;n<i;n+=1){var r=this.points[n],o=this.points[n+1],a=e.intersectsWithLine(new no(r,o));a&&t.push(a)}return t.length>0?t:null}},{key:"isDifferentiable",value:function(){for(var e=0,t=this.points.length-1;e<t;e+=1){var n=this.points[e],i=this.points[e+1];if(new no(n,i).isDifferentiable())return!0}return!1}},{key:"length",value:function(){for(var e=0,t=0,n=this.points.length-1;t<n;t+=1){var i=this.points[t],r=this.points[t+1];e+=i.distance(r)}return e}},{key:"pointAt",value:function(e){var t=this.points,n=t.length;if(0===n)return null;if(1===n)return t[0].clone();if(e<=0)return t[0].clone();if(e>=1)return t[n-1].clone();var i=this.length()*e;return this.pointAtLength(i)}},{key:"pointAtLength",value:function(e){var t=this.points,n=t.length;if(0===n)return null;if(1===n)return t[0].clone();var i=!0;e<0&&(i=!1,e=-e);for(var r=0,o=0,a=n-1;o<a;o+=1){var s=i?o:a-1-o,l=t[s],u=t[s+1],c=new no(l,u),h=l.distance(u);if(e<=r+h)return c.pointAtLength((i?1:-1)*(e-r));r+=h}return(i?t[n-1]:t[0]).clone()}},{key:"tangentAt",value:function(e){var t=this.points.length;if(0===t||1===t)return null;e<0&&(e=0),e>1&&(e=1);var n=this.length()*e;return this.tangentAtLength(n)}},{key:"tangentAtLength",value:function(e){var t=this.points,n=t.length;if(0===n||1===n)return null;var i,r=!0;e<0&&(r=!1,e=-e);for(var o=0,a=0,s=n-1;a<s;a+=1){var l=r?a:s-1-a,u=t[l],c=t[l+1],h=new no(u,c),f=u.distance(c);if(h.isDifferentiable()){if(e<=o+f)return h.tangentAtLength((r?1:-1)*(e-o));i=h}o+=f}if(i){var g=r?1:0;return i.tangentAt(g)}return null}},{key:"simplify",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.points;if(t.length<3)return this;for(var n=e.threshold||0,i=0;t[i+2];){var r=i+1,o=i+2,a=t[i],s=t[r],l=t[o];new no(a,l).closestPoint(s).distance(s)<=n?t.splice(r,1):i+=1}return this}},{key:"toHull",value:function(){var e=this.points,n=e.length;if(0===n)return new t;for(var i=e[0],r=1;r<n;r+=1)(e[r].y<i.y||e[r].y===i.y&&e[r].x>i.x)&&(i=e[r]);for(var o=[],a=0;a<n;a+=1){var s=i.theta(e[a]);0===s&&(s=360),o.push([e[a],a,s])}if(o.sort((function(e,t){var n=e[2]-t[2];return 0===n&&(n=t[1]-e[1]),n})),o.length>2){var l=o[o.length-1];o.unshift(l)}for(var u,c={},h=[],f=function(e){return"".concat(e[0].toString(),"@").concat(e[1])};0!==o.length;){var g=o.pop(),d=g[0];if(!c[f(g)])for(var v=!1;!v;)if(h.length<2)h.push(g),v=!0;else{var p=h.pop(),y=p[0],m=h.pop(),b=m[0],k=b.cross(y,d);if(k<0)h.push(m),h.push(p),h.push(g),v=!0;else if(0===k){var x=y.angleBetween(b,d);Math.abs(x-180)<1e-10||y.equals(d)||b.equals(y)?(c[f(p)]=y,h.push(m)):Math.abs((x+1)%360-1)<1e-10&&(h.push(m),o.push(p))}else c[f(p)]=y,h.push(m)}}h.length>2&&h.pop();for(var w=-1,P=0,C=h.length;P<C;P+=1){var A=h[P][1];(void 0===u||A<u)&&(u=A,w=P)}var O=[];if(w>0){var E=h.slice(w),M=h.slice(0,w);O=E.concat(M)}else O=h;for(var S=[],T=0,N=O.length;T<N;T+=1)S.push(O[T][0]);return new t(S)}},{key:"equals",value:function(e){var t=this;return null!=e&&(e.points.length===this.points.length&&e.points.every((function(e,n){return e.equals(t.points[n])})))}},{key:"clone",value:function(){return new t(this.points.map((function(e){return e.clone()})))}},{key:"toJSON",value:function(){return this.points.map((function(e){return e.toJSON()}))}},{key:"serialize",value:function(){return this.points.map((function(e){return"".concat(e.serialize())})).join(" ")}}])}($r);!function(e){e.isPolyline=function(t){return null!=t&&t instanceof e}}(co||(co={})),function(e){e.parse=function(t){var n=t.trim();if(""===n)return new e;for(var i=[],r=n.split(/\s*,\s*|\s+/),o=0,a=r.length;o<a;o+=2)i.push({x:+r[o],y:+r[o+1]});return new e(i)}}(co||(co={}));var ho=function(e){function t(e,n,i,r){var o;return v(this,t),(o=a(this,t)).PRECISION=3,o.start=eo.create(e),o.controlPoint1=eo.create(n),o.controlPoint2=eo.create(i),o.end=eo.create(r),o}return c(t,e),y(t,[{key:"bbox",value:function(){for(var e,t,n,i,r,o,a,s,l,u,c,h=this.start,f=this.controlPoint1,g=this.controlPoint2,d=this.end,v=h.x,p=h.y,y=f.x,m=f.y,b=g.x,k=g.y,x=d.x,w=d.y,P=[],C=[[],[]],A=0;A<2;A+=1)if(0===A?(t=6*v-12*y+6*b,e=-3*v+9*y-9*b+3*x,n=3*y-3*v):(t=6*p-12*m+6*k,e=-3*p+9*m-9*k+3*w,n=3*m-3*p),Math.abs(e)<1e-12){if(Math.abs(t)<1e-12)continue;(i=-n/t)>0&&i<1&&P.push(i)}else a=t*t-4*n*e,s=Math.sqrt(a),a<0||((r=(-t+s)/(2*e))>0&&r<1&&P.push(r),(o=(-t-s)/(2*e))>0&&o<1&&P.push(o));for(var O=P.length,E=O;O;)l=(c=1-(i=P[O-=1]))*c*c*v+3*c*c*i*y+3*c*i*i*b+i*i*i*x,C[0][O]=l,u=c*c*c*p+3*c*c*i*m+3*c*i*i*k+i*i*i*w,C[1][O]=u;P[E]=0,P[E+1]=1,C[0][E]=v,C[1][E]=p,C[0][E+1]=x,C[1][E+1]=w,P.length=E+2,C[0].length=E+2,C[1].length=E+2;var M=Math.min.apply(null,C[0]),S=Math.min.apply(null,C[1]),T=Math.max.apply(null,C[0]),N=Math.max.apply(null,C[1]);return new to(M,S,T-M,N-S)}},{key:"closestPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.pointAtT(this.closestPointT(e,t))}},{key:"closestPointLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t);return this.lengthAtT(this.closestPointT(e,n),n)}},{key:"closestPointNormalizedLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t),i=this.closestPointLength(e,n);if(!i)return 0;var r=this.length(n);return 0===r?0:i/r}},{key:"closestPointT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPrecision(t),i=this.getDivisions(t),r=Math.pow(10,-n),o=null,a=0,s=0,l=0,u=0,c=0,h=null,f=i.length,g=f>0?1/f:0;for(i.forEach((function(t,n){var i=t.start.distance(e),r=t.end.distance(e),f=i+r;(null==h||f<h)&&(o=t,a=n*g,s=(n+1)*g,l=i,u=r,h=f,c=t.endpointDistance())}));;){var d=l?Math.abs(l-u)/l:0,v=null!=u?Math.abs(l-u)/u:0;if(d<r||v<r||(!l||l<c*r||(!u||u<c*r)))return l<=u?a:s;var p=o.divide(.5);g/=2;var y=p[0].start.distance(e),m=p[0].end.distance(e),b=y+m,k=p[1].start.distance(e),x=p[1].end.distance(e);b<=k+x?(o=p[0],s-=g,l=y,u=m):(o=p[1],a+=g,l=k,u=x)}}},{key:"closestPointTangent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.tangentAtT(this.closestPointT(e,t))}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.toPolyline(t).containsPoint(e)}},{key:"divideAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return this.divideAtT(0);if(e>=1)return this.divideAtT(1);var n=this.tAt(e,t);return this.divideAtT(n)}},{key:"divideAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.tAtLength(e,t);return this.divideAtT(n)}},{key:"divide",value:function(e){return this.divideAtT(e)}},{key:"divideAtT",value:function(e){var n=this.start,i=this.controlPoint1,r=this.controlPoint2,o=this.end;if(e<=0)return[new t(n,n,n,n),new t(n,i,r,o)];if(e>=1)return[new t(n,i,r,o),new t(o,o,o,o)];var a=this.getSkeletonPoints(e),s=a.startControlPoint1,l=a.startControlPoint2,u=a.divider,c=a.dividerControlPoint1,h=a.dividerControlPoint2;return[new t(n,s,l,u),new t(u,c,h,o)]}},{key:"endpointDistance",value:function(){return this.start.distance(this.end)}},{key:"getSkeletonPoints",value:function(e){var t=this.start,n=this.controlPoint1,i=this.controlPoint2,r=this.end;if(e<=0)return{startControlPoint1:t.clone(),startControlPoint2:t.clone(),divider:t.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:i.clone()};if(e>=1)return{startControlPoint1:n.clone(),startControlPoint2:i.clone(),divider:r.clone(),dividerControlPoint1:r.clone(),dividerControlPoint2:r.clone()};var o=new no(t,n).pointAt(e),a=new no(n,i).pointAt(e),s=new no(i,r).pointAt(e),l=new no(o,a).pointAt(e),u=new no(a,s).pointAt(e);return{startControlPoint1:o,startControlPoint2:l,divider:new no(l,u).pointAt(e),dividerControlPoint1:u,dividerControlPoint2:s}}},{key:"getSubdivisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.getPrecision(e),i=[new t(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===n)return i;for(var r,o=this.endpointDistance(),a=Math.pow(10,-n),s=0,l=function(){s+=1;var e=[];i.forEach((function(t){var n=t.divide(.5);e.push(n[0],n[1])}));var t=e.reduce((function(e,t){return e+t.endpointDistance()}),0);if(s>1&&(0!==t?(t-o)/t:0)<a)return{v:e};i=e,o=t};;)if(r=l())return r.v}},{key:"length",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getDivisions(e).reduce((function(e,t){return e+t.endpointDistance()}),0)}},{key:"lengthAtT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return 0;var n=void 0===t.precision?this.PRECISION:t.precision;return this.divide(e)[0].length({precision:n})}},{key:"pointAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();var n=this.tAt(e,t);return this.pointAtT(n)}},{key:"pointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.tAtLength(e,t);return this.pointAtT(n)}},{key:"pointAtT",value:function(e){return e<=0?this.start.clone():e>=1?this.end.clone():this.getSkeletonPoints(e).divider}},{key:"isDifferentiable",value:function(){var e=this.start,t=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(e.equals(t)&&t.equals(n)&&n.equals(i))}},{key:"tangentAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isDifferentiable())return null;e<0?e=0:e>1&&(e=1);var n=this.tAt(e,t);return this.tangentAtT(n)}},{key:"tangentAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isDifferentiable())return null;var n=this.tAtLength(e,t);return this.tangentAtT(n)}},{key:"tangentAtT",value:function(e){if(!this.isDifferentiable())return null;e<0&&(e=0),e>1&&(e=1);var t=this.getSkeletonPoints(e),n=t.startControlPoint2,i=t.dividerControlPoint1,r=t.divider,o=new no(n,i);return o.translate(r.x-n.x,r.y-n.y),o}},{key:"getPrecision",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null==e.precision?this.PRECISION:e.precision}},{key:"getDivisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null!=e.subdivisions)return e.subdivisions;var t=this.getPrecision(e);return this.getSubdivisions({precision:t})}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{precision:this.getPrecision(e),subdivisions:this.getDivisions(e)}}},{key:"tAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return 0;if(e>=1)return 1;var n=this.getOptions(t),i=this.length(n)*e;return this.tAtLength(i,n)}},{key:"tAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!0;e<0&&(n=!1,e=-e);for(var i,r,o=this.getPrecision(t),a=this.getDivisions(t),s={precision:o,subdivisions:a},l=null,u=0,c=0,h=0,f=a.length,g=f>0?1/f:0,d=0;d<f;d+=1){var v=n?d:f-1-d,p=a[d],y=p.endpointDistance();if(e<=h+y){l=p,i=v*g,r=(v+1)*g,u=n?e-h:y+h-e,c=n?y+h-e:e-h;break}h+=y}if(null==l)return n?1:0;for(var m=this.length(s),b=Math.pow(10,-o);;){if((0!==m?u/m:0)<b)return i;if((0!==m?c/m:0)<b)return r;var k=void 0,x=void 0,w=l.divide(.5);g/=2;var P=w[0].endpointDistance(),C=w[1].endpointDistance();u<=P?(l=w[0],r-=g,x=P-(k=u)):(l=w[1],i+=g,x=C-(k=u-P)),u=k,c=x}}},{key:"toPoints",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getDivisions(e),n=[t[0].start.clone()];return t.forEach((function(e){return n.push(e.end.clone())})),n}},{key:"toPolyline",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new co(this.toPoints(e))}},{key:"scale",value:function(e,t,n){return this.start.scale(e,t,n),this.controlPoint1.scale(e,t,n),this.controlPoint2.scale(e,t,n),this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.start.rotate(e,t),this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?(this.start.translate(e,t),this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}},{key:"equals",value:function(e){return null!=e&&this.start.equals(e.start)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)&&this.end.equals(e.end)}},{key:"clone",value:function(){return new t(this.start,this.controlPoint1,this.controlPoint2,this.end)}},{key:"toJSON",value:function(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}])}($r);!function(e){e.isCurve=function(t){return null!=t&&t instanceof e}}(ho||(ho={})),function(e){function t(e){var t=e.length,n=[],i=[],r=2;n[0]=e[0]/r;for(var o=1;o<t;o+=1)i[o]=1/r,r=(o<t-1?4:3.5)-i[o],n[o]=(e[o]-n[o-1])/r;for(var a=1;a<t;a+=1)n[t-a-1]-=i[t-a]*n[t-a];return n}e.throughPoints=function(n){if(null==n||Array.isArray(n)&&n.length<2)throw new Error("At least 2 points are required");for(var i=function(e){var n=e.map((function(e){return eo.clone(e)})),i=[],r=[],o=n.length-1;if(1===o)return i[0]=new eo((2*n[0].x+n[1].x)/3,(2*n[0].y+n[1].y)/3),r[0]=new eo(2*i[0].x-n[0].x,2*i[0].y-n[0].y),[i,r];for(var a=[],s=1;s<o-1;s+=1)a[s]=4*n[s].x+2*n[s+1].x;a[0]=n[0].x+2*n[1].x,a[o-1]=(8*n[o-1].x+n[o].x)/2;for(var l=t(a),u=1;u<o-1;u+=1)a[u]=4*n[u].y+2*n[u+1].y;a[0]=n[0].y+2*n[1].y,a[o-1]=(8*n[o-1].y+n[o].y)/2;for(var c=t(a),h=0;h<o;h+=1)i.push(new eo(l[h],c[h])),h<o-1?r.push(new eo(2*n[h+1].x-l[h+1],2*n[h+1].y-c[h+1])):r.push(new eo((n[o].x+l[o-1])/2,(n[o].y+c[o-1])/2));return[i,r]}(n),r=[],o=0,a=i[0].length;o<a;o+=1){var s=new eo(i[0][o].x,i[0][o].y),l=new eo(i[1][o].x,i[1][o].y);r.push(new e(n[o],s,l,n[o+1]))}return r}}(ho||(ho={}));var fo=function(e){function t(){var e;return v(this,t),(e=a(this,t,arguments)).isVisible=!0,e.isSegment=!0,e.isSubpathStart=!1,e}return c(t,e),y(t,[{key:"end",get:function(){return this.endPoint}},{key:"start",get:function(){if(null==this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}},{key:"closestPointT",value:function(e,t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(e);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}},{key:"lengthAtT",value:function(e,t){if(e<=0)return 0;var n=this.length();return e>=1?n:n*e}},{key:"divideAtT",value:function(e){if(this.divideAt)return this.divideAt(e);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}},{key:"pointAtT",value:function(e){if(this.pointAt)return this.pointAt(e);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}},{key:"tangentAtT",value:function(e){if(this.tangentAt)return this.tangentAt(e);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}])}($r),go=function(e){function t(e,n){var i;return v(this,t),i=a(this,t),no.isLine(e)?i.endPoint=e.end.clone().round(2):i.endPoint=eo.create(e,n).round(2),i}return c(t,e),y(t,[{key:"type",get:function(){return"L"}},{key:"line",get:function(){return new no(this.start,this.end)}},{key:"bbox",value:function(){return this.line.bbox()}},{key:"closestPoint",value:function(e){return this.line.closestPoint(e)}},{key:"closestPointLength",value:function(e){return this.line.closestPointLength(e)}},{key:"closestPointNormalizedLength",value:function(e){return this.line.closestPointNormalizedLength(e)}},{key:"closestPointTangent",value:function(e){return this.line.closestPointTangent(e)}},{key:"length",value:function(){return this.line.length()}},{key:"divideAt",value:function(e){var n=this.line.divideAt(e);return[new t(n[0]),new t(n[1])]}},{key:"divideAtLength",value:function(e){var n=this.line.divideAtLength(e);return[new t(n[0]),new t(n[1])]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(e){return this.line.pointAt(e)}},{key:"pointAtLength",value:function(e){return this.line.pointAtLength(e)}},{key:"tangentAt",value:function(e){return this.line.tangentAt(e)}},{key:"tangentAtLength",value:function(e){return this.line.tangentAtLength(e)}},{key:"isDifferentiable",value:function(){return null!=this.previousSegment&&!this.start.equals(this.end)}},{key:"clone",value:function(){return new t(this.end)}},{key:"scale",value:function(e,t,n){return this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?this.end.translate(e,t):this.end.translate(e),this}},{key:"equals",value:function(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}},{key:"toJSON",value:function(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){var e=this.end;return"".concat(this.type," ").concat(e.x," ").concat(e.y)}}])}(fo);!function(e){e.create=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=n.length,o=n[0];if(no.isLine(o))return new e(o);if(eo.isPointLike(o))return 1===r?new e(o):n.map((function(t){return new e(t)}));if(2===r)return new e(+n[0],+n[1]);for(var a=[],s=0;s<r;s+=2){var l=+n[s],u=+n[s+1];a.push(new e(l,u))}return a}}(go||(go={}));var vo=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"end",get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}},{key:"type",get:function(){return"Z"}},{key:"line",get:function(){return new no(this.start,this.end)}},{key:"bbox",value:function(){return this.line.bbox()}},{key:"closestPoint",value:function(e){return this.line.closestPoint(e)}},{key:"closestPointLength",value:function(e){return this.line.closestPointLength(e)}},{key:"closestPointNormalizedLength",value:function(e){return this.line.closestPointNormalizedLength(e)}},{key:"closestPointTangent",value:function(e){return this.line.closestPointTangent(e)}},{key:"length",value:function(){return this.line.length()}},{key:"divideAt",value:function(e){var t=this.line.divideAt(e);return[t[1].isDifferentiable()?new go(t[0]):this.clone(),new go(t[1])]}},{key:"divideAtLength",value:function(e){var t=this.line.divideAtLength(e);return[t[1].isDifferentiable()?new go(t[0]):this.clone(),new go(t[1])]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(e){return this.line.pointAt(e)}},{key:"pointAtLength",value:function(e){return this.line.pointAtLength(e)}},{key:"tangentAt",value:function(e){return this.line.tangentAt(e)}},{key:"tangentAtLength",value:function(e){return this.line.tangentAtLength(e)}},{key:"isDifferentiable",value:function(){return!(!this.previousSegment||!this.subpathStartSegment)&&!this.start.equals(this.end)}},{key:"scale",value:function(){return this}},{key:"rotate",value:function(){return this}},{key:"translate",value:function(){return this}},{key:"equals",value:function(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}},{key:"clone",value:function(){return new t}},{key:"toJSON",value:function(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){return this.type}}])}(fo);!function(e){e.create=function(){return new e}}(vo||(vo={}));var po=function(e){function t(e,n){var i;return v(this,t),(i=a(this,t)).isVisible=!1,i.isSubpathStart=!0,no.isLine(e)||ho.isCurve(e)?i.endPoint=e.end.clone().round(2):i.endPoint=eo.create(e,n).round(2),i}return c(t,e),y(t,[{key:"start",get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}},{key:"type",get:function(){return"M"}},{key:"bbox",value:function(){return null}},{key:"closestPoint",value:function(){return this.end.clone()}},{key:"closestPointLength",value:function(){return 0}},{key:"closestPointNormalizedLength",value:function(){return 0}},{key:"closestPointT",value:function(){return 1}},{key:"closestPointTangent",value:function(){return null}},{key:"length",value:function(){return 0}},{key:"lengthAtT",value:function(){return 0}},{key:"divideAt",value:function(){return[this.clone(),this.clone()]}},{key:"divideAtLength",value:function(){return[this.clone(),this.clone()]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(){return this.end.clone()}},{key:"pointAtLength",value:function(){return this.end.clone()}},{key:"pointAtT",value:function(){return this.end.clone()}},{key:"tangentAt",value:function(){return null}},{key:"tangentAtLength",value:function(){return null}},{key:"tangentAtT",value:function(){return null}},{key:"isDifferentiable",value:function(){return!1}},{key:"scale",value:function(e,t,n){return this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?this.end.translate(e,t):this.end.translate(e),this}},{key:"clone",value:function(){return new t(this.end)}},{key:"equals",value:function(e){return this.type===e.type&&this.end.equals(e.end)}},{key:"toJSON",value:function(){return{type:this.type,end:this.end.toJSON()}}},{key:"serialize",value:function(){var e=this.end;return"".concat(this.type," ").concat(e.x," ").concat(e.y)}}])}(fo);!function(e){e.create=function(){var t=arguments.length,n=arguments.length<=0?void 0:arguments[0];if(no.isLine(n))return new e(n);if(ho.isCurve(n))return new e(n);if(eo.isPointLike(n)){if(1===t)return new e(n);for(var i=[],r=0;r<t;r+=1)0===r?i.push(new e(r<0||arguments.length<=r?void 0:arguments[r])):i.push(new go(r<0||arguments.length<=r?void 0:arguments[r]));return i}if(2===t)return new e(+(arguments.length<=0?void 0:arguments[0]),+(arguments.length<=1?void 0:arguments[1]));for(var o=[],a=0;a<t;a+=2){var s=+(a<0||arguments.length<=a?void 0:arguments[a]),l=+(a+1<0||arguments.length<=a+1?void 0:arguments[a+1]);0===a?o.push(new e(s,l)):o.push(new go(s,l))}return o}}(po||(po={}));var yo=function(e){function t(e,n,i,r,o,s){var l;return v(this,t),l=a(this,t),ho.isCurve(e)?(l.controlPoint1=e.controlPoint1.clone().round(2),l.controlPoint2=e.controlPoint2.clone().round(2),l.endPoint=e.end.clone().round(2)):"number"==typeof e?(l.controlPoint1=new eo(e,n).round(2),l.controlPoint2=new eo(i,r).round(2),l.endPoint=new eo(o,s).round(2)):(l.controlPoint1=eo.create(e).round(2),l.controlPoint2=eo.create(n).round(2),l.endPoint=eo.create(i).round(2)),l}return c(t,e),y(t,[{key:"type",get:function(){return"C"}},{key:"curve",get:function(){return new ho(this.start,this.controlPoint1,this.controlPoint2,this.end)}},{key:"bbox",value:function(){return this.curve.bbox()}},{key:"closestPoint",value:function(e){return this.curve.closestPoint(e)}},{key:"closestPointLength",value:function(e){return this.curve.closestPointLength(e)}},{key:"closestPointNormalizedLength",value:function(e){return this.curve.closestPointNormalizedLength(e)}},{key:"closestPointTangent",value:function(e){return this.curve.closestPointTangent(e)}},{key:"length",value:function(){return this.curve.length()}},{key:"divideAt",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.curve.divideAt(e,n);return[new t(i[0]),new t(i[1])]}},{key:"divideAtLength",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.curve.divideAtLength(e,n);return[new t(i[0]),new t(i[1])]}},{key:"divideAtT",value:function(e){var n=this.curve.divideAtT(e);return[new t(n[0]),new t(n[1])]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(e){return this.curve.pointAt(e)}},{key:"pointAtLength",value:function(e){return this.curve.pointAtLength(e)}},{key:"tangentAt",value:function(e){return this.curve.tangentAt(e)}},{key:"tangentAtLength",value:function(e){return this.curve.tangentAtLength(e)}},{key:"isDifferentiable",value:function(){if(!this.previousSegment)return!1;var e=this.start,t=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(e.equals(t)&&t.equals(n)&&n.equals(i))}},{key:"scale",value:function(e,t,n){return this.controlPoint1.scale(e,t,n),this.controlPoint2.scale(e,t,n),this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?(this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}},{key:"equals",value:function(e){return this.start.equals(e.start)&&this.end.equals(e.end)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)}},{key:"clone",value:function(){return new t(this.controlPoint1,this.controlPoint2,this.end)}},{key:"toJSON",value:function(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){var e=this.controlPoint1,t=this.controlPoint2,n=this.end;return[this.type,e.x,e.y,t.x,t.y,n.x,n.y].join(" ")}}])}(fo);function mo(e,t,n){return{x:e*Math.cos(n)-t*Math.sin(n),y:e*Math.sin(n)+t*Math.cos(n)}}function bo(e,t,n,i,r,o){var a=1/3,s=2/3;return[a*e+s*n,a*t+s*i,a*r+s*n,a*o+s*i,r,o]}function ko(e,t,n,i,r,o,a,s,l,u){var c,h,f,g,d,v=120*Math.PI/180,p=Math.PI/180*(+r||0),y=[];if(u)h=u[0],f=u[1],g=u[2],d=u[3];else{e=(c=mo(e,t,-p)).x,t=c.y;var m=(e-(s=(c=mo(s,l,-p)).x))/2,b=(t-(l=c.y))/2,k=m*m/(n*n)+b*b/(i*i);k>1&&(n*=k=Math.sqrt(k),i*=k);var x=n*n,w=i*i,P=(o===a?-1:1)*Math.sqrt(Math.abs((x*w-x*b*b-w*m*m)/(x*b*b+w*m*m)));g=P*n*b/i+(e+s)/2,d=P*-i*m/n+(t+l)/2,h=Math.asin((t-d)/i),f=Math.asin((l-d)/i),h=e<g?Math.PI-h:h,f=s<g?Math.PI-f:f,h<0&&(h=2*Math.PI+h),f<0&&(f=2*Math.PI+f),a&&h>f&&(h-=2*Math.PI),!a&&f>h&&(f-=2*Math.PI)}var C=f-h;if(Math.abs(C)>v){var A=f,O=s,E=l;f=h+v*(a&&f>h?1:-1),y=ko(s=g+n*Math.cos(f),l=d+i*Math.sin(f),n,i,r,0,a,O,E,[f,A,g,d])}C=f-h;var M=Math.cos(h),S=Math.sin(h),T=Math.cos(f),N=Math.sin(f),j=Math.tan(C/4),L=4/3*(n*j),D=4/3*(i*j),I=[e,t],R=[e+L*S,t-D*M],V=[s+L*N,l-D*T],B=[s,l];if(R[0]=2*I[0]-R[0],R[1]=2*I[1]-R[1],u)return[R,V,B].concat(y);for(var z=[],F=(y=[R,V,B].concat(y).join().split(",")).length,G=0;G<F;G+=1)z[G]=G%2?mo(+y[G-1],+y[G],p).y:mo(+y[G],+y[G+1],p).x;return z}function xo(e){var t=function(e){if(!e)return null;var t="\t\n\v\f\r   ᠎             　\u2028\u2029",n=new RegExp("([a-z])[".concat(t,",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[").concat(t,"]*,?[").concat(t,"]*)+)"),"ig"),i=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[".concat(t,"]*,?[").concat(t,"]*"),"ig"),r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return e.replace(n,(function(e,t,n){var a=[],s=t.toLowerCase();n.replace(i,(function(e,t){return t&&a.push(+t),e})),"m"===s&&a.length>2&&(o.push([t].concat(f(a.splice(0,2)))),s="l",t="m"===t?"l":"L");for(var l=r[s];a.length>=l&&(o.push([t].concat(f(a.splice(0,l)))),l););return e})),o}(e);if(!t||!t.length)return[["M",0,0]];for(var n=0,i=0,r=0,o=0,a=[],s=0,l=t.length;s<l;s+=1){var u=[];a.push(u);var c=t[s],h=c[0];if(h!==h.toUpperCase())switch(u[0]=h.toUpperCase(),u[0]){case"A":u[1]=c[1],u[2]=c[2],u[3]=c[3],u[4]=c[4],u[5]=c[5],u[6]=+c[6]+n,u[7]=+c[7]+i;break;case"V":u[1]=+c[1]+i;break;case"H":u[1]=+c[1]+n;break;case"M":r=+c[1]+n,o=+c[2]+i;for(var g=1,d=c.length;g<d;g+=1)u[g]=+c[g]+(g%2?n:i);break;default:for(var v=1,p=c.length;v<p;v+=1)u[v]=+c[v]+(v%2?n:i)}else for(var y=0,m=c.length;y<m;y+=1)u[y]=c[y];switch(u[0]){case"Z":n=+r,i=+o;break;case"H":n=u[1];break;case"V":i=u[1];break;case"M":r=u[u.length-2],o=u[u.length-1],n=u[u.length-2],i=u[u.length-1];break;default:n=u[u.length-2],i=u[u.length-1]}}return a}function wo(e){var t=xo(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function i(e,t,n){var i,r;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(e[0]in{T:1,Q:1}||(t.qx=null,t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":return 0===parseFloat(e[1])||0===parseFloat(e[2])?["L",e[6],e[7]]:["C"].concat(ko.apply(0,[t.x,t.y].concat(e.slice(1))));case"S":return"C"===n||"S"===n?(i=2*t.x-t.bx,r=2*t.y-t.by):(i=t.x,r=t.y),["C",i,r].concat(e.slice(1));case"T":return"Q"===n||"T"===n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),["C"].concat(bo(t.x,t.y,t.qx,t.qy,e[1],e[2]));case"Q":return t.qx=e[1],t.qy=e[2],["C"].concat(bo(t.x,t.y,e[1],e[2],e[3],e[4]));case"H":return["L"].concat(e[1],t.y);case"V":return["L"].concat(t.x,e[1])}return e}function r(e,n){if(e[n].length>7){e[n].shift();for(var i=e[n];i.length;)o[n]="A",n+=1,e.splice(n,0,["C"].concat(i.splice(0,6)));e.splice(n,1),s=t.length}}for(var o=[],a="",s=t.length,l=0;l<s;l+=1){var u="";t[l]&&(u=t[l][0]),"C"!==u&&(o[l]=u,l>0&&(a=o[l-1])),t[l]=i(t[l],n,a),"A"!==o[l]&&"C"===u&&(o[l]="C"),r(t,l);var c=t[l],h=c.length;n.x=c[h-2],n.y=c[h-1],n.bx=parseFloat(c[h-4])||n.x,n.by=parseFloat(c[h-3])||n.y}return t[0][0]&&"M"===t[0][0]||t.unshift(["M",0,0]),t}function Po(e){return wo(e).map((function(e){return e.map((function(e){return"string"==typeof e?e:Kr.round(e,2)}))})).join(",").split(",").join(" ")}!function(e){e.create=function(){var t=arguments.length,n=arguments.length<=0?void 0:arguments[0];if(ho.isCurve(n))return new e(n);if(eo.isPointLike(n)){if(3===t)return new e(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]);for(var i=[],r=0;r<t;r+=3)i.push(new e(r<0||arguments.length<=r?void 0:arguments[r],r+1<0||arguments.length<=r+1?void 0:arguments[r+1],r+2<0||arguments.length<=r+2?void 0:arguments[r+2]));return i}if(6===t)return new e(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4],arguments.length<=5?void 0:arguments[5]);for(var o=[],a=0;a<t;a+=6)o.push(new e(a<0||arguments.length<=a?void 0:arguments[a],a+1<0||arguments.length<=a+1?void 0:arguments[a+1],a+2<0||arguments.length<=a+2?void 0:arguments[a+2],a+3<0||arguments.length<=a+3?void 0:arguments[a+3],a+4<0||arguments.length<=a+4?void 0:arguments[a+4],a+5<0||arguments.length<=a+5?void 0:arguments[a+5]));return o}}(yo||(yo={}));var Co=function(e){function t(e){var n;if(v(this,t),(n=a(this,t)).PRECISION=3,n.segments=[],Array.isArray(e))if(no.isLine(e[0])||ho.isCurve(e[0])){var i=null;e.forEach((function(e,r){0===r&&n.appendSegment(t.createSegment("M",e.start)),null==i||i.end.equals(e.start)||n.appendSegment(t.createSegment("M",e.start)),no.isLine(e)?n.appendSegment(t.createSegment("L",e.end)):ho.isCurve(e)&&n.appendSegment(t.createSegment("C",e.controlPoint1,e.controlPoint2,e.end)),i=e}))}else{e.forEach((function(e){e.isSegment&&n.appendSegment(e)}))}else null!=e&&(no.isLine(e)?(n.appendSegment(t.createSegment("M",e.start)),n.appendSegment(t.createSegment("L",e.end))):ho.isCurve(e)?(n.appendSegment(t.createSegment("M",e.start)),n.appendSegment(t.createSegment("C",e.controlPoint1,e.controlPoint2,e.end))):co.isPolyline(e)?e.points&&e.points.length&&e.points.forEach((function(e,i){var r=0===i?t.createSegment("M",e):t.createSegment("L",e);n.appendSegment(r)})):e.isSegment&&n.appendSegment(e));return n}return c(t,e),y(t,[{key:"start",get:function(){var e=this.segments,t=e.length;if(0===t)return null;for(var n=0;n<t;n+=1){var i=e[n];if(i.isVisible)return i.start}return e[t-1].end}},{key:"end",get:function(){var e=this.segments,t=e.length;if(0===t)return null;for(var n=t-1;n>=0;n-=1){var i=e[n];if(i.isVisible)return i.end}return e[t-1].end}},{key:"moveTo",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.appendSegment((e=po.create).call.apply(e,[null].concat(n)))}},{key:"lineTo",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.appendSegment((e=go.create).call.apply(e,[null].concat(n)))}},{key:"curveTo",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.appendSegment((e=yo.create).call.apply(e,[null].concat(n)))}},{key:"arcTo",value:function(e,t,n,i,r,o,a){var s=this.end||new eo,l="number"==typeof o?lo(s.x,s.y,e,t,n,i,r,o,a):lo(s.x,s.y,e,t,n,i,r,o.x,o.y);if(null!=l)for(var u=0,c=l.length;u<c;u+=6)this.curveTo(l[u],l[u+1],l[u+2],l[u+3],l[u+4],l[u+5]);return this}},{key:"quadTo",value:function(e,n,i,r){var o=this.end||new eo,a=["M",o.x,o.y];if("number"==typeof e)a.push("Q",e,n,i,r);else{var s=n;a.push("Q",e.x,e.y,s.x,s.y)}var l=t.parse(a.join(" "));return this.appendSegment(l.segments.slice(1)),this}},{key:"close",value:function(){return this.appendSegment(vo.create())}},{key:"drawPoints",value:function(e){var n=so(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=t.parse(n);i&&i.segments&&this.appendSegment(i.segments)}},{key:"bbox",value:function(){var e,t=this.segments,n=t.length;if(0===n)return null;for(var i=0;i<n;i+=1){var r=t[i];if(r.isVisible){var o=r.bbox();null!=o&&(e=e?e.union(o):o)}}if(null!=e)return e;var a=t[n-1];return new to(a.end.x,a.end.y,0,0)}},{key:"appendSegment",value:function(e){var t,n=this.segments.length,i=0!==n?this.segments[n-1]:null;if(Array.isArray(e))for(var r=0,o=e.length;r<o;r+=1){var a=e[r];t=this.prepareSegment(a,i,null),this.segments.push(t),i=t}else null!=e&&e.isSegment&&(t=this.prepareSegment(e,i,null),this.segments.push(t));return this}},{key:"insertSegment",value:function(e,t){var n,i=this.segments.length;if(e<0&&(e=i+e+1),e>i||e<0)throw new Error("Index out of range.");var r=null,o=null;if(0!==i&&(e>=1?o=(r=this.segments[e-1]).nextSegment:(r=null,o=this.segments[0])),Array.isArray(t))for(var a=0,s=t.length;a<s;a+=1){var l=t[a];n=this.prepareSegment(l,r,o),this.segments.splice(e+a,0,n),r=n}else n=this.prepareSegment(t,r,o),this.segments.splice(e,0,n);return this}},{key:"removeSegment",value:function(e){var t=this.fixIndex(e),n=this.segments.splice(t,1)[0],i=n.previousSegment,r=n.nextSegment;return i&&(i.nextSegment=r),r&&(r.previousSegment=i),n.isSubpathStart&&r&&this.updateSubpathStartSegment(r),n}},{key:"replaceSegment",value:function(e,t){var n,i=this.fixIndex(e),r=this.segments[i],o=r.previousSegment,a=r.nextSegment,s=r.isSubpathStart;if(Array.isArray(t)){this.segments.splice(e,1);for(var l=0,u=t.length;l<u;l+=1){var c=t[l];n=this.prepareSegment(c,o,a),this.segments.splice(e+l,0,n),o=n,s&&n.isSubpathStart&&(s=!1)}}else n=this.prepareSegment(t,o,a),this.segments.splice(i,1,n),s&&n.isSubpathStart&&(s=!1);s&&a&&this.updateSubpathStartSegment(a)}},{key:"getSegment",value:function(e){var t=this.fixIndex(e);return this.segments[t]}},{key:"fixIndex",value:function(e){var t=this.segments.length;if(0===t)throw new Error("Path has no segments.");for(var n=e;n<0;)n=t+n;if(n>=t||n<0)throw new Error("Index out of range.");return n}},{key:"segmentAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segmentIndexAt(e,t);return n?this.getSegment(n):null}},{key:"segmentAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segmentIndexAtLength(e,t);return n?this.getSegment(n):null}},{key:"segmentIndexAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=Kr.clamp(e,0,1),i=this.getOptions(t),r=this.length(i)*n;return this.segmentIndexAtLength(r,i)}},{key:"segmentIndexAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segments.length;if(0===n)return null;var i=!0;e<0&&(i=!1,e=-e);for(var r=this.getPrecision(t),o=this.getSubdivisions(t),a=0,s=null,l=0;l<n;l+=1){var u=i?l:n-1-l,c=this.segments[u],h=o[u],f=c.length({precision:r,subdivisions:h});if(c.isVisible){if(e<=a+f)return u;s=u}a+=f}return s}},{key:"getSegmentSubdivisions",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getPrecision(e),n=[],i=0,r=this.segments.length;i<r;i+=1){var o=this.segments[i].getSubdivisions({precision:t});n.push(o)}return n}},{key:"updateSubpathStartSegment",value:function(e){for(var t=e.previousSegment,n=e;n&&!n.isSubpathStart;)n.subpathStartSegment=null!=t?t.subpathStartSegment:null,t=n,n=n.nextSegment}},{key:"prepareSegment",value:function(e,t,n){e.previousSegment=t,e.nextSegment=n,null!=t&&(t.nextSegment=e),null!=n&&(n.previousSegment=e);var i=e;return e.isSubpathStart&&(e.subpathStartSegment=e,i=n),null!=i&&this.updateSubpathStartSegment(i),e}},{key:"closestPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.closestPointT(e,t);return n?this.pointAtT(n):null}},{key:"closestPointLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t),i=this.closestPointT(e,n);return i?this.lengthAtT(i,n):0}},{key:"closestPointNormalizedLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t),i=this.closestPointLength(e,n);if(0===i)return 0;var r=this.length(n);return 0===r?0:i/r}},{key:"closestPointT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;for(var n,i=this.getPrecision(t),r=this.getSubdivisions(t),o=1/0,a=0,s=this.segments.length;a<s;a+=1){var l=this.segments[a],u=r[a];if(l.isVisible){var c=l.closestPointT(e,{precision:i,subdivisions:u}),h=l.pointAtT(c),f=Kr.squaredLength(h,e);f<o&&(n={segmentIndex:a,value:c},o=f)}}return n||{segmentIndex:this.segments.length-1,value:1}}},{key:"closestPointTangent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;for(var n,i=this.getPrecision(t),r=this.getSubdivisions(t),o=1/0,a=0,s=this.segments.length;a<s;a+=1){var l=this.segments[a],u=r[a];if(l.isDifferentiable()){var c=l.closestPointT(e,{precision:i,subdivisions:u}),h=l.pointAtT(c),f=Kr.squaredLength(h,e);f<o&&(n=l.tangentAtT(c),o=f)}}return n||null}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.toPolylines(t);if(!n)return!1;for(var i=0,r=0,o=n.length;r<o;r+=1){n[r].containsPoint(e)&&(i+=1)}return i%2==1}},{key:"pointAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();var n=this.getOptions(t),i=this.length(n)*e;return this.pointAtLength(i,n)}},{key:"pointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;if(0===e)return this.start.clone();var n=!0;e<0&&(n=!1,e=-e);for(var i,r=this.getPrecision(t),o=this.getSubdivisions(t),a=0,s=0,l=this.segments.length;s<l;s+=1){var u=n?s:l-1-s,c=this.segments[u],h=o[u],f=c.length({precision:r,subdivisions:h});if(c.isVisible){if(e<=a+f)return c.pointAtLength((n?1:-1)*(e-a),{precision:r,subdivisions:h});i=c}a+=f}return i?n?i.end:i.start:this.segments[this.segments.length-1].end.clone()}},{key:"pointAtT",value:function(e){var t=this.segments,n=t.length;if(0===n)return null;var i=e.segmentIndex;if(i<0)return t[0].pointAtT(0);if(i>=n)return t[n-1].pointAtT(1);var r=Kr.clamp(e.value,0,1);return t[i].pointAtT(r)}},{key:"divideAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=Kr.clamp(e,0,1),i=this.getOptions(t),r=this.length(i)*n;return this.divideAtLength(r,i)}},{key:"divideAtLength",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var i=!0;e<0&&(i=!1,e=-e);for(var r,o,a,s,l,u=this.getPrecision(n),c=this.getSubdivisions(n),h=0,f=0,g=this.segments.length;f<g;f+=1){var d=i?f:g-1-f,v=this.getSegment(d),p={precision:u,subdivisions:c[d]},y=v.length(p);if(v.isDifferentiable()&&(a=v,s=d,e<=h+y)){o=d,r=v.divideAtLength((i?1:-1)*(e-h),p);break}h+=y}if(!a)return null;r||(o=s,l=i?1:0,r=a.divideAtT(l));var m=this.clone(),b=o;m.replaceSegment(b,r);var k=b,x=b+1,w=b+2;r[0].isDifferentiable()||(m.removeSegment(k),x-=1,w-=1);var P=m.getSegment(x).start;m.insertSegment(x,t.createSegment("M",P)),w+=1,r[1].isDifferentiable()||(m.removeSegment(w-1),w-=1);for(var C=w-k-1,A=w,O=m.segments.length;A<O;A+=1){var E=this.getSegment(A-C),M=m.getSegment(A);if("Z"===M.type&&!E.subpathStartSegment.end.equals(M.subpathStartSegment.end)){var S=t.createSegment("L",E.end);m.replaceSegment(A,S)}}return[new t(m.segments.slice(0,x)),new t(m.segments.slice(x))]}},{key:"intersectsWithLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.toPolylines(t);if(null==n)return null;for(var i=null,r=0,o=n.length;r<o;r+=1){var a,s=n[r],l=e.intersect(s);if(l)if(null==i&&(i=[]),Array.isArray(l))(a=i).push.apply(a,f(l));else i.push(l)}return i}},{key:"isDifferentiable",value:function(){for(var e=0,t=this.segments.length;e<t;e+=1){if(this.segments[e].isDifferentiable())return!0}return!1}},{key:"isValid",value:function(){var e=this.segments,t=0===e.length||"M"===e[0].type;return t}},{key:"length",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0===this.segments.length)return 0;for(var t=this.getSubdivisions(e),n=0,i=0,r=this.segments.length;i<r;i+=1){var o=this.segments[i],a=t[i];n+=o.length({subdivisions:a})}return n}},{key:"lengthAtT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segments.length;if(0===n)return 0;var i=e.segmentIndex;if(i<0)return 0;var r=Kr.clamp(e.value,0,1);i>=n&&(i=n-1,r=1);for(var o=this.getPrecision(t),a=this.getSubdivisions(t),s=0,l=0;l<i;l+=1){var u=this.segments[l],c=a[l];s+=u.length({precision:o,subdivisions:c})}var h=this.segments[i],f=a[i];return s+=h.lengthAtT(r,{precision:o,subdivisions:f})}},{key:"tangentAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=Kr.clamp(e,0,1),i=this.getOptions(t),r=this.length(i)*n;return this.tangentAtLength(r,i)}},{key:"tangentAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=!0;e<0&&(n=!1,e=-e);for(var i,r=this.getPrecision(t),o=this.getSubdivisions(t),a=0,s=0,l=this.segments.length;s<l;s+=1){var u=n?s:l-1-s,c=this.segments[u],h=o[u],f=c.length({precision:r,subdivisions:h});if(c.isDifferentiable()){if(e<=a+f)return c.tangentAtLength((n?1:-1)*(e-a),{precision:r,subdivisions:h});i=c}a+=f}if(i){var g=n?1:0;return i.tangentAtT(g)}return null}},{key:"tangentAtT",value:function(e){var t=this.segments.length;if(0===t)return null;var n=e.segmentIndex;if(n<0)return this.segments[0].tangentAtT(0);if(n>=t)return this.segments[t-1].tangentAtT(1);var i=Kr.clamp(e.value,0,1);return this.segments[n].tangentAtT(i)}},{key:"getPrecision",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null==e.precision?this.PRECISION:e.precision}},{key:"getSubdivisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null==e.segmentSubdivisions){var t=this.getPrecision(e);return this.getSegmentSubdivisions({precision:t})}return e.segmentSubdivisions}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{precision:this.getPrecision(e),segmentSubdivisions:this.getSubdivisions(e)}}},{key:"toPoints",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.segments,n=t.length;if(0===n)return null;for(var i=this.getSubdivisions(e),r=[],o=[],a=0;a<n;a+=1){var s=t[a];if(s.isVisible){var l=i[a];l.length>0?l.forEach((function(e){return o.push(e.start)})):o.push(s.start)}else o.length>0&&(o.push(t[a-1].end),r.push(o),o=[])}return o.length>0&&(o.push(this.end),r.push(o)),r}},{key:"toPolylines",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.toPoints(e);return t?t.map((function(e){return new co(e)})):null}},{key:"scale",value:function(e,t,n){return this.segments.forEach((function(i){return i.scale(e,t,n)})),this}},{key:"rotate",value:function(e,t){return this.segments.forEach((function(n){return n.rotate(e,t)})),this}},{key:"translate",value:function(e,t){return"number"==typeof e?this.segments.forEach((function(n){return n.translate(e,t)})):this.segments.forEach((function(t){return t.translate(e)})),this}},{key:"clone",value:function(){var e=new t;return this.segments.forEach((function(t){return e.appendSegment(t.clone())})),e}},{key:"equals",value:function(e){if(null==e)return!1;var t=this.segments,n=e.segments,i=t.length;if(n.length!==i)return!1;for(var r=0;r<i;r+=1){var o=t[r],a=n[r];if(o.type!==a.type||!o.equals(a))return!1}return!0}},{key:"toJSON",value:function(){return this.segments.map((function(e){return e.toJSON()}))}},{key:"serialize",value:function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map((function(e){return e.serialize()})).join(" ")}},{key:"toString",value:function(){return this.serialize()}}])}($r);!function(e){e.isPath=function(t){return null!=t&&t instanceof e}}(Co||(Co={})),function(e){function t(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o,a;if("M"===e)return(r=po.create).call.apply(r,[null].concat(n));if("L"===e)return(o=go.create).call.apply(o,[null].concat(n));if("C"===e)return(a=yo.create).call.apply(a,[null].concat(n));if("z"===e||"Z"===e)return vo.create();throw new Error('Invalid path segment type "'.concat(e,'"'))}e.parse=function(n){if(!n)return new e;var i=new e,r=e.normalize(n).match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g);if(null!=r)for(var o=0,a=r.length;o<a;o+=1){var s=r[o].match(/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g);if(null!=s){var l=s[0],u=s.slice(1).map((function(e){return+e})),c=t.call.apply(t,[null,l].concat(f(u)));i.appendSegment(c)}}return i},e.createSegment=t}(Co||(Co={})),function(e){e.normalize=Po,e.isValid=oo,e.drawArc=uo,e.drawPoints=so,e.arcToCurves=lo}(Co||(Co={}));var Ao=function(){return y((function e(t){v(this,e),this.options=Object.assign({},t),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}),[{key:"names",get:function(){return Object.keys(this.data)}},{key:"register",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("object"!==b(e)){!this.exist(e)||i||qn.isApplyingHMR()||this.onDuplicated(e);var o=this.options.process,a=o?mn(o,this,e,t):t;return this.data[e]=a,a}Object.entries(e).forEach((function(e){var i=r(e,2),o=i[0],a=i[1];n.register(o,a,t)}))}},{key:"unregister",value:function(e){var t=e?this.data[e]:null;return delete this.data[e],t}},{key:"get",value:function(e){return e?this.data[e]:null}},{key:"exist",value:function(e){return!!e&&null!=this.data[e]}},{key:"onDuplicated",value:function(e){try{throw this.options.onConflict&&mn(this.options.onConflict,this,e),new Error("".concat(nt(this.options.type)," with name '").concat(e,"' already registered."))}catch(gh){throw gh}}},{key:"onNotFound",value:function(e,t){throw new Error(this.getSpellingSuggestion(e,t))}},{key:"getSpellingSuggestion",value:function(e,t){var n=this.getSpellingSuggestionForName(e),i=t?"".concat(t," ").concat(en(this.options.type)):this.options.type;return"".concat(nt(i)," with name '").concat(e,"' does not exist.").concat(n?" Did you mean '".concat(n,"'?"):"")}},{key:"getSpellingSuggestionForName",value:function(e){return Vn(e,Object.keys(this.data),(function(e){return e}))}}])}();!function(e){e.create=function(t){return new e(t)}}(Ao||(Ao={}));var Oo={color:"#aaaaaa",thickness:1,markup:"rect",update:function(e,t){var n=t.thickness*t.sx,i=t.thickness*t.sy;Bi(e,{width:n,height:i,rx:n,ry:i,fill:t.color})}},Eo={color:"#aaaaaa",thickness:1,markup:"rect",update:function(e,t){var n=t.sx<=1?t.thickness*t.sx:t.thickness;Bi(e,{width:n,height:n,rx:n,ry:n,fill:t.color})}},Mo={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update:function(e,t){var n=t.width,i=t.height,r=t.thickness;Bi(e,{d:n-r>=0&&i-r>=0?["M",n,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",stroke:t.color,"stroke-width":t.thickness})}},So=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update:function(e,t){var n=t.width,i=t.height,r=t.thickness;Bi(e,{d:n-r>=0&&i-r>=0?["M",n,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",stroke:t.color,"stroke-width":t.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update:function(e,t){var n,i=t.factor||1,r=t.width*i,o=t.height*i,a=t.thickness;n=r-a>=0&&o-a>=0?["M",r,0,"H0 M0 0 V0",o].join(" "):"M 0 0 0 0",t.width=r,t.height=o,Bi(e,{d:n,stroke:t.color,"stroke-width":t.thickness})}}],To=Object.freeze(Object.defineProperty({__proto__:null,dot:Oo,doubleMesh:So,fixedDot:Eo,mesh:Mo},Symbol.toStringTag,{value:"Module"})),No=function(){return y((function e(){v(this,e),this.patterns={},this.root=ir.create(Pi(),{width:"100%",height:"100%"},[wi("defs")]).node}),[{key:"add",value:function(e,t){var n=this.root.childNodes[0];n&&n.appendChild(t),this.patterns[e]=t,ir.create("rect",{width:"100%",height:"100%",fill:"url(#".concat(e,")")}).appendTo(this.root)}},{key:"get",value:function(e){return this.patterns[e]}},{key:"has",value:function(e){return null!=this.patterns[e]}}])}();!function(e){e.presets=To,e.registry=Ao.create({type:"grid"}),e.registry.register(e.presets,!0)}(No||(No={}));var jo,Lo=function(e){var t=document.createElement("canvas"),n=e.width,i=e.height;t.width=2*n,t.height=i;var r=t.getContext("2d");return r.drawImage(e,0,0,n,i),r.translate(2*n,0),r.scale(-1,1),r.drawImage(e,0,0,n,i),t},Do=function(e){var t=document.createElement("canvas"),n=e.width,i=e.height;t.width=n,t.height=2*i;var r=t.getContext("2d");return r.drawImage(e,0,0,n,i),r.translate(0,2*i),r.scale(1,-1),r.drawImage(e,0,0,n,i),t},Io=function(e){var t=document.createElement("canvas"),n=e.width,i=e.height;t.width=2*n,t.height=2*i;var r=t.getContext("2d");return r.drawImage(e,0,0,n,i),r.setTransform(-1,0,0,-1,t.width,t.height),r.drawImage(e,0,0,n,i),r.setTransform(-1,0,0,1,t.width,0),r.drawImage(e,0,0,n,i),r.setTransform(1,0,0,-1,0,t.height),r.drawImage(e,0,0,n,i),t},Ro=Object.freeze(Object.defineProperty({__proto__:null,flipX:Lo,flipXY:Io,flipY:Do,watermark:function(e,t){var n=e.width,i=e.height,r=document.createElement("canvas");r.width=3*n,r.height=3*i;for(var o=r.getContext("2d"),a=null!=t.angle?-t.angle:-20,s=Zr.toRad(a),l=r.width/4,u=r.height/4,c=0;c<4;c+=1)for(var h=0;h<4;h+=1)(c+h)%2>0&&(o.setTransform(1,0,0,1,(2*c-1)*l,(2*h-1)*u),o.rotate(s),o.drawImage(e,-n/2,-i/2,n,i));return r}},Symbol.toStringTag,{value:"Module"}));function Vo(e,t){return null!=e?e:t}function Bo(e,t){return null!=e&&Number.isFinite(e)?e:t}!function(e){e.presets=Object.assign({},Ro),e.presets["flip-x"]=Lo,e.presets["flip-y"]=Do,e.presets["flip-xy"]=Io,e.registry=Ao.create({type:"background pattern"}),e.registry.register(e.presets,!0)}(jo||(jo={}));var zo,Fo=Object.freeze(Object.defineProperty({__proto__:null,blur:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Bo(e.x,2),n=null!=e.y&&Number.isFinite(e.y)?[t,e.y]:t;return'\n    <filter>\n      <feGaussianBlur stdDeviation="'.concat(n,'"/>\n    </filter>\n  ').trim()},brightness:function(){var e=Bo((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1);return'\n    <filter>\n      <feComponentTransfer>\n        <feFuncR type="linear" slope="'.concat(e,'"/>\n        <feFuncG type="linear" slope="').concat(e,'"/>\n        <feFuncB type="linear" slope="').concat(e,'"/>\n      </feComponentTransfer>\n    </filter>\n  ').trim()},contrast:function(){var e=Bo((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=.5-e/2;return'\n    <filter>\n     <feComponentTransfer>\n        <feFuncR type="linear" slope="'.concat(e,'" intercept="').concat(t,'"/>\n        <feFuncG type="linear" slope="').concat(e,'" intercept="').concat(t,'"/>\n        <feFuncB type="linear" slope="').concat(e,'" intercept="').concat(t,'"/>\n      </feComponentTransfer>\n    </filter>\n  ').trim()},dropShadow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Bo(e.dx,0),n=Bo(e.dy,0),i=Vo(e.color,"black"),r=Bo(e.blur,4),o=Bo(e.opacity,1);return"SVGFEDropShadowElement"in window?'<filter>\n         <feDropShadow stdDeviation="'.concat(r,'" dx="').concat(t,'" dy="').concat(n,'" flood-color="').concat(i,'" flood-opacity="').concat(o,'" />\n       </filter>').trim():'<filter>\n         <feGaussianBlur in="SourceAlpha" stdDeviation="'.concat(r,'" />\n         <feOffset dx="').concat(t,'" dy="').concat(n,'" result="offsetblur" />\n         <feFlood flood-color="').concat(i,'" />\n         <feComposite in2="offsetblur" operator="in" />\n         <feComponentTransfer>\n           <feFuncA type="linear" slope="').concat(o,'" />\n         </feComponentTransfer>\n         <feMerge>\n           <feMergeNode/>\n           <feMergeNode in="SourceGraphic"/>\n         </feMerge>\n       </filter>').trim()},grayScale:function(){var e=Bo((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=.7152-.7152*(1-e),n=.0722-.0722*(1-e),i=.2126-.2126*(1-e),r=.7152+.2848*(1-e),o=.0722-.0722*(1-e),a=.2126-.2126*(1-e),s=.0722+.9278*(1-e);return'\n    <filter>\n      <feColorMatrix type="matrix" values="'.concat(.2126+.7874*(1-e)," ").concat(t," ").concat(n," 0 0 ").concat(i," ").concat(r," ").concat(o," 0 0 ").concat(a," ").concat(t," ").concat(s,' 0 0 0 0 0 1 0"/>\n    </filter>\n  ').trim()},highlight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Vo(e.color,"red"),n=Bo(e.blur,0),i=Bo(e.width,1),r=Bo(e.opacity,1);return'\n      <filter>\n        <feFlood flood-color="'.concat(t,'" flood-opacity="').concat(r,'" result="colored"/>\n        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="').concat(i,'"/>\n        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>\n        <feGaussianBlur result="blured" in="composed" stdDeviation="').concat(n,'"/>\n        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>\n      </filter>\n    ').trim()},hueRotate:function(){var e=Bo((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).angle,0);return'\n      <filter>\n        <feColorMatrix type="hueRotate" values="'.concat(e,'"/>\n      </filter>\n    ').trim()},invert:function(){var e=Bo((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=1-e;return'\n      <filter>\n        <feComponentTransfer>\n          <feFuncR type="table" tableValues="'.concat(e," ").concat(t,'"/>\n          <feFuncG type="table" tableValues="').concat(e," ").concat(t,'"/>\n          <feFuncB type="table" tableValues="').concat(e," ").concat(t,'"/>\n        </feComponentTransfer>\n      </filter>\n    ').trim()},outline:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Vo(e.color,"blue"),n=Bo(e.width,1),i=Bo(e.margin,2),r=Bo(e.opacity,1),o=i,a=i+n;return'\n    <filter>\n      <feFlood flood-color="'.concat(t,'" flood-opacity="').concat(r,'" result="colored"/>\n      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="').concat(a,'" />\n      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="').concat(o,'" />\n      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>\n      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>\n      <feMerge>\n        <feMergeNode in="outline"/>\n        <feMergeNode in="SourceGraphic"/>\n      </feMerge>\n    </filter>\n  ').trim()},saturate:function(){var e=Bo((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1);return'\n      <filter>\n        <feColorMatrix type="saturate" values="'.concat(1-e,'"/>\n      </filter>\n    ').trim()},sepia:function(){var e=Bo((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=.769-.769*(1-e),n=.189-.189*(1-e),i=.349-.349*(1-e),r=.686+.314*(1-e),o=.168-.168*(1-e),a=.272-.272*(1-e),s=.534-.534*(1-e),l=.131+.869*(1-e);return'\n      <filter>\n        <feColorMatrix type="matrix" values="'.concat(.393+.607*(1-e)," ").concat(t," ").concat(n," 0 0 ").concat(i," ").concat(r," ").concat(o," 0 0 ").concat(a," ").concat(s," ").concat(l,' 0 0 0 0 0 1 0"/>\n      </filter>\n    ').trim()}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Fo,e.registry=Ao.create({type:"filter"}),e.registry.register(e.presets,!0)}(zo||(zo={}));var Go,qo,Ho={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},_o={position:ga("x","width","origin")},Uo={position:ga("y","height","origin")},Wo={position:ga("x","width","corner")},Jo={position:ga("y","height","corner")},Xo={set:da("width","width")},Yo={set:da("height","height")},Zo={set:da("rx","width")},Ko={set:da("ry","height")},Qo={set:(Go=da("r","width"),qo=da("r","height"),function(e,t){var n=t.refBBox;return mn(n.height>n.width?Go:qo,this,e,t)})},$o={set:function(e,t){var n=t.refBBox,i=parseFloat(e),r=zn(e);r&&(i/=100);var o,a=Math.sqrt(n.height*n.height+n.width*n.width);return Number.isFinite(i)&&(o=r||i>=0&&i<=1?i*a:Math.max(i+a,0)),{r:o}}},ea={set:da("cx","width")},ta={set:da("cy","height")},na={set:pa({resetOffset:!0})},ia={set:pa({resetOffset:!1})},ra={set:ya({resetOffset:!0})},oa={set:ya({resetOffset:!1})},aa=Qo,sa=na,la=ra,ua=_o,ca=Uo,ha=Xo,fa=Yo;function ga(e,t,n){return function(i,r){var o=r.refBBox;if(null==i)return null;var a,s=parseFloat(i),l=zn(i);if(l&&(s/=100),Number.isFinite(s)){var u=o[n];a=l||s>0&&s<1?u[e]+o[t]*s:u[e]+s}var c=new eo;return c[e]=a||0,c}}function da(e,t){return function(n,i){var r=i.refBBox,o=parseFloat(n),a=zn(n);a&&(o/=100);var s={};if(Number.isFinite(o)){var l=a||o>=0&&o<=1?o*r[t]:Math.max(o+r[t],0);s[e]=l}return s}}function va(e,t){var n="x6-shape",i=t&&t.resetOffset;return function(t,r){var o=r.elem,a=r.refBBox,s=nr(o,n);if(!s||s.value!==t){var l=e(t);s={value:t,shape:l,shapeBBox:l.bbox()},nr(o,n,s)}var u=s.shape.clone(),c=s.shapeBBox.clone(),h=c.getOrigin(),f=a.getOrigin();c.x=f.x,c.y=f.y;var g=a.getMaxScaleToFit(c,f),d=0===c.width||0===a.width?1:g.sx,v=0===c.height||0===a.height?1:g.sy;return u.scale(d,v,h),i&&u.translate(-h.x,-h.y),u}}function pa(e){var t=va((function(e){return Co.parse(e)}),e);return function(e,n){return{d:t(e,n).serialize()}}}function ya(e){var t=va((function(e){return new co(e)}),e);return function(e,n){return{points:t(e,n).serialize()}}}var ma={qualify:D,set:function(e,t){var n=t.view;return"url(#".concat(n.graph.defineGradient(e),")")}},ba={qualify:D,set:function(e,t){var n=t.view,i=n.cell,r=Object.assign({},e);if(i.isEdge()&&"linearGradient"===r.type){var o=n,a=o.sourcePoint,s=o.targetPoint;r.id="gradient-".concat(r.type,"-").concat(i.id),r.attrs=Object.assign(Object.assign({},r.attrs),{x1:a.x,y1:a.y,x2:s.x,y2:s.y,gradientUnits:"userSpaceOnUse"}),n.graph.defs.remove(r.id)}return"url(#".concat(n.graph.defineGradient(r),")")}},ka={qualify:function(e,t){var n=t.attrs;return null==n.textWrap||!D(n.textWrap)},set:function(e,t){var n=t.view,i=t.elem,r=t.attrs,o="x6-text",a=nr(i,o),s=function(e){try{return JSON.parse(e)}catch(t){return e}},l={x:r.x,eol:r.eol,annotations:s(r.annotations),textPath:s(r["text-path"]||r.textPath),textVerticalAnchor:r["text-vertical-anchor"]||r.textVerticalAnchor,displayEmpty:"true"===(r["display-empty"]||r.displayEmpty),lineHeight:r["line-height"]||r.lineHeight},u=r["font-size"]||r.fontSize,c=JSON.stringify([e,l]);if(u&&i.setAttribute("font-size",u),null==a||a!==c){var h=l.textPath;if(null!=h&&"object"===b(h)){var f=h.selector;if("string"==typeof f){var g=n.find(f)[0];g instanceof SVGPathElement&&(yi(g),l.textPath=Object.assign({"xlink:href":"#".concat(g.id)},h))}}sr(i,"".concat(e),l),nr(i,o,c)}}},xa={qualify:D,set:function(e,t){var n=t.view,i=t.elem,r=t.attrs,o=t.refBBox,a=e,s=a.width||0;zn(s)?o.width*=parseFloat(s)/100:s<=0?o.width+=s:o.width=s;var l,u=a.height||0;zn(u)?o.height*=parseFloat(u)/100:u<=0?o.height+=u:o.height=u;var c=a.text;null==c&&(c=r.text||(null==i?void 0:i.textContent)),l=null!=c?cr("".concat(c),o,{"font-weight":r["font-weight"]||r.fontWeight,"font-size":r["font-size"]||r.fontSize,"font-family":r["font-family"]||r.fontFamily,lineHeight:r.lineHeight},{ellipsis:a.ellipsis}):"",mn(ka.set,this,l,{view:n,elem:i,attrs:r,refBBox:o,cell:n.cell})}},wa=function(e,t){return void 0!==t.attrs.text},Pa={qualify:wa},Ca={qualify:wa},Aa={qualify:wa},Oa={qualify:wa},Ea={qualify:wa},Ma={qualify:wa},Sa={qualify:function(e,t){return t.elem instanceof SVGElement},set:function(e,t){var n=t.elem,i="x6-title",r="".concat(e),o=nr(n,i);if(null==o||o!==r){nr(n,i,r);var a=n.firstChild;if(a&&"TITLE"===a.tagName.toUpperCase()){a.textContent=r}else{var s=document.createElementNS(n.namespaceURI,"title");s.textContent=r,n.insertBefore(s,a)}}}},Ta={offset:ja("x","width","right")},Na={offset:ja("y","height","bottom")};function ja(e,t,n){return function(i,r){var o,a=r.refBBox,s=new eo;return o="middle"===i?a[t]/2:i===n?a[t]:"number"==typeof i&&Number.isFinite(i)?i>-1&&i<1?-a[t]*i:-i:zn(i)?a[t]*parseFloat(i)/100:0,s[e]=-(a[e]+o),s}}var La={qualify:D,set:function(e,t){$i(t.elem,e)}},Da={qualify:D,set:function(e,t){var n=t.view;return"url(#".concat(n.graph.defineFilter(e),")")}},Ia={set:function(e){return null!=e&&"object"===b(e)&&e.id?e.id:e}};function Ra(e,t,n){var i,r;"object"===b(t)?(i=t.x,r=t.y):(i=t,r=n);var o=Co.parse(e),a=o.bbox();if(a){var s=-a.height/2-a.y,l=-a.width/2-a.x;"number"==typeof i&&(l-=i),"number"==typeof r&&(s-=r),o.translate(l,s)}return o.serialize()}var Va=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Ba(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3/4,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=e.size||10,a=e.width||o,s=e.height||o,l=new Co,u={};if(t)l.moveTo(a,0).lineTo(0,s/2).lineTo(a,s),u.fill="none";else{if(l.moveTo(0,s/2),l.lineTo(a,0),!n){var c=It(i,0,1);l.lineTo(a*c,s/2)}l.lineTo(a,s),l.close()}return Object.assign(Object.assign(Object.assign({},u),r),{tagName:"path",d:Ra(l.serialize(),{x:null!=e.offset?e.offset:-a/2})})}var za,Fa=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Ga=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},qa=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Ha=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},_a=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Ua=function(e){var t=e.r,n=_a(e,["r"]),i=t||5;return Object.assign(Object.assign({cx:i},n),{tagName:"circle",r:i})},Wa=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Ja=Object.freeze(Object.defineProperty({__proto__:null,async:function(e){var t=e.width,n=e.height,i=e.offset,r=e.open,o=e.flip,a=Ha(e,["width","height","offset","open","flip"]),s=n||6,l=t||10,u=!0===r,c=!0===o,h=Object.assign(Object.assign({},a),{tagName:"path"});c&&(s=-s);var f=new Co;return f.moveTo(0,s).lineTo(l,0),u?h.fill="none":(f.lineTo(l,s),f.close()),h.d=Ra(f.serialize(),{x:i||-l/2,y:s/2}),h},block:function(e){return Ba({size:e.size,width:e.width,height:e.height,offset:e.offset},!0===e.open,!0,void 0,Va(e,["size","width","height","offset","open"]))},circle:Ua,circlePlus:function(e){var t=e.r,n=_a(e,["r"]),i=t||5,r=new Co;return r.moveTo(i,0).lineTo(i,2*i),r.moveTo(0,i).lineTo(2*i,i),{children:[Object.assign(Object.assign({},Ua({r:i})),{fill:"none"}),Object.assign(Object.assign({},n),{tagName:"path",d:Ra(r.serialize(),-i)})]}},classic:function(e){return Ba({size:e.size,width:e.width,height:e.height,offset:e.offset},!1,!1,e.factor,Va(e,["size","width","height","offset","factor"]))},cross:function(e){var t=e.size,n=e.width,i=e.height,r=e.offset,o=qa(e,["size","width","height","offset"]),a=t||10,s=n||a,l=i||a,u=new Co;return u.moveTo(0,0).lineTo(s,l).moveTo(0,l).lineTo(s,0),Object.assign(Object.assign({},o),{tagName:"path",fill:"none",d:Ra(u.serialize(),r||-s/2)})},diamond:function(e){var t=e.size,n=e.width,i=e.height,r=e.offset,o=Fa(e,["size","width","height","offset"]),a=t||10,s=n||a,l=i||a,u=new Co;return u.moveTo(0,l/2).lineTo(s/2,0).lineTo(s,l/2).lineTo(s/2,l).close(),Object.assign(Object.assign({},o),{tagName:"path",d:Ra(u.serialize(),null==r?-s/2:r)})},ellipse:function(e){var t=e.rx,n=e.ry,i=Wa(e,["rx","ry"]),r=t||5,o=n||5;return Object.assign(Object.assign({cx:r},i),{tagName:"ellipse",rx:r,ry:o})},path:function(e){var t=e.d,n=e.offsetX,i=e.offsetY,r=Ga(e,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},r),{tagName:"path",d:Ra(t,n,i)})}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Ja,e.registry=Ao.create({type:"marker"}),e.registry.register(e.presets,!0)}(za||(za={})),function(e){e.normalize=Ra}(za||(za={}));var Xa=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Ya(e){return"string"==typeof e||D(e)}var Za={qualify:Ya,set:function(e,t){return $a("marker-start",e,t.view,t.attrs)}},Ka={qualify:Ya,set:function(e,t){return $a("marker-end",e,t.view,t.attrs,{transform:"rotate(180)"})}},Qa={qualify:Ya,set:function(e,t){return $a("marker-mid",e,t.view,t.attrs)}};function $a(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a="string"==typeof t?{name:t}:t,s=a.name,l=a.args,u=Xa(a,["name","args"]),c=u;if(s&&"string"==typeof s){var h=za.registry.get(s);if(!h)return za.registry.onNotFound(s);c=h(Object.assign(Object.assign({},u),l))}var f=Object.assign(Object.assign(Object.assign({},function(e,t){var n={},i=e.stroke;"string"==typeof i&&(n.stroke=i,n.fill=i);var r=e.strokeOpacity;null==r&&(r=e["stroke-opacity"]);null==r&&(r=e.opacity);null!=r&&(n["stroke-opacity"]=r,n["fill-opacity"]=r);if("marker-mid"!==t){var o=parseFloat(e.strokeWidth||e["stroke-width"]);if(Number.isFinite(o)&&o>1){var a=Math.ceil(o/2);n.refX="marker-start"===t?a:-a}}return n}(i,e)),r),c);return o({},e,"url(#".concat(n.graph.defineMarker(f),")"))}var es=function(e,t){return t.view.cell.isEdge()},ts={qualify:es,set:function(e,t){var n,i,r,o,a,s=t.view,l=e.reverse||!1,u=e.stubs||0;if(Number.isFinite(u)&&0!==u)if(l){var c,h,f=s.getConnectionLength()||0;u<0?(c=(f+u)/2,h=-u):(c=u,h=f-2*u);var g=s.getConnection();a=null===(o=null===(r=null===(i=null===(n=null==g?void 0:g.divideAtLength(c))||void 0===n?void 0:n[1])||void 0===i?void 0:i.divideAtLength(h))||void 0===r?void 0:r[0])||void 0===o?void 0:o.serialize()}else{var d;if(u<0)d=((s.getConnectionLength()||0)+u)/2;else d=u;var v=s.getConnection();if(v){var p=v.divideAtLength(d),y=v.divideAtLength(-d);p&&y&&(a="".concat(p[0].serialize()," ").concat(y[1].serialize()))}}return{d:a||s.getConnectionPathData()}}},ns={qualify:es,set:ls("getTangentAtLength",{rotate:!0})},is={qualify:es,set:ls("getTangentAtLength",{rotate:!1})},rs={qualify:es,set:ls("getTangentAtRatio",{rotate:!0})},os={qualify:es,set:ls("getTangentAtRatio",{rotate:!1})},as=ns,ss=rs;function ls(e,t){var n={x:1,y:0};return function(i,r){var o,a,s=r.view,l=s[e](Number(i));return l?(a=t.rotate?l.vector().vectorAngle(n):0,o=l.start):(o=s.path.start,a=0),0===a?{transform:"translate(".concat(o.x,",").concat(o.y,"')")}:{transform:"translate(".concat(o.x,",").concat(o.y,"') rotate(").concat(a,")")}}}var us,cs=Object.freeze(Object.defineProperty({__proto__:null,annotations:Oa,atConnectionLength:as,atConnectionLengthIgnoreGradient:is,atConnectionLengthKeepGradient:ns,atConnectionRatio:ss,atConnectionRatioIgnoreGradient:os,atConnectionRatioKeepGradient:rs,connection:ts,displayEmpty:Ma,eol:Ea,fill:ma,filter:Da,html:{set:function(e,t){t.elem.innerHTML="".concat(e)}},lineHeight:Pa,port:Ia,ref:{},refCx:ea,refCy:ta,refD:sa,refDKeepOffset:ia,refDResetOffset:na,refDx:Wo,refDy:Jo,refHeight:Yo,refHeight2:fa,refPoints:la,refPointsKeepOffset:oa,refPointsResetOffset:ra,refR:aa,refRCircumscribed:$o,refRInscribed:Qo,refRx:Zo,refRy:Ko,refWidth:Xo,refWidth2:ha,refX:_o,refX2:ua,refY:Uo,refY2:ca,resetOffset:{offset:function(e,t){var n=t.refBBox;return e?{x:-n.x,y:-n.y}:{x:0,y:0}}},sourceMarker:Za,stroke:ba,style:La,targetMarker:Ka,text:ka,textPath:Aa,textVerticalAnchor:Ca,textWrap:xa,title:Sa,vertexMarker:Qa,xAlign:Ta,yAlign:Na},Symbol.toStringTag,{value:"Module"}));!function(e){e.isValidDefinition=function(e,t,n){if(null!=e){if("string"==typeof e)return!0;if("function"!=typeof e.qualify||mn(e.qualify,this,t,n))return!0}return!1}}(us||(us={})),function(e){e.presets=Object.assign(Object.assign({},Ho),cs),e.registry=Ao.create({type:"attribute definition"}),e.registry.register(e.presets,!0)}(us||(us={}));var hs,fs={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,prefix:function(e){return"".concat(fs.prefixCls,"-").concat(e)}},gs=fs.prefix("highlighted"),ds={highlight:function(e,t,n){gi(t,n&&n.className||gs)},unhighlight:function(e,t,n){di(t,n&&n.className||gs)}},vs=fs.prefix("highlight-opacity"),ps={highlight:function(e,t){gi(t,vs)},unhighlight:function(e,t){di(t,vs)}};!function(e){function t(e,t){var n,i,r,o=(n=e.x,i=e.y,r=wi("svg").createSVGPoint(),r.x=n,r.y=i,r).matrixTransform(t);return new eo(o.x,o.y)}function n(e,t){var n=wi("svg").createSVGPoint();n.x=e.x,n.y=e.y;var i=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y;var r=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y+e.height;var o=n.matrixTransform(t);n.x=e.x,n.y=e.y+e.height;var a=n.matrixTransform(t),s=Math.min(i.x,r.x,o.x,a.x),l=Math.max(i.x,r.x,o.x,a.x),u=Math.min(i.y,r.y,o.y,a.y),c=Math.max(i.y,r.y,o.y,a.y);return new to(s,u,l-s,c-u)}function i(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.ownerSVGElement||!mi(e)){if(Ni(e)){var a=r(e),s=a.left,l=a.top,u=a.width,c=a.height;return new to(s,l,u,c)}return new to(0,0,0,0)}var h=o.target;if(!o.recursive){try{t=e.getBBox()}catch(y){t={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight}}return h?n(t,Lr(e,h)):to.create(t)}var f=e.childNodes,g=f.length;if(0===g)return i(e,{target:h});h||(h=e);for(var d=0;d<g;d+=1){var v=f[d],p=void 0;p=0===v.childNodes.length?i(v,{target:h}):i(v,{target:h,recursive:!0}),t=t?t.union(p):p}return t}function r(e){var t=0,n=0,i=0,r=0;if(e){for(var o=e;o;)t+=o.offsetLeft,n+=o.offsetTop,(o=o.offsetParent)&&(t+=parseInt(Ki(o,"borderLeft"),10),n+=parseInt(Ki(o,"borderTop"),10));i=e.offsetWidth,r=e.offsetHeight}return{left:t,top:n,width:i,height:r}}function o(e){var t=function(t){var n=e.getAttribute(t),i=n?parseFloat(n):0;return Number.isNaN(i)?0:i};switch(e instanceof SVGElement&&e.nodeName.toLowerCase()){case"rect":return new to(t("x"),t("y"),t("width"),t("height"));case"circle":return new io(t("cx"),t("cy"),t("r"),t("r"));case"ellipse":return new io(t("cx"),t("cy"),t("rx"),t("ry"));case"polyline":var n=dr(e);return new co(n);case"polygon":var r=dr(e);return r.length>1&&r.push(r[0]),new co(r);case"path":var o=e.getAttribute("d");return Co.isValid(o)||(o=Co.normalize(o)),Co.parse(o);case"line":return new no(t("x1"),t("y1"),t("x2"),t("y2"))}return i(e)}function a(e){if(null==e)return null;var t=e;do{var n=t.tagName;if("string"!=typeof n)return null;if(n=n.toUpperCase(),fi(t,"x6-port"))t=t.nextElementSibling;else if("G"===n)t=t.firstElementChild;else{if("TITLE"!==n)break;t=t.nextElementSibling}}while(t);return t}e.normalizeMarker=Ra,e.transformPoint=t,e.transformLine=function(e,n){return new no(t(e.start,n),t(e.end,n))},e.transformPolyline=function(e,n){var i=e instanceof co?e.points:e;return Array.isArray(i)||(i=[]),new co(i.map((function(e){return t(e,n)})))},e.transformRectangle=n,e.bbox=function(e,t,i){var r,o=e.ownerSVGElement;if(!o)return new to(0,0,0,0);try{r=e.getBBox()}catch(a){r={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight}}return t?to.create(r):n(r,Lr(e,i||o))},e.getBBox=i,e.getBoundingOffsetRect=r,e.toGeometryShape=o,e.translateAndAutoOrient=function(e,t,n,r){var o=eo.create(t),a=eo.create(n);r||(r=e instanceof SVGSVGElement?e:e.ownerSVGElement);var s=jr(e);e.setAttribute("transform","");var l=i(e,{target:r}).scale(s.sx,s.sy),u=Cr();u.setTranslate(-l.x-l.width/2,-l.y-l.height/2);var c=Cr(),h=o.angleBetween(a,o.clone().translate(1,0));h&&c.setRotate(h,0,0);var f=Cr(),g=o.clone().move(a,l.width/2);f.setTranslate(2*o.x-g.x,2*o.y-g.y);var d=Lr(e,r),v=Cr();v.setMatrix(f.matrix.multiply(c.matrix.multiply(u.matrix.multiply(d.scale(s.sx,s.sy))))),e.setAttribute("transform",Or(v.matrix))},e.findShapeNode=a,e.getBBoxV2=function(e){var t=a(e);if(!mi(t)){if(Ni(e)){var n=r(e),i=n.left,s=n.top,l=n.width,u=n.height;return new to(i,s,l,u)}return new to(0,0,0,0)}return o(t).bbox()||to.create()}}(hs||(hs={}));var ys,ms={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},bs={highlight:function(e,t,n){var i=ys.getHighlighterId(t,n);if(!ys.hasCache(i)){n=Wt({},n,ms);var r,o,a=ir.create(t);try{r=a.toPathData()}catch(b){o=hs.bbox(a.node,!0),r=vr(Object.assign(Object.assign({},n),o))}var s=wi("path");if(Bi(s,Object.assign({d:r,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},n.attrs?Fi(n.attrs):null)),e.isEdgeElement(t))Bi(s,"d",e.getConnectionPathData());else{var l=a.getTransformToElement(e.container),u=n.padding;if(u){null==o&&(o=hs.bbox(a.node,!0));var c=o.x+o.width/2,h=o.y+o.height/2;o=hs.transformRectangle(o,l);var f=Math.max(o.width,1),g=Math.max(o.height,1),d=(f+u)/f,v=(g+u)/g,p=Pr({a:d,b:0,c:0,d:v,e:c-d*c,f:h-v*h});l=l.multiply(p)}Sr(s,l)}gi(s,fs.prefix("highlight-stroke"));var y=e.cell,m=function(){return ys.removeHighlighter(i)};y.on("removed",m),y.model&&y.model.on("reseted",m),e.container.appendChild(s),ys.setCache(i,s)}},unhighlight:function(e,t,n){ys.removeHighlighter(ys.getHighlighterId(t,n))}};!function(e){e.getHighlighterId=function(e,t){return yi(e),e.id+JSON.stringify(t)};var t={};e.setCache=function(e,n){t[e]=n},e.hasCache=function(e){return null!=t[e]},e.removeHighlighter=function(e){var n=t[e];n&&(Ei(n),delete t[e])}}(ys||(ys={}));var ks,xs=Object.freeze(Object.defineProperty({__proto__:null,className:ds,opacity:ps,stroke:bs},Symbol.toStringTag,{value:"Module"}));function ws(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new eo(Fn(t.x,e.width),Fn(t.y,e.height))}function Ps(e,t,n){return Object.assign({angle:t,position:e.toJSON()},n)}!function(e){e.check=function(e,t){if("function"!=typeof t.highlight)throw new Error("Highlighter '".concat(e,"' is missing required `highlight()` method"));if("function"!=typeof t.unhighlight)throw new Error("Highlighter '".concat(e,"' is missing required `unhighlight()` method"))}}(ks||(ks={})),function(e){e.presets=xs,e.registry=Ao.create({type:"highlighter"}),e.registry.register(e.presets,!0)}(ks||(ks={}));function Cs(e,t,n,i){var r=t.getCenter(),o=t.getTopCenter(),a=t.width/t.height,s=io.fromRect(t),l=e.length;return e.map((function(e,t){var u=n+i(t,l),c=o.clone().rotate(-u,r).scale(a,1,r),h=e.compensateRotate?-s.tangentTheta(c):0;return(e.dx||e.dy)&&c.translate(e.dx||0,e.dy||0),e.dr&&c.move(r,e.dr),Ps(c.round(),h,e)}))}var As=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Os(e,t,n,i){var r=new no(t,n),o=e.length;return e.map((function(e,t){var n=e.strict,a=As(e,["strict"]),s=n||i.strict?(t+1)/(o+1):(t+.5)/o,l=r.pointAt(s);return(a.dx||a.dy)&&l.translate(a.dx||0,a.dy||0),Ps(l.round(),0,a)}))}var Es,Ms=Object.freeze(Object.defineProperty({__proto__:null,absolute:function(e,t){return e.map((function(e){var n=e.x,i=e.y,r=e.angle;return Ps(ws(t,{x:n,y:i}),r||0)}))},bottom:function(e,t,n){return Os(e,t.getBottomLeft(),t.getBottomRight(),n)},ellipse:function(e,t,n){var i=n.start||0,r=n.step||20;return Cs(e,t,i,(function(e,t){return(e+.5-t/2)*r}))},ellipseSpread:function(e,t,n){var i=n.start||0,r=n.step||360/e.length;return Cs(e,t,i,(function(e){return e*r}))},left:function(e,t,n){return Os(e,t.getTopLeft(),t.getBottomLeft(),n)},line:function(e,t,n){return Os(e,ws(t,n.start||t.getOrigin()),ws(t,n.end||t.getCorner()),n)},right:function(e,t,n){return Os(e,t.getTopRight(),t.getBottomRight(),n)},top:function(e,t,n){return Os(e,t.getTopLeft(),t.getTopRight(),n)}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Ms,e.registry=Ao.create({type:"port layout"}),e.registry.register(e.presets,!0)}(Es||(Es={}));var Ss={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function Ts(e,t){var n=t||{},i=n.x,r=n.y,o=n.angle,a=n.attrs;return Wt({},{angle:o,attrs:a,position:{x:i,y:r}},e,Ss)}function Ns(e,t,n,i){var r,o,a,s,l=null!=i.offset?i.offset:15,u=t.getCenter().theta(e),c=Ls(t),h=0;return u<c[1]||u>c[2]?(r=".3em",o=l,a=0,s="start"):u<c[0]?(r="0",o=0,a=-l,n?(h=-90,s="start"):s="middle"):u<c[3]?(r=".3em",o=-l,a=0,s="end"):(r=".6em",o=0,a=l,n?(h=90,s="start"):s="middle"),Ts({position:{x:Math.round(o),y:Math.round(a)},angle:h,attrs:{".":{y:r,"text-anchor":s}}},i)}function js(e,t,n,i){var r,o,a,s,l=null!=i.offset?i.offset:15,u=t.getCenter().theta(e),c=Ls(t),h=0;return u<c[1]||u>c[2]?(r=".3em",o=-l,a=0,s="end"):u<c[0]?(r=".6em",o=0,a=l,n?(h=90,s="start"):s="middle"):u<c[3]?(r=".3em",o=l,a=0,s="start"):(r="0em",o=0,a=-l,n?(h=-90,s="start"):s="middle"),Ts({position:{x:Math.round(o),y:Math.round(a)},angle:h,attrs:{".":{y:r,"text-anchor":s}}},i)}function Ls(e){var t=e.getCenter(),n=t.theta(e.getTopLeft()),i=t.theta(e.getBottomLeft()),r=t.theta(e.getBottomRight());return[n,t.theta(e.getTopRight()),r,i]}function Ds(e,t,n){var i,r=null!=n.offset?n.offset:20,o=new eo(0,0),a=-e.theta(o),s=".3em",l=a;return(a+90)%180==0?(i=t?"end":"middle",t||-270!==a||(s="0em")):a>-270&&a<-90?(i="start",l=a-180):i="end",Ts({position:e.clone().move(o,r).diff(e).round().round().toJSON(),angle:t?l:0,attrs:{".":{y:s,"text-anchor":i}}},n)}var Is,Rs=Object.freeze(Object.defineProperty({__proto__:null,bottom:function(e,t,n){return Ts({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},n)},inside:function(e,t,n){return js(e,t,!1,n)},insideOriented:function(e,t,n){return js(e,t,!0,n)},left:function(e,t,n){return Ts({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},n)},manual:function(e,t,n){return Ts({position:t.getTopLeft()},n)},outside:function(e,t,n){return Ns(e,t,!1,n)},outsideOriented:function(e,t,n){return Ns(e,t,!0,n)},radial:function(e,t,n){return Ds(e.diff(t.getCenter()),!1,n)},radialOriented:function(e,t,n){return Ds(e.diff(t.getCenter()),!0,n)},right:function(e,t,n){return Ts({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},n)},top:function(e,t,n){return Ts({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},n)}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Rs,e.registry=Ao.create({type:"port label layout"}),e.registry.register(e.presets,!0)}(Is||(Is={}));var Vs,Bs=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},zs=function(e){function t(){var e;return v(this,t),(e=a(this,t)).cid=Vs.uniqueId(),t.views[e.cid]=e,e}return c(t,e),y(t,[{key:"priority",get:function(){return 2}},{key:"disposeContainer",get:function(){return!0}},{key:"confirmUpdate",value:function(e,t){return 0}},{key:"empty",value:function(){return Mi(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container),this}},{key:"unmount",value:function(){return Ei(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container),this}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container;return e===this.container?(this.removeEventListeners(document),this.onRemove(),delete t.views[this.cid],this.disposeContainer&&this.unmount(e)):this.unmount(e),this}},{key:"onRemove",value:function(){}},{key:"setClass",value:function(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container).classList.value=Array.isArray(e)?e.join(" "):e}},{key:"addClass",value:function(e){return gi(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,Array.isArray(e)?e.join(" "):e),this}},{key:"removeClass",value:function(e){return di(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,Array.isArray(e)?e.join(" "):e),this}},{key:"setStyle",value:function(e){return $i(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,e),this}},{key:"setAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;return null!=e&&null!=t&&Bi(t,e),this}},{key:"findAttr",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;t&&1===t.nodeType;){var n=t.getAttribute(e);if(null!=n)return n;if(t===this.container)return null;t=t.parentNode}return null}},{key:"find",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectors;return t.find(e,n,i).elems}},{key:"findOne",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectors,i=this.find(e,t,n);return i.length>0?i[0]:null}},{key:"findByAttr",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;t&&t.getAttribute;){var n=t.getAttribute(e);if((null!=n||t===this.container)&&"false"!==n)return t;t=t.parentNode}return null}},{key:"getSelector",value:function(e,t){var n;if(e===this.container)return"string"==typeof t&&(n="> ".concat(t)),n;if(e){var i=Ci(e)+1;n="".concat(e.tagName.toLowerCase(),":nth-child(").concat(i,")"),t&&(n+=" > ".concat(t)),n=this.getSelector(e.parentNode,n)}return n}},{key:"prefixClassName",value:function(e){return fs.prefix(e)}},{key:"delegateEvents",value:function(e,t){var n=this;if(null==e)return this;t||this.undelegateEvents();var i=/^(\S+)\s*(.*)$/;return Object.keys(e).forEach((function(t){var r=t.match(i);if(null!=r){var o=n.getEventHandler(e[t]);"function"==typeof o&&n.delegateEvent(r[1],r[2],o)}})),this}},{key:"undelegateEvents",value:function(){return Rr.off(this.container,this.getEventNamespace()),this}},{key:"delegateDocumentEvents",value:function(e,t){return this.addEventListeners(document,e,t),this}},{key:"undelegateDocumentEvents",value:function(){return this.removeEventListeners(document),this}},{key:"delegateEvent",value:function(e,t,n){return Rr.on(this.container,e+this.getEventNamespace(),t,n),this}},{key:"undelegateEvent",value:function(e,t,n){var i=e+this.getEventNamespace();return null==t?Rr.off(this.container,i):"string"==typeof t?Rr.off(this.container,i,t,n):Rr.off(this.container,i,t),this}},{key:"addEventListeners",value:function(e,t,n){var i=this;if(null==t)return this;var r=this.getEventNamespace();return Object.keys(t).forEach((function(o){var a=i.getEventHandler(t[o]);"function"==typeof a&&Rr.on(e,o+r,n,a)})),this}},{key:"removeEventListeners",value:function(e){return null!=e&&Rr.off(e,this.getEventNamespace()),this}},{key:"getEventNamespace",value:function(){return".".concat(fs.prefixCls,"-event-").concat(this.cid)}},{key:"getEventHandler",value:function(e){var t,n=this;if("string"==typeof e){var i=this[e];"function"==typeof i&&(t=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.call.apply(i,[n].concat(t))})}else t=function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.call.apply(e,[n].concat(i))};return t}},{key:"getEventTarget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.target,i=e.type,r=e.clientX,o=void 0===r?0:r,a=e.clientY,s=void 0===a?0:a;return t.fromPoint||"touchmove"===i||"touchend"===i?document.elementFromPoint(o,s):n}},{key:"stopPropagation",value:function(e){return this.setEventData(e,{propagationStopped:!0}),this}},{key:"isPropagationStopped",value:function(e){return!0===this.getEventData(e).propagationStopped}},{key:"getEventData",value:function(e){return this.eventData(e)}},{key:"setEventData",value:function(e,t){return this.eventData(e,t)}},{key:"eventData",value:function(e,t){if(null==e)throw new TypeError("Event object required");var n=e.data,i="__".concat(this.cid,"__");return null==t?null==n?{}:n[i]||{}:(null==n&&(n=e.data={}),null==n[i]?n[i]=Object.assign({},t):n[i]=Object.assign(Object.assign({},n[i]),t),n[i])}},{key:"normalizeEvent",value:function(e){return t.normalizeEvent(e)}},{key:"dispose",value:function(){this.remove()}}])}(Nn);Bs([zs.dispose()],zs.prototype,"dispose",null),function(e){e.createElement=function(e,t){return t?wi(e||"g"):xi(e||"div")},e.find=function(e,t,n){if(!e||"."===e)return{elems:[t]};if(n){var i=n[e];if(i)return{elems:Array.isArray(i)?i:[i]}}var r=e.includes(">")?":scope ".concat(e):e;return{isCSSSelector:!0,elems:Array.prototype.slice.call(t.querySelectorAll(r))}},e.normalizeEvent=function(e){var t=e,n=e.originalEvent,i=n&&n.changedTouches&&n.changedTouches[0];if(i){for(var r in e)void 0===i[r]&&(i[r]=e[r]);t=i}return t}}(zs||(zs={})),function(e){e.views={},e.getView=function(t){return e.views[t]||null}}(zs||(zs={})),function(e){var t=0;e.uniqueId=function(){var e="v".concat(t);return t+=1,e}}(Vs||(Vs={}));var Fs,Gs=function(){return y((function e(t){v(this,e),this.view=t,this.clean()}),[{key:"clean",value:function(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new Yr,this.pathCache={}}},{key:"get",value:function(e){return this.elemCache.has(e)||this.elemCache.set(e,{}),this.elemCache.get(e)}},{key:"getData",value:function(e){var t=this.get(e);return t.data||(t.data={}),t.data}},{key:"getMatrix",value:function(e){var t=this.get(e);if(null==t.matrix){var n=this.view.container;t.matrix=function(e,t){var n=Pr();if(mi(t)&&mi(e)){for(var i=e,r=[];i&&i!==t;){var o=Ar(i.getAttribute("transform")||null);r.push(o),i=i.parentNode}r.reverse().forEach((function(e){n=n.multiply(e)}))}return n}(e,n)}return Pr(t.matrix)}},{key:"getShape",value:function(e){var t=this.get(e);return null==t.shape&&(t.shape=hs.toGeometryShape(e)),t.shape.clone()}},{key:"getBoundingRect",value:function(e){var t=this.get(e);return null==t.boundingRect&&(t.boundingRect=hs.getBBoxV2(e)),t.boundingRect.clone()}}])}();!function(e){function t(e){return null!=e&&"string"==typeof e}function n(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:bi.svg},n=document.createDocumentFragment(),i={},r={},o=[{markup:Array.isArray(e)?e:[e],parent:n,ns:t.ns}],a=function(){var e=o.pop(),t=e.ns||bi.svg,n=e.markup,a=e.parent;n.forEach((function(e){var n=e.tagName;if(!n)throw new TypeError("Invalid tagName");e.ns&&(t=e.ns);var s=t?xi(n,t):ki(n),l=e.attrs;l&&Bi(s,Fi(l));var u=e.style;u&&$i(s,u);var c=e.className;null!=c&&s.setAttribute("class",Array.isArray(c)?c.join(" "):c),e.textContent&&(s.textContent=e.textContent);var h=e.selector;if(null!=h){if(r[h])throw new TypeError("Selector must be unique");r[h]=s}if(e.groupSelector){var f=e.groupSelector;Array.isArray(f)||(f=[f]),f.forEach((function(e){i[e]||(i[e]=[]),i[e].push(s)}))}a.appendChild(s);var g=e.children;Array.isArray(g)&&o.push({ns:t,markup:g,parent:s})}))};o.length>0;)a();return Object.keys(i).forEach((function(e){if(r[e])throw new Error("Ambiguous group selector");r[e]=i[e]})),{fragment:n,selectors:r,groups:i}}function i(e){return e instanceof SVGElement?wi("g"):ki("div")}e.isJSONMarkup=function(e){return null!=e&&!t(e)},e.isStringMarkup=t,e.clone=function(e){return null==e||t(e)?e:Q(e)},e.sanitize=function(e){return"".concat(e).trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")},e.parseJSONMarkup=n,e.renderMarkup=function(e){if(t(e)){var r=ir.createVectors(e),o=r.length;if(1===o)return{elem:r[0].node};if(o>1){var a=i(r[0].node);return r.forEach((function(e){a.appendChild(e.node)})),{elem:a}}return{}}var s=n(e),l=s.fragment,u=null;return l.childNodes.length>1?(u=i(l.firstChild)).appendChild(l):u=l.firstChild,{elem:u,selectors:s.selectors}},e.parseLabelStringMarkup=function(e){for(var t=ir.createVectors(e),n=document.createDocumentFragment(),i=0,r=t.length;i<r;i+=1){var o=t[i].node;n.appendChild(o)}return{fragment:n,selectors:{}}}}(Fs||(Fs={})),function(e){e.getSelector=function e(t,n,i){if(null!=t){var r,o=t.tagName.toLowerCase();if(t===n)return r="string"==typeof i?"> ".concat(o," > ").concat(i):"> ".concat(o);var a=t.parentNode;if(a&&a.childNodes.length>1){var s=Ci(t)+1;r="".concat(o,":nth-child(").concat(s,")")}else r=o;return i&&(r+=" > ".concat(i)),e(t.parentNode,n,r)}return i}}(Fs||(Fs={})),function(e){e.getPortContainerMarkup=function(){return"g"},e.getPortMarkup=function(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}},e.getPortLabelMarkup=function(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}}(Fs||(Fs={})),function(e){e.getEdgeMarkup=function(){return[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}]}}(Fs||(Fs={})),function(e){e.getForeignObjectMarkup=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{tagName:"foreignObject",selector:"fo",children:[{ns:bi.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:bi.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:e?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}}(Fs||(Fs={}));var qs=function(){return y((function e(t){v(this,e),this.view=t}),[{key:"cell",get:function(){return this.view.cell}},{key:"getDefinition",value:function(e){return this.cell.getAttrDefinition(e)}},{key:"processAttrs",value:function(e,t){var n,i,r,o,a=this,s=[];return Object.keys(t).forEach((function(i){var r=t[i],o=a.getDefinition(i),l=mn(us.isValidDefinition,a.view,o,r,{elem:e,attrs:t,cell:a.cell,view:a.view});if(o&&l)"string"==typeof o?(null==n&&(n={}),n[o]=r):null!==r&&s.push({name:i,definition:o});else{null==n&&(n={});var u=Di.includes(i)?i:Ln(i);n[u]=r}})),s.forEach((function(e){var n=e.name,a=e.definition,s=t[n];"function"==typeof a.set&&(null==i&&(i={}),i[n]=s),"function"==typeof a.offset&&(null==r&&(r={}),r[n]=s),"function"==typeof a.position&&(null==o&&(o={}),o[n]=s)})),{raw:t,normal:n,set:i,offset:r,position:o}}},{key:"mergeProcessedAttrs",value:function(e,t){e.set=Object.assign(Object.assign({},e.set),t.set),e.position=Object.assign(Object.assign({},e.position),t.position),e.offset=Object.assign(Object.assign({},e.offset),t.offset);var n=e.normal&&e.normal.transform;null!=n&&t.normal&&(t.normal.transform=n),e.normal=t.normal}},{key:"findAttrs",value:function(e,t,n,i){var r=[],o=new Yr;return Object.keys(e).forEach((function(a){var s=e[a];if(D(s)){var l=zs.find(a,t,i),u=l.isCSSSelector,c=l.elems;n[a]=c;for(var h=0,f=c.length;h<f;h+=1){var g=c[h],d=i&&i[a]===g,v=o.get(g);if(v){v.array||(r.push(g),v.array=!0,v.attrs=[v.attrs],v.priority=[v.priority]);var p=v.attrs,y=v.priority;if(d)p.unshift(s),y.unshift(-1);else{var m=fn(y,u?-1:f);p.splice(m,0,s),y.splice(m,0,f)}}else o.set(g,{elem:g,attrs:s,priority:d?-1:f,array:!1})}}})),r.forEach((function(e){var t=o.get(e),n=t.attrs;t.attrs=n.reduceRight((function(e,t){return nn(e,t)}),{})})),o}},{key:"updateRelativeAttrs",value:function(e,t,n){var i=this,r=t.raw||{},o=t.normal||{},a=t.set,s=t.position,l=t.offset,u=function(){return{elem:e,cell:i.cell,view:i.view,attrs:r,refBBox:n.clone()}};if(null!=a&&Object.keys(a).forEach((function(e){var t=a[e],n=i.getDefinition(e);if(null!=n){var r=mn(n.set,i.view,t,u());"object"===b(r)?o=Object.assign(Object.assign({},o),r):null!=r&&(o[e]=r)}})),e instanceof HTMLElement)this.view.setAttrs(o,e);else{var c=o.transform,h=Ar(c?"".concat(c):null),f=new eo(h.e,h.f);c&&(delete o.transform,h.e=0,h.f=0);var g=!1;null!=s&&Object.keys(s).forEach((function(e){var t=s[e],n=i.getDefinition(e);if(null!=n){var r=mn(n.position,i.view,t,u());null!=r&&(g=!0,f.translate(eo.create(r)))}})),this.view.setAttrs(o,e);var d=!1;if(null!=l){var v=this.view.getBoundingRectOfElement(e);if(v.width>0&&v.height>0){var p=hs.transformRectangle(v,h);Object.keys(l).forEach((function(t){var n=l[t],o=i.getDefinition(t);if(null!=o){var a=mn(o.offset,i.view,n,{elem:e,cell:i.cell,view:i.view,attrs:r,refBBox:p});null!=a&&(d=!0,f.translate(eo.create(a)))}}))}}(null!=c||g||d)&&(f.round(1),h.e=f.x,h.f=f.y,e.setAttribute("transform",Or(h)))}}},{key:"update",value:function(e,t,n){var i=this,r={},o=this.findAttrs(n.attrs||t,e,r,n.selectors),a=n.attrs?this.findAttrs(t,e,r,n.selectors):o,s=[];o.each((function(t){var o=t.elem,l=t.attrs,u=i.processAttrs(o,l);if(null==u.set&&null==u.position&&null==u.offset)i.view.setAttrs(u.normal,o);else{var c,h=a.get(o),f=h?h.attrs:null,g=f&&null==l.ref?f.ref:l.ref;if(g){if(!(c=(r[g]||i.view.find(g,e,n.selectors))[0]))throw new Error('"'.concat(g,'" reference does not exist.'))}else c=null;var d={node:o,refNode:c,attributes:f,processedAttributes:u},v=s.findIndex((function(e){return e.refNode===o}));v>-1?s.splice(v,0,d):s.push(d)}}));var l,u=new Yr;s.forEach((function(t){var r,o,a=t.node,s=t.refNode,c=null!=s&&null!=n.rotatableNode&&Oi(n.rotatableNode,s);if(s&&(r=u.get(s)),!r){var h=c?n.rotatableNode:e;r=s?hs.getBBox(s,{target:h}):n.rootBBox,s&&u.set(s,r)}n.attrs&&t.attributes?(o=i.processAttrs(a,t.attributes),i.mergeProcessedAttrs(o,t.processedAttributes)):o=t.processedAttributes;var f=r;c&&null!=n.rotatableNode&&!n.rotatableNode.contains(a)&&(l||(l=Ar(Bi(n.rotatableNode,"transform"))),f=hs.transformRectangle(r,l)),i.updateRelativeAttrs(a,o,f)}))}}])}(),Hs=function(){return y((function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];v(this,e),this.view=t;var r={},o={},a=0;Object.keys(n).forEach((function(e){var t=n[e];Array.isArray(t)||(t=[t]),t.forEach((function(t){var n=r[t];n||(a+=1,n=r[t]=1<<a),o[e]|=n}))}));var s=i;if(Array.isArray(s)||(s=[s]),s.forEach((function(e){r[e]||(a+=1,r[e]=1<<a)})),a>25)throw new Error("Maximum number of flags exceeded.");this.flags=r,this.attrs=o,this.bootstrap=i}),[{key:"cell",get:function(){return this.view.cell}},{key:"getFlag",value:function(e){var t=this.flags;return null==t?0:Array.isArray(e)?e.reduce((function(e,n){return e|t[n]}),0):0|t[e]}},{key:"hasAction",value:function(e,t){return e&this.getFlag(t)}},{key:"removeAction",value:function(e,t){return e^e&this.getFlag(t)}},{key:"getBootstrapFlag",value:function(){return this.getFlag(this.bootstrap)}},{key:"getChangedFlag",value:function(){var e=this,t=0;return this.attrs?(Object.keys(this.attrs).forEach((function(n){e.cell.hasChanged(n)&&(t|=e.attrs[n])})),t):t}}])}(),_s=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Us=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Ws=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v(this,t),(n=a(this,t)).cell=e,n.options=n.ensureOptions(i),n.graph=n.options.graph,n.attr=new qs(n),n.flag=new Hs(n,n.options.actions,n.options.bootstrap),n.cache=new Gs(n),n.setContainer(n.ensureContainer()),n.setup(),n.init(),n}return c(t,e),y(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"init",value:function(){}},{key:"onRemove",value:function(){this.removeTools()}},{key:"priority",get:function(){return this.options.priority}},{key:"rootSelector",get:function(){return this.options.rootSelector}},{key:"getConstructor",value:function(){return this.constructor}},{key:"ensureOptions",value:function(e){return this.getConstructor().getOptions(e)}},{key:"getContainerTagName",value:function(){return this.options.isSvgElement?"g":"div"}},{key:"getContainerStyle",value:function(){}},{key:"getContainerAttrs",value:function(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}},{key:"getContainerClassName",value:function(){return this.prefixClassName("cell")}},{key:"ensureContainer",value:function(){return zs.createElement(this.getContainerTagName(),this.options.isSvgElement)}},{key:"setContainer",value:function(e){if(this.container!==e){this.undelegateEvents(),this.container=e,null!=this.options.events&&this.delegateEvents(this.options.events);var t=this.getContainerAttrs();null!=t&&this.setAttrs(t,e);var n=this.getContainerStyle();null!=n&&this.setStyle(n,e);var i=this.getContainerClassName();null!=i&&this.addClass(i,e)}return this}},{key:"isNodeView",value:function(){return!1}},{key:"isEdgeView",value:function(){return!1}},{key:"render",value:function(){return this}},{key:"confirmUpdate",value:function(e){return 0}},{key:"getBootstrapFlag",value:function(){return this.flag.getBootstrapFlag()}},{key:"getFlag",value:function(e){return this.flag.getFlag(e)}},{key:"hasAction",value:function(e,t){return this.flag.hasAction(e,t)}},{key:"removeAction",value:function(e,t){return this.flag.removeAction(e,t)}},{key:"handleAction",value:function(e,t,n,i){if(this.hasAction(e,t)){n();var r=[t];return i&&("string"==typeof i?r.push(i):r.push.apply(r,f(i))),this.removeAction(e,r)}return e}},{key:"setup",value:function(){this.cell.on("changed",this.onCellChanged,this)}},{key:"onCellChanged",value:function(e){var t=e.options;this.onAttrsChange(t)}},{key:"onAttrsChange",value:function(e){var t=this.flag.getChangedFlag();!e.updated&&t&&(e.dirty&&this.hasAction(t,"update")&&(t|=this.getFlag("render")),e.toolId&&(e.async=!1),null!=this.graph&&this.graph.renderer.requestViewUpdate(this,t,e))}},{key:"parseJSONMarkup",value:function(e,t){var n=Fs.parseJSONMarkup(e),i=n.selectors,r=this.rootSelector;if(t&&r){if(i[r])throw new Error("Invalid root selector");i[r]=t}return n}},{key:"can",value:function(e){var t=this.graph.options.interacting;if("function"==typeof t&&(t=mn(t,this.graph,this)),"object"===b(t)){var n=t[e];return"function"==typeof n&&(n=mn(n,this.graph,this)),!1!==n}return"boolean"==typeof t&&t}},{key:"cleanCache",value:function(){return this.cache.clean(),this}},{key:"getCache",value:function(e){return this.cache.get(e)}},{key:"getDataOfElement",value:function(e){return this.cache.getData(e)}},{key:"getMatrixOfElement",value:function(e){return this.cache.getMatrix(e)}},{key:"getShapeOfElement",value:function(e){return this.cache.getShape(e)}},{key:"getBoundingRectOfElement",value:function(e){return this.cache.getBoundingRect(e)}},{key:"getBBoxOfElement",value:function(e){var t=this.getBoundingRectOfElement(e),n=this.getMatrixOfElement(e),i=this.getRootRotatedMatrix(),r=this.getRootTranslatedMatrix();return hs.transformRectangle(t,r.multiply(i).multiply(n))}},{key:"getUnrotatedBBoxOfElement",value:function(e){var t=this.getBoundingRectOfElement(e),n=this.getMatrixOfElement(e),i=this.getRootTranslatedMatrix();return hs.transformRectangle(t,i.multiply(n))}},{key:"getBBox",value:function(){var e;if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).useCellGeometry){var t=this.cell,n=t.isNode()?t.getAngle():0;e=t.getBBox().bbox(n)}else e=this.getBBoxOfElement(this.container);return this.graph.coord.localToGraphRect(e)}},{key:"getRootTranslatedMatrix",value:function(){var e=this.cell,t=e.isNode()?e.getPosition():{x:0,y:0};return Pr().translate(t.x,t.y)}},{key:"getRootRotatedMatrix",value:function(){var e=Pr(),t=this.cell,n=t.isNode()?t.getAngle():0;if(n){var i=t.getBBox(),r=i.width/2,o=i.height/2;e=e.translate(r,o).rotate(n).translate(-r,-o)}return e}},{key:"findMagnet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container;return this.findByAttr("magnet",e)}},{key:"updateAttrs",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null==n.rootBBox&&(n.rootBBox=new to),null==n.selectors&&(n.selectors=this.selectors),this.attr.update(e,t,n)}},{key:"isEdgeElement",value:function(e){return this.cell.isEdge()&&(null==e||e===this.container)}},{key:"prepareHighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e||this.container;return t.partial=n===this.container,n}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.prepareHighlight(e,t);return this.notify("cell:highlight",{magnet:n,options:t,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:n,options:t,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:n,options:t,view:this,node:this.cell,cell:this.cell}),this}},{key:"unhighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.prepareHighlight(e,t);return this.notify("cell:unhighlight",{magnet:n,options:t,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:n,options:t,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:n,options:t,view:this,edge:this.cell,cell:this.cell}),this}},{key:"notifyUnhighlight",value:function(e,t){}},{key:"getEdgeTerminal",value:function(e,t,n,i,r){var o=this.cell,a=this.findAttr("port",e),s=e.getAttribute("data-selector"),l={cell:o.id};return null!=s&&(l.magnet=s),null!=a?(l.port=a,o.isNode()&&(o.hasPort(a)||null!=s||(l.selector=this.getSelector(e)))):null==s&&this.container!==e&&(l.selector=this.getSelector(e)),l}},{key:"getMagnetFromEdgeTerminal",value:function(e){var t,n=this.cell,i=this.container,r=e.port,o=e.magnet;return null!=r&&n.isNode()&&n.hasPort(r)?t=this.findPortElem(r,o)||i:(o||(o=e.selector),o||null==r||(o='[port="'.concat(r,'"]')),t=this.findOne(o,i,this.selectors)),t}},{key:"hasTools",value:function(e){var t=this.tools;return null!=t&&(null==e||t.name===e)}},{key:"addTools",value:function(e){if(this.removeTools(),e){if(!this.can("toolsAddable"))return this;var t=Js.isToolsView(e)?e:new Js(e);this.tools=t,t.config({view:this}),t.mount()}return this}},{key:"updateTools",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.tools&&this.tools.update(e),this}},{key:"removeTools",value:function(){return this.tools&&(this.tools.remove(),this.tools=null),this}},{key:"hideTools",value:function(){return this.tools&&this.tools.hide(),this}},{key:"showTools",value:function(){return this.tools&&this.tools.show(),this}},{key:"renderTools",value:function(){var e=this.cell.getTools();return this.addTools(e),this}},{key:"notify",value:function(e,t){return this.trigger(e,t),this.graph.trigger(e,t),this}},{key:"getEventArgs",value:function(e,t,n){var i=this,r=i.cell;return null==t||null==n?{e:e,view:i,cell:r}:{e:e,x:t,y:n,view:i,cell:r}}},{key:"onClick",value:function(e,t,n){this.notify("cell:click",this.getEventArgs(e,t,n))}},{key:"onDblClick",value:function(e,t,n){this.notify("cell:dblclick",this.getEventArgs(e,t,n))}},{key:"onContextMenu",value:function(e,t,n){this.notify("cell:contextmenu",this.getEventArgs(e,t,n))}},{key:"onMouseDown",value:function(e,t,n){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(e,t,n))}},{key:"onMouseUp",value:function(e,t,n){this.notify("cell:mouseup",this.getEventArgs(e,t,n)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}},{key:"onMouseMove",value:function(e,t,n){this.notify("cell:mousemove",this.getEventArgs(e,t,n))}},{key:"onMouseOver",value:function(e){this.notify("cell:mouseover",this.getEventArgs(e))}},{key:"onMouseOut",value:function(e){this.notify("cell:mouseout",this.getEventArgs(e))}},{key:"onMouseEnter",value:function(e){this.notify("cell:mouseenter",this.getEventArgs(e))}},{key:"onMouseLeave",value:function(e){this.notify("cell:mouseleave",this.getEventArgs(e))}},{key:"onMouseWheel",value:function(e,t,n,i){this.notify("cell:mousewheel",Object.assign({delta:i},this.getEventArgs(e,t,n)))}},{key:"onCustomEvent",value:function(e,t,n,i){this.notify("cell:customevent",Object.assign({name:t},this.getEventArgs(e,n,i))),this.notify(t,Object.assign({},this.getEventArgs(e,n,i)))}},{key:"onMagnetMouseDown",value:function(e,t,n,i){}},{key:"onMagnetDblClick",value:function(e,t,n,i){}},{key:"onMagnetContextMenu",value:function(e,t,n,i){}},{key:"onLabelMouseDown",value:function(e,t,n){}},{key:"checkMouseleave",value:function(e){var t=this.getEventTarget(e,{fromPoint:!0}),n=this.graph.findViewByElem(t);n!==this&&(this.onMouseLeave(e),n&&n.onMouseEnter(e))}},{key:"dispose",value:function(){this.cell.off("changed",this.onCellChanged,this)}}],[{key:"getDefaults",value:function(){return this.defaults}},{key:"config",value:function(e){this.defaults=this.getOptions(e)}},{key:"getOptions",value:function(e){var t=function(e,t){return null!=t?$([].concat(f(Array.isArray(e)?e:[e]),f(Array.isArray(t)?t:[t]))):Array.isArray(e)?f(e):[e]},n=Q(this.getDefaults()),i=e.bootstrap,o=e.actions,a=e.events,s=e.documentEvents,l=Us(e,["bootstrap","actions","events","documentEvents"]);return i&&(n.bootstrap=t(n.bootstrap,i)),o&&Object.entries(o).forEach((function(e){var i=r(e,2),o=i[0],a=i[1],s=n.actions[o];a&&s?n.actions[o]=t(s,a):a&&(n.actions[o]=t(a))})),a&&(n.events=Object.assign(Object.assign({},n.events),a)),e.documentEvents&&(n.documentEvents=Object.assign(Object.assign({},n.documentEvents),s)),nn(n,l)}}])}(zs);Ws.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},_s([Ws.dispose()],Ws.prototype,"dispose",null),function(e){e.Flag=Hs,e.Attr=qs}(Ws||(Ws={})),function(e){e.toStringTag="X6.".concat(e.name),e.isCellView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNodeView&&"function"==typeof i.isEdgeView&&"function"==typeof i.confirmUpdate}}(Ws||(Ws={})),function(e){e.priority=function(e){return function(t){t.config({priority:e})}},e.bootstrap=function(e){return function(t){t.config({bootstrap:e})}}}(Ws||(Ws={})),function(e){e.registry=Ao.create({type:"view"})}(Ws||(Ws={}));var Js=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return v(this,t),(e=a(this,t)).svgContainer=e.createContainer(!0,n),e.htmlContainer=e.createContainer(!1,n),e.config(n),e}return c(t,e),y(t,[{key:"name",get:function(){return this.options.name}},{key:"graph",get:function(){return this.cellView.graph}},{key:"cell",get:function(){return this.cellView.cell}},{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"createContainer",value:function(e,t){var n=e?zs.createElement("g",!0):zs.createElement("div",!1);return gi(n,this.prefixClassName("cell-tools")),t.className&&gi(n,t.className),n}},{key:"config",value:function(e){if(this.options=Object.assign(Object.assign({},this.options),e),!Ws.isCellView(e.view)||e.view===this.cellView)return this;this.cellView=e.view,this.cell.isEdge()?(gi(this.svgContainer,this.prefixClassName("edge-tools")),gi(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(gi(this.svgContainer,this.prefixClassName("node-tools")),gi(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));var n=this.options.items;if(!Array.isArray(n))return this;this.tools=[];var i=[];n.forEach((function(e){t.ToolItem.isToolItem(e)?"vertices"===e.name?i.unshift(e):i.push(e):"vertices"===("object"===b(e)?e.name:e)?i.unshift(e):i.push(e)}));for(var r=0;r<i.length;r+=1){var o=i[r],a=void 0;if(t.ToolItem.isToolItem(o))a=o;else{var s="object"===b(o)?o.name:o,l="object"===b(o)&&o.args||{};if(s)if(this.cell.isNode()){var u=vl.registry.get(s);if(!u)return vl.registry.onNotFound(s);a=new u(l)}else if(this.cell.isEdge()){var c=pl.registry.get(s);if(!c)return pl.registry.onNotFound(s);a=new c(l)}}if(a)a.config(this.cellView,this),a.render(),(!1!==a.options.isSVGElement?this.svgContainer:this.htmlContainer).appendChild(a.container),this.tools.push(a)}return this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.tools;return t&&t.forEach((function(t){e.toolId!==t.cid&&t.isVisible()&&t.update()})),this}},{key:"focus",value:function(e){var t=this.tools;return t&&t.forEach((function(t){e===t?t.show():t.hide()})),this}},{key:"blur",value:function(e){var t=this.tools;return t&&t.forEach((function(t){t===e||t.isVisible()||(t.show(),t.update())})),this}},{key:"hide",value:function(){return this.focus(null)}},{key:"show",value:function(){return this.blur(null)}},{key:"remove",value:function(){var e=this.tools;return e&&(e.forEach((function(e){return e.remove()})),this.tools=null),Ei(this.svgContainer),Ei(this.htmlContainer),n(t,"remove",this,3)([])}},{key:"mount",value:function(){var e=this.tools,t=this.cellView;if(t&&e){var n=e.some((function(e){return!1!==e.options.isSVGElement})),i=e.some((function(e){return!1===e.options.isSVGElement}));if(n)(this.options.local?t.container:t.graph.view.decorator).appendChild(this.svgContainer);i&&this.graph.container.appendChild(this.htmlContainer)}return this}}])}(zs);!function(e){e.toStringTag="X6.".concat(e.name),e.isToolsView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&null!=i.graph&&null!=i.cell&&"function"==typeof i.config&&"function"==typeof i.update&&"function"==typeof i.focus&&"function"==typeof i.blur&&"function"==typeof i.show&&"function"==typeof i.hide}}(Js||(Js={})),function(e){var t=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return v(this,t),(e=a(this,t)).visible=!0,e.options=e.getOptions(n),e.container=zs.createElement(e.options.tagName||"g",!1!==e.options.isSVGElement),gi(e.container,e.prefixClassName("cell-tool")),"string"==typeof e.options.className&&gi(e.container,e.options.className),e.init(),e}return c(t,e),y(t,[{key:"graph",get:function(){return this.cellView.graph}},{key:"cell",get:function(){return this.cellView.cell}},{key:"name",get:function(){return this.options.name}},{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"init",value:function(){}},{key:"getOptions",value:function(e){return this.constructor.getOptions(e)}},{key:"delegateEvents",value:function(){return this.options.events&&n(t,"delegateEvents",this,3)([this.options.events]),this}},{key:"config",value:function(e,t){return this.cellView=e,this.parent=t,this.stamp(this.container),this.cell.isEdge()?gi(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&gi(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}},{key:"render",value:function(){this.empty();var e=this.options.markup;if(e){var t=Fs.parseJSONMarkup(e);this.container.appendChild(t.fragment),this.childNodes=t.selectors}return this.onRender(),this}},{key:"onRender",value:function(){}},{key:"update",value:function(){return this}},{key:"stamp",value:function(e){e&&e.setAttribute("data-cell-id",this.cellView.cell.id)}},{key:"show",value:function(){return this.container.style.display="",this.visible=!0,this}},{key:"hide",value:function(){return this.container.style.display="none",this.visible=!1,this}},{key:"isVisible",value:function(){return this.visible}},{key:"focus",value:function(){var e=this.options.focusOpacity;return null!=e&&Number.isFinite(e)&&(this.container.style.opacity="".concat(e)),this.parent.focus(this),this}},{key:"blur",value:function(){return this.container.style.opacity="",this.parent.blur(this),this}},{key:"guard",value:function(e){return null==this.graph||null==this.cellView||this.graph.view.guard(e,this.cellView)}}],[{key:"getDefaults",value:function(){return this.defaults}},{key:"config",value:function(e){this.defaults=this.getOptions(e)}},{key:"getOptions",value:function(e){return nn(Q(this.getDefaults()),e)}}])}(zs);t.defaults={isSVGElement:!0,tagName:"g"},e.ToolItem=t,function(e){var t=0;e.define=function(e){var n,i=An((n=e.name)?Dn(n):"CustomTool".concat(t+=1),this);return i.config(e),i}}(t=e.ToolItem||(e.ToolItem={})),function(e){e.toStringTag="X6.".concat(e.name),e.isToolItem=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&null!=i.graph&&null!=i.cell&&"function"==typeof i.config&&"function"==typeof i.update&&"function"==typeof i.focus&&"function"==typeof i.blur&&"function"==typeof i.show&&"function"==typeof i.hide&&"function"==typeof i.isVisible}}(t=e.ToolItem||(e.ToolItem={}))}(Js||(Js={}));function Xs(e,t){return 0===t?"0%":"".concat(Math.round(e/t*100),"%")}function Ys(e){return function(t,n,i,r){return n.isEdgeElement(i)?function(e,t,n,i,r){var o=n.getConnection();if(!o)return t;var a=o.closestPointLength(r);if(e){var s=o.length();t.anchor={name:"ratio",args:{ratio:a/s}}}else t.anchor={name:"length",args:{length:a}};return t}(e,t,n,0,r):function(e,t,n,i,r){var o=n.cell,a=o.getAngle(),s=n.getUnrotatedBBoxOfElement(i),l=o.getBBox().getCenter(),u=eo.create(r).rotate(a,l),c=u.x-s.x,h=u.y-s.y;e&&(c=Xs(c,s.width),h=Xs(h,s.height));return t.anchor={name:"topLeft",args:{dx:c,dy:h,rotate:!0}},t}(e,t,n,i,r)}}var Zs,Ks=Ys(!0),Qs=Ys(!1),$s=Object.freeze(Object.defineProperty({__proto__:null,noop:function(e){return e},pinAbsolute:Qs,pinRelative:Ks},Symbol.toStringTag,{value:"Module"}));function el(e,t,n,i){return mn(Zs.presets.pinRelative,this.graph,{},t,n,e,this.cell,i,{}).anchor}function tl(e,t){return t?e.cell.getBBox():e.cell.isEdge()?e.getConnection().bbox():e.getUnrotatedBBoxOfElement(e.container)}!function(e){e.presets=$s,e.registry=Ao.create({type:"connection strategy"}),e.registry.register(e.presets,!0)}(Zs||(Zs={}));var nl=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"onRender",value:function(){gi(this.container,this.prefixClassName("cell-tool-button")),this.update()}},{key:"update",value:function(){return this.updatePosition(),this}},{key:"updatePosition",value:function(){var e=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();Sr(this.container,e,{absolute:!0})}},{key:"getNodeMatrix",value:function(){var e=this.cellView,t=this.options,n=t.x,i=void 0===n?0:n,r=t.y,o=void 0===r?0:r,a=t.offset,s=t.useCellGeometry,l=t.rotate,u=tl(e,s),c=e.cell.getAngle();l||(u=u.bbox(c));var h=0,f=0;"number"==typeof a?(h=a,f=a):"object"===b(a)&&(h=a.x,f=a.y),i=Fn(i,u.width),o=Fn(o,u.height);var g=Pr().translate(u.x+u.width/2,u.y+u.height/2);return l&&(g=g.rotate(c)),g=g.translate(i+h-u.width/2,o+f-u.height/2)}},{key:"getEdgeMatrix",value:function(){var e,t,n,i=this.cellView,r=this.options,o=r.offset,a=void 0===o?0:o,s=r.distance,l=void 0===s?0:s,u=r.rotate,c=Fn(l,1);(e=c>=0&&c<=1?i.getTangentAtRatio(c):i.getTangentAtLength(c))?(t=e.start,n=e.vector().vectorAngle(new eo(1,0))||0):(t=i.getConnection().start,n=0);var h=Pr().translate(t.x,t.y).rotate(n);return h="object"===b(a)?h.translate(a.x||0,a.y||0):h.translate(0,a),u||(h=h.rotate(-n)),h}},{key:"onMouseDown",value:function(e){if(!this.guard(e)){e.stopPropagation(),e.preventDefault();var t=this.options.onClick;"function"==typeof t&&mn(t,this.cellView,{e:e,view:this.cellView,cell:this.cellView.cell,btn:this})}}}])}(Js.ToolItem);!function(e){e.config({name:"button",useCellGeometry:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})}(nl||(nl={})),function(e){e.Remove=e.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,useCellGeometry:!0,onClick:function(e){var t=e.view,n=e.btn;n.parent.remove(),t.cell.remove({ui:!0,toolId:n.cid})}})}(nl||(nl={}));var il=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},rl=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"onRender",value:function(){if(gi(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){var e=this.options.attrs,t=e.class,n=il(e,["class"]);Bi(this.container,Fi(n)),t&&gi(this.container,t)}this.update()}},{key:"update",value:function(){var e=this.cellView,t=this.options,n=t.useCellGeometry,i=t.rotate,r=Gn(t.padding),o=tl(e,n).moveAndExpand({x:-r.left,y:-r.top,width:r.left+r.right,height:r.top+r.bottom}),a=e.cell;if(a.isNode()){var s=a.getAngle();if(s)if(i){var l=a.getBBox().getCenter();Nr(this.container,s,l.x,l.y,{absolute:!0})}else o=o.bbox(s)}return Bi(this.container,o.toJSON()),this}}])}(Js.ToolItem);!function(e){e.config({name:"boundary",tagName:"rect",padding:10,useCellGeometry:!0,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})}(rl||(rl={}));var ol=function(e){function t(){var e;return v(this,t),(e=a(this,t,arguments)).handles=[],e}return c(t,e),y(t,[{key:"vertices",get:function(){return this.cellView.cell.getVertices()}},{key:"onRender",value:function(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}},{key:"update",value:function(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}},{key:"resetHandles",value:function(){var e=this,t=this.handles;this.handles=[],t&&t.forEach((function(t){e.stopHandleListening(t),t.remove()}))}},{key:"renderHandles",value:function(){for(var e=this,t=this.vertices,n=0,i=t.length;n<i;n+=1){var r=t[n],o=this.options.createHandle,a=this.options.processHandle,s=o({index:n,graph:this.graph,guard:function(t){return e.guard(t)},attrs:this.options.attrs||{}});a&&a(s),s.updatePosition(r.x,r.y),this.stamp(s.container),this.container.appendChild(s.container),this.handles.push(s),this.startHandleListening(s)}}},{key:"updateHandles",value:function(){for(var e=this.vertices,t=0,n=e.length;t<n;t+=1){var i=e[t],r=this.handles[t];r&&r.updatePosition(i.x,i.y)}}},{key:"updatePath",value:function(){var e=this.childNodes.connection;e&&e.setAttribute("d",this.cellView.getConnectionPathData())}},{key:"startHandleListening",value:function(e){var t=this.cellView;t.can("vertexMovable")&&(e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.on("remove",this.onHandleRemove,this)}},{key:"stopHandleListening",value:function(e){var t=this.cellView;t.can("vertexMovable")&&(e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.off("remove",this.onHandleRemove,this)}},{key:"getNeighborPoints",value:function(e){var t=this.cellView,n=this.vertices,i=e>0?n[e-1]:t.sourceAnchor,r=e<n.length-1?n[e+1]:t.targetAnchor;return{prev:eo.create(i),next:eo.create(r)}}},{key:"getMouseEventArgs",value:function(e){var t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY);return{e:t,x:n.x,y:n.y}}},{key:"onHandleChange",value:function(e){var t=e.e;this.focus();var n=this.cellView;if(n.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){var i=this.getMouseEventArgs(t),r=i.e,o=i.x,a=i.y;this.eventData(r,{start:{x:o,y:a}}),n.notifyMouseDown(r,o,a)}}},{key:"onHandleChanging",value:function(e){var t=e.handle,n=e.e,i=this.cellView,r=t.options.index,o=this.getMouseEventArgs(n),a=o.e,s=o.x,l=o.y,u={x:s,y:l};this.snapVertex(u,r),i.cell.setVertexAt(r,u,{ui:!0,toolId:this.cid}),t.updatePosition(u.x,u.y),this.options.stopPropagation||i.notifyMouseMove(a,s,l)}},{key:"stopBatch",value:function(e){this.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),e&&this.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid})}},{key:"onHandleChanged",value:function(e){var t=e.e,n=this.options,i=this.cellView;if(n.addable&&this.updatePath(),n.removeRedundancies){i.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),this.stopBatch(this.eventData(t).vertexAdded);var r=this.getMouseEventArgs(t),o=r.e,a=r.x,s=r.y;if(!this.options.stopPropagation){i.notifyMouseUp(o,a,s);var l=this.eventData(o).start;if(l){var u=l.x,c=l.y;u===a&&c===s&&i.onClick(o,a,s)}}i.checkMouseleave(o),n.onChanged&&n.onChanged({edge:i.cell,edgeView:i})}else this.stopBatch(this.eventData(t).vertexAdded)}},{key:"snapVertex",value:function(e,t){var n=this.options.snapRadius||0;if(n>0){var i=this.getNeighborPoints(t),r=i.prev,o=i.next;Math.abs(e.x-r.x)<n?e.x=r.x:Math.abs(e.x-o.x)<n&&(e.x=o.x),Math.abs(e.y-r.y)<n?e.y=i.prev.y:Math.abs(e.y-o.y)<n&&(e.y=o.y)}}},{key:"onHandleRemove",value:function(e){var t=e.handle,n=e.e;if(this.options.removable){var i=t.options.index,r=this.cellView;r.cell.removeVertexAt(i,{ui:!0}),this.options.addable&&this.updatePath(),r.checkMouseleave(this.normalizeEvent(n))}}},{key:"allowAddVertex",value:function(e){var t=this.guard(e),n=this.options.addable&&this.cellView.can("vertexAddable"),i=!this.options.modifiers||Wr.isMatch(e,this.options.modifiers);return!t&&n&&i}},{key:"onPathMouseDown",value:function(e){var t=this.cellView;if(this.allowAddVertex(e)){e.stopPropagation(),e.preventDefault();var n=this.normalizeEvent(e),i=this.graph.snapToGrid(n.clientX,n.clientY).toJSON();t.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});var r=t.getVertexIndex(i.x,i.y);this.snapVertex(i,r),t.cell.insertVertex(i,r,{ui:!0,toolId:this.cid}),this.render();var o=this.handles[r];this.eventData(n,{vertexAdded:!0}),o.onMouseDown(n)}}},{key:"onRemove",value:function(){this.resetHandles()}}])}(Js.ToolItem);!function(e){var t=function(t){function n(e){var t;return v(this,n),(t=a(this,n)).options=e,t.render(),t.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"}),t}return c(n,t),y(n,[{key:"graph",get:function(){return this.options.graph}},{key:"render",value:function(){this.container=zs.createElement("circle",!0);var t=this.options.attrs;if("function"==typeof t){var n=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},n.attrs),t(this)))}else this.setAttrs(t);this.addClass(this.prefixClassName("edge-tool-vertex"))}},{key:"updatePosition",value:function(e,t){this.setAttrs({cx:e,cy:t})}},{key:"onMouseDown",value:function(e){this.options.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data),this.emit("change",{e:e,handle:this}))}},{key:"onMouseMove",value:function(e){this.emit("changing",{e:e,handle:this})}},{key:"onMouseUp",value:function(e){this.emit("changed",{e:e,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}},{key:"onDoubleClick",value:function(e){this.emit("remove",{e:e,handle:this})}}])}(zs);e.Handle=t}(ol||(ol={})),function(e){var t=fs.prefix("edge-tool-vertex-path");e.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:function(t){return new e.Handle(t)},markup:[{tagName:"path",selector:"connection",className:t,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:o(o({},"mousedown .".concat(t),"onPathMouseDown"),"touchstart .".concat(t),"onPathMouseDown")})}(ol||(ol={}));var al=function(e){function t(){var e;return v(this,t),(e=a(this,t,arguments)).handles=[],e}return c(t,e),y(t,[{key:"vertices",get:function(){return this.cellView.cell.getVertices()}},{key:"update",value:function(){return this.render(),this}},{key:"onRender",value:function(){gi(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();var e=this.cellView,t=f(this.vertices);t.unshift(e.sourcePoint),t.push(e.targetPoint);for(var n=0,i=t.length;n<i-1;n+=1){var r=t[n],o=t[n+1],a=this.renderHandle(r,o,n);this.stamp(a.container),this.handles.push(a)}return this}},{key:"renderHandle",value:function(e,t,n){var i=this,r=this.options.createHandle({index:n,graph:this.graph,guard:function(e){return i.guard(e)},attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(r),this.updateHandle(r,e,t),this.container.appendChild(r.container),this.startHandleListening(r),r}},{key:"startHandleListening",value:function(e){e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)}},{key:"stopHandleListening",value:function(e){e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)}},{key:"resetHandles",value:function(){var e=this,t=this.handles;this.handles=[],t&&t.forEach((function(t){e.stopHandleListening(t),t.remove()}))}},{key:"shiftHandleIndexes",value:function(e){for(var t=this.handles,n=0,i=t.length;n<i;n+=1)t[n].options.index+=e}},{key:"resetAnchor",value:function(e,t){var n=this.cellView.cell,i={ui:!0,toolId:this.cid};t?n.prop([e,"anchor"],t,i):n.removeProp([e,"anchor"],i)}},{key:"snapHandle",value:function(e,t,n){var i=e.options.axis,r=e.options.index,o=this.cellView.cell.getVertices(),a=o[r-2]||n.sourceAnchor,s=o[r+1]||n.targetAnchor,l=this.options.snapRadius;return Math.abs(t[i]-a[i])<l?t[i]=a[i]:Math.abs(t[i]-s[i])<l&&(t[i]=s[i]),t}},{key:"onHandleChanging",value:function(e){var t=e.handle,n=e.e,i=this.graph,r=this.options,o=this.cellView,a=r.anchor,s=t.options.axis,l=t.options.index-1,u=this.getEventData(n),c=this.normalizeEvent(n),h=i.snapToGrid(c.clientX,c.clientY),f=this.snapHandle(t,h.clone(),u),g=Q(this.vertices),d=g[l],v=g[l+1],p=o.sourceView,y=o.sourceBBox,m=!1,b=!1;if(d?0===l?y.containsPoint(d)?(g.shift(),this.shiftHandleIndexes(-1),m=!0):(d[s]=f[s],b=!0):d[s]=f[s]:((d=o.sourceAnchor.toJSON())[s]=f[s],y.containsPoint(d)?m=!0:(g.unshift(d),this.shiftHandleIndexes(1),b=!0)),"function"==typeof a&&p){if(m){var k=u.sourceAnchor.clone();k[s]=f[s];var x=mn(a,o,k,p,o.sourceMagnet||p.container,"source",o,this);this.resetAnchor("source",x)}b&&this.resetAnchor("source",u.sourceAnchorDef)}var w=o.targetView,P=o.targetBBox,C=!1,A=!1;if(v?l===g.length-2?P.containsPoint(v)?(g.pop(),C=!0):(v[s]=f[s],A=!0):v[s]=f[s]:((v=o.targetAnchor.toJSON())[s]=f[s],P.containsPoint(v)?C=!0:(g.push(v),A=!0)),"function"==typeof a&&w){if(C){var O=u.targetAnchor.clone();O[s]=f[s];var E=mn(a,o,O,w,o.targetMagnet||w.container,"target",o,this);this.resetAnchor("target",E)}A&&this.resetAnchor("target",u.targetAnchorDef)}eo.equalPoints(g,this.vertices)||this.cellView.cell.setVertices(g,{ui:!0,toolId:this.cid}),this.updateHandle(t,d,v,0),r.stopPropagation||o.notifyMouseMove(c,h.x,h.y)}},{key:"onHandleChange",value:function(e){var t=e.handle,n=e.e,i=this.options,r=this.handles,o=this.cellView,a=t.options.index;if(Array.isArray(r)){for(var s=0,l=r.length;s<l;s+=1)s!==a&&r[s].hide();if(this.focus(),this.setEventData(n,{sourceAnchor:o.sourceAnchor.clone(),targetAnchor:o.targetAnchor.clone(),sourceAnchorDef:Q(this.cell.prop(["source","anchor"])),targetAnchorDef:Q(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!i.stopPropagation){var u=this.normalizeEvent(n),c=this.graph.snapToGrid(u.clientX,u.clientY);o.notifyMouseDown(u,c.x,c.y)}}}},{key:"onHandleChanged",value:function(e){var t=e.e,n=this.options,i=this.cellView;n.removeRedundancies&&i.removeRedundantLinearVertices({ui:!0,toolId:this.cid});var r=this.normalizeEvent(t),o=this.graph.snapToGrid(r.clientX,r.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),n.stopPropagation||i.notifyMouseUp(r,o.x,o.y),i.checkMouseleave(r),n.onChanged&&n.onChanged({edge:i.cell,edgeView:i})}},{key:"updateHandle",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.options.precision||0,o=Math.abs(t.x-n.x)<r,a=Math.abs(t.y-n.y)<r;if(o||a){var s=new no(t,n);if(s.length()<this.options.threshold)e.hide();else{var l=s.getCenter(),u=o?"x":"y";l[u]+=i||0;var c=s.vector().vectorAngle(new eo(1,0));e.updatePosition(l.x,l.y,c,this.cellView),e.show(),e.options.axis=u}}else e.hide()}},{key:"onRemove",value:function(){this.resetHandles()}}])}(Js.ToolItem);!function(e){var t=function(t){function n(e){var t;return v(this,n),(t=a(this,n)).options=e,t.render(),t.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"}),t}return c(n,t),y(n,[{key:"render",value:function(){this.container=zs.createElement("rect",!0);var t=this.options.attrs;if("function"==typeof t){var n=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},n.attrs),t(this)))}else this.setAttrs(t);this.addClass(this.prefixClassName("edge-tool-segment"))}},{key:"updatePosition",value:function(e,t,n,i){var r=i.getClosestPoint(new eo(e,t))||new eo(e,t),o=Pr().translate(r.x,r.y);if(r.equals({x:e,y:t}))o=o.rotate(n);else{var a=new no(e,t,r.x,r.y).vector().vectorAngle(new eo(1,0));0!==a&&(a+=90),o=o.rotate(a)}this.setAttrs({transform:Or(o),cursor:n%180==0?"row-resize":"col-resize"})}},{key:"onMouseDown",value:function(e){this.options.guard(e)||(this.trigger("change",{e:e,handle:this}),e.stopPropagation(),e.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data))}},{key:"onMouseMove",value:function(e){this.emit("changing",{e:e,handle:this})}},{key:"onMouseUp",value:function(e){this.emit("changed",{e:e,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}},{key:"show",value:function(){this.container.style.display=""}},{key:"hide",value:function(){this.container.style.display="none"}}])}(zs);e.Handle=t}(al||(al={})),function(e){e.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:function(t){return new e.Handle(t)},anchor:el})}(al||(al={}));var sl=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"type",get:function(){return this.options.type}},{key:"onRender",value:function(){gi(this.container,this.prefixClassName("edge-tool-".concat(this.type,"-anchor"))),this.toggleArea(!1),this.update()}},{key:"update",value:function(){var e=this.type;return this.cellView.getTerminalView(e)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}},{key:"updateAnchor",value:function(){var e=this.childNodes;if(e){var t=e.anchor;if(t){var n=this.type,i=this.cellView,r=this.options,o=i.getTerminalAnchor(n),a=i.cell.prop([n,"anchor"]);t.setAttribute("transform","translate(".concat(o.x,", ").concat(o.y,")"));var s=a?r.customAnchorAttrs:r.defaultAnchorAttrs;s&&Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])}))}}}},{key:"updateArea",value:function(){var e=this.childNodes;if(e){var t=e.area;if(t){var n=this.type,i=this.cellView,r=i.getTerminalView(n);if(r){var o,a,s,l=r.cell,u=i.getTerminalMagnet(n),c=this.options.areaPadding||0;Number.isFinite(c)||(c=0),r.isEdgeElement(u)?(a=0,s=(o=r.getBBox()).getCenter()):(o=r.getUnrotatedBBoxOfElement(u),a=l.getAngle(),s=o.getCenter(),a&&s.rotate(-a,l.getBBox().getCenter())),o.inflate(c),Bi(t,{x:-o.width/2,y:-o.height/2,width:o.width,height:o.height,transform:"translate(".concat(s.x,", ").concat(s.y,") rotate(").concat(a,")")})}}}}},{key:"toggleArea",value:function(e){if(this.childNodes){var t=this.childNodes.area;t&&(t.style.display=e?"":"none")}}},{key:"onMouseDown",value:function(e){this.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}},{key:"resetAnchor",value:function(e){var t=this.type,n=this.cell;e?n.prop([t,"anchor"],e,{rewrite:!0,ui:!0,toolId:this.cid}):n.removeProp([t,"anchor"],{ui:!0,toolId:this.cid})}},{key:"onMouseMove",value:function(e){var t=this.type,n=this.cellView,i=n.getTerminalView(t);if(null!=i){var r,o=this.normalizeEvent(e),a=i.cell,s=n.getTerminalMagnet(t),l=this.graph.coord.clientToLocalPoint(o.clientX,o.clientY),u=this.options.snap;if("function"==typeof u){var c=mn(u,n,l,i,s,t,n,this);l=eo.create(c)}if(this.options.restrictArea)if(i.isEdgeElement(s)){var h=i.getClosestPoint(l);h&&(l=h)}else{var f=i.getUnrotatedBBoxOfElement(s),g=a.getAngle(),d=a.getBBox().getCenter(),v=l.clone().rotate(g,d);f.containsPoint(v)||(l=f.getNearestPointToPoint(v).rotate(-g,d))}var p=this.options.anchor;"function"==typeof p&&(r=mn(p,n,l,i,s,t,n,this)),this.resetAnchor(r),this.update()}}},{key:"onMouseUp",value:function(e){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);var t=this.cellView;this.options.removeRedundancies&&t.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}},{key:"onDblClick",value:function(){var e=this.options.resetAnchor;e&&this.resetAnchor(!0===e?void 0:e),this.update()}}])}(Js.ToolItem);!function(e){e.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:el,snap:function(e,t,n,i,r,o){var a=o.options.snapRadius||0,s="source"===i,l=s?0:-1,u=this.cell.getVertexAt(l)||this.getTerminalAnchor(s?"target":"source");return u&&(Math.abs(u.x-e.x)<a&&(e.x=u.x),Math.abs(u.y-e.y)<a&&(e.y=u.y)),e}})}(sl||(sl={}));var ll=sl.define({name:"source-anchor",type:"source"}),ul=sl.define({name:"target-anchor",type:"target"}),cl=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},hl=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"type",get:function(){return this.options.type}},{key:"ratio",get:function(){return this.options.ratio}},{key:"init",value:function(){if(this.options.attrs){var e=this.options.attrs,t=e.class,n=cl(e,["class"]);this.setAttrs(n,this.container),t&&gi(this.container,t)}}},{key:"onRender",value:function(){gi(this.container,this.prefixClassName("edge-tool-".concat(this.type,"-arrowhead"))),this.update()}},{key:"update",value:function(){var e=this.ratio,t=this.cellView,n=t.getTangentAtRatio(e),i=n?n.start:t.getPointAtRatio(e),r=n&&n.vector().vectorAngle(new eo(1,0))||0;if(!i)return this;var o=Pr().translate(i.x,i.y).rotate(r);return Sr(this.container,o,{absolute:!0}),this}},{key:"onMouseDown",value:function(e){if(!this.guard(e)){e.stopPropagation(),e.preventDefault();var t=this.cellView;if(t.can("arrowheadMovable")){t.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});var n=this.graph.snapToGrid(e.clientX,e.clientY),i=t.prepareArrowheadDragging(this.type,{x:n.x,y:n.y,options:Object.assign(Object.assign({},this.options),{toolId:this.cid})});this.cellView.setEventData(e,i),this.delegateDocumentEvents(this.options.documentEvents,e.data),t.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}}},{key:"onMouseMove",value:function(e){var t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY);this.cellView.onMouseMove(t,n.x,n.y),this.update()}},{key:"onMouseUp",value:function(e){this.undelegateDocumentEvents();var t=this.normalizeEvent(e),n=this.cellView,i=this.graph.snapToGrid(t.clientX,t.clientY);n.onMouseUp(t,i.x,i.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",n.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}])}(Js.ToolItem);!function(e){e.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})}(hl||(hl={}));var fl=hl.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),gl=hl.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),dl=function(e){function t(){var e;return v(this,t),(e=a(this,t,arguments)).labelIndex=-1,e.distance=.5,e.dblClick=e.onCellDblClick.bind(e),e}return c(t,e),y(t,[{key:"onRender",value:function(){var e=this.cellView;e&&e.on("cell:dblclick",this.dblClick)}},{key:"createElement",value:function(){var e=[this.prefixClassName("".concat(this.cell.isEdge()?"edge":"node","-tool-editor")),this.prefixClassName("cell-tool-editor")];this.editor=Js.createElement("div",!1),this.addClass(e,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}},{key:"removeElement",value:function(){this.undelegateDocumentEvents(),this.editor&&(this.container.removeChild(this.editor),this.editor=null)}},{key:"updateEditor",value:function(){var e=this.cell,t=this.editor;if(t){var n=t.style;e.isNode()?this.updateNodeEditorTransform():e.isEdge()&&this.updateEdgeEditorTransform();var i=this.options.attrs;n.fontSize="".concat(i.fontSize,"px"),n.fontFamily=i.fontFamily,n.color=i.color,n.backgroundColor=i.backgroundColor;var r=this.getCellText()||"";return t.innerText=r,this.setCellText(""),this}}},{key:"updateNodeEditorTransform",value:function(){var e=this.graph,t=this.cell,n=this.editor;if(n){var i=eo.create(),r=20,o="",a=this.options,s=a.x,l=a.y,u=this.options,c=u.width,h=u.height;if(void 0!==s&&void 0!==l){var f=t.getBBox();s=Fn(s,f.width),l=Fn(l,f.height),i=f.topLeft.translate(s,l),r=f.width-2*s}else{var g=t.getBBox();i=g.center,r=g.width-4,o="translate(-50%, -50%)"}var d=e.scale(),v=n.style;i=e.localToGraph(i),v.left="".concat(i.x,"px"),v.top="".concat(i.y,"px"),v.transform="scale(".concat(d.sx,", ").concat(d.sy,") ").concat(o),v.minWidth="".concat(r,"px"),"number"==typeof c&&(v.width="".concat(c,"px")),"number"==typeof h&&(v.height="".concat(h,"px"))}}},{key:"updateEdgeEditorTransform",value:function(){if(this.event){var e=this.graph,t=this.editor;if(t){var n=eo.create(),i=20,r=t.style,o=this.event.target,a=o.parentElement;if(a&&fi(a,this.prefixClassName("edge-label"))){var s=a.getAttribute("data-index")||"0";this.labelIndex=parseInt(s,10);var l=Er(a.getAttribute("transform")).translation;n=new eo(l.tx,l.ty),i=hs.getBBox(o).width}else{if(!this.options.labelAddable)return this;n=e.clientToLocal(eo.create(this.event.clientX,this.event.clientY));var u=this.cellView.path.closestPointLength(n);this.distance=u,this.labelIndex=-1}n=e.localToGraph(n);var c=e.scale();r.left="".concat(n.x,"px"),r.top="".concat(n.y,"px"),r.minWidth="".concat(i,"px"),r.transform="scale(".concat(c.sx,", ").concat(c.sy,") translate(-50%, -50%)")}}}},{key:"onDocumentMouseUp",value:function(e){if(this.editor&&e.target!==this.editor){var t=this.editor.innerText.replace(/\n$/,"")||"";this.setCellText(""!==t?t:null),this.removeElement()}}},{key:"onCellDblClick",value:function(e){var t=e.e;this.editor||(t.stopPropagation(),this.removeElement(),this.event=t,this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents))}},{key:"onMouseDown",value:function(e){e.stopPropagation()}},{key:"autoFocus",value:function(){var e=this;setTimeout((function(){e.editor&&(e.editor.focus(),e.selectText())}))}},{key:"selectText",value:function(){if(window.getSelection&&this.editor){var e=document.createRange(),t=window.getSelection();e.selectNodeContents(this.editor),t.removeAllRanges(),t.addRange(e)}}},{key:"getCellText",value:function(){var e=this.options.getText;if("function"==typeof e)return mn(e,this.cellView,{cell:this.cell,index:this.labelIndex});if("string"==typeof e){if(this.cell.isNode())return this.cell.attr(e);if(this.cell.isEdge()&&-1!==this.labelIndex)return this.cell.prop("labels/".concat(this.labelIndex,"/attrs/").concat(e))}}},{key:"setCellText",value:function(e){var t=this.options.setText;if("function"!=typeof t){if("string"==typeof t){if(this.cell.isNode())return void(null!==e&&this.cell.attr(t,e));if(this.cell.isEdge()){var n=this.cell;if(-1===this.labelIndex){if(e){var i={position:{distance:this.distance},attrs:{}};Mn(i,"attrs/".concat(t),e),n.appendLabel(i)}}else null!==e?n.prop("labels/".concat(this.labelIndex,"/attrs/").concat(t),e):"number"==typeof this.labelIndex&&n.removeLabelAt(this.labelIndex)}}}else mn(t,this.cellView,{cell:this.cell,value:e,index:this.labelIndex,distance:this.distance})}},{key:"onRemove",value:function(){var e=this.cellView;e&&e.off("cell:dblclick",this.dblClick),this.removeElement()}}])}(Js.ToolItem);!function(e){e.config({tagName:"div",isSVGElement:!1,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mouseup:"onDocumentMouseUp",touchend:"onDocumentMouseUp",touchcancel:"onDocumentMouseUp"}})}(dl||(dl={})),function(e){e.NodeEditor=e.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:"text/text",setText:"text/text"}),e.EdgeEditor=e.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:"label/text",setText:"label/text"})}(dl||(dl={}));var vl,pl,yl=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};!function(e){e.presets={boundary:rl,button:nl,"button-remove":nl.Remove,"node-editor":dl.NodeEditor},e.registry=Ao.create({type:"node tool",process:function(e,t){if("function"==typeof t)return t;var n=Js.ToolItem,i=t.inherit,r=yl(t,["inherit"]);if(i){var o=this.get(i);null==o?this.onNotFound(i,"inherited"):n=o}return null==r.name&&(r.name=e),n.define.call(n,r)}}),e.registry.register(e.presets,!0)}(vl||(vl={})),function(e){e.presets={boundary:rl,vertices:ol,segments:al,button:nl,"button-remove":nl.Remove,"source-anchor":ll,"target-anchor":ul,"source-arrowhead":fl,"target-arrowhead":gl,"edge-editor":dl.EdgeEditor},e.registry=Ao.create({type:"edge tool",process:function(e,t){if("function"==typeof t)return t;var n=Js.ToolItem,i=t.inherit,r=yl(t,["inherit"]);if(i){var o=this.get(i);null==o?this.onNotFound(i,"inherited"):n=o}return null==r.name&&(r.name=e),n.define.call(n,r)}}),e.registry.register(e.presets,!0)}(pl||(pl={}));var ml=El("center"),bl=El("topCenter"),kl=El("bottomCenter"),xl=El("leftMiddle"),wl=El("rightMiddle"),Pl=El("topLeft"),Cl=El("topRight"),Al=El("bottomLeft"),Ol=El("bottomRight");function El(e){return function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=r.rotate?t.getUnrotatedBBoxOfElement(n):t.getBBoxOfElement(n),a=o[e];a.x+=Fn(r.dx,o.width),a.y+=Fn(r.dy,o.height);var s=t.cell;return r.rotate?a.rotate(-s.getAngle(),s.getBBox().getCenter()):a}}function Ml(e){return function(t,n,i,r){if(i instanceof Element){var o,a=this.graph.findViewByElem(i);if(a)if(a.isEdgeElement(i))o=Sl(a,null!=r.fixedAt?r.fixedAt:"50%");else o=a.getBBoxOfElement(i).getCenter();else o=new eo;return e.call(this,t,n,o,r)}return e.apply(this,arguments)}}function Sl(e,t){var n=zn(t),i="string"==typeof t?parseFloat(t):t;return n?e.getPointAtRatio(i/100):e.getPointAtLength(i)}var Tl,Nl=Ml((function(e,t,n,i){var r=Zr.normalize(e.cell.getAngle()),o=e.getBBoxOfElement(t),a=o.getCenter(),s=o.getTopLeft(),l=o.getBottomRight(),u=i.padding;if(Number.isFinite(u)||(u=0),s.y+u<=n.y&&n.y<=l.y-u){var c=n.y-a.y;a.x+=0===r||180===r?0:1*c/Math.tan(Zr.toRad(r)),a.y+=c}else if(s.x+u<=n.x&&n.x<=l.x-u){var h=n.x-a.x;a.y+=90===r||270===r?0:h*Math.tan(Zr.toRad(r)),a.x+=h}return a})),jl=Ml((function(e,t,n,i){var r,o,a=0,s=e.cell;i.rotate?(r=e.getUnrotatedBBoxOfElement(t),o=s.getBBox().getCenter(),a=s.getAngle()):r=e.getBBoxOfElement(t);var l=i.padding;null!=l&&Number.isFinite(l)&&r.inflate(l),i.rotate&&n.rotate(a,o);var u,c=r.getNearestSideToPoint(n);switch(c){case"left":u=r.getLeftMiddle();break;case"right":u=r.getRightMiddle();break;case"top":u=r.getTopCenter();break;case"bottom":u=r.getBottomCenter()}var h=i.direction;return"H"===h?"top"!==c&&"bottom"!==c||(u=n.x<=r.x+r.width?r.getLeftMiddle():r.getRightMiddle()):"V"===h&&(u=n.y<=r.y+r.height?r.getTopCenter():r.getBottomCenter()),i.rotate?u.rotate(-a,o):u})),Ll=Object.freeze(Object.defineProperty({__proto__:null,bottom:kl,bottomLeft:Al,bottomRight:Ol,center:ml,left:xl,midSide:jl,nodeCenter:function(e,t,n,i,r){var o=e.cell.getConnectionPoint(this.cell,r);return(i.dx||i.dy)&&o.translate(i.dx||0,i.dy||0),o},orth:Nl,right:wl,top:bl,topLeft:Pl,topRight:Cl},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Ll,e.registry=Ao.create({type:"node endpoint"}),e.registry.register(e.presets,!0)}(Tl||(Tl={}));var Dl,Il=function(e,t,n,i){var r=e.getClosestPoint(n);return null!=r?r:new eo},Rl=Ml(Il),Vl=Ml((function(e,t,n,i){var r=1e6,o=e.getConnection(),a=e.getConnectionSubdivisions(),s=new no(n.clone().translate(0,r),n.clone().translate(0,-r)),l=new no(n.clone().translate(r,0),n.clone().translate(-r,0)),u=s.intersect(o,{segmentSubdivisions:a}),c=l.intersect(o,{segmentSubdivisions:a}),h=[];return u&&h.push.apply(h,f(u)),c&&h.push.apply(h,f(c)),h.length>0?n.closest(h):null!=i.fallbackAt?Sl(e,i.fallbackAt):mn(Il,this,e,t,n,i)})),Bl=Object.freeze(Object.defineProperty({__proto__:null,closest:Rl,length:function(e,t,n,i){var r=null!=i.length?i.length:20;return e.getPointAtLength(r)},orth:Vl,ratio:function(e,t,n,i){var r=null!=i.ratio?i.ratio:.5;return r>1&&(r/=100),e.getPointAtRatio(r)}},Symbol.toStringTag,{value:"Module"}));function zl(e,t,n){var i;if("object"===b(n)){if(Number.isFinite(n.y)){var r=new no(t,e).parallel(n.y);t=r.start,e=r.end}i=n.x}else i=n;if(null==i||!Number.isFinite(i))return e;var o=e.distance(t);return 0===i&&o>0?e:e.move(t,-Math.min(i,o-1))}function Fl(e){var t=e.getAttribute("stroke-width");return null===t?0:parseFloat(t)||0}!function(e){e.presets=Bl,e.registry=Ao.create({type:"edge endpoint"}),e.registry.register(e.presets,!0)}(Dl||(Dl={}));var Gl=function(e,t,n,i){var r=t.getBBoxOfElement(n);i.stroked&&r.inflate(Fl(n)/2);var o=e.intersect(r);return zl(o&&o.length?e.start.closest(o):e.end,e.start,i.offset)};var ql,Hl=Object.freeze(Object.defineProperty({__proto__:null,anchor:function(e,t,n,i){var r=i.alignOffset,o=i.align;return o&&function(e,t){var n,i,r,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=e.start,l=e.end;switch(t){case"left":o="x",n=l,i=s,r=-1;break;case"right":o="x",n=s,i=l,r=1;break;case"top":o="y",n=l,i=s,r=-1;break;case"bottom":o="y",n=s,i=l,r=1;break;default:return}s[o]<l[o]?n[o]=i[o]:i[o]=n[o],Number.isFinite(a)&&(n[o]+=r*a,i[o]+=r*a)}(e,o,r),zl(e.end,e.start,i.offset)},bbox:Gl,boundary:function(e,t,n,i){var r,o,a=e.end,s=i.selector;if(r="string"==typeof s?t.findOne(s):Array.isArray(s)?En(n,s):function(e){if(null==e)return null;var t=e;do{var n=t.tagName;if("string"!=typeof n)return null;if("G"===(n=n.toUpperCase()))t=t.firstElementChild;else{if("TITLE"!==n)break;t=t.nextElementSibling}}while(t);return t}(n),!mi(r)){if(r===n||!mi(n))return a;r=n}var l,u=t.getShapeOfElement(r),c=t.getMatrixOfElement(r),h=t.getRootTranslatedMatrix(),f=t.getRootRotatedMatrix(),g=h.multiply(f).multiply(c),d=g.inverse(),v=hs.transformLine(e,d),p=v.start.clone(),y=t.getDataOfElement(r);if(!1===i.insideout){null==y.shapeBBox&&(y.shapeBBox=u.bbox());var m=y.shapeBBox;if(null!=m&&m.containsPoint(p))return a}if(!0===i.extrapolate&&v.setLength(1e6),Co.isPath(u)){var k=i.precision||2;null==y.segmentSubdivisions&&(y.segmentSubdivisions=u.getSegmentSubdivisions({precision:k})),l={precision:k,segmentSubdivisions:y.segmentSubdivisions},o=v.intersect(u,l)}else o=v.intersect(u);o?Array.isArray(o)&&(o=p.closest(o)):!0===i.sticky&&(o=to.isRectangle(u)?u.getNearestPointToPoint(p):io.isEllipse(u)?u.intersectsWithLineFromCenterToPoint(p):u.closestPoint(p,l));var x=o?hs.transformPoint(o,g):a,w=i.offset||0;return!1!==i.stroked&&("object"===b(w)?(null==(w=Object.assign({},w)).x&&(w.x=0),w.x+=Fl(r)/2):w+=Fl(r)/2),zl(x,e.start,w)},rect:function(e,t,n,i,r){var o=t.cell,a=o.isNode()?o.getAngle():0;if(0===a)return mn(Gl,this,e,t,n,i,r);var s=t.getUnrotatedBBoxOfElement(n);i.stroked&&s.inflate(Fl(n)/2);var l=s.getCenter(),u=e.clone().rotate(a,l),c=u.setLength(1e6).intersect(s);return zl(c&&c.length?u.start.closest(c).rotate(-a,l):e.end,e.start,i.offset)}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Hl,e.registry=Ao.create({type:"connection point"}),e.registry.register(e.presets,!0)}(ql||(ql={}));function _l(e){return new to(e.x,e.y,0,0)}function Ul(){var e=Gn((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).padding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function Wl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.sourceBBox.clone().moveAndExpand(Ul(t))}function Jl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.targetBBox.clone().moveAndExpand(Ul(t))}var Xl,Yl=function(e,t,n){var i=Wl(n,t),r=Jl(n,t),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.sourceAnchor?e.sourceAnchor:Wl(e,t).getCenter()}(n,t),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.targetAnchor?e.targetAnchor:Jl(e,t).getCenter()}(n,t);i=i.union(_l(o)),r=r.union(_l(a));var s=e.map((function(e){return eo.create(e)}));s.unshift(o),s.push(a);for(var l=null,u=[],c=0,h=s.length-1;c<h;c+=1){var g=null,d=s[c],v=s[c+1],p=null!=Xl.getBearing(d,v);if(0===c)c+1===h?i.intersectsWithRect(r.clone().inflate(1))?g=Xl.insideNode(d,v,i,r):p||(g=Xl.nodeToNode(d,v,i,r)):i.containsPoint(v)?g=Xl.insideNode(d,v,i,_l(v).moveAndExpand(Ul(t))):p||(g=Xl.nodeToVertex(d,v,i));else if(c+1===h){var y=p&&Xl.getBearing(v,d)===l;r.containsPoint(d)||y?g=Xl.insideNode(d,v,_l(d).moveAndExpand(Ul(t)),r,l):p||(g=Xl.vertexToNode(d,v,r,l))}else p||(g=Xl.vertexToVertex(d,v,l));g?(u.push.apply(u,f(g.points)),l=g.direction):l=Xl.getBearing(d,v),c+1<h&&u.push(v)}return u};!function(e){var t={N:"S",S:"N",E:"W",W:"E"},n={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function i(e,t,n){var i=new eo(e.x,t.y);return n.containsPoint(i)&&(i=new eo(t.x,e.y)),i}function r(e,t){return e["W"===t||"E"===t?"width":"height"]}function o(e,t){return e.x===t.x?e.y>t.y?"N":"S":e.y===t.y?e.x>t.x?"W":"E":null}function a(e,n,i){var r=new eo(e.x,n.y),a=new eo(n.x,e.y),s=o(e,r),l=o(e,a),u=i?t[i]:null,c=s===i||s!==u&&(l===u||l!==i)?r:a;return{points:[c],direction:o(c,n)}}function s(e,t,n){var r=i(e,t,n);return{points:[r],direction:o(r,t)}}e.getBBoxSize=r,e.getBearing=o,e.vertexToVertex=a,e.nodeToVertex=s,e.vertexToNode=function(e,t,n,a){var s,l=[new eo(e.x,t.y),new eo(t.x,e.y)],u=l.filter((function(e){return!n.containsPoint(e)})),c=u.filter((function(t){return o(t,e)!==a}));if(c.length>0)return{points:[s=(s=c.filter((function(t){return o(e,t)===a})).pop())||c[0]],direction:o(s,t)};s=Jt(l,u)[0];var h=eo.create(t).move(s,-r(n,a)/2);return{points:[i(h,e,n),h],direction:o(h,t)}},e.nodeToNode=function(e,t,n,i){var l=s(t,e,i),u=l.points[0];if(n.containsPoint(u)){var c=(l=s(e,t,n)).points[0];if(i.containsPoint(c)){var h=eo.create(e).move(c,-r(n,o(e,c))/2),f=eo.create(t).move(u,-r(i,o(t,u))/2),g=new no(h,f).getCenter(),d=s(e,g,n),v=a(g,t,d.direction);l.points=[d.points[0],v.points[0]],l.direction=v.direction}}return l},e.insideNode=function(e,t,r,a,s){var l,u,c,h,f=r.union(a).inflate(1),g=f.getCenter(),d=g.distance(t)>g.distance(e),v=d?t:e,p=d?e:t;return s?(l=eo.fromPolar(f.width+f.height,n[s],v),l=f.getNearestPointToPoint(l).move(l,-1)):l=f.getNearestPointToPoint(v).move(v,1),u=i(l,p,f),l.round().equals(u.round())?(u=eo.fromPolar(f.width+f.height,Zr.toRad(l.theta(v))+Math.PI/2,p),c=i(l,u=f.getNearestPointToPoint(u).move(p,1).round(),f),h=d?[u,c,l]:[l,c,u]):h=d?[u,l]:[l,u],{points:h,direction:o(d?l:u,t)}}}(Xl||(Xl={}));var Zl={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeNodes:[],excludeShapes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return Kl(this.step,this)},directions:function(){var e=Kl(this.step,this),t=Kl(this.cost,this);return[{cost:t,offsetX:e,offsetY:0},{cost:t,offsetX:-e,offsetY:0},{cost:t,offsetX:0,offsetY:e},{cost:t,offsetX:0,offsetY:-e}]},penalties:function(){var e=Kl(this.step,this);return{0:0,45:e/2,90:e/2}},paddingBox:function(){var e=Kl(this.step,this);return{x:-e,y:-e,width:2*e,height:2*e}},fallbackRouter:Yl,draggingRouter:null,snapToGrid:!0};function Kl(e,t){return"function"==typeof e?e.call(t):e}var Ql=function(){return y((function e(){v(this,e),this.items=[],this.hash={},this.values={}}),[{key:"add",value:function(e,t){var n=this;this.hash[e]?this.items.splice(this.items.indexOf(e),1):this.hash[e]=1,this.values[e]=t;var i=function(e,t,n){return cn(e,t,Z(n))}(this.items,e,(function(e){return n.values[e]}));this.items.splice(i,0,e)}},{key:"pop",value:function(){var e=this.items.shift();return e&&(this.hash[e]=2),e}},{key:"isOpen",value:function(e){return 1===this.hash[e]}},{key:"isClose",value:function(e){return 2===this.hash[e]}},{key:"isEmpty",value:function(){return 0===this.items.length}}])}(),$l=function(){return y((function e(t){v(this,e),this.options=t,this.mapGridSize=100,this.map={}}),[{key:"build",value:function(e,t){var n=this.options,i=n.excludeTerminals.reduce((function(n,i){var r=t[i];if(r){var o=e.getCell(r.cell);o&&n.push(o)}return n}),[]),r=[],o=e.getCell(t.getSourceCellId());o&&(r=dn(r,o.getAncestors().map((function(e){return e.id}))));var a=e.getCell(t.getTargetCellId());a&&(r=dn(r,a.getAncestors().map((function(e){return e.id}))));var s=this.mapGridSize;return e.getNodes().reduce((function(e,t){var o=i.some((function(e){return e.id===t.id})),a=!!t.shape&&n.excludeShapes.includes(t.shape),l=n.excludeNodes.some((function(e){return"string"==typeof e?t.id===e:e===t})),u=r.includes(t.id),c=a||o||l||u;if(t.isVisible()&&!c)for(var h=t.getBBox().moveAndExpand(n.paddingBox),f=h.getOrigin().snapToGrid(s),g=h.getCorner().snapToGrid(s),d=f.x;d<=g.x;d+=s)for(var v=f.y;v<=g.y;v+=s){var p=new eo(d,v).toString();null==e[p]&&(e[p]=[]),e[p].push(h)}return e}),this.map),this}},{key:"isAccessible",value:function(e){var t=e.clone().snapToGrid(this.mapGridSize).toString(),n=this.map[t];return!n||n.every((function(t){return!t.containsPoint(e)}))}}])}();function eu(e,t){var n=e.sourceBBox.clone();return t&&t.paddingBox?n.moveAndExpand(t.paddingBox):n}function tu(e,t){var n=e.targetBBox.clone();return t&&t.paddingBox?n.moveAndExpand(t.paddingBox):n}function nu(e,t){return e.sourceAnchor?e.sourceAnchor:eu(e,t).getCenter()}function iu(e,t,n,i,r){var o=360/n,a=e.theta(function(e,t,n,i){var r=i.step,o=t.x-e.x,a=t.y-e.y,s=o/n.x,l=a/n.y,u=s*r,c=l*r;return new eo(e.x+u,e.y+c)}(e,t,i,r)),s=Zr.normalize(a+o/2);return o*Math.floor(s/o)}function ru(e,t){var n=Math.abs(e-t);return n>180?360-n:n}function ou(e,t){if(!e)return t;var n=Math.abs(e),i=Math.round(n/t);return i?t+(n-i*t)/i:n}function au(e,t){return e.round(t)}function su(e,t,n){return au(function(e,t){var n=t.source,i=Kr.snapToGrid(e.x-n.x,t.x)+n.x,r=Kr.snapToGrid(e.y-n.y,t.y)+n.y;return new eo(i,r)}(e.clone(),t),n)}function lu(e){return e.toString()}function uu(e){return new eo(0===e.x?0:Math.abs(e.x)/e.x,0===e.y?0:Math.abs(e.y)/e.y)}function cu(e,t){for(var n=1/0,i=0,r=t.length;i<r;i+=1){var o=e.manhattanDistance(t[i]);o<n&&(n=o)}return n}function hu(e,t,n,i,r){var o=r.precision,a=r.directionMap,s=e.diff(t.getCenter()),l=Object.keys(a).reduce((function(r,l){if(n.includes(l)){for(var u,c=a[l],h=new eo(e.x+c.x*(Math.abs(s.x)+t.width),e.y+c.y*(Math.abs(s.y)+t.height)),f=new no(e,h).intersect(t)||[],g=null,d=0;d<f.length;d+=1){var v=f[d],p=e.squaredDistance(v);(null==u||p>u)&&(u=p,g=v)}if(g){var y=su(g,i,o);t.containsPoint(y)&&(y=su(y.translate(c.x*i.x,c.y*i.y),i,o)),r.push(y)}}return r}),[]);return t.containsPoint(e)||l.push(su(e,i,o)),l}function fu(e,t,n,i,r){for(var o,a=[],s=uu(r.diff(n)),l=lu(n),u=e[l];u;){var c=uu((o=t[l]).diff(u));c.equals(s)||(a.unshift(o),s=c),u=e[l=lu(u)]}var h=t[l];return uu(h.diff(i)).equals(s)||a.unshift(h),a}function gu(e,t,n,i,r){var o,a,s=r.precision;o=to.isRectangle(t)?au(nu(e,r).clone(),s):au(t.clone(),s),a=to.isRectangle(n)?au(function(e,t){return e.targetAnchor?e.targetAnchor:tu(e,t).getCenter()}(e,r).clone(),s):au(n.clone(),s);var l,u,c,h,f,g=(l=r.step,c=a,{source:(u=o).clone(),x:ou(c.x-u.x,l),y:ou(c.y-u.y,l)}),d=o,v=a;if(h=to.isRectangle(t)?hu(d,t,r.startDirections,g,r):[d],f=to.isRectangle(n)?hu(a,n,r.endDirections,g,r):[v],h=h.filter((function(e){return i.isAccessible(e)})),f=f.filter((function(e){return i.isAccessible(e)})),h.length>0&&f.length>0){for(var p=new Ql,y={},m={},b={},k=0,x=h.length;k<x;k+=1){var w=h[k],P=lu(w);p.add(P,cu(w,f)),y[P]=w,b[P]=0}for(var C,A,O=r.previousDirectionAngle,E=void 0===O,M=function(e,t){var n=t.step;return t.directions.forEach((function(t){t.gridOffsetX=t.offsetX/n*e.x,t.gridOffsetY=t.offsetY/n*e.y})),t.directions}(g,r),S=M.length,T=f.reduce((function(e,t){var n=lu(t);return e.push(n),e}),[]),N=eo.equalPoints(h,f),j=r.maxLoopCount;!p.isEmpty()&&j>0;){var L=p.pop(),D=y[L],I=m[L],R=b[L],V=D.equals(d),B=null==I,z=void 0;if(z=B?E?V?null:iu(d,D,S,g,r):O:iu(I,D,S,g,r),!(B&&N)&&T.indexOf(L)>=0)return r.previousDirectionAngle=z,fu(m,y,D,d,v);for(var F=0;F<S;F+=1){var G=(C=M[F]).angle;if(A=ru(z,G),E&&V||!(A>r.maxDirectionChange)){var q=su(D.clone().translate(C.gridOffsetX||0,C.gridOffsetY||0),g,s),H=lu(q);if(!p.isClose(H)&&i.isAccessible(q)){if(T.indexOf(H)>=0)if(!q.equals(v))if(ru(G,iu(q,v,S,g,r))>r.maxDirectionChange)continue;var _=R+C.cost+(V?0:r.penalties[A]);(!p.isOpen(H)||_<b[H])&&(y[H]=q,m[H]=D,b[H]=_,p.add(H,_+cu(q,f)))}}}j-=1}}return r.fallbackRoute?mn(r.fallbackRoute,this,d,v,r):null}var du=function(e,t,n){for(var i,r,o=function(e){var t=Object.keys(e).reduce((function(t,n){return t[n]="fallbackRouter"===n||"draggingRouter"===n||"fallbackRoute"===n?e[n]:Kl(e[n],e),t}),{});if(t.padding){var n=Gn(t.padding);t.paddingBox={x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom}}return t.directions.forEach((function(e){var t=new eo(0,0),n=new eo(e.offsetX,e.offsetY);e.angle=Zr.normalize(t.theta(n))})),t}(t),a=eu(n,o),s=tu(n,o),l=nu(n,o),u=new $l(o).build(n.graph.model,n.cell),c=e.map((function(e){return eo.create(e)})),h=[],g=l,d=0,v=c.length;d<=v;d+=1){var p=null;if(i=r||a,null==(r=c[d])){r=s;var y=n.cell;if((null==y.getSourceCellId()||null==y.getTargetCellId())&&"function"==typeof o.draggingRouter){var m=i===a?l:i,b=r.getOrigin();p=mn(o.draggingRouter,n,m,b,o)}}if(null==p&&(p=gu(n,i,r,u,o)),null===p)return mn(o.fallbackRouter,this,e,o,n);var k=p[0];k&&k.equals(g)&&p.shift(),g=p[p.length-1]||g,h.push.apply(h,f(p))}return o.snapToGrid?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(e.length<=1)return e;for(var n=0,i=e.length;n<i-1;n+=1){var r=e[n],o=e[n+1];if(r.x===o.x){var a=t*Math.round(r.x/t);r.x!==a&&(r.x=a,o.x=a)}else if(r.y===o.y){var s=t*Math.round(r.y/t);r.y!==s&&(r.y=s,o.y=s)}}return e}(h,n.graph.grid.getGridSize()):h},vu=function(e,t,n){return mn(du,this,e,Object.assign(Object.assign({},Zl),t),n)},pu={maxDirectionChange:45,directions:function(){var e=Kl(this.step,this),t=Kl(this.cost,this),n=Math.ceil(Math.sqrt(e*e<<1));return[{cost:t,offsetX:e,offsetY:0},{cost:n,offsetX:e,offsetY:e},{cost:t,offsetX:0,offsetY:e},{cost:n,offsetX:-e,offsetY:e},{cost:t,offsetX:-e,offsetY:0},{cost:n,offsetX:-e,offsetY:-e},{cost:t,offsetX:0,offsetY:-e},{cost:n,offsetX:e,offsetY:-e}]},fallbackRoute:function(e,t,n){var i=e.theta(t),r=[],o={x:t.x,y:e.y},a={x:e.x,y:t.y};if(i%180>90){var s=o;o=a,a=s}var l=i%90<45?o:a,u=new no(e,l),c=90*Math.ceil(i/90),h=eo.fromPolar(u.squaredLength(),Zr.toRad(c+135),l),f=new no(t,h),g=u.intersectsWithLine(f),d=g||t,v=g?d:e,p=360/n.directions.length,y=v.theta(t),m=Zr.normalize(y+p/2),b=p*Math.floor(m/p);return n.previousDirectionAngle=b,d&&r.push(d.round()),r.push(t),r}};function yu(e,t){if(null!=t&&!1!==t){var n="boolean"==typeof t?0:t;if(n>0){var i=eo.create(e[1]).move(e[2],n),r=eo.create(e[1]).move(e[0],n);return[i.toJSON()].concat(f(e),[r.toJSON()])}var o=e[1];return[Object.assign({},o)].concat(f(e),[Object.assign({},o)])}return e}var mu,bu=Object.freeze(Object.defineProperty({__proto__:null,er:function(e,t,n){var i,r,o,a=t.offset||32,s=null==t.min?16:t.min,l=0,u=t.direction,c=n.sourceBBox,h=n.targetBBox,g=c.getCenter(),d=h.getCenter();if("number"==typeof a&&(l=a),null==u){var v=h.left-c.right,p=h.top-c.bottom;v>=0&&p>=0?u=v>=p?"L":"T":v<=0&&p>=0?u=(v=c.left-h.right)>=0&&v>=p?"R":"T":v>=0&&p<=0?u=(p=c.top-h.bottom)>=0?v>=p?"L":"B":"L":(v=c.left-h.right,p=c.top-h.bottom,u=v>=0&&p>=0?v>=p?"R":"B":v<=0&&p>=0?"B":v>=0&&p<=0||Math.abs(v)>Math.abs(p)?"R":"B")}"H"===u?u=d.x-g.x>=0?"L":"R":"V"===u&&(u=d.y-g.y>=0?"T":"B"),"center"===a&&("L"===u?l=(h.left-c.right)/2:"R"===u?l=(c.left-h.right)/2:"T"===u?l=(h.top-c.bottom)/2:"B"===u&&(l=(c.top-h.bottom)/2));var y="L"===u||"R"===u;if(y){if(d.y===g.y)return f(e);o="L"===u?1:-1,i="x",r="width"}else{if(d.x===g.x)return f(e);o="T"===u?1:-1,i="y",r="height"}var m=g.clone(),b=d.clone();if(m[i]+=o*(c[r]/2+l),b[i]-=o*(h[r]/2+l),y){var k=m.x,x=b.x,w=c.width/2+s,P=h.width/2+s;d.x>g.x?x<=k&&(m.x=Math.max(x,g.x+w),b.x=Math.min(k,d.x-P)):x>=k&&(m.x=Math.min(x,g.x-w),b.x=Math.max(k,d.x+P))}else{var C=m.y,A=b.y,O=c.height/2+s,E=h.height/2+s;d.y>g.y?A<=C&&(m.y=Math.max(A,g.y+O),b.y=Math.min(C,d.y-E)):A>=C&&(m.y=Math.min(A,g.y-O),b.y=Math.max(C,d.y+E))}return[m.toJSON()].concat(f(e),[b.toJSON()])},loop:function(e,t,n){var i=t.width||50,r=(t.height||80)/2,o=t.angle||"auto",a=n.sourceAnchor,s=n.targetAnchor,l=n.sourceBBox,u=n.targetBBox;if(a.equals(s)){var c=function(e){var t=Zr.toRad(e),n=Math.sin(t),o=Math.cos(t),s=new eo(a.x+o*i,a.y+n*i),l=new eo(s.x-o*r,s.y-n*r),u=l.clone().rotate(-90,s),c=l.clone().rotate(90,s);return[u.toJSON(),s.toJSON(),c.toJSON()]},h=function(e){var t=a.clone().move(e,-1),n=new no(t,e);return!l.containsPoint(e)&&!l.intersectsWithLine(n)},g=[0,90,180,270,45,135,225,315];if("number"==typeof o)return yu(c(o),t.merge);var d=l.getCenter();if(d.equals(a))return yu(c(0),t.merge);var v=d.angleBetween(a,d.clone().translate(1,0)),p=c(v);if(h(p[1]))return yu(p,t.merge);for(var y=1,m=g.length;y<m;y+=1)if(h((p=c(v+g[y]))[1]))return yu(p,t.merge);return yu(p,t.merge)}var b=new no(a,s),k=b.parallel(-i),x=k.getCenter(),w=k.start.clone().move(k.end,r),P=k.end.clone().move(k.start,r),C=b.parallel(-1),A=new no(C.start,x),O=new no(C.end,x);if((l.containsPoint(x)||u.containsPoint(x)||l.intersectsWithLine(A)||l.intersectsWithLine(O)||u.intersectsWithLine(A)||u.intersectsWithLine(O))&&(x=(k=b.parallel(i)).getCenter(),w=k.start.clone().move(k.end,r),P=k.end.clone().move(k.start,r)),t.merge){var E=new no(a,s),M=new no(x,E.center).setLength(Number.MAX_SAFE_INTEGER),S=l.intersectsWithLine(M),T=u.intersectsWithLine(M),N=S?Array.isArray(S)?S:[S]:[];T&&(Array.isArray(T)?N.push.apply(N,f(T)):N.push(T));var j=E.center.closest(N);j?(n.sourceAnchor=j.clone(),n.targetAnchor=j.clone()):(n.sourceAnchor=E.center.clone(),n.targetAnchor=E.center.clone())}return yu([w.toJSON(),x.toJSON(),P.toJSON()],t.merge)},manhattan:vu,metro:function(e,t,n){return mn(vu,this,e,Object.assign(Object.assign({},pu),t),n)},normal:function(e){return f(e)},oneSide:function(e,t,n){var i,r,o,a=t.side||"bottom",s=Gn(t.padding||40),l=n.sourceBBox,u=n.targetBBox,c=l.getCenter(),h=u.getCenter();switch(a){case"top":o=-1,i="y",r="height";break;case"left":o=-1,i="x",r="width";break;case"right":o=1,i="x",r="width";break;default:o=1,i="y",r="height"}return c[i]+=o*(l[r]/2+s[a]),h[i]+=o*(u[r]/2+s[a]),o*(c[i]-h[i])>0?h[i]=c[i]:c[i]=h[i],[c.toJSON()].concat(f(e),[h.toJSON()])},orth:Yl},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=bu,e.registry=Ao.create({type:"router"}),e.registry.register(e.presets,!0)}(mu||(mu={}));var ku,xu,wu=1/3,Pu=2/3;function Cu(e,t){var n=[e].concat(f(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]),[t]),i=[];return n.forEach((function(e,t){var r=n[t+1];null!=r&&i.push(new no(e,r))})),i}function Au(e,t){return new no(e,t).squaredLength()}function Ou(e,t,n,i){var r,o=new Co;return r=Co.createSegment("M",e[0].start),o.appendSegment(r),e.forEach((function(a,s){if(ku.includes(a)){var l,u,c,h;if("arc"===n){l=-90,((u=a.start.diff(a.end)).x<0||0===u.x&&u.y<0)&&(l+=180);var f,g=a.getCenter(),d=new no(g,a.end).rotate(l,g);c=(f=new no(a.start,g)).pointAt(2/3).rotate(l,a.start),h=d.pointAt(1/3).rotate(-l,d.end),r=Co.createSegment("C",c,h,d.end),o.appendSegment(r),f=new no(g,a.end),c=d.pointAt(1/3).rotate(l,d.end),h=f.pointAt(1/3).rotate(-l,a.end),r=Co.createSegment("C",c,h,a.end),o.appendSegment(r)}else if("gap"===n)r=Co.createSegment("M",a.end),o.appendSegment(r);else if("cubic"===n){l=a.start.theta(a.end);var v=.6*t,p=1.35*t;((u=a.start.diff(a.end)).x<0||0===u.x&&u.y<0)&&(p*=-1),c=new eo(a.start.x+v,a.start.y+p).rotate(l,a.start),h=new eo(a.end.x-v,a.end.y+p).rotate(l,a.end),r=Co.createSegment("C",c,h,a.end),o.appendSegment(r)}}else{var y=e[s+1];0===i||!y||ku.includes(y)?(r=Co.createSegment("L",a.end),o.appendSegment(r)):function(e,t,n,i,r){var o,a=n.distance(i)/2,s=n.distance(r)/2,l=-Math.min(e,a),u=-Math.min(e,s),c=n.clone().move(i,l).round(),h=n.clone().move(r,u).round(),f=new eo(wu*c.x+Pu*n.x,Pu*n.y+wu*c.y),g=new eo(wu*h.x+Pu*n.x,Pu*n.y+wu*h.y);o=Co.createSegment("L",c),t.appendSegment(o),o=Co.createSegment("C",f,g,h),t.appendSegment(o)}(i,o,a.end,a.start,y.end)}})),o}var Eu,Mu=Object.freeze(Object.defineProperty({__proto__:null,jumpover:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};ku=[],xu=[],function(e){var t=e.graph._jumpOverUpdateList;if(null==t&&(t=e.graph._jumpOverUpdateList=[],e.graph.on("cell:mouseup",(function(){var t=e.graph._jumpOverUpdateList;setTimeout((function(){for(var e=0;e<t.length;e+=1)t[e].update()}))})),e.graph.on("model:reseted",(function(){t=e.graph._jumpOverUpdateList=[]}))),t.indexOf(e)<0){t.push(e);var n=function(){return t.splice(t.indexOf(e),1)};e.cell.once("change:connector",n),e.cell.once("removed",n)}}(this);var o=r.size||5,a=r.type||"arc",s=r.radius||0,l=r.ignoreConnectors||["smooth"],u=this.graph,c=u.model.getEdges();if(1===c.length)return Ou(Cu(e,t,n),o,a,s);var h=this.cell,g=c.indexOf(h),d=u.options.connecting.connector||{},v=c.filter((function(e,t){var n=e.getConnector()||d;return!l.includes(n.name)&&(!(t>g)||"jumpover"!==n.name)})),p=v.map((function(e){return u.findViewByCell(e)})),y=Cu(e,t,n),m=p.map((function(e){return null==e?[]:e===i?y:Cu(e.sourcePoint,e.targetPoint,e.routePoints)})),b=[];y.forEach((function(e){var t=v.reduce((function(t,n,i){if(n!==h){var r=function(e,t){var n=[];return t.forEach((function(t){var i=e.intersectsWithLine(t);i&&n.push(i)})),n}(e,m[i]);t.push.apply(t,f(r))}return t}),[]).sort((function(t,n){return Au(e.start,t)-Au(e.start,n)}));t.length>0?b.push.apply(b,f(function(e,t,n){return t.reduce((function(i,r,o){if(xu.includes(r))return i;var a=i.pop()||e,s=eo.create(r).move(a.start,-n),l=eo.create(r).move(a.start,+n),u=t[o+1];if(null!=u){var c=l.distance(u);c<=n&&(l=u.move(a.start,c),xu.push(u))}else if(s.distance(a.end)<2*n+1)return i.push(a),i;if(l.distance(a.start)<2*n+1)return i.push(a),i;var h=new no(s,l);return ku.push(h),i.push(new no(a.start,s),h,new no(l,a.end)),i}),[])}(e,t,o))):b.push(e)}));var k=Ou(b,o,a,s);return ku=[],xu=[],r.raw?k:k.serialize()},loop:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=3===n.length?0:1,o=eo.create(n[0+r]),a=eo.create(n[2+r]),s=eo.create(n[1+r]);if(!eo.equals(e,t)){var l=new eo((e.x+t.x)/2,(e.y+t.y)/2),u=l.angleBetween(eo.create(e).rotate(90,l),s);u>1&&(o.rotate(180-u,l),a.rotate(180-u,l),s.rotate(180-u,l))}var c="\n     M ".concat(e.x," ").concat(e.y,"\n     Q ").concat(o.x," ").concat(o.y," ").concat(s.x," ").concat(s.y,"\n     Q ").concat(a.x," ").concat(a.y," ").concat(t.x," ").concat(t.y,"\n  ");return i.raw?Co.parse(c):c},normal:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=[e].concat(f(n),[t]),o=new co(r),a=new Co(o);return i.raw?a:a.serialize()},rounded:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=new Co;r.appendSegment(Co.createSegment("M",e));for(var o,a,s=1/3,l=2/3,u=i.radius||10,c=0,h=n.length;c<h;c+=1){var f=eo.create(n[c]),g=n[c-1]||e,d=n[c+1]||t;o=a||f.distance(g)/2,a=f.distance(d)/2;var v=-Math.min(u,o),p=-Math.min(u,a),y=f.clone().move(g,v).round(),m=f.clone().move(d,p).round(),b=new eo(s*y.x+l*f.x,l*f.y+s*y.y),k=new eo(s*m.x+l*f.x,l*f.y+s*m.y);r.appendSegment(Co.createSegment("L",y)),r.appendSegment(Co.createSegment("C",b,k,m))}return r.appendSegment(Co.createSegment("L",t)),i.raw?r:r.serialize()},smooth:function(e,t,n){var i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=r.direction;if(n&&0!==n.length){var a=[e].concat(f(n),[t]),s=ho.throughPoints(a);i=new Co(s)}else if((i=new Co).appendSegment(Co.createSegment("M",e)),o||(o=Math.abs(e.x-t.x)>=Math.abs(e.y-t.y)?"H":"V"),"H"===o){var l=(e.x+t.x)/2;i.appendSegment(Co.createSegment("C",l,e.y,l,t.y,t.x,t.y))}else{var u=(e.y+t.y)/2;i.appendSegment(Co.createSegment("C",e.x,u,t.x,u,t.x,t.y))}return r.raw?i:i.serialize()}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Mu,e.registry=Ao.create({type:"connector"}),e.registry.register(e.presets,!0)}(Eu||(Eu={}));var Su=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Tu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return v(this,t),(e=a(this,t)).pending=!1,e.changing=!1,e.data={},e.mutate(Q(n)),e.changed={},e}return c(t,e),y(t,[{key:"mutate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!0===n.unset,r=!0===n.silent,o=[],a=this.changing;this.changing=!0,a||(this.previous=Q(this.data),this.changed={});var s=this.data,l=this.previous,u=this.changed;if(Object.keys(e).forEach((function(t){var n=t,r=e[n];ee(s[n],r)||o.push(n),ee(l[n],r)?delete u[n]:u[n]=r,i?delete s[n]:s[n]=r})),!r&&o.length>0&&(this.pending=!0,this.pendingOptions=n,o.forEach((function(e){t.emit("change:*",{key:e,options:n,store:t,current:s[e],previous:l[e]})}))),a)return this;if(!r)for(;this.pending;)this.pending=!1,this.emit("changed",{current:s,previous:l,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}},{key:"get",value:function(e,t){if(null==e)return this.data;var n=this.data[e];return null==n?t:n}},{key:"getPrevious",value:function(e){if(this.previous){var t=this.previous[e];return null==t?void 0:t}}},{key:"set",value:function(e,t,n){return null!=e&&("object"===b(e)?this.mutate(e,t):this.mutate(o({},e,t),n)),this}},{key:"remove",value:function(e,t){var n,i=void 0,r={};if("string"==typeof e)r[e]=i,n=t;else if(Array.isArray(e))e.forEach((function(e){return r[e]=i})),n=t;else{for(var o in this.data)r[o]=i;n=e}return this.mutate(r,Object.assign(Object.assign({},n),{unset:!0})),this}},{key:"getByPath",value:function(e){return En(this.data,e,"/")}},{key:"setByPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="/",r=Array.isArray(e)?f(e):e.split(i),o=Array.isArray(e)?e.join(i):e,a=r[0],s=r.length;if(n.propertyPath=o,n.propertyValue=t,n.propertyPathArray=r,1===s)this.set(a,t,n);else{for(var l={},u=l,c=a,h=1;h<s;h+=1){var g=r[h],d=Number.isFinite(Number(g));u=u[c]=d?[]:{},c=g}Mn(l,r,t,i);var v=Q(this.data);n.rewrite&&Sn(v,e,i);var p=nn(v,l);this.set(a,p[a],n)}return this}},{key:"removeByPath",value:function(e,t){var n=Array.isArray(e)?e:e.split("/"),i=n[0];if(1===n.length)this.remove(i,t);else{var r=n.slice(1),o=Q(this.get(i));o&&Sn(o,r),this.set(i,o,t)}return this}},{key:"hasChanged",value:function(e){return null==e?Object.keys(this.changed).length>0:e in this.changed}},{key:"getChanges",value:function(e){if(null==e)return this.hasChanged()?Q(this.changed):null;var t,n=this.changing?this.previous:this.data,i={};for(var r in e){var o=e[r];ee(n[r],o)||(i[r]=o,t=!0)}return t?Q(i):null}},{key:"toJSON",value:function(){return Q(this.data)}},{key:"clone",value:function(){return new(0,this.constructor)(this.data)}},{key:"dispose",value:function(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}])}(Nn);Su([Nn.dispose()],Tu.prototype,"dispose",null);var Nu=function(){function e(t){v(this,e),this.cell=t,this.ids={},this.cache={}}return y(e,[{key:"get",value:function(){return Object.keys(this.ids)}},{key:"start",value:function(t,n){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",a=this.cell.getPropByPath(t),s=zt(r,e.defaultOptions),l=this.getTiming(s.timing),u=this.getInterp(s.interp,a,n),c=0,h=Array.isArray(t)?t.join(o):t,f=Array.isArray(t)?t:t.split(o),g=function(){var e=(new Date).getTime();0===c&&(c=e);var t=(e-c)/s.duration;t<1?i.ids[h]=requestAnimationFrame(g):t=1;var n=u(l(t));i.cell.setPropByPath(f,n),r.progress&&r.progress(Object.assign({progress:t,currentValue:n},i.getArgs(h))),1===t&&(i.cell.notify("transition:complete",i.getArgs(h)),r.complete&&r.complete(i.getArgs(h)),i.cell.notify("transition:finish",i.getArgs(h)),r.finish&&r.finish(i.getArgs(h)),i.clean(h))};return setTimeout((function(){i.stop(t,void 0,o),i.cache[h]={startValue:a,targetValue:n,options:s},i.ids[h]=requestAnimationFrame(g),i.cell.notify("transition:start",i.getArgs(h)),r.start&&r.start(i.getArgs(h))}),r.delay),this.stop.bind(this,t,o,r)}},{key:"stop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",r=Array.isArray(e)?e:e.split(i);return Object.keys(this.ids).filter((function(e){return ee(r,e.split(i).slice(0,r.length))})).forEach((function(e){cancelAnimationFrame(t.ids[e]);var i=t.cache[e],r=t.getArgs(e),o=Object.assign(Object.assign({},i.options),n),a=o.jumpedToEnd;a&&null!=i.targetValue&&(t.cell.setPropByPath(e,i.targetValue),t.cell.notify("transition:end",Object.assign({},r)),t.cell.notify("transition:complete",Object.assign({},r)),o.complete&&o.complete(Object.assign({},r)));var s=Object.assign({jumpedToEnd:a},r);t.cell.notify("transition:stop",Object.assign({},s)),o.stop&&o.stop(Object.assign({},s)),t.cell.notify("transition:finish",Object.assign({},r)),o.finish&&o.finish(Object.assign({},r)),t.clean(e)})),this}},{key:"clean",value:function(e){delete this.ids[e],delete this.cache[e]}},{key:"getTiming",value:function(e){return"string"==typeof e?Jr[e]:e}},{key:"getInterp",value:function(e,t,n){return e?e(t,n):"number"==typeof n?Xr.number(t,n):"string"==typeof n?"#"===n[0]?Xr.color(t,n):Xr.unit(t,n):Xr.object(t,n)}},{key:"getArgs",value:function(e){var t=this.cache[e];return{path:e,startValue:t.startValue,targetValue:t.targetValue,cell:this.cell}}}])}();!function(e){e.defaultOptions={delay:10,duration:100,timing:"linear"}}(Nu||(Nu={}));var ju,Lu=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Du=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Iu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,t);var i=(e=a(this,t)).constructor.getDefaults(!0),r=nn({},e.preprocess(i),e.preprocess(n));return e.id=r.id||Rn(),e.store=new Tu(r),e.animation=new Nu(e),e.setup(),e.init(),e.postprocess(n),e}return c(t,e),y(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"init",value:function(){}},{key:"model",get:function(){return this._model},set:function(e){this._model!==e&&(this._model=e)}},{key:"preprocess",value:function(e,t){var n=e.id,i=this.constructor.applyPropHooks(this,e);return null==n&&!0!==t&&(i.id=Rn()),i}},{key:"postprocess",value:function(e){}},{key:"setup",value:function(){var e=this;this.store.on("change:*",(function(t){var n=t.key,i=t.current,r=t.previous,o=t.options;e.notify("change:*",{key:n,options:o,current:i,previous:r,cell:e}),e.notify("change:".concat(n),{options:o,current:i,previous:r,cell:e});var a=n;"source"!==a&&"target"!==a||e.notify("change:terminal",{type:a,current:i,previous:r,options:o,cell:e})})),this.store.on("changed",(function(t){var n=t.options;return e.notify("changed",{options:n,cell:e})}))}},{key:"notify",value:function(e,t){this.trigger(e,t);var n=this.model;return n&&(n.notify("cell:".concat(e),t),this.isNode()?n.notify("node:".concat(e),Object.assign(Object.assign({},t),{node:this})):this.isEdge()&&n.notify("edge:".concat(e),Object.assign(Object.assign({},t),{edge:this}))),this}},{key:"isNode",value:function(){return!1}},{key:"isEdge",value:function(){return!1}},{key:"isSameStore",value:function(e){return this.store===e.store}},{key:"view",get:function(){return this.store.get("view")}},{key:"shape",get:function(){return this.store.get("shape","")}},{key:"getProp",value:function(e,t){return null==e?this.store.get():this.store.get(e,t)}},{key:"setProp",value:function(e,t,n){if("string"==typeof e)this.store.set(e,t,n);else{var i=this.preprocess(e,!0);this.store.set(nn({},this.getProp(),i),t),this.postprocess(e)}return this}},{key:"removeProp",value:function(e,t){return"string"==typeof e||Array.isArray(e)?this.store.removeByPath(e,t):this.store.remove(t),this}},{key:"hasChanged",value:function(e){return null==e?this.store.hasChanged():this.store.hasChanged(e)}},{key:"getPropByPath",value:function(e){return this.store.getByPath(e)}},{key:"setPropByPath",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model&&("children"===e?this._children=t?t.map((function(e){return n.model.getCell(e)})).filter((function(e){return null!=e})):null:"parent"===e&&(this._parent=t?this.model.getCell(t):null)),this.store.setByPath(e,t,i),this}},{key:"removePropByPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Array.isArray(e)?e:e.split("/");return"attrs"===n[0]&&(t.dirty=!0),this.store.removeByPath(n,t),this}},{key:"prop",value:function(e,t,n){return null==e?this.getProp():"string"==typeof e||Array.isArray(e)?1===arguments.length?this.getPropByPath(e):null==t?this.removePropByPath(e,n||{}):this.setPropByPath(e,t,n||{}):this.setProp(e,t||{})}},{key:"previous",value:function(e){return this.store.getPrevious(e)}},{key:"zIndex",get:function(){return this.getZIndex()},set:function(e){null==e?this.removeZIndex():this.setZIndex(e)}},{key:"getZIndex",value:function(){return this.store.get("zIndex")}},{key:"setZIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("zIndex",e,t),this}},{key:"removeZIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("zIndex",e),this}},{key:"toFront",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.model;if(t){var n,i=t.getMaxZIndex();e.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0})).unshift(this):n=[this],i=i-n.length+1;var r=t.total(),o=t.indexOf(this)!==r-n.length;o||(o=n.some((function(e,t){return e.getZIndex()!==i+t}))),o&&this.batchUpdate("to-front",(function(){i+=n.length,n.forEach((function(t,n){t.setZIndex(i+n,e)}))}))}return this}},{key:"toBack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.model;if(t){var n,i=t.getMinZIndex();e.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0})).unshift(this):n=[this];var r=0!==t.indexOf(this);r||(r=n.some((function(e,t){return e.getZIndex()!==i+t}))),r&&this.batchUpdate("to-back",(function(){i-=n.length,n.forEach((function(t,n){t.setZIndex(i+n,e)}))}))}return this}},{key:"markup",get:function(){return this.getMarkup()},set:function(e){null==e?this.removeMarkup():this.setMarkup(e)}},{key:"getMarkup",value:function(){var e=this.store.get("markup");null==e&&(e=this.constructor.getMarkup());return e}},{key:"setMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("markup",e,t),this}},{key:"removeMarkup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("markup",e),this}},{key:"attrs",get:function(){return this.getAttrs()},set:function(e){null==e?this.removeAttrs():this.setAttrs(e)}},{key:"getAttrs",value:function(){var e=this.store.get("attrs");return e?Object.assign({},e):{}}},{key:"setAttrs",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)this.removeAttrs(n);else{var i=function(e){return t.store.set("attrs",e,n)};if(!0===n.overwrite)i(e);else{var r=this.getAttrs();!1===n.deep?i(Object.assign(Object.assign({},r),e)):i(nn({},r,e))}}return this}},{key:"replaceAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setAttrs(e,Object.assign(Object.assign({},t),{overwrite:!0}))}},{key:"updateAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setAttrs(e,Object.assign(Object.assign({},t),{deep:!1}))}},{key:"removeAttrs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("attrs",e),this}},{key:"getAttrDefinition",value:function(e){if(!e)return null;var t=this.constructor.getAttrHooks()||{},n=t[e]||us.registry.get(e);if(!n){var i=Dt(e);n=t[i]||us.registry.get(i)}return n||null}},{key:"getAttrByPath",value:function(e){return null==e||""===e?this.getAttrs():this.getPropByPath(this.prefixAttrPath(e))}},{key:"setAttrByPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setPropByPath(this.prefixAttrPath(e),t,n),this}},{key:"removeAttrByPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.removePropByPath(this.prefixAttrPath(e),t),this}},{key:"prefixAttrPath",value:function(e){return Array.isArray(e)?["attrs"].concat(e):"attrs/".concat(e)}},{key:"attr",value:function(e,t,n){return null==e?this.getAttrByPath():"string"==typeof e||Array.isArray(e)?1===arguments.length?this.getAttrByPath(e):null==t?this.removeAttrByPath(e,n||{}):this.setAttrByPath(e,t,n||{}):this.setAttrs(e,t||{})}},{key:"visible",get:function(){return this.isVisible()},set:function(e){this.setVisible(e)}},{key:"setVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("visible",e,t),this}},{key:"isVisible",value:function(){return!1!==this.store.get("visible")}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.isVisible()||this.setVisible(!0,e),this}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.isVisible()&&this.setVisible(!1,e),this}},{key:"toggleVisible",value:function(e){var t="boolean"==typeof e?arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}:e;return("boolean"==typeof e?e:!this.isVisible())?this.show(t):this.hide(t),this}},{key:"data",get:function(){return this.getData()},set:function(e){this.setData(e)}},{key:"getData",value:function(){return this.store.get("data")}},{key:"setData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)this.removeData(n);else{var i=function(e){return t.store.set("data",e,n)};if(!0===n.overwrite)i(e);else{var r=this.getData();!1===n.deep?i("object"===b(e)?Object.assign(Object.assign({},r),e):e):i(nn({},r,e))}}return this}},{key:"replaceData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setData(e,Object.assign(Object.assign({},t),{overwrite:!0}))}},{key:"updateData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setData(e,Object.assign(Object.assign({},t),{deep:!1}))}},{key:"removeData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("data",e),this}},{key:"parent",get:function(){return this.getParent()}},{key:"children",get:function(){return this.getChildren()}},{key:"getParentId",value:function(){return this.store.get("parent")}},{key:"getParent",value:function(){var e=this.getParentId();if(e&&this.model){var t=this.model.getCell(e);return this._parent=t,t}return null}},{key:"getChildren",value:function(){var e=this,t=this.store.get("children");if(t&&t.length&&this.model){var n=t.map((function(t){var n;return null===(n=e.model)||void 0===n?void 0:n.getCell(t)})).filter((function(e){return null!=e}));return this._children=n,f(n)}return null}},{key:"hasParent",value:function(){return null!=this.parent}},{key:"isParentOf",value:function(e){return null!=e&&e.getParent()===this}},{key:"isChildOf",value:function(e){return null!=e&&this.getParent()===e}},{key:"eachChild",value:function(e,t){return this.children&&this.children.forEach(e,t),this}},{key:"filterChild",value:function(e,t){return this.children?this.children.filter(e,t):[]}},{key:"getChildCount",value:function(){return null==this.children?0:this.children.length}},{key:"getChildIndex",value:function(e){return null==this.children?-1:this.children.indexOf(e)}},{key:"getChildAt",value:function(e){return null!=this.children&&e>=0?this.children[e]:null}},{key:"getAncestors",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],n=this.getParent();n;)t.push(n),n=!1!==e.deep?n.getParent():null;return t}},{key:"getDescendants",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!1!==e.deep){if(e.breadthFirst){for(var t=[],n=this.getChildren()||[];n.length>0;){var i=n.shift(),r=i.getChildren();t.push(i),r&&n.push.apply(n,f(r))}return t}var o=this.getChildren()||[];return o.forEach((function(t){o.push.apply(o,f(t.getDescendants(e)))})),o}return this.getChildren()||[]}},{key:"isDescendantOf",value:function(e){if(null==e)return!1;if(!1!==(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).deep){for(var t=this.getParent();t;){if(t===e)return!0;t=t.getParent()}return!1}return this.isChildOf(e)}},{key:"isAncestorOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=e&&e.isDescendantOf(this,t)}},{key:"contains",value:function(e){return this.isAncestorOf(e)}},{key:"getCommonAncestor",value:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.getCommonAncestor.apply(t,[this].concat(n))}},{key:"setParent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._parent=e,e?this.store.set("parent",e.id,t):this.store.remove("parent",t),this}},{key:"setChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._children=e,null!=e?this.store.set("children",e.map((function(e){return e.id})),t):this.store.remove("children",t),this}},{key:"unembed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.children;if(null!=n&&null!=e){var i=this.getChildIndex(e);-1!==i&&(n.splice(i,1),e.setParent(null,t),this.setChildren(n,t))}return this}},{key:"embed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.addTo(this,t),this}},{key:"addTo",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.isCell(e)?e.addChild(this,n):e.addCell(this,n),this}},{key:"insertTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.insertChild(this,t,n),this}},{key:"addChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.insertChild(e,void 0,t)}},{key:"insertChild",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&e!==this){var i=e.getParent(),r=this!==i,o=t;if(null==o&&(o=this.getChildCount(),r||(o-=1)),i){var a=i.getChildren();if(a){var s=a.indexOf(e);s>=0&&(e.setParent(null,n),a.splice(s,1),i.setChildren(a,n))}}var l=this.children;if(null==l?(l=[]).push(e):l.splice(o,0,e),e.setParent(this,n),this.setChildren(l,n),r&&this.model){var u=this.model.getIncomingEdges(this),c=this.model.getOutgoingEdges(this);u&&u.forEach((function(e){return e.updateParent(n)})),c&&c.forEach((function(e){return e.updateParent(n)}))}this.model&&this.model.addCell(e,n)}return this}},{key:"removeFromParent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getParent();if(null!=t){var n=t.getChildIndex(this);t.removeChildAt(n,e)}return this}},{key:"removeChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getChildIndex(e);return this.removeChildAt(n,t)}},{key:"removeChildAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getChildAt(e);return null!=this.children&&null!=n&&(this.unembed(n,t),n.remove(t)),n}},{key:"remove",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.batchUpdate("remove",(function(){var n=e.getParent();n&&n.removeChild(e,t),!1!==t.deep&&e.eachChild((function(e){return e.remove(t)})),e.model&&e.model.removeCell(e,t)})),this}},{key:"transition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/";return this.animation.start(e,t,n,i)}},{key:"stopTransition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/";return this.animation.stop(e,t,n),this}},{key:"getTransitions",value:function(){return this.animation.get()}},{key:"translate",value:function(e,t,n){return this}},{key:"scale",value:function(e,t,n,i){return this}},{key:"addTools",value:function(e,t,n){var i=Array.isArray(e)?e:[e],r="string"==typeof t?t:null,o="object"===b(t)?t:"object"===b(n)?n:{};if(o.reset)return this.setTools({name:r,items:i,local:o.local},o);var a=Q(this.getTools());return null==a||null==r||a.name===r?(null==a&&(a={}),a.items||(a.items=[]),a.name=r,a.items=[].concat(f(a.items),f(i)),this.setTools(Object.assign({},a),o)):void 0}},{key:"setTools",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==e?this.removeTools():this.store.set("tools",t.normalizeTools(e),n),this}},{key:"getTools",value:function(){return this.store.get("tools")}},{key:"removeTools",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("tools",e),this}},{key:"hasTools",value:function(e){var t=this.getTools();return null!=t&&(null==e||t.name===e)}},{key:"hasTool",value:function(e){var t=this.getTools();return null!=t&&t.items.some((function(t){return"string"==typeof t?t===e:t.name===e}))}},{key:"removeTool",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Q(this.getTools());if(n){var i=!1,r=n.items.slice(),o=function(e){r.splice(e,1),i=!0};if("number"==typeof e)o(e);else for(var a=r.length-1;a>=0;a-=1){var s=r[a];("string"==typeof s?s===e:s.name===e)&&o(a)}i&&(n.items=r,this.setTools(n,t))}return this}},{key:"getBBox",value:function(e){return new to}},{key:"getConnectionPoint",value:function(e,t){return new eo}},{key:"toJSON",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},this.store.get()),i=Object.prototype.toString,o=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!n.shape){var a=this.constructor;throw new Error("Unable to serialize ".concat(o,' missing "shape" prop, check the ').concat(o,' "').concat(a.name||i.call(a),'"'))}var s=this.constructor,l=!0===t.diff,c=n.attrs||{},h=s.getDefaults(!0),f=l?this.preprocess(h,!0):h,g=f.attrs||{},d={};Object.entries(n).forEach((function(t){var a=r(t,2),s=a[0],u=a[1];if(null!=u&&!Array.isArray(u)&&"object"===b(u)&&!D(u))throw new Error("Can only serialize ".concat(o,' with plain-object props, but got a "').concat(i.call(u),'" type of key "').concat(s,'" on ').concat(o,' "').concat(e.id,'"'));if("attrs"!==s&&"shape"!==s&&l){var c=f[s];ee(u,c)&&delete n[s]}})),Object.keys(c).forEach((function(e){var t=c[e],n=g[e];Object.keys(t).forEach((function(i){var r=t[i],o=n?n[i]:null;null==r||"object"!==b(r)||Array.isArray(r)?null!=n&&ee(o,r)||(null==d[e]&&(d[e]={}),d[e][i]=r):Object.keys(r).forEach((function(t){var a=r[t];null!=n&&null!=o&&u(o)&&ee(o[t],a)||(null==d[e]&&(d[e]={}),null==d[e][i]&&(d[e][i]={}),d[e][i][t]=a)}))}))}));var v=Object.assign(Object.assign({},n),{attrs:te(d)?void 0:d});null==v.attrs&&delete v.attrs;var p=v;return 0===p.angle&&delete p.angle,Q(p)}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.deep){var n=Object.assign({},this.store.get());return e.keepId||delete n.id,delete n.parent,delete n.children,new(0,this.constructor)(n)}return t.deepClone(this)[this.id]}},{key:"findView",value:function(e){return e.findViewByCell(this)}},{key:"startBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.model;return this.notify("batch:start",{name:e,data:t,cell:this}),n&&n.startBatch(e,Object.assign(Object.assign({},t),{cell:this})),this}},{key:"stopBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.model;return n&&n.stopBatch(e,Object.assign(Object.assign({},t),{cell:this})),this.notify("batch:stop",{name:e,data:t,cell:this}),this}},{key:"batchUpdate",value:function(e,t,n){var i=this.model;this.startBatch(e,n,i);var r=t();return this.stopBatch(e,n,i),r}},{key:"dispose",value:function(){this.removeFromParent(),this.store.dispose()}}],[{key:"config",value:function(e){var t,n=this,i=e.markup,r=e.propHooks,o=e.attrHooks,a=Du(e,["markup","propHooks","attrHooks"]);(null!=i&&(this.markup=i),r)&&(this.propHooks=this.propHooks.slice(),Array.isArray(r)?(t=this.propHooks).push.apply(t,f(r)):"function"==typeof r?this.propHooks.push(r):Object.values(r).forEach((function(e){"function"==typeof e&&n.propHooks.push(e)})));o&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),o)),this.defaults=nn({},this.defaults,a)}},{key:"getMarkup",value:function(){return this.markup}},{key:"getDefaults",value:function(e){return e?this.defaults:Q(this.defaults)}},{key:"getAttrHooks",value:function(){return this.attrHooks}},{key:"applyPropHooks",value:function(e,t){return this.propHooks.reduce((function(t,n){return n?mn(n,e,t):t}),t)}}])}(Nn);Iu.defaults={},Iu.attrHooks={},Iu.propHooks=[],Lu([Nn.dispose()],Iu.prototype,"dispose",null),function(e){e.normalizeTools=function(e){return"string"==typeof e?{items:[e]}:Array.isArray(e)?{items:e}:e.items?e:{items:[e]}}}(Iu||(Iu={})),function(e){e.toStringTag="X6.".concat(e.name),e.isCell=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNode&&"function"==typeof i.isEdge&&"function"==typeof i.prop&&"function"==typeof i.attr}}(Iu||(Iu={})),function(e){e.getCommonAncestor=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.filter((function(e){return null!=e})).map((function(e){return e.getAncestors()})).sort((function(e,t){return e.length-t.length}));return i.shift().find((function(e){return i.every((function(t){return t.includes(e)}))}))||null},e.getCellsBBox=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=0,r=e.length;i<r;i+=1){var o=e[i],a=o.getBBox(t);if(a){if(o.isNode()){var s=o.getAngle();null!=s&&0!==s&&(a=a.bbox(s))}n=null==n?a:n.union(a)}}return n},e.deepClone=function(t){var n=[t].concat(f(t.getDescendants({deep:!0})));return e.cloneCells(n)},e.cloneCells=function(e){var t=$(e),n=t.reduce((function(e,t){return e[t.id]=t.clone(),e}),{});return t.forEach((function(e){var t=n[e.id];if(t.isEdge()){var i=t.getSourceCellId(),r=t.getTargetCellId();i&&n[i]&&t.setSource(Object.assign(Object.assign({},t.getSource()),{cell:n[i].id})),r&&n[r]&&t.setTarget(Object.assign(Object.assign({},t.getTarget()),{cell:n[r].id}))}var o=e.getParent();o&&n[o.id]&&t.setParent(n[o.id]);var a=e.getChildren();if(a&&a.length){var s=a.reduce((function(e,t){return n[t.id]&&e.push(n[t.id]),e}),[]);s.length>0&&t.setChildren(s)}})),n}}(Iu||(Iu={})),function(e){e.config({propHooks:function(t){var n=t.tools,i=Du(t,["tools"]);return n&&(i.tools=e.normalizeTools(n)),i}})}(Iu||(Iu={})),function(e){var t,n;e.exist=function(e,i){return i?null!=t&&t.exist(e):null!=n&&n.exist(e)},e.setEdgeRegistry=function(e){t=e},e.setNodeRegistry=function(e){n=e}}(ju||(ju={}));var Ru=function(){return y((function e(t){v(this,e),this.ports=[],this.groups={},this.init(Q(t))}),[{key:"getPorts",value:function(){return this.ports}},{key:"getGroup",value:function(e){return null!=e?this.groups[e]:null}},{key:"getPortsByGroup",value:function(e){return this.ports.filter((function(t){return t.group===e||null==t.group&&null==e}))}},{key:"getPortsLayoutByGroup",value:function(e,t){var n,i=this,r=this.getPortsByGroup(e),o=e?this.getGroup(e):null,a=o?o.position:null,s=a?a.name:null;if(null!=s){var l=Es.registry.get(s);if(null==l)return Es.registry.onNotFound(s);n=l}else n=Es.presets.left;var u=r.map((function(e){return e&&e.position&&e.position.args||{}})),c=a&&a.args||{};return n(u,t,c).map((function(e,n){var o=r[n];return{portLayout:e,portId:o.id,portSize:o.size,portAttrs:o.attrs,labelSize:o.label.size,labelLayout:i.getPortLabelLayout(o,eo.create(e.position),t)}}))}},{key:"init",value:function(e){var t=this,n=e.groups,i=e.items;null!=n&&Object.keys(n).forEach((function(e){t.groups[e]=t.parseGroup(n[e])})),Array.isArray(i)&&i.forEach((function(e){t.ports.push(t.parsePort(e))}))}},{key:"parseGroup",value:function(e){return Object.assign(Object.assign({},e),{label:this.getLabel(e,!0),position:this.getPortPosition(e.position,!0)})}},{key:"parsePort",value:function(e){var t=Object.assign({},e),n=this.getGroup(e.group)||{};return t.markup=t.markup||n.markup,t.attrs=nn({},n.attrs,t.attrs),t.position=this.createPosition(n,t),t.label=nn({},n.label,this.getLabel(t)),t.zIndex=this.getZIndex(n,t),t.size=Object.assign(Object.assign({},n.size),t.size),t}},{key:"getZIndex",value:function(e,t){return"number"==typeof t.zIndex?t.zIndex:"number"==typeof e.zIndex||"auto"===e.zIndex?e.zIndex:"auto"}},{key:"createPosition",value:function(e,t){return nn({name:"left",args:{}},e.position,{args:t.args})}},{key:"getPortPosition",value:function(e){if(null==e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return{name:"left",args:{}}}else{if("string"==typeof e)return{name:e,args:{}};if(Array.isArray(e))return{name:"absolute",args:{x:e[0],y:e[1]}};if("object"===b(e))return e}return{args:{}}}},{key:"getPortLabelPosition",value:function(e){if(null==e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return{name:"left",args:{}}}else{if("string"==typeof e)return{name:e,args:{}};if("object"===b(e))return e}return{args:{}}}},{key:"getLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.label||{};return n.position=this.getPortLabelPosition(n.position,t),n}},{key:"getPortLabelLayout",value:function(e,t,n){var i=e.label.position.name||"left",r=e.label.position.args||{},o=Is.registry.get(i)||Is.presets.left;return o?o(t,n,r):null}}])}(),Vu=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Bu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return v(this,t),(e=a(this,t,[n])).initPorts(),e}return c(t,e),y(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"preprocess",value:function(e,i){var r=e.x,o=e.y,a=e.width,s=e.height,l=Vu(e,["x","y","width","height"]);if(null!=r||null!=o){var u=l.position;l.position=Object.assign(Object.assign({},u),{x:null!=r?r:u?u.x:0,y:null!=o?o:u?u.y:0})}if(null!=a||null!=s){var c=l.size;l.size=Object.assign(Object.assign({},c),{width:null!=a?a:c?c.width:0,height:null!=s?s:c?c.height:0})}return n(t,"preprocess",this,3)([l,i])}},{key:"isNode",value:function(){return!0}},{key:"size",value:function(e,t,n){return void 0===e?this.getSize():"number"==typeof e?this.setSize(e,t,n):this.setSize(e,t)}},{key:"getSize",value:function(){var e=this.store.get("size");return e?Object.assign({},e):{width:1,height:1}}},{key:"setSize",value:function(e,t,n){return"object"===b(e)?this.resize(e.width,e.height,t):this.resize(e,t,n),this}},{key:"resize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.startBatch("resize",n);var i=n.direction;if(i){var r=this.getSize();switch(i){case"left":case"right":t=r.height;break;case"top":case"bottom":e=r.width}var o={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[i],a=Zr.normalize(this.getAngle()||0);n.absolute&&(o+=Math.floor((a+45)/90),o%=4);var s=this.getBBox(),l=(0===o?s.getBottomLeft():1===o?s.getCorner():2===o?s.getTopRight():s.getOrigin()).clone().rotate(-a,s.getCenter()),u=Math.sqrt(e*e+t*t)/2,c=o*Math.PI/2;c+=Math.atan(o%2==0?t/e:e/t),c-=Zr.toRad(a);var h=eo.fromPolar(u,c,l).clone().translate(e/-2,t/-2);this.store.set("size",{width:e,height:t},n),this.setPosition(h.x,h.y,n)}else this.store.set("size",{width:e,height:t},n);return this.stopBatch("resize",n),this}},{key:"scale",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=this.getBBox().scale(e,t,null==n?void 0:n);return this.startBatch("scale",i),this.setPosition(r.x,r.y,i),this.resize(r.width,r.height,i),this.stopBatch("scale"),this}},{key:"position",value:function(e,t,n){return"number"==typeof e?this.setPosition(e,t,n):this.getPosition(e)}},{key:"getPosition",value:function(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).relative){var e=this.getParent();if(null!=e&&e.isNode()){var t=this.getPosition(),n=e.getPosition();return{x:t.x-n.x,y:t.y-n.y}}}var i=this.store.get("position");return i?Object.assign({},i):{x:0,y:0}}},{key:"setPosition",value:function(e,t){var n,i,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"===b(e)?(n=e.x,i=e.y,r=t||{}):(n=e,i=t,r=o||{}),r.relative){var a=this.getParent();if(null!=a&&a.isNode()){var s=a.getPosition();n+=s.x,i+=s.y}}if(r.deep){var l=this.getPosition();this.translate(n-l.x,i-l.y,r)}else this.store.set("position",{x:n,y:i},r);return this}},{key:"translate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0===e&&0===t)return this;n.translateBy=n.translateBy||this.id;var i=this.getPosition();if(null!=n.restrict&&n.translateBy===this.id){var r=this.getBBox({deep:!0}),o=n.restrict,a=i.x-r.x,s=i.y-r.y,l=Math.max(o.x+a,Math.min(o.x+o.width+a-r.width,i.x+e)),u=Math.max(o.y+s,Math.min(o.y+o.height+s-r.height,i.y+t));e=l-i.x,t=u-i.y}var c={x:i.x+e,y:i.y+t};return n.tx=e,n.ty=t,n.transition?("object"!==b(n.transition)&&(n.transition={}),this.transition("position",c,Object.assign(Object.assign({},n.transition),{interp:Xr.object})),this.eachChild((function(i){var r;(null===(r=n.exclude)||void 0===r?void 0:r.includes(i))||i.translate(e,t,n)}))):(this.startBatch("translate",n),this.store.set("position",c,n),this.eachChild((function(i){var r;(null===(r=n.exclude)||void 0===r?void 0:r.includes(i))||i.translate(e,t,n)})),this.stopBatch("translate",n)),this}},{key:"angle",value:function(e,t){return null==e?this.getAngle():this.rotate(e,t)}},{key:"getAngle",value:function(){return this.store.get("angle",0)}},{key:"rotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getAngle();if(t.center){var i=this.getSize(),r=this.getPosition(),o=this.getBBox().getCenter();o.rotate(n-e,t.center);var a=o.x-i.width/2-r.x,s=o.y-i.height/2-r.y;this.startBatch("rotate",{angle:e,options:t}),this.setPosition(r.x+a,r.y+s,t),this.rotate(e,Object.assign(Object.assign({},t),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",t.absolute?e:(n+e)%360,t);return this}},{key:"getBBox",value:function(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).deep){var e=this.getDescendants({deep:!0,breadthFirst:!0});return e.push(this),Iu.getCellsBBox(e)}return to.fromPositionAndSize(this.getPosition(),this.getSize())}},{key:"getConnectionPoint",value:function(e,t){var n=this.getBBox(),i=n.getCenter(),r=e.getTerminal(t);if(null==r)return i;var o=r.port;if(!o||!this.hasPort(o))return i;var a=this.getPort(o);if(!a||!a.group)return i;var s=this.getPortsPosition(a.group)[o].position,l=eo.create(s).translate(n.getOrigin()),u=this.getAngle();return u&&l.rotate(-u,i),l}},{key:"fit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(this.getChildren()||[]).filter((function(e){return e.isNode()}));if(0===t.length)return this;this.startBatch("fit-embeds",e),e.deep&&t.forEach((function(t){return t.fit(e)}));var n=Iu.getCellsBBox(t),i=n.x,r=n.y,o=n.width,a=n.height,s=Gn(e.padding);return i-=s.left,r-=s.top,o+=s.left+s.right,a+=s.bottom+s.top,this.store.set({position:{x:i,y:r},size:{width:o,height:a}},e),this.stopBatch("fit-embeds"),this}},{key:"portContainerMarkup",get:function(){return this.getPortContainerMarkup()},set:function(e){this.setPortContainerMarkup(e)}},{key:"getDefaultPortContainerMarkup",value:function(){return this.store.get("defaultPortContainerMarkup")||Fs.getPortContainerMarkup()}},{key:"getPortContainerMarkup",value:function(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}},{key:"setPortContainerMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("portContainerMarkup",Fs.clone(e),t),this}},{key:"portMarkup",get:function(){return this.getPortMarkup()},set:function(e){this.setPortMarkup(e)}},{key:"getDefaultPortMarkup",value:function(){return this.store.get("defaultPortMarkup")||Fs.getPortMarkup()}},{key:"getPortMarkup",value:function(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}},{key:"setPortMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("portMarkup",Fs.clone(e),t),this}},{key:"portLabelMarkup",get:function(){return this.getPortLabelMarkup()},set:function(e){this.setPortLabelMarkup(e)}},{key:"getDefaultPortLabelMarkup",value:function(){return this.store.get("defaultPortLabelMarkup")||Fs.getPortLabelMarkup()}},{key:"getPortLabelMarkup",value:function(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}},{key:"setPortLabelMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("portLabelMarkup",Fs.clone(e),t),this}},{key:"ports",get:function(){var e=this.store.get("ports",{items:[]});return null==e.items&&(e.items=[]),e}},{key:"getPorts",value:function(){return Q(this.ports.items)}},{key:"getPortsByGroup",value:function(e){return this.getPorts().filter((function(t){return t.group===e}))}},{key:"getPort",value:function(e){return Q(this.ports.items.find((function(t){return t.id&&t.id===e})))}},{key:"getPortAt",value:function(e){return this.ports.items[e]||null}},{key:"hasPorts",value:function(){return this.ports.items.length>0}},{key:"hasPort",value:function(e){return-1!==this.getPortIndex(e)}},{key:"getPortIndex",value:function(e){var t="string"==typeof e?e:e.id;return null!=t?this.ports.items.findIndex((function(e){return e.id===t})):-1}},{key:"getPortsPosition",value:function(e){var t=this.getSize();return this.port.getPortsLayoutByGroup(e,new to(0,0,t.width,t.height)).reduce((function(e,t){var n=t.portLayout;return e[t.portId]={position:Object.assign({},n.position),angle:n.angle||0},e}),{})}},{key:"getPortProp",value:function(e,t){return this.getPropByPath(this.prefixPortPath(e,t))}},{key:"setPortProp",value:function(e,t,n,i){if("string"==typeof t||Array.isArray(t)){var r=this.prefixPortPath(e,t),o=n;return this.setPropByPath(r,o,i)}var a=this.prefixPortPath(e),s=t;return this.setPropByPath(a,s,n)}},{key:"removePortProp",value:function(e,t,n){return"string"==typeof t||Array.isArray(t)?this.removePropByPath(this.prefixPortPath(e,t),n):this.removePropByPath(this.prefixPortPath(e),t)}},{key:"portProp",value:function(e,t,n,i){return null==t?this.getPortProp(e):"string"==typeof t||Array.isArray(t)?2===arguments.length?this.getPortProp(e,t):null==n?this.removePortProp(e,t,i):this.setPortProp(e,t,n,i):this.setPortProp(e,t,n)}},{key:"prefixPortPath",value:function(e,t){var n=this.getPortIndex(e);if(-1===n)throw new Error('Unable to find port with id: "'.concat(e,'"'));return null==t||""===t?["ports","items","".concat(n)]:Array.isArray(t)?["ports","items","".concat(n)].concat(f(t)):"ports/items/".concat(n,"/").concat(t)}},{key:"addPort",value:function(e,t){var n=f(this.ports.items);return n.push(e),this.setPropByPath("ports/items",n,t),this}},{key:"addPorts",value:function(e,t){return this.setPropByPath("ports/items",[].concat(f(this.ports.items),f(e)),t),this}},{key:"insertPort",value:function(e,t,n){var i=f(this.ports.items);return i.splice(e,0,t),this.setPropByPath("ports/items",i,n),this}},{key:"removePort",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.removePortAt(this.getPortIndex(e),t)}},{key:"removePortAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e>=0){var n=f(this.ports.items);n.splice(e,1),t.rewrite=!0,this.setPropByPath("ports/items",n,t)}return this}},{key:"removePorts",value:function(e,t){var n;if(Array.isArray(e)){if(n=t||{},e.length){n.rewrite=!0;var i=f(this.ports.items).filter((function(t){return!e.some((function(e){var n="string"==typeof e?e:e.id;return t.id===n}))}));this.setPropByPath("ports/items",i,n)}}else(n=e||{}).rewrite=!0,this.setPropByPath("ports/items",[],n);return this}},{key:"getParsedPorts",value:function(){return this.port.getPorts()}},{key:"getParsedGroups",value:function(){return this.port.groups}},{key:"getPortsLayoutByGroup",value:function(e,t){return this.port.getPortsLayoutByGroup(e,t)}},{key:"initPorts",value:function(){var e=this;this.updatePortData(),this.on("change:ports",(function(){e.processRemovedPort(),e.updatePortData()}))}},{key:"processRemovedPort",value:function(){var e=this.ports,t={};e.items.forEach((function(e){e.id&&(t[e.id]=!0)}));var n={};(this.store.getPrevious("ports")||{items:[]}).items.forEach((function(e){e.id&&!t[e.id]&&(n[e.id]=!0)}));var i=this.model;i&&!te(n)&&(i.getConnectedEdges(this,{incoming:!0}).forEach((function(e){var t=e.getTargetPortId();t&&n[t]&&e.remove()})),i.getConnectedEdges(this,{outgoing:!0}).forEach((function(e){var t=e.getSourcePortId();t&&n[t]&&e.remove()})))}},{key:"validatePorts",value:function(){var e=this,t={},n=[];return this.ports.items.forEach((function(i){"object"!==b(i)&&n.push("Invalid port ".concat(i,".")),null==i.id&&(i.id=e.generatePortId()),t[i.id]&&n.push("Duplicitied port id."),t[i.id]=!0})),n}},{key:"generatePortId",value:function(){return Rn()}},{key:"updatePortData",value:function(){var e=this.validatePorts();if(e.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(e.join(" "));var t=this.port?this.port.getPorts():null;this.port=new Ru(this.ports);var n=this.port.getPorts(),i=t?n.filter((function(e){return t.find((function(t){return t.id===e.id}))?null:e})):f(n),r=t?t.filter((function(e){return n.find((function(t){return t.id===e.id}))?null:e})):[];i.length>0&&this.notify("ports:added",{added:i,cell:this,node:this}),r.length>0&&this.notify("ports:removed",{removed:r,cell:this,node:this})}}])}(Iu);Bu.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(e){e.toStringTag="X6.".concat(e.name),e.isNode=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNode&&"function"==typeof i.isEdge&&"function"==typeof i.prop&&"function"==typeof i.attr&&"function"==typeof i.size&&"function"==typeof i.position}}(Bu||(Bu={})),function(e){e.config({propHooks:function(e){var t=e.ports,n=Vu(e,["ports"]);return t&&(n.ports=Array.isArray(t)?{items:t}:t),n}})}(Bu||(Bu={})),function(e){e.registry=Ao.create({type:"node",process:function(t,n){if(ju.exist(t,!0))throw new Error("Node with name '".concat(t,"' was registered by anthor Edge"));if("function"==typeof n)return n.config({shape:t}),n;var i=e,r=n.inherit,o=Vu(n,["inherit"]);if(r)if("string"==typeof r){var a=this.get(r);null==a?this.onNotFound(r,"inherited"):i=a}else i=r;null==o.constructorName&&(o.constructorName=t);var s=i.define.call(i,o);return s.config({shape:t}),s}}),ju.setNodeRegistry(e.registry)}(Bu||(Bu={})),function(e){var t=0;e.define=function(n){var i,r=n.constructorName,o=n.overwrite,a=Vu(n,["constructorName","overwrite"]),s=An((i=r||a.shape)?Dn(i):"CustomNode".concat(t+=1),this);return s.config(a),a.shape&&e.registry.register(a.shape,s,o),s},e.create=function(t){var n=t.shape||"rect",i=e.registry.get(n);return i?new i(t):e.registry.onNotFound(n)}}(Bu||(Bu={}));var zu=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Fu=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return v(this,t),a(this,t,[e])}return c(t,e),y(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"preprocess",value:function(e,i){var r=e.source,o=e.sourceCell,a=e.sourcePort,s=e.sourcePoint,l=e.target,u=e.targetCell,c=e.targetPort,h=e.targetPoint,f=zu(e,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),g=function(e){return"string"==typeof e||"number"==typeof e};if(null!=r)if(Iu.isCell(r))f.source={cell:r.id};else if(g(r))f.source={cell:r};else if(eo.isPoint(r))f.source=r.toJSON();else if(Array.isArray(r))f.source={x:r[0],y:r[1]};else{var d=r.cell;Iu.isCell(d)?f.source=Object.assign(Object.assign({},r),{cell:d.id}):f.source=r}if(null!=o||null!=a){var v=f.source;if(null!=o){var p=g(o)?o:o.id;v?v.cell=p:v=f.source={cell:p}}null!=a&&v&&(v.port=a)}else null!=s&&(f.source=eo.create(s).toJSON());if(null!=l)if(Iu.isCell(l))f.target={cell:l.id};else if(g(l))f.target={cell:l};else if(eo.isPoint(l))f.target=l.toJSON();else if(Array.isArray(l))f.target={x:l[0],y:l[1]};else{var y=l.cell;Iu.isCell(y)?f.target=Object.assign(Object.assign({},l),{cell:y.id}):f.target=l}if(null!=u||null!=c){var m=f.target;if(null!=u){var b=g(u)?u:u.id;m?m.cell=b:m=f.target={cell:b}}null!=c&&m&&(m.port=c)}else null!=h&&(f.target=eo.create(h).toJSON());return n(t,"preprocess",this,3)([f,i])}},{key:"setup",value:function(){var e=this;n(t,"setup",this,3)([]),this.on("change:labels",(function(t){return e.onLabelsChanged(t)})),this.on("change:vertices",(function(t){return e.onVertexsChanged(t)}))}},{key:"isEdge",value:function(){return!0}},{key:"disconnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},e),this}},{key:"source",get:function(){return this.getSource()},set:function(e){this.setSource(e)}},{key:"getSource",value:function(){return this.getTerminal("source")}},{key:"getSourceCellId",value:function(){return this.source.cell}},{key:"getSourcePortId",value:function(){return this.source.port}},{key:"setSource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setTerminal("source",e,t,n)}},{key:"target",get:function(){return this.getTarget()},set:function(e){this.setTarget(e)}},{key:"getTarget",value:function(){return this.getTerminal("target")}},{key:"getTargetCellId",value:function(){return this.target.cell}},{key:"getTargetPortId",value:function(){return this.target.port}},{key:"setTarget",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setTerminal("target",e,t,n)}},{key:"getTerminal",value:function(e){return Object.assign({},this.store.get(e))}},{key:"setTerminal",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(Iu.isCell(t))return this.store.set(e,nn({},n,{cell:t.id}),i),this;var r=t;return eo.isPoint(t)||null!=r.x&&null!=r.y?(this.store.set(e,nn({},n,{x:r.x,y:r.y}),i),this):(this.store.set(e,Q(t),i),this)}},{key:"getSourcePoint",value:function(){return this.getTerminalPoint("source")}},{key:"getTargetPoint",value:function(){return this.getTerminalPoint("target")}},{key:"getTerminalPoint",value:function(e){var t=this[e];if(eo.isPointLike(t))return eo.create(t);var n=this.getTerminalCell(e);return n?n.getConnectionPoint(this,e):new eo}},{key:"getSourceCell",value:function(){return this.getTerminalCell("source")}},{key:"getTargetCell",value:function(){return this.getTerminalCell("target")}},{key:"getTerminalCell",value:function(e){if(this.model){var t="source"===e?this.getSourceCellId():this.getTargetCellId();if(t)return this.model.getCell(t)}return null}},{key:"getSourceNode",value:function(){return this.getTerminalNode("source")}},{key:"getTargetNode",value:function(){return this.getTerminalNode("target")}},{key:"getTerminalNode",value:function(e){for(var t=this,n={};t&&t.isEdge();){if(n[t.id])return null;n[t.id]=!0,t=t.getTerminalCell(e)}return t&&t.isNode()?t:null}},{key:"router",get:function(){return this.getRouter()},set:function(e){null==e?this.removeRouter():this.setRouter(e)}},{key:"getRouter",value:function(){return this.store.get("router")}},{key:"setRouter",value:function(e,t,n){return"object"===b(e)?this.store.set("router",e,t):this.store.set("router",{name:e,args:t},n),this}},{key:"removeRouter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("router",e),this}},{key:"connector",get:function(){return this.getConnector()},set:function(e){null==e?this.removeConnector():this.setConnector(e)}},{key:"getConnector",value:function(){return this.store.get("connector")}},{key:"setConnector",value:function(e,t,n){return"object"===b(e)?this.store.set("connector",e,t):this.store.set("connector",{name:e,args:t},n),this}},{key:"removeConnector",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("connector",e)}},{key:"getDefaultLabel",value:function(){var e=this.constructor,t=this.store.get("defaultLabel")||e.defaultLabel||{};return Q(t)}},{key:"labels",get:function(){return this.getLabels()},set:function(e){this.setLabels(e)}},{key:"getLabels",value:function(){var e=this;return f(this.store.get("labels",[])).map((function(t){return e.parseLabel(t)}))}},{key:"setLabels",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("labels",Array.isArray(e)?e:[e],t),this}},{key:"insertLabel",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getLabels(),r=i.length,o=null!=t&&Number.isFinite(t)?t:r;return o<0&&(o=r+o+1),i.splice(o,0,this.parseLabel(e)),this.setLabels(i,n)}},{key:"appendLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.insertLabel(e,-1,t)}},{key:"getLabelAt",value:function(e){var t=this.getLabels();return null!=e&&Number.isFinite(e)?this.parseLabel(t[e]):null}},{key:"setLabelAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&Number.isFinite(e)){var i=this.getLabels();i[e]=this.parseLabel(t),this.setLabels(i,n)}return this}},{key:"removeLabelAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getLabels(),i=null!=e&&Number.isFinite(e)?e:-1,r=n.splice(i,1);return this.setLabels(n,t),r.length?r[0]:null}},{key:"parseLabel",value:function(e){return"string"==typeof e?this.constructor.parseStringLabel(e):e}},{key:"onLabelsChanged",value:function(e){var t=e.previous,n=e.current,i=t&&n?n.filter((function(e){return t.find((function(t){return e===t||ee(e,t)}))?null:e})):n?f(n):[],r=t&&n?t.filter((function(e){return n.find((function(t){return e===t||ee(e,t)}))?null:e})):t?f(t):[];i.length>0&&this.notify("labels:added",{added:i,cell:this,edge:this}),r.length>0&&this.notify("labels:removed",{removed:r,cell:this,edge:this})}},{key:"vertices",get:function(){return this.getVertices()},set:function(e){this.setVertices(e)}},{key:"getVertices",value:function(){return f(this.store.get("vertices",[]))}},{key:"setVertices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Array.isArray(e)?e:[e];return this.store.set("vertices",n.map((function(e){return eo.toJSON(e)})),t),this}},{key:"insertVertex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getVertices(),r=i.length,o=null!=t&&Number.isFinite(t)?t:r;return o<0&&(o=r+o+1),i.splice(o,0,eo.toJSON(e)),this.setVertices(i,n)}},{key:"appendVertex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.insertVertex(e,-1,t)}},{key:"getVertexAt",value:function(e){return null!=e&&Number.isFinite(e)?this.getVertices()[e]:null}},{key:"setVertexAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&Number.isFinite(e)){var i=this.getVertices();i[e]=t,this.setVertices(i,n)}return this}},{key:"removeVertexAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getVertices(),i=null!=e&&Number.isFinite(e)?e:-1;return n.splice(i,1),this.setVertices(n,t)}},{key:"onVertexsChanged",value:function(e){var t=e.previous,n=e.current,i=t&&n?n.filter((function(e){return t.find((function(t){return eo.equals(e,t)}))?null:e})):n?f(n):[],r=t&&n?t.filter((function(e){return n.find((function(t){return eo.equals(e,t)}))?null:e})):t?f(t):[];i.length>0&&this.notify("vertexs:added",{added:i,cell:this,edge:this}),r.length>0&&this.notify("vertexs:removed",{removed:r,cell:this,edge:this})}},{key:"getDefaultMarkup",value:function(){return this.store.get("defaultMarkup")||Fs.getEdgeMarkup()}},{key:"getMarkup",value:function(){return n(t,"getMarkup",this,3)([])||this.getDefaultMarkup()}},{key:"translate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.translateBy=n.translateBy||this.id,n.tx=e,n.ty=t,this.applyToPoints((function(n){return{x:(n.x||0)+e,y:(n.y||0)+t}}),n)}},{key:"scale",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.applyToPoints((function(i){return eo.create(i).scale(e,t,n).toJSON()}),i)}},{key:"applyToPoints",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},i=this.getSource(),r=this.getTarget();eo.isPointLike(i)&&(n.source=e(i)),eo.isPointLike(r)&&(n.target=e(r));var o=this.getVertices();return o.length>0&&(n.vertices=o.map(e)),this.store.set(n,t),this}},{key:"getBBox",value:function(){return this.getPolyline().bbox()}},{key:"getConnectionPoint",value:function(){return this.getPolyline().pointAt(.5)}},{key:"getPolyline",value:function(){var e=[this.getSourcePoint()].concat(f(this.getVertices().map((function(e){return eo.create(e)}))),[this.getTargetPoint()]);return new co(e)}},{key:"updateParent",value:function(e){var t=null,n=this.getSourceCell(),i=this.getTargetCell(),r=this.getParent();return n&&i&&(t=n===i||n.isDescendantOf(i)?i:i.isDescendantOf(n)?n:Iu.getCommonAncestor(n,i)),r&&t&&t.id!==r.id&&r.unembed(this,e),!t||r&&r.id===t.id||t.embed(this,e),t}},{key:"hasLoop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getSource(),n=this.getTarget(),i=t.cell,r=n.cell;if(!i||!r)return!1;var o=i===r;if(!o&&e.deep&&this._model){var a=this.getSourceCell(),s=this.getTargetCell();a&&s&&(o=a.isAncestorOf(s,e)||s.isAncestorOf(a,e))}return o}},{key:"getFragmentAncestor",value:function(){var e=[this,this.getSourceNode(),this.getTargetNode()].filter((function(e){return null!=e}));return this.getCommonAncestor.apply(this,f(e))}},{key:"isFragmentDescendantOf",value:function(e){var t=this.getFragmentAncestor();return!!t&&(t.id===e.id||t.isDescendantOf(e))}}])}(Iu);Fu.defaults={},function(e){e.equalTerminals=function(e,t){var n=e,i=t;return n.cell===i.cell&&(n.port===i.port||null==n.port&&null==i.port)}}(Fu||(Fu={})),function(e){e.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}},e.parseStringLabel=function(e){return{attrs:{label:{text:e}}}}}(Fu||(Fu={})),function(e){e.toStringTag="X6.".concat(e.name),e.isEdge=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNode&&"function"==typeof i.isEdge&&"function"==typeof i.prop&&"function"==typeof i.attr&&"function"==typeof i.disconnect&&"function"==typeof i.getSource&&"function"==typeof i.getTarget}}(Fu||(Fu={})),function(e){e.registry=Ao.create({type:"edge",process:function(t,n){if(ju.exist(t,!1))throw new Error("Edge with name '".concat(t,"' was registered by anthor Node"));if("function"==typeof n)return n.config({shape:t}),n;var i=e,r=n.inherit,o=void 0===r?"edge":r,a=zu(n,["inherit"]);if("string"==typeof o){var s=this.get(o||"edge");null==s&&o?this.onNotFound(o,"inherited"):i=s}else i=o;null==a.constructorName&&(a.constructorName=t);var l=i.define.call(i,a);return l.config({shape:t}),l}}),ju.setEdgeRegistry(e.registry)}(Fu||(Fu={})),function(e){var t=0;e.define=function(n){var i,r=n.constructorName,o=n.overwrite,a=zu(n,["constructorName","overwrite"]),s=An((i=r||a.shape)?Dn(i):"CustomEdge".concat(t+=1),this);return s.config(a),a.shape&&e.registry.register(a.shape,s,o),s},e.create=function(t){var n=t.shape||"edge",i=e.registry.get(n);return i?new i(t):e.registry.onNotFound(n)}}(Fu||(Fu={})),function(e){var t="basic.edge";e.config({shape:t,propHooks:function(t){var n=t.label,i=t.vertices,r=zu(t,["label","vertices"]);if(n){null==r.labels&&(r.labels=[]);var o="string"==typeof n?e.parseStringLabel(n):n;r.labels.push(o)}return i&&Array.isArray(i)&&(r.vertices=i.map((function(e){return eo.create(e).toJSON()}))),r}}),e.registry.register(t,e)}(Fu||(Fu={}));var Gu=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},qu=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v(this,t),(n=a(this,t)).length=0,n.comparator=i.comparator||"zIndex",n.clean(),e&&n.reset(e,{silent:!0}),n}return c(t,e),y(t,[{key:"toJSON",value:function(){return this.cells.map((function(e){return e.toJSON()}))}},{key:"add",value:function(e,t,n){var i,r,o=this;"number"==typeof t?(i=t,r=Object.assign({merge:!1},n)):(i=this.length,r=Object.assign({merge:!1},t)),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var a,s=Array.isArray(e)?e:[e],l=this.comparator&&"number"!=typeof t&&!1!==r.sort,u=this.comparator||null,c=!1,h=[],f=[];(s.forEach((function(e){var t=o.get(e);t?r.merge&&!e.isSameStore(t)&&(t.setProp(e.getProp(),n),f.push(t),l&&!c&&(c=null==u||"function"==typeof u?t.hasChanged():"string"==typeof u?t.hasChanged(u):u.some((function(e){return t.hasChanged(e)})))):(h.push(e),o.reference(e))})),h.length)&&(l&&(c=!0),(a=this.cells).splice.apply(a,[i,0].concat(h)),this.length=this.cells.length);return c&&this.sort({silent:!0}),r.silent||(h.forEach((function(e,t){var n={cell:e,index:i+t,options:r};o.trigger("added",n),r.dryrun||e.notify("added",Object.assign({},n))})),c&&this.trigger("sorted"),(h.length||f.length)&&this.trigger("updated",{added:h,merged:f,removed:[],options:r})),this}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Array.isArray(e)?e:[e],i=this.removeCells(n,t);return!t.silent&&i.length>0&&this.trigger("updated",{options:t,removed:i,added:[],merged:[]}),Array.isArray(e)?i:i[0]}},{key:"removeCells",value:function(e,t){for(var n=[],i=0;i<e.length;i+=1){var r=this.get(e[i]);if(null!=r){var o=this.cells.indexOf(r);this.cells.splice(o,1),this.length-=1,delete this.map[r.id],n.push(r),this.unreference(r),t.dryrun||r.remove(),t.silent||(this.trigger("removed",{cell:r,index:o,options:t}),t.dryrun||r.notify("removed",{cell:r,index:o,options:t}))}}return n}},{key:"reset",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.cells.slice();if(i.forEach((function(e){return t.unreference(e)})),this.clean(),this.add(e,Object.assign({silent:!0},n)),!n.silent){var r=this.cells.slice();this.trigger("reseted",{options:n,previous:i,current:r});var o=[],a=[];r.forEach((function(e){i.some((function(t){return t.id===e.id}))||o.push(e)})),i.forEach((function(e){r.some((function(t){return t.id===e.id}))||a.push(e)})),this.trigger("updated",{options:n,added:o,removed:a,merged:[]})}return this}},{key:"push",value:function(e,t){return this.add(e,this.length,t)}},{key:"pop",value:function(e){var t=this.at(this.length-1);return this.remove(t,e)}},{key:"unshift",value:function(e,t){return this.add(e,0,t)}},{key:"shift",value:function(e){var t=this.at(0);return this.remove(t,e)}},{key:"get",value:function(e){if(null==e)return null;var t="string"==typeof e||"number"==typeof e?e:e.id;return this.map[t]||null}},{key:"has",value:function(e){return null!=this.get(e)}},{key:"at",value:function(e){return e<0&&(e+=this.length),this.cells[e]||null}},{key:"first",value:function(){return this.at(0)}},{key:"last",value:function(){return this.at(-1)}},{key:"indexOf",value:function(e){return this.cells.indexOf(e)}},{key:"toArray",value:function(){return this.cells.slice()}},{key:"sort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null!=this.comparator&&(this.cells=an(this.cells,this.comparator),e.silent||this.trigger("sorted")),this}},{key:"clone",value:function(){return new(0,this.constructor)(this.cells.slice(),{comparator:this.comparator})}},{key:"reference",value:function(e){this.map[e.id]=e,e.on("*",this.notifyCellEvent,this)}},{key:"unreference",value:function(e){e.off("*",this.notifyCellEvent,this),delete this.map[e.id]}},{key:"notifyCellEvent",value:function(e,t){var n=t.cell;this.trigger("cell:".concat(e),t),n&&(n.isNode()?this.trigger("node:".concat(e),Object.assign(Object.assign({},t),{node:n})):n.isEdge()&&this.trigger("edge:".concat(e),Object.assign(Object.assign({},t),{edge:n})))}},{key:"clean",value:function(){this.length=0,this.cells=[],this.map={}}},{key:"dispose",value:function(){this.reset([])}}])}(Nn);Gu([qu.dispose()],qu.prototype,"dispose",null);var Hu=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},_u=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return v(this,t),(e=a(this,t)).batches={},e.addings=new WeakMap,e.nodes={},e.edges={},e.outgoings={},e.incomings={},e.collection=new qu(n),e.setup(),e}return c(t,e),y(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"notify",value:function(e,t){this.trigger(e,t);var n=this.graph;return n&&("sorted"===e||"reseted"===e||"updated"===e?n.trigger("model:".concat(e),t):n.trigger(e,t)),this}},{key:"setup",value:function(){var e=this,t=this.collection;t.on("sorted",(function(){return e.notify("sorted",null)})),t.on("updated",(function(t){return e.notify("updated",t)})),t.on("cell:change:zIndex",(function(){return e.sortOnChangeZ()})),t.on("added",(function(t){var n=t.cell;e.onCellAdded(n)})),t.on("removed",(function(t){var n=t.cell;e.onCellRemoved(n,t.options),e.notify("cell:removed",t),n.isNode()?e.notify("node:removed",Object.assign(Object.assign({},t),{node:n})):n.isEdge()&&e.notify("edge:removed",Object.assign(Object.assign({},t),{edge:n}))})),t.on("reseted",(function(t){e.onReset(t.current),e.notify("reseted",t)})),t.on("edge:change:source",(function(t){var n=t.edge;return e.onEdgeTerminalChanged(n,"source")})),t.on("edge:change:target",(function(t){var n=t.edge;e.onEdgeTerminalChanged(n,"target")}))}},{key:"sortOnChangeZ",value:function(){this.collection.sort()}},{key:"onCellAdded",value:function(e){var t=e.id;e.isEdge()?(e.updateParent(),this.edges[t]=!0,this.onEdgeTerminalChanged(e,"source"),this.onEdgeTerminalChanged(e,"target")):this.nodes[t]=!0}},{key:"onCellRemoved",value:function(e,t){var n=e.id;if(e.isEdge()){delete this.edges[n];var i=e.getSource(),r=e.getTarget();if(i&&i.cell){var o=this.outgoings[i.cell],a=o?o.indexOf(n):-1;a>=0&&(o.splice(a,1),0===o.length&&delete this.outgoings[i.cell])}if(r&&r.cell){var s=this.incomings[r.cell],l=s?s.indexOf(n):-1;l>=0&&(s.splice(l,1),0===s.length&&delete this.incomings[r.cell])}}else delete this.nodes[n];t.clear||(t.disconnectEdges?this.disconnectConnectedEdges(e,t):this.removeConnectedEdges(e,t)),e.model===this&&(e.model=null)}},{key:"onReset",value:function(e){var t=this;this.nodes={},this.edges={},this.outgoings={},this.incomings={},e.forEach((function(e){return t.onCellAdded(e)}))}},{key:"onEdgeTerminalChanged",value:function(e,t){var n="source"===t?this.outgoings:this.incomings,i=e.previous(t);if(i&&i.cell){var r=Iu.isCell(i.cell)?i.cell.id:i.cell,o=n[r],a=o?o.indexOf(e.id):-1;a>=0&&(o.splice(a,1),0===o.length&&delete n[r])}var s=e.getTerminal(t);if(s&&s.cell){var l=Iu.isCell(s.cell)?s.cell.id:s.cell,u=n[l]||[];-1===u.indexOf(e.id)&&u.push(e.id),n[l]=u}}},{key:"prepareCell",value:function(e,t){return e.model||t&&t.dryrun||(e.model=this),null==e.zIndex&&e.setZIndex(this.getMaxZIndex()+1,{silent:!0}),e}},{key:"resetCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.map((function(e){return t.prepareCell(e,Object.assign(Object.assign({},n),{dryrun:!0}))})),this.collection.reset(e,n),e.map((function(e){return t.prepareCell(e,{options:n})})),this}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getCells();if(0===t.length)return this;var n=Object.assign(Object.assign({},e),{clear:!0});return this.batchUpdate("clear",(function(){for(var e=t.sort((function(e,t){return(e.isEdge()?1:2)-(t.isEdge()?1:2)}));e.length>0;){var i=e.shift();i&&i.remove(n)}}),n),this}},{key:"addNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Bu.isNode(e)?e:this.createNode(e);return this.addCell(n,t),n}},{key:"updateNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.createNode(e),i=n.getProp();return n.dispose(),this.updateCell(i,t)}},{key:"createNode",value:function(e){return Bu.create(e)}},{key:"addEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Fu.isEdge(e)?e:this.createEdge(e);return this.addCell(n,t),n}},{key:"createEdge",value:function(e){return Fu.create(e)}},{key:"updateEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.createEdge(e),i=n.getProp();return n.dispose(),this.updateCell(i,t)}},{key:"addCell",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Array.isArray(e)?this.addCells(e,n):(this.collection.has(e)||this.addings.has(e)||(this.addings.set(e,!0),this.collection.add(this.prepareCell(e,n),n),e.eachChild((function(e){return t.addCell(e,n)})),this.addings.delete(e)),this)}},{key:"addCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.length;if(0===i)return this;var r=Object.assign(Object.assign({},n),{position:i-1,maxPosition:i-1});return this.startBatch("add",Object.assign(Object.assign({},r),{cells:e})),e.forEach((function(e){t.addCell(e,r),r.position-=1})),this.stopBatch("add",Object.assign(Object.assign({},r),{cells:e})),this}},{key:"updateCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.id&&this.getCell(e.id);return!!n&&this.batchUpdate("update",(function(){return Object.entries(e).forEach((function(e){var i=r(e,2),o=i[0],a=i[1];return n.setProp(o,a,t)})),!0}),e)}},{key:"removeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="string"==typeof e?this.getCell(e):e;return n&&this.has(n)?this.collection.remove(n,t):null}},{key:"updateCellId",value:function(e,t){if(e.id!==t){this.startBatch("update",{id:t}),e.prop("id",t);var n=e.clone({keepId:!0});return this.addCell(n),this.getConnectedEdges(e).forEach((function(n){var i=n.getSourceCell(),r=n.getTargetCell();i===e&&n.setSource(Object.assign(Object.assign({},n.getSource()),{cell:t})),r===e&&n.setTarget(Object.assign(Object.assign({},n.getTarget()),{cell:t}))})),this.removeCell(e),this.stopBatch("update",{id:t}),n}}},{key:"removeCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.length?this.batchUpdate("remove",(function(){return e.map((function(e){return t.removeCell(e,n)}))})):[]}},{key:"removeConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getConnectedEdges(e);return n.forEach((function(e){e.remove(t)})),n}},{key:"disconnectConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="string"==typeof e?e:e.id;this.getConnectedEdges(e).forEach((function(e){var i=e.getSourceCellId(),r=e.getTargetCellId();i===n&&e.setSource({x:0,y:0},t),r===n&&e.setTarget({x:0,y:0},t)}))}},{key:"has",value:function(e){return this.collection.has(e)}},{key:"total",value:function(){return this.collection.length}},{key:"indexOf",value:function(e){return this.collection.indexOf(e)}},{key:"getCell",value:function(e){return this.collection.get(e)}},{key:"getCells",value:function(){return this.collection.toArray()}},{key:"getFirstCell",value:function(){return this.collection.first()}},{key:"getLastCell",value:function(){return this.collection.last()}},{key:"getMinZIndex",value:function(){var e=this.collection.first();return e&&e.getZIndex()||0}},{key:"getMaxZIndex",value:function(){var e=this.collection.last();return e&&e.getZIndex()||0}},{key:"getCellsFromCache",value:function(e){var t=this;return e?Object.keys(e).map((function(e){return t.getCell(e)})).filter((function(e){return null!=e})):[]}},{key:"getNodes",value:function(){return this.getCellsFromCache(this.nodes)}},{key:"getEdges",value:function(){return this.getCellsFromCache(this.edges)}},{key:"getOutgoingEdges",value:function(e){var t=this,n="string"==typeof e?e:e.id,i=this.outgoings[n];return i?i.map((function(e){return t.getCell(e)})).filter((function(e){return e&&e.isEdge()})):null}},{key:"getIncomingEdges",value:function(e){var t=this,n="string"==typeof e?e:e.id,i=this.incomings[n];return i?i.map((function(e){return t.getCell(e)})).filter((function(e){return e&&e.isEdge()})):null}},{key:"getConnectedEdges",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[],r="string"==typeof e?this.getCell(e):e;if(null==r)return i;var o={},a=n.indirect,s=n.incoming,l=n.outgoing;null==s&&null==l&&(s=l=!0);var u=function(e,n){var r=n?t.getOutgoingEdges(e):t.getIncomingEdges(e);if(null!=r&&r.forEach((function(e){o[e.id]||(i.push(e),o[e.id]=!0,a&&(s&&u(e,!1),l&&u(e,!0)))})),a&&e.isEdge()){var c=n?e.getTargetCell():e.getSourceCell();c&&c.isEdge()&&(o[c.id]||(i.push(c),u(c,n)))}};if(l&&u(r,!0),s&&u(r,!1),n.deep){var c=r.getDescendants({deep:!0}),h={};c.forEach((function(e){e.isNode()&&(h[e.id]=!0)}));var f=function(e,r){var a=r?t.getOutgoingEdges(e.id):t.getIncomingEdges(e.id);null!=a&&a.forEach((function(e){if(!o[e.id]){var t=e.getSourceCell(),r=e.getTargetCell();if(!n.enclosed&&t&&h[t.id]&&r&&h[r.id])return;i.push(e),o[e.id]=!0}}))};c.forEach((function(e){e.isEdge()||(l&&f(e,!0),s&&f(e,!1))}))}return i}},{key:"isBoundary",value:function(e,t){var n="string"==typeof e?this.getCell(e):e,i=t?this.getIncomingEdges(n):this.getOutgoingEdges(n);return null==i||0===i.length}},{key:"getBoundaryNodes",value:function(e){var t=this,n=[];return Object.keys(this.nodes).forEach((function(i){if(t.isBoundary(i,e)){var r=t.getCell(i);r&&n.push(r)}})),n}},{key:"getRoots",value:function(){return this.getBoundaryNodes(!0)}},{key:"getLeafs",value:function(){return this.getBoundaryNodes(!1)}},{key:"isRoot",value:function(e){return this.isBoundary(e,!0)}},{key:"isLeaf",value:function(e){return this.isBoundary(e,!1)}},{key:"getNeighbors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.incoming,i=t.outgoing;null==n&&null==i&&(n=i=!0);var r=this.getConnectedEdges(e,t).reduce((function(r,o){var a=o.hasLoop(t),s=o.getSourceCell(),l=o.getTargetCell();return n&&s&&s.isNode()&&!r[s.id]&&(!a&&(s===e||t.deep&&s.isDescendantOf(e))||(r[s.id]=s)),i&&l&&l.isNode()&&!r[l.id]&&(!a&&(l===e||t.deep&&l.isDescendantOf(e))||(r[l.id]=l)),r}),{});if(e.isEdge()){if(n){var o=e.getSourceCell();o&&o.isNode()&&!r[o.id]&&(r[o.id]=o)}if(i){var a=e.getTargetCell();a&&a.isNode()&&!r[a.id]&&(r[a.id]=a)}}return Object.keys(r).map((function(e){return r[e]}))}},{key:"isNeighbor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.incoming,r=n.outgoing;return null==i&&null==r&&(i=r=!0),this.getConnectedEdges(e,n).some((function(e){var n=e.getSourceCell(),o=e.getTargetCell();return!(!i||!n||n.id!==t.id)||!(!r||!o||o.id!==t.id)}))}},{key:"getSuccessors",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[];return this.search(e,(function(r,o){r!==e&&t.matchDistance(o,n.distance)&&i.push(r)}),Object.assign(Object.assign({},n),{outgoing:!0})),i}},{key:"isSuccessor",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!1;return this.search(e,(function(o,a){if(o===t&&o!==e&&n.matchDistance(a,i.distance))return r=!0,!1}),Object.assign(Object.assign({},i),{outgoing:!0})),r}},{key:"getPredecessors",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[];return this.search(e,(function(r,o){r!==e&&t.matchDistance(o,n.distance)&&i.push(r)}),Object.assign(Object.assign({},n),{incoming:!0})),i}},{key:"isPredecessor",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!1;return this.search(e,(function(o,a){if(o===t&&o!==e&&n.matchDistance(a,i.distance))return r=!0,!1}),Object.assign(Object.assign({},i),{incoming:!0})),r}},{key:"matchDistance",value:function(e,t){return null==t||("function"==typeof t?t(e):!(!Array.isArray(t)||!t.includes(e))||e===t)}},{key:"getCommonAncestor",value:function(){for(var e,t=[],n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return i.forEach((function(e){e&&(Array.isArray(e)?t.push.apply(t,f(e)):t.push(e))})),(e=Iu).getCommonAncestor.apply(e,t)}},{key:"getSubGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[],r={},o=[],a=[],s=function(e){r[e.id]||(i.push(e),r[e.id]=e,e.isEdge()&&a.push(e),e.isNode()&&o.push(e))};return e.forEach((function(e){(s(e),n.deep)&&e.getDescendants({deep:!0}).forEach((function(e){return s(e)}))})),a.forEach((function(e){var t=e.getSourceCell(),n=e.getTargetCell();t&&!r[t.id]&&(i.push(t),r[t.id]=t,t.isNode()&&o.push(t)),n&&!r[n.id]&&(i.push(n),r[n.id]=n,n.isNode()&&o.push(n))})),o.forEach((function(e){t.getConnectedEdges(e,n).forEach((function(e){var t=e.getSourceCell(),n=e.getTargetCell();!r[e.id]&&t&&r[t.id]&&n&&r[n.id]&&(i.push(e),r[e.id]=e)}))})),i}},{key:"cloneSubGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getSubGraph(e,t);return this.cloneCells(n)}},{key:"cloneCells",value:function(e){return Iu.cloneCells(e)}},{key:"getNodesFromPoint",value:function(e,t){var n="number"==typeof e?{x:e,y:t||0}:e;return this.getNodes().filter((function(e){return e.getBBox().containsPoint(n)}))}},{key:"getNodesInArea",value:function(e,t,n,i,r){var o="number"==typeof e?new to(e,t,n,i):to.create(e),a="number"==typeof e?r:t,s=a&&a.strict;return this.getNodes().filter((function(e){var t=e.getBBox();return s?o.containsRect(t):o.isIntersectWithRect(t)}))}},{key:"getEdgesInArea",value:function(e,t,n,i,r){var o="number"==typeof e?new to(e,t,n,i):to.create(e),a="number"==typeof e?r:t,s=a&&a.strict;return this.getEdges().filter((function(e){var t=e.getBBox();return 0===t.width?t.inflate(1,0):0===t.height&&t.inflate(0,1),s?o.containsRect(t):o.isIntersectWithRect(t)}))}},{key:"getNodesUnderNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.getBBox();return(null==t.by||"bbox"===t.by?this.getNodesInArea(n):this.getNodesFromPoint(n[t.by])).filter((function(t){return e.id!==t.id&&!t.isDescendantOf(e)}))}},{key:"getAllCellsBBox",value:function(){return this.getCellsBBox(this.getCells())}},{key:"getCellsBBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Iu.getCellsBBox(e,t)}},{key:"search",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.breadthFirst?this.breadthFirstSearch(e,t,n):this.depthFirstSearch(e,t,n)}},{key:"breadthFirstSearch",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o={},a={};r.push(e),a[e.id]=0;for(var s=function(){var e=r.shift();return null==e||o[e.id]?0:(o[e.id]=!0,!1===mn(t,n,e,a[e.id])?0:void n.getNeighbors(e,i).forEach((function(t){a[t.id]=a[e.id]+1,r.push(t)})))};r.length>0;)s()}},{key:"depthFirstSearch",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o={},a={};r.push(e),a[e.id]=0;for(var s=function(){var e=r.pop();if(null==e||o[e.id])return 0;if(o[e.id]=!0,!1===mn(t,n,e,a[e.id]))return 0;var s=n.getNeighbors(e,i),l=r.length;s.forEach((function(t){a[t.id]=a[e.id]+1,r.splice(l,0,t)}))};r.length>0;)s()}},{key:"getShortestPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={};this.getEdges().forEach((function(e){var t=e.getSourceCellId(),r=e.getTargetCellId();t&&r&&(i[t]||(i[t]=[]),i[r]||(i[r]=[]),i[t].push(r),n.directed||i[r].push(t))}));var r="string"==typeof e?e:e.id,o=Hr.run(i,r,n.weight),a=[],s="string"==typeof t?t:t.id;for(o[s]&&a.push(s);s=o[s];)a.unshift(s);return a}},{key:"translate",value:function(e,t,n){return this.getCells().filter((function(e){return!e.hasParent()})).forEach((function(i){return i.translate(e,t,n)})),this}},{key:"resize",value:function(e,t,n){return this.resizeCells(e,t,this.getCells(),n)}},{key:"resizeCells",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=this.getCellsBBox(n);if(r){var o=Math.max(e/r.width,0),a=Math.max(t/r.height,0),s=r.getOrigin();n.forEach((function(e){return e.scale(o,a,s,i)}))}return this}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.toJSON(this.getCells(),e)}},{key:"parseJSON",value:function(e){return t.fromJSON(e)}},{key:"fromJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.parseJSON(e);return this.resetCells(n,t),this}},{key:"startBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.batches[e]=(this.batches[e]||0)+1,this.notify("batch:start",{name:e,data:t}),this}},{key:"stopBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.batches[e]=(this.batches[e]||0)-1,this.notify("batch:stop",{name:e,data:t}),this}},{key:"batchUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.startBatch(e,n);var i=t();return this.stopBatch(e,n),i}},{key:"hasActiveBatch",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.keys(this.batches);return(Array.isArray(t)?t:[t]).some((function(t){return e.batches[t]>0}))}},{key:"dispose",value:function(){this.collection.dispose()}}])}(Nn);Hu([_u.dispose()],_u.prototype,"dispose",null),function(e){e.toStringTag="X6.".concat(e.name),e.isModel=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.addNode&&"function"==typeof i.addEdge&&null!=i.collection}}(_u||(_u={})),function(e){e.toJSON=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{cells:e.map((function(e){return e.toJSON(t)}))}},e.fromJSON=function(e){var t=[];return Array.isArray(e)?t.push.apply(t,f(e)):(e.cells&&t.push.apply(t,f(e.cells)),e.nodes&&e.nodes.forEach((function(e){null==e.shape&&(e.shape="rect"),t.push(e)})),e.edges&&e.edges.forEach((function(e){null==e.shape&&(e.shape="edge"),t.push(e)}))),t.map((function(e){var t=e.shape;if(t){if(Bu.registry.exist(t))return Bu.create(e);if(Fu.registry.exist(t))return Fu.create(e)}throw new Error("The `shape` should be specified when creating a node/edge instance")}))}}(_u||(_u={}));var Uu=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Wu=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"label",get:function(){return this.getLabel()},set:function(e){this.setLabel(e)}},{key:"getLabel",value:function(){return this.getAttrByPath("text/text")}},{key:"setLabel",value:function(e,t){return null==e?this.removeLabel():this.setAttrByPath("text/text",e,t),this}},{key:"removeLabel",value:function(){return this.removeAttrByPath("text/text"),this}}])}(Bu);!function(e){e.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},e.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},e.config({attrs:{text:Object.assign({},e.labelAttr)},propHooks:function(e){var t=e.label,n=Uu(e,["label"]);return t&&Mn(n,"attrs/text/text",t),n},visible:!0})}(Wu||(Wu={}));var Ju=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Xu(e){return[{tagName:e,selector:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body"},{tagName:"text",selector:"label"}]}function Yu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={constructorName:e,markup:Xu(e,n.selector),attrs:o({},e,Object.assign({},Wu.bodyAttr))};return(n.parent||Wu).define(nn(i,t,{shape:e}))}Yu("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}});var Zu=Fu.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});Yu("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var Ku=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Qu=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"points",get:function(){return this.getPoints()},set:function(e){this.setPoints(e)}},{key:"getPoints",value:function(){return this.getAttrByPath("body/refPoints")}},{key:"setPoints",value:function(e,n){return null==e?this.removePoints():this.setAttrByPath("body/refPoints",t.pointsToString(e),n),this}},{key:"removePoints",value:function(){return this.removeAttrByPath("body/refPoints"),this}}])}(Wu);!function(e){function t(e){return"string"==typeof e?e:e.map((function(e){return Array.isArray(e)?e.join(","):eo.isPointLike(e)?"".concat(e.x,", ").concat(e.y):""})).join(" ")}e.pointsToString=t,e.config({propHooks:function(e){var n=e.points,i=Ku(e,["points"]);if(n){var r=t(n);r&&Mn(i,"attrs/body/refPoints",r)}return i}})}(Qu||(Qu={})),Yu("polygon",{},{parent:Qu}),Yu("polyline",{},{parent:Qu});var $u=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Wu.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks:function(e){var t=e.path,n=$u(e,["path"]);return t&&Mn(n,"attrs/body/refD",t),n}});var ec=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Wu.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},qn.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:bi.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},Wu.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks:function(e){var t=e.text,n=ec(e,["text"]);return t&&Mn(n,"attrs/label/text",t),n},attrHooks:{text:{set:function(e,t){var n=t.cell,i=t.view,r=t.refBBox,o=t.elem,a=t.attrs;if(!(o instanceof HTMLElement)){var s=a.style||{},l={text:e,width:-5,height:"100%"},u=Object.assign({textVerticalAnchor:"middle"},s);return mn(us.presets.textWrap.set,this,l,{cell:n,view:i,elem:o,refBBox:r,attrs:u}),{fill:s.color||null}}o.textContent=e},position:function(e,t){var n=t.refBBox;if(t.elem instanceof SVGElement)return n.getCenter()}}}}),Yu("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xlink:href";return function(t){var n=t.imageUrl,i=t.imageWidth,r=t.imageHeight,o=Ju(t,["imageUrl","imageWidth","imageHeight"]);if(null!=n||null!=i||null!=r){var a=function(){if(o.attrs){var t=o.attrs.image;null!=n&&(t[e]=n),null!=i&&(t.width=i),null!=r&&(t.height=r),o.attrs.image=t}};o.attrs?(null==o.attrs.image&&(o.attrs.image={}),a()):(o.attrs={image:{}},a())}return o}}()},{selector:"image"}),Yu("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});var tc=function(e){function t(){var e;return v(this,t),(e=a(this,t,arguments)).portsCache={},e}return c(t,e),y(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"getContainerClassName",value:function(){var e=[n(t,"getContainerClassName",this,3)([]),this.prefixClassName("node")];return this.can("nodeMovable")||e.push(this.prefixClassName("node-immovable")),e.join(" ")}},{key:"updateClassName",value:function(e){var t=e.target;if(t.hasAttribute("magnet")){var n=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?di(t,n):gi(t,n)}else{var i=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(i):this.addClass(i)}}},{key:"isNodeView",value:function(){return!0}},{key:"confirmUpdate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e;return this.hasAction(i,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(i,"render")?(this.render(),i=this.removeAction(i,["render","update","resize","translate","rotate","ports","tools"])):(i=this.handleAction(i,"resize",(function(){return t.resize()}),"update"),i=this.handleAction(i,"update",(function(){return t.update()}),"ports"),i=this.handleAction(i,"translate",(function(){return t.translate()})),i=this.handleAction(i,"rotate",(function(){return t.rotate()})),i=this.handleAction(i,"ports",(function(){return t.renderPorts()})),i=this.handleAction(i,"tools",(function(){t.getFlag("tools")===e?t.renderTools():t.updateTools(n)}))),i}},{key:"update",value:function(e){this.cleanCache(),this.removePorts();var t=this.cell,n=t.getSize(),i=t.getAttrs();this.updateAttrs(this.container,i,{attrs:e===i?null:e,rootBBox:new to(0,0,n.width,n.height),selectors:this.selectors}),this.renderPorts()}},{key:"renderMarkup",value:function(){var e=this.cell.markup;if(e){if("string"==typeof e)throw new TypeError("Not support string markup.");return this.renderJSONMarkup(e)}throw new TypeError("Invalid node markup.")}},{key:"renderJSONMarkup",value:function(e){var t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.appendChild(t.fragment)}},{key:"render",value:function(){return this.empty(),this.renderMarkup(),this.resize(),this.updateTransform(),this.renderTools(),this}},{key:"resize",value:function(){this.cell.getAngle()&&this.rotate(),this.update()}},{key:"translate",value:function(){this.updateTransform()}},{key:"rotate",value:function(){this.updateTransform()}},{key:"getTranslationString",value:function(){var e=this.cell.getPosition();return"translate(".concat(e.x,",").concat(e.y,")")}},{key:"getRotationString",value:function(){var e=this.cell.getAngle();if(e){var t=this.cell.getSize();return"rotate(".concat(e,",").concat(t.width/2,",").concat(t.height/2,")")}}},{key:"updateTransform",value:function(){var e=this.getTranslationString(),t=this.getRotationString();t&&(e+=" ".concat(t)),this.container.setAttribute("transform",e)}},{key:"findPortElem",value:function(e,t){var n=e?this.portsCache[e]:null;if(!n)return null;var i=n.portContentElement,r=n.portContentSelectors||{};return this.findOne(t,i,r)}},{key:"cleanPortsCache",value:function(){this.portsCache={}}},{key:"removePorts",value:function(){Object.values(this.portsCache).forEach((function(e){Ei(e.portElement)}))}},{key:"renderPorts",value:function(){var e=this,t=this.container,n=[];t.childNodes.forEach((function(e){n.push(e)}));var i=this.cell.getParsedPorts(),r=Yt(i,"zIndex"),o="auto";r[o]&&r[o].forEach((function(i){var r=e.getPortElement(i);t.append(r),n.push(r)})),Object.keys(r).forEach((function(t){if(t!==o){var i=parseInt(t,10);e.appendPorts(r[t],i,n)}})),this.updatePorts()}},{key:"appendPorts",value:function(e,t,n){var i=this,r=e.map((function(e){return i.getPortElement(e)}));n[t]||t<0?Ti(n[Math.max(t,0)],r):Si(this.container,r)}},{key:"getPortElement",value:function(e){var t=this.portsCache[e.id];return t?t.portElement:this.createPortElement(e)}},{key:"createPortElement",value:function(e){var t=Fs.renderMarkup(this.cell.getPortContainerMarkup()),n=t.elem;if(null==n)throw new Error("Invalid port container markup.");var i=(t=Fs.renderMarkup(this.getPortMarkup(e))).elem,r=t.selectors;if(null==i)throw new Error("Invalid port markup.");this.setAttrs({port:e.id,"port-group":e.group},i);var o="x6-port";e.group&&(o+=" x6-port-".concat(e.group)),gi(n,o),gi(n,"x6-port"),gi(i,"x6-port-body"),n.appendChild(i);var a,s,l=r;if(this.existPortLabel(e)){if(a=(t=Fs.renderMarkup(this.getPortLabelMarkup(e.label))).elem,s=t.selectors,null==a)throw new Error("Invalid port label markup.");if(r&&s){for(var u in s)if(r[u]&&u!==this.rootSelector)throw new Error("Selectors within port must be unique.");l=Object.assign(Object.assign({},r),s)}gi(a,"x6-port-label"),n.appendChild(a)}return this.portsCache[e.id]={portElement:n,portSelectors:l,portLabelElement:a,portLabelSelectors:s,portContentElement:i,portContentSelectors:r},this.graph.options.onPortRendered&&this.graph.options.onPortRendered({port:e,node:this.cell,container:n,selectors:l,labelContainer:a,labelSelectors:s,contentContainer:i,contentSelectors:r}),n}},{key:"updatePorts",value:function(){var e=this,t=this.cell.getParsedGroups(),n=Object.keys(t);0===n.length?this.updatePortGroup():n.forEach((function(t){return e.updatePortGroup(t)}))}},{key:"updatePortGroup",value:function(e){for(var t=to.fromSize(this.cell.getSize()),n=this.cell.getPortsLayoutByGroup(e,t),i=0,r=n.length;i<r;i+=1){var o=n[i],a=o.portId,s=this.portsCache[a]||{},l=o.portLayout;if(this.applyPortTransform(s.portElement,l),null!=o.portAttrs){var u={selectors:s.portSelectors||{}};o.portSize&&(u.rootBBox=to.fromSize(o.portSize)),this.updateAttrs(s.portElement,o.portAttrs,u)}var c=o.labelLayout;if(c&&s.portLabelElement&&(this.applyPortTransform(s.portLabelElement,c,-(l.angle||0)),c.attrs)){var h={selectors:s.portLabelSelectors||{}};o.labelSize&&(h.rootBBox=to.fromSize(o.labelSize)),this.updateAttrs(s.portLabelElement,c.attrs,h)}}}},{key:"applyPortTransform",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.angle,r=t.position;Sr(e,Pr().rotate(n).translate(r.x||0,r.y||0).rotate(i||0),{absolute:!0})}},{key:"getPortMarkup",value:function(e){return e.markup||this.cell.portMarkup}},{key:"getPortLabelMarkup",value:function(e){return e.markup||this.cell.portLabelMarkup}},{key:"existPortLabel",value:function(e){return e.attrs&&e.attrs.text}},{key:"getEventArgs",value:function(e,t,n){var i=this,r=i.cell;return null==t||null==n?{e:e,view:i,node:r,cell:r}:{e:e,x:t,y:n,view:i,node:r,cell:r}}},{key:"getPortEventArgs",value:function(e,t,n){var i=this,r=i.cell,o=r;return n?{e:e,x:n.x,y:n.y,view:i,node:r,cell:o,port:t}:{e:e,view:i,node:r,cell:o,port:t}}},{key:"notifyMouseDown",value:function(e,i,r){n(t,"onMouseDown",this,3)([e,i,r]),this.notify("node:mousedown",this.getEventArgs(e,i,r))}},{key:"notifyMouseMove",value:function(e,i,r){n(t,"onMouseMove",this,3)([e,i,r]),this.notify("node:mousemove",this.getEventArgs(e,i,r))}},{key:"notifyMouseUp",value:function(e,i,r){n(t,"onMouseUp",this,3)([e,i,r]),this.notify("node:mouseup",this.getEventArgs(e,i,r))}},{key:"notifyPortEvent",value:function(e,t,n){var i=this.findAttr("port",t.target);if(i){var r=t.type;"node:port:mouseenter"===e?t.type="mouseenter":"node:port:mouseleave"===e&&(t.type="mouseleave"),this.notify(e,this.getPortEventArgs(t,i,n)),t.type=r}}},{key:"onClick",value:function(e,i,r){n(t,"onClick",this,3)([e,i,r]),this.notify("node:click",this.getEventArgs(e,i,r)),this.notifyPortEvent("node:port:click",e,{x:i,y:r})}},{key:"onDblClick",value:function(e,i,r){n(t,"onDblClick",this,3)([e,i,r]),this.notify("node:dblclick",this.getEventArgs(e,i,r)),this.notifyPortEvent("node:port:dblclick",e,{x:i,y:r})}},{key:"onContextMenu",value:function(e,i,r){n(t,"onContextMenu",this,3)([e,i,r]),this.notify("node:contextmenu",this.getEventArgs(e,i,r)),this.notifyPortEvent("node:port:contextmenu",e,{x:i,y:r})}},{key:"onMouseDown",value:function(e,t,n){this.isPropagationStopped(e)||(this.notifyMouseDown(e,t,n),this.notifyPortEvent("node:port:mousedown",e,{x:t,y:n}),this.startNodeDragging(e,t,n))}},{key:"onMouseMove",value:function(e,t,n){var i=this.getEventData(e),r=i.action;if("magnet"===r)this.dragMagnet(e,t,n);else{if("move"===r){var o=i.targetView||this;o.dragNode(e,t,n),o.notify("node:moving",{e:e,x:t,y:n,view:o,cell:o.cell,node:o.cell})}this.notifyMouseMove(e,t,n),this.notifyPortEvent("node:port:mousemove",e,{x:t,y:n})}this.setEventData(e,i)}},{key:"onMouseUp",value:function(e,t,n){var i=this.getEventData(e),r=i.action;"magnet"===r?this.stopMagnetDragging(e,t,n):(this.notifyMouseUp(e,t,n),this.notifyPortEvent("node:port:mouseup",e,{x:t,y:n}),"move"===r&&(i.targetView||this).stopNodeDragging(e,t,n));var o=i.targetMagnet;o&&this.onMagnetClick(e,o,t,n),this.checkMouseleave(e)}},{key:"onMouseOver",value:function(e){n(t,"onMouseOver",this,3)([e]),this.notify("node:mouseover",this.getEventArgs(e)),this.notifyPortEvent("node:port:mouseenter",e),this.notifyPortEvent("node:port:mouseover",e)}},{key:"onMouseOut",value:function(e){n(t,"onMouseOut",this,3)([e]),this.notify("node:mouseout",this.getEventArgs(e)),this.notifyPortEvent("node:port:mouseleave",e),this.notifyPortEvent("node:port:mouseout",e)}},{key:"onMouseEnter",value:function(e){this.updateClassName(e),n(t,"onMouseEnter",this,3)([e]),this.notify("node:mouseenter",this.getEventArgs(e))}},{key:"onMouseLeave",value:function(e){n(t,"onMouseLeave",this,3)([e]),this.notify("node:mouseleave",this.getEventArgs(e))}},{key:"onMouseWheel",value:function(e,i,r,o){n(t,"onMouseWheel",this,3)([e,i,r,o]),this.notify("node:mousewheel",Object.assign({delta:o},this.getEventArgs(e,i,r)))}},{key:"onMagnetClick",value:function(e,t,n,i){var r=this.graph;r.view.getMouseMovedCount(e)>r.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:t},this.getEventArgs(e,n,i)))}},{key:"onMagnetDblClick",value:function(e,t,n,i){this.notify("node:magnet:dblclick",Object.assign({magnet:t},this.getEventArgs(e,n,i)))}},{key:"onMagnetContextMenu",value:function(e,t,n,i){this.notify("node:magnet:contextmenu",Object.assign({magnet:t},this.getEventArgs(e,n,i)))}},{key:"onMagnetMouseDown",value:function(e,t,n,i){this.startMagnetDragging(e,n,i)}},{key:"onCustomEvent",value:function(e,i,r,o){this.notify("node:customevent",Object.assign({name:i},this.getEventArgs(e,r,o))),n(t,"onCustomEvent",this,3)([e,i,r,o])}},{key:"prepareEmbedding",value:function(e){var t=this.graph,n=this.getEventData(e).cell||this.cell,i=t.findViewByCell(n),r=t.snapToGrid(e.clientX,e.clientY);this.notify("node:embed",{e:e,node:n,view:i,cell:n,x:r.x,y:r.y,currentParent:n.getParent()})}},{key:"processEmbedding",value:function(e,t){var n=this,i=t.cell||this.cell,r=t.graph||this.graph,o=r.options.embedding,a=o.findParent,s="function"==typeof a?mn(a,r,{view:this,node:this.cell}).filter((function(e){return Iu.isCell(e)&&n.cell.id!==e.id&&!e.isDescendantOf(n.cell)})):r.model.getNodesUnderNode(i,{by:a});if(o.frontOnly&&s.length>0){var l=Yt(s,"zIndex"),u=tn(Object.keys(l).map((function(e){return parseInt(e,10)})));u&&(s=l[u])}s=s.filter((function(e){return e.visible}));for(var c=null,h=t.candidateEmbedView,f=o.validate,g=s.length-1;g>=0;g-=1){var d=s[g];if(h&&h.cell.id===d.id){c=h;break}var v=d.findView(r);if(f&&mn(f,r,{child:this.cell,parent:v.cell,childView:this,parentView:v})){c=v;break}}this.clearEmbedding(t),c&&c.highlight(null,{type:"embedding"}),t.candidateEmbedView=c;var p=r.snapToGrid(e.clientX,e.clientY);this.notify("node:embedding",{e:e,cell:i,node:i,view:r.findViewByCell(i),x:p.x,y:p.y,currentParent:i.getParent(),candidateParent:c?c.cell:null})}},{key:"clearEmbedding",value:function(e){var t=e.candidateEmbedView;t&&(t.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null)}},{key:"finalizeEmbedding",value:function(e,t){this.graph.startBatch("embedding");var n=t.cell||this.cell,i=t.graph||this.graph,r=i.findViewByCell(n),o=n.getParent(),a=t.candidateEmbedView;if(a?(a.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null,null!=o&&o.id===a.cell.id||a.cell.insertChild(n,void 0,{ui:!0})):o&&o.unembed(n,{ui:!0}),i.model.getConnectedEdges(n,{deep:!0}).forEach((function(e){e.updateParent({ui:!0})})),r&&a){var s=i.snapToGrid(e.clientX,e.clientY);r.notify("node:embedded",{e:e,cell:n,x:s.x,y:s.y,node:n,view:i.findViewByCell(n),previousParent:o,currentParent:n.getParent()})}this.graph.stopBatch("embedding")}},{key:"getDelegatedView",value:function(){for(var e=this.cell,t=this;t&&!e.isEdge();){if(!e.hasParent()||t.can("stopDelegateOnDragging"))return t;e=e.getParent(),t=this.graph.findViewByCell(e)}return null}},{key:"validateMagnet",value:function(e,t,n){if("passive"!==t.getAttribute("magnet")){var i=this.graph.options.connecting.validateMagnet;return!i||mn(i,this.graph,{e:n,magnet:t,view:e,cell:e.cell})}return!1}},{key:"startMagnetDragging",value:function(e,t,n){if(this.can("magnetConnectable")){e.stopPropagation();var i=e.currentTarget,r=this.graph;this.setEventData(e,{targetMagnet:i}),this.validateMagnet(this,i,e)?(r.options.magnetThreshold<=0&&this.startConnectting(e,i,t,n),this.setEventData(e,{action:"magnet"}),this.stopPropagation(e)):this.onMouseDown(e,t,n),r.view.delegateDragEvents(e,this)}}},{key:"startConnectting",value:function(e,t,n,i){this.graph.model.startBatch("add-edge");var r=this.createEdgeFromMagnet(t,n,i);r.setEventData(e,r.prepareArrowheadDragging("target",{x:n,y:i,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(e,{edgeView:r}),r.notifyMouseDown(e,n,i)}},{key:"getDefaultEdge",value:function(e,t){var n,i=this.graph.options.connecting.createEdge;return i&&(n=mn(i,this.graph,{sourceMagnet:t,sourceView:e,sourceCell:e.cell})),n}},{key:"createEdgeFromMagnet",value:function(e,t,n){var i=this.graph,r=i.model,o=this.getDefaultEdge(this,e);return o.setSource(Object.assign(Object.assign({},o.getSource()),this.getEdgeTerminal(e,t,n,o,"source"))),o.setTarget(Object.assign(Object.assign({},o.getTarget()),{x:t,y:n})),o.addTo(r,{async:!1,ui:!0}),o.findView(i)}},{key:"dragMagnet",value:function(e,t,n){var i=this.getEventData(e),r=i.edgeView;if(r)r.onMouseMove(e,t,n),this.autoScrollGraph(e.clientX,e.clientY);else{var o=this.graph,a=o.options.magnetThreshold,s=this.getEventTarget(e),l=i.targetMagnet;if("onleave"===a){if(l===s||l.contains(s))return}else if(o.view.getMouseMovedCount(e)<=a)return;this.startConnectting(e,l,t,n)}}},{key:"stopMagnetDragging",value:function(e,t,n){var i=this.eventData(e).edgeView;i&&(i.onMouseUp(e,t,n),this.graph.model.stopBatch("add-edge"))}},{key:"notifyUnhandledMouseDown",value:function(e,t,n){this.notify("node:unhandled:mousedown",{e:e,x:t,y:n,view:this,cell:this.cell,node:this.cell})}},{key:"notifyNodeMove",value:function(e,t,n,i,r){var o=this,a=[r],s=this.graph.getPlugin("selection");if(s&&s.isSelectionMovable()){var l=s.getSelectedCells();l.includes(r)&&(a=l.filter((function(e){return e.isNode()})))}a.forEach((function(r){o.notify(e,{e:t,x:n,y:i,cell:r,node:r,view:r.findView(o.graph)})}))}},{key:"getRestrictArea",value:function(e){var t=this.graph.options.translating.restrict,n="function"==typeof t?mn(t,this.graph,e):t;return"number"==typeof n?this.graph.transform.getGraphArea().inflate(n):!0===n?this.graph.transform.getGraphArea():n||null}},{key:"startNodeDragging",value:function(e,t,n){var i=this.getDelegatedView();if(null==i||!i.can("nodeMovable"))return this.notifyUnhandledMouseDown(e,t,n);this.setEventData(e,{targetView:i,action:"move"});var r=eo.create(i.cell.getPosition());i.setEventData(e,{moving:!1,offset:r.diff(t,n),restrict:this.getRestrictArea(i)})}},{key:"dragNode",value:function(e,t,n){var i=this.cell,r=this.graph,o=r.getGridSize(),a=this.getEventData(e),s=a.offset,l=a.restrict;a.moving||(a.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",e,t,n,this.cell)),this.autoScrollGraph(e.clientX,e.clientY);var u=Kr.snapToGrid(t+s.x,o),c=Kr.snapToGrid(n+s.y,o);i.setPosition(u,c,{restrict:l,deep:!0,ui:!0}),r.options.embedding.enabled&&(a.embedding||(this.prepareEmbedding(e),a.embedding=!0),this.processEmbedding(e,a))}},{key:"stopNodeDragging",value:function(e,t,n){var i=this.getEventData(e);i.embedding&&this.finalizeEmbedding(e,i),i.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",e,t,n,this.cell)),i.moving=!1,i.embedding=!1}},{key:"autoScrollGraph",value:function(e,t){var n=this.graph.getPlugin("scroller");n&&n.autoScroll(e,t)}}])}(Ws);!function(e){e.toStringTag="X6.".concat(e.name),e.isNodeView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNodeView&&"function"==typeof i.isEdgeView&&"function"==typeof i.confirmUpdate&&"function"==typeof i.update&&"function"==typeof i.findPortElem&&"function"==typeof i.resize&&"function"==typeof i.rotate&&"function"==typeof i.translate}}(tc||(tc={})),tc.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),tc.registry.register("node",tc,!0);var nc=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},ic=function(e){function t(){var e;return v(this,t),(e=a(this,t,arguments)).POINT_ROUNDING=2,e.labelDestroyFn={},e}return c(t,e),y(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"getContainerClassName",value:function(){return[n(t,"getContainerClassName",this,3)([]),this.prefixClassName("edge")].join(" ")}},{key:"sourceBBox",get:function(){var e=this.sourceView;if(!e){var t=this.cell.getSource();return new to(t.x,t.y)}var n=this.sourceMagnet;return e.isEdgeElement(n)?new to(this.sourceAnchor.x,this.sourceAnchor.y):e.getBBoxOfElement(n||e.container)}},{key:"targetBBox",get:function(){var e=this.targetView;if(!e){var t=this.cell.getTarget();return new to(t.x,t.y)}var n=this.targetMagnet;return e.isEdgeElement(n)?new to(this.targetAnchor.x,this.targetAnchor.y):e.getBBoxOfElement(n||e.container)}},{key:"isEdgeView",value:function(){return!0}},{key:"confirmUpdate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e;if(this.hasAction(i,"source")){if(!this.updateTerminalProperties("source"))return i;i=this.removeAction(i,"source")}if(this.hasAction(i,"target")){if(!this.updateTerminalProperties("target"))return i;i=this.removeAction(i,"target")}return this.hasAction(i,"render")?(this.render(),i=this.removeAction(i,["render","update","labels","tools"])):(i=this.handleAction(i,"update",(function(){return t.update(n)})),i=this.handleAction(i,"labels",(function(){return t.onLabelsChange(n)})),i=this.handleAction(i,"tools",(function(){return t.renderTools()})))}},{key:"render",value:function(){return this.empty(),this.renderMarkup(),this.labelContainer=null,this.renderLabels(),this.update(),this.renderTools(),this}},{key:"renderMarkup",value:function(){var e=this.cell.markup;if(e){if("string"==typeof e)throw new TypeError("Not support string markup.");return this.renderJSONMarkup(e)}throw new TypeError("Invalid edge markup.")}},{key:"renderJSONMarkup",value:function(e){var t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.append(t.fragment)}},{key:"customizeLabels",value:function(){if(this.labelContainer)for(var e=this.cell,t=e.labels,n=0,i=t.length;n<i;n+=1){var r=t[n],o=this.labelCache[n],a=this.labelSelectors[n],s=this.graph.options.onEdgeLabelRendered;if(s){var l=s({edge:e,label:r,container:o,selectors:a});l&&(this.labelDestroyFn[n]=l)}}}},{key:"destroyCustomizeLabels",value:function(){var e=this.cell.labels;if(this.labelCache&&this.labelSelectors&&this.labelDestroyFn)for(var t=0,n=e.length;t<n;t+=1){var i=this.labelDestroyFn[t],r=this.labelCache[t],o=this.labelSelectors[t];i&&r&&o&&i({edge:this.cell,label:e[t],container:r,selectors:o})}this.labelDestroyFn={}}},{key:"renderLabels",value:function(){var e=this.cell,t=e.getLabels(),n=t.length,i=this.labelContainer;if(this.labelCache={},this.labelSelectors={},n<=0)return i&&i.parentNode&&i.parentNode.removeChild(i),this;i?this.empty(i):(i=wi("g"),this.addClass(this.prefixClassName("edge-labels"),i),this.labelContainer=i);for(var r=0,o=t.length;r<o;r+=1){var a=t[r],s=this.normalizeLabelMarkup(this.parseLabelMarkup(a.markup)),l=void 0,u=void 0;if(s)l=s.node,u=s.selectors;else{var c=e.getDefaultLabel(),h=this.normalizeLabelMarkup(this.parseLabelMarkup(c.markup));l=h.node,u=h.selectors}l.setAttribute("data-index","".concat(r)),i.appendChild(l);var f=this.rootSelector;if(u[f])throw new Error("Ambiguous label root selector.");u[f]=l,this.labelCache[r]=l,this.labelSelectors[r]=u}return null==i.parentNode&&this.container.appendChild(i),this.updateLabels(),this.customizeLabels(),this}},{key:"onLabelsChange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.destroyCustomizeLabels(),this.shouldRerenderLabels(e)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}},{key:"shouldRerenderLabels",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.cell.previous("labels");if(null==t)return!0;if("propertyPathArray"in e&&"propertyValue"in e){var n=e.propertyPathArray||[],i=n.length;if(i>1)if(t[n[1]]){if(2===i)return"object"===b(e.propertyValue)&&$t(e.propertyValue,"markup");if("markup"!==n[2])return!1}}return!0}},{key:"parseLabelMarkup",value:function(e){return e?"string"==typeof e?this.parseLabelStringMarkup(e):this.parseJSONMarkup(e):null}},{key:"parseLabelStringMarkup",value:function(e){for(var t=ir.createVectors(e),n=document.createDocumentFragment(),i=0,r=t.length;i<r;i+=1){var o=t[i].node;n.appendChild(o)}return{fragment:n,selectors:{}}}},{key:"normalizeLabelMarkup",value:function(e){if(null!=e){var t,n=e.fragment;if(!(n instanceof DocumentFragment&&n.hasChildNodes()))throw new Error("Invalid label markup.");var i=n.childNodes;return(t=i.length>1||"G"!==i[0].nodeName.toUpperCase()?ir.create("g").append(n):ir.create(i[0])).addClass(this.prefixClassName("edge-label")),{node:t.node,selectors:e.selectors}}}},{key:"updateLabels",value:function(){if(this.labelContainer)for(var e=this.cell,t=e.labels,n=this.can("edgeLabelMovable"),i=e.getDefaultLabel(),r=0,o=t.length;r<o;r+=1){var a=this.labelCache[r],s=this.labelSelectors[r];a.setAttribute("cursor",n?"move":"default");var l=t[r],u=nn({},i.attrs,l.attrs);this.updateAttrs(a,u,{selectors:s,rootBBox:l.size?to.fromSize(l.size):void 0})}}},{key:"renderTools",value:function(){var e=this.cell.getTools();return this.addTools(e),this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cleanCache(),this.updateConnection(e);var t=this.cell.getAttrs(),n=nc(t,["text"]);return null!=n&&this.updateAttrs(this.container,n,{selectors:this.selectors}),this.updateLabelPositions(),this.updateTools(e),this}},{key:"removeRedundantLinearVertices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.cell,n=t.getVertices(),i=[this.sourceAnchor].concat(f(n),[this.targetAnchor]),r=i.length,o=new co(i);o.simplify({threshold:.01});var a=o.points.map((function(e){return e.toJSON()})),s=a.length;return r===s?0:(t.setVertices(a.slice(1,s-1),e),r-s)}},{key:"getTerminalView",value:function(e){switch(e){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"getTerminalAnchor",value:function(e){switch(e){case"source":return eo.create(this.sourceAnchor);case"target":return eo.create(this.targetAnchor);default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"getTerminalConnectionPoint",value:function(e){switch(e){case"source":return eo.create(this.sourcePoint);case"target":return eo.create(this.targetPoint);default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"getTerminalMagnet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case"source":if(t.raw)return this.sourceMagnet;var n=this.sourceView;return n?this.sourceMagnet||n.container:null;case"target":if(t.raw)return this.targetMagnet;var i=this.targetView;return i?this.targetMagnet||i.container:null;default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"updateConnection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.cell;if(e.translateBy&&t.isFragmentDescendantOf(e.translateBy)){var n=e.tx||0,i=e.ty||0;this.routePoints=new co(this.routePoints).translate(n,i).points,this.translateConnectionPoints(n,i),this.path.translate(n,i)}else{var r=t.getVertices(),o=this.findAnchors(r);this.sourceAnchor=o.source,this.targetAnchor=o.target,this.routePoints=this.findRoutePoints(r);var a=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=a.source,this.targetPoint=a.target;var s=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,s.source||this.sourcePoint,s.target||this.targetPoint)}this.cleanCache()}},{key:"findAnchors",value:function(e){var t=this.cell,n=t.source,i=t.target,r=e[0],o=e[e.length-1];return i.priority&&!n.priority?this.findAnchorsOrdered("target",o,"source",r):this.findAnchorsOrdered("source",r,"target",o)}},{key:"findAnchorsOrdered",value:function(e,t,n,i){var r,a,s,l=this.cell,u=l[e],c=l[n],h=this.getTerminalView(e),f=this.getTerminalView(n),g=this.getTerminalMagnet(e),d=this.getTerminalMagnet(n);h?(s=t?eo.create(t):f?d:eo.create(c),r=this.getAnchor(u.anchor,h,g,s,e)):r=eo.create(u);if(f){var v=eo.create(i||r);a=this.getAnchor(c.anchor,f,d,v,n)}else a=eo.isPointLike(c)?eo.create(c):new eo;return o(o({},e,r),n,a)}},{key:"getAnchor",value:function(e,t,n,i,r){var o,a=t.isEdgeElement(n),s=this.graph.options.connecting,l="string"==typeof e?{name:e}:e;if(!l){var u=a?("source"===r?s.sourceEdgeAnchor:s.targetEdgeAnchor)||s.edgeAnchor:("source"===r?s.sourceAnchor:s.targetAnchor)||s.anchor;l="string"==typeof u?{name:u}:u}if(!l)throw new Error("Anchor should be specified.");var c=l.name;if(a){var h=Dl.registry.get(c);if("function"!=typeof h)return Dl.registry.onNotFound(c);o=mn(h,this,t,n,i,l.args||{},r)}else{var f=Tl.registry.get(c);if("function"!=typeof f)return Tl.registry.onNotFound(c);o=mn(f,this,t,n,i,l.args||{},r)}return o?o.round(this.POINT_ROUNDING):new eo}},{key:"findRoutePoints",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.graph.options.connecting.router||mu.presets.normal,i=this.cell.getRouter()||n;if("function"==typeof i)e=mn(i,this,t,{},this);else{var r="string"==typeof i?i:i.name,o="string"==typeof i?{}:i.args||{},a=r?mu.registry.get(r):mu.presets.normal;if("function"!=typeof a)return mu.registry.onNotFound(r);e=mn(a,this,t,o,this)}return null==e?t.map((function(e){return eo.create(e)})):e.map((function(e){return eo.create(e)}))}},{key:"findConnectionPoints",value:function(e,t,n){var i,r,o=this.cell,a=this.graph.options.connecting,s=o.getSource(),l=o.getTarget(),u=this.sourceView,c=this.targetView,h=e[0],f=e[e.length-1];if(u&&!u.isEdgeElement(this.sourceMagnet)){var g=this.sourceMagnet||u.container,d=new no(h||n,t),v=s.connectionPoint||a.sourceConnectionPoint||a.connectionPoint;i=this.getConnectionPoint(v,u,g,d,"source")}else i=t;if(c&&!c.isEdgeElement(this.targetMagnet)){var p=this.targetMagnet||c.container,y=l.connectionPoint||a.targetConnectionPoint||a.connectionPoint,m=new no(f||t,n);r=this.getConnectionPoint(y,c,p,m,"target")}else r=n;return{source:i,target:r}}},{key:"getConnectionPoint",value:function(e,t,n,i,r){var o=i.end;if(null==e)return o;var a="string"==typeof e?e:e.name,s="string"==typeof e?{}:e.args,l=ql.registry.get(a);if("function"!=typeof l)return ql.registry.onNotFound(a);var u=mn(l,this,i,t,n,s||{},r);return u?u.round(this.POINT_ROUNDING):o}},{key:"findMarkerPoints",value:function(e,t,n){var i,r,o=this,a=function(e){for(var t=o.cell.getAttrs(),n=Object.keys(t),i=0,r=n.length;i<r;i+=1){var a=t[n[i]];if(a["".concat(e,"Marker")]||a["".concat(e,"-marker")]){var s=a.strokeWidth||a["stroke-width"];if(s)return parseFloat(s);break}}return null},s=e[0],l=e[e.length-1],u=a("source");u&&(i=t.clone().move(s||n,-u));var c=a("target");return c&&(r=n.clone().move(l||t,-c)),this.sourceMarkerPoint=i||t.clone(),this.targetMarkerPoint=r||n.clone(),{source:i,target:r}}},{key:"findPath",value:function(e,t,n){var i,r,o,a=this.cell.getConnector()||this.graph.options.connecting.connector;if("string"==typeof a?i=a:(i=a.name,r=a.args),i){var s=Eu.registry.get(i);if("function"!=typeof s)return Eu.registry.onNotFound(i);o=s}else o=Eu.presets.normal;var l=mn(o,this,t,n,e,Object.assign(Object.assign({},r),{raw:!0}),this);return"string"==typeof l?Co.parse(l):l}},{key:"translateConnectionPoints",value:function(e,t){this.sourcePoint.translate(e,t),this.targetPoint.translate(e,t),this.sourceAnchor.translate(e,t),this.targetAnchor.translate(e,t),this.sourceMarkerPoint.translate(e,t),this.targetMarkerPoint.translate(e,t)}},{key:"updateLabelPositions",value:function(){if(null==this.labelContainer)return this;if(!this.path)return this;var e=this.cell,t=e.getLabels();if(0===t.length)return this;for(var n=e.getDefaultLabel(),i=this.normalizeLabelPosition(n.position),r=0,o=t.length;r<o;r+=1){var a=t[r],s=this.labelCache[r];if(s){var l=this.normalizeLabelPosition(a.position),u=nn({},i,l),c=this.getLabelTransformationMatrix(u);s.setAttribute("transform",Or(c))}}return this}},{key:"updateTerminalProperties",value:function(e){var t=this.cell,n=this.graph,i=t[e],r=i&&i.cell,o="".concat(e,"View");if(!r)return this[o]=null,this.updateTerminalMagnet(e),!0;var a=n.getCellById(r);if(!a)throw new Error("Edge's ".concat(e,' node with id "').concat(r,'" not exists'));var s=a.findView(n);return!!s&&(this[o]=s,this.updateTerminalMagnet(e),!0)}},{key:"updateTerminalMagnet",value:function(e){var t="".concat(e,"Magnet"),n=this.getTerminalView(e);if(n){var i=n.getMagnetFromEdgeTerminal(this.cell[e]);i===n.container&&(i=null),this[t]=i}else this[t]=null}},{key:"getLabelPositionAngle",value:function(e){var t=this.cell.getLabelAt(e);return t&&t.position&&"object"===b(t.position)&&t.position.angle||0}},{key:"getLabelPositionArgs",value:function(e){var t=this.cell.getLabelAt(e);if(t&&t.position&&"object"===b(t.position))return t.position.options}},{key:"getDefaultLabelPositionArgs",value:function(){var e=this.cell.getDefaultLabel();if(e&&e.position&&"object"===b(e.position))return e.position.options}},{key:"mergeLabelPositionArgs",value:function(e,t){return null===e?null:void 0===e?null===t?null:t:nn({},t,e)}},{key:"getConnection",value:function(){return null!=this.path?this.path.clone():null}},{key:"getConnectionPathData",value:function(){if(null==this.path)return"";var e=this.cache.pathCache;return $t(e,"data")||(e.data=this.path.serialize()),e.data||""}},{key:"getConnectionSubdivisions",value:function(){if(null==this.path)return null;var e=this.cache.pathCache;return $t(e,"segmentSubdivisions")||(e.segmentSubdivisions=this.path.getSegmentSubdivisions()),e.segmentSubdivisions}},{key:"getConnectionLength",value:function(){if(null==this.path)return 0;var e=this.cache.pathCache;return $t(e,"length")||(e.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),e.length}},{key:"getPointAtLength",value:function(e){return null==this.path?null:this.path.pointAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getPointAtRatio",value:function(e){return null==this.path?null:(zn(e)&&(e=parseFloat(e)/100),this.path.pointAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()}))}},{key:"getTangentAtLength",value:function(e){return null==this.path?null:this.path.tangentAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getTangentAtRatio",value:function(e){return null==this.path?null:this.path.tangentAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getClosestPoint",value:function(e){return null==this.path?null:this.path.closestPoint(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getClosestPointLength",value:function(e){return null==this.path?null:this.path.closestPointLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getClosestPointRatio",value:function(e){return null==this.path?null:this.path.closestPointNormalizedLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getLabelPosition",value:function(e,t,n,i){var r,o={distance:0},a=0;"number"==typeof n?(a=n,r=i):r=n,null!=r&&(o.options=r);var s,l,u=r&&r.absoluteOffset,c=!(r&&r.absoluteDistance),h=r&&r.absoluteDistance&&r.reverseDistance,f=this.path,g={segmentSubdivisions:this.getConnectionSubdivisions()},d=new eo(e,t),v=f.closestPointT(d,g),p=this.getConnectionLength()||0,y=f.lengthAtT(v,g);if(c&&(y=p>0?y/p:0),h&&(y=-1*(p-y)||1),o.distance=y,u||(s=f.tangentAtT(v)),s)l=s.pointOffset(d);else{var m=f.pointAtT(v),b=d.diff(m);l={x:b.x,y:b.y}}return o.offset=l,o.angle=a,o}},{key:"normalizeLabelPosition",value:function(e){return"number"==typeof e?{distance:e}:e}},{key:"getLabelTransformationMatrix",value:function(e){var t=this.normalizeLabelPosition(e),n=t.options||{},i=t.angle||0,r=t.distance,o=r>0&&r<=1,a=0,s={x:0,y:0},l=t.offset;l&&("number"==typeof l?a=l:(null!=l.x&&(s.x=l.x),null!=l.y&&(s.y=l.y)));var u,c=0!==s.x||0!==s.y||0===a,h=n.keepGradient,f=n.ensureLegibility,g=this.path,d={segmentSubdivisions:this.getConnectionSubdivisions()},v=o?r*this.getConnectionLength():r,p=g.tangentAtLength(v,d),y=i;if(p){if(c)(u=p.start).translate(s);else{var m=p.clone();m.rotate(-90,p.start),m.setLength(a),u=m.end}h&&(y=p.angle()+i,f&&(y=Zr.normalize((y+90)%180-90)))}else u=g.start,c&&u.translate(s);return Pr().translate(u.x,u.y).rotate(y)}},{key:"getVertexIndex",value:function(e,t){var n=this.cell.getVertices(),i=this.getClosestPointLength(new eo(e,t)),r=0;if(null!=i)for(var o=n.length;r<o;r+=1){var a=n[r],s=this.getClosestPointLength(a);if(null!=s&&i<s)break}return r}},{key:"getEventArgs",value:function(e,t,n){var i=this,r=i.cell;return null==t||null==n?{e:e,view:i,edge:r,cell:r}:{e:e,x:t,y:n,view:i,edge:r,cell:r}}},{key:"notifyUnhandledMouseDown",value:function(e,t,n){this.notify("edge:unhandled:mousedown",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}},{key:"notifyMouseDown",value:function(e,i,r){n(t,"onMouseDown",this,3)([e,i,r]),this.notify("edge:mousedown",this.getEventArgs(e,i,r))}},{key:"notifyMouseMove",value:function(e,i,r){n(t,"onMouseMove",this,3)([e,i,r]),this.notify("edge:mousemove",this.getEventArgs(e,i,r))}},{key:"notifyMouseUp",value:function(e,i,r){n(t,"onMouseUp",this,3)([e,i,r]),this.notify("edge:mouseup",this.getEventArgs(e,i,r))}},{key:"onClick",value:function(e,i,r){n(t,"onClick",this,3)([e,i,r]),this.notify("edge:click",this.getEventArgs(e,i,r))}},{key:"onDblClick",value:function(e,i,r){n(t,"onDblClick",this,3)([e,i,r]),this.notify("edge:dblclick",this.getEventArgs(e,i,r))}},{key:"onContextMenu",value:function(e,i,r){n(t,"onContextMenu",this,3)([e,i,r]),this.notify("edge:contextmenu",this.getEventArgs(e,i,r))}},{key:"onMouseDown",value:function(e,t,n){this.notifyMouseDown(e,t,n),this.startEdgeDragging(e,t,n)}},{key:"onMouseMove",value:function(e,t,n){var i=this.getEventData(e);switch(i.action){case"drag-label":this.dragLabel(e,t,n);break;case"drag-arrowhead":this.dragArrowhead(e,t,n);break;case"drag-edge":this.dragEdge(e,t,n)}return this.notifyMouseMove(e,t,n),i}},{key:"onMouseUp",value:function(e,t,n){var i=this.getEventData(e);switch(i.action){case"drag-label":this.stopLabelDragging(e,t,n);break;case"drag-arrowhead":this.stopArrowheadDragging(e,t,n);break;case"drag-edge":this.stopEdgeDragging(e,t,n)}return this.notifyMouseUp(e,t,n),this.checkMouseleave(e),i}},{key:"onMouseOver",value:function(e){n(t,"onMouseOver",this,3)([e]),this.notify("edge:mouseover",this.getEventArgs(e))}},{key:"onMouseOut",value:function(e){n(t,"onMouseOut",this,3)([e]),this.notify("edge:mouseout",this.getEventArgs(e))}},{key:"onMouseEnter",value:function(e){n(t,"onMouseEnter",this,3)([e]),this.notify("edge:mouseenter",this.getEventArgs(e))}},{key:"onMouseLeave",value:function(e){n(t,"onMouseLeave",this,3)([e]),this.notify("edge:mouseleave",this.getEventArgs(e))}},{key:"onMouseWheel",value:function(e,i,r,o){n(t,"onMouseWheel",this,3)([e,i,r,o]),this.notify("edge:mousewheel",Object.assign({delta:o},this.getEventArgs(e,i,r)))}},{key:"onCustomEvent",value:function(e,i,r,o){if(Ai(e.target,"edge-tool",this.container)){if(e.stopPropagation(),this.can("useEdgeTools")){if("edge:remove"===i)return void this.cell.remove({ui:!0});this.notify("edge:customevent",Object.assign({name:i},this.getEventArgs(e,r,o)))}this.notifyMouseDown(e,r,o)}else this.notify("edge:customevent",Object.assign({name:i},this.getEventArgs(e,r,o))),n(t,"onCustomEvent",this,3)([e,i,r,o])}},{key:"onLabelMouseDown",value:function(e,t,n){this.notifyMouseDown(e,t,n),this.startLabelDragging(e,t,n),this.getEventData(e).stopPropagation&&e.stopPropagation()}},{key:"startEdgeDragging",value:function(e,t,n){this.can("edgeMovable")?this.setEventData(e,{x:t,y:n,moving:!1,action:"drag-edge"}):this.notifyUnhandledMouseDown(e,t,n)}},{key:"dragEdge",value:function(e,t,n){var i=this.getEventData(e);i.moving||(i.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(t-i.x,n-i.y,{ui:!0}),this.setEventData(e,{x:t,y:n}),this.notify("edge:moving",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}},{key:"stopEdgeDragging",value:function(e,t,n){var i=this.getEventData(e);i.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),i.moving=!1}},{key:"prepareArrowheadDragging",value:function(e,t){var n=this.getTerminalMagnet(e),i={action:"drag-arrowhead",x:t.x,y:t.y,isNewEdge:!0===t.isNewEdge,terminalType:e,initialMagnet:n,initialTerminal:Rt(this.cell[e]),fallbackAction:t.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(e),options:t.options};return this.beforeArrowheadDragging(i),i}},{key:"createValidateConnectionArgs",value:function(e){var t,n=[];n[4]=e,n[5]=this;var i=0,r=0;"source"===e?(i=2,t="target"):(r=2,t="source");var o=this.cell[t],a=o.cell;if(a){var s,l=n[i]=this.graph.findViewByCell(a);l&&(s=l.getMagnetFromEdgeTerminal(o))===l.container&&(s=void 0),n[i+1]=s}return function(e,t){return n[r]=e,n[r+1]=e.container===t?void 0:t,n}}},{key:"beforeArrowheadDragging",value:function(e){e.zIndex=this.cell.zIndex,this.cell.toFront();var t=this.container.style;e.pointerEvents=t.pointerEvents,t.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(e)}},{key:"afterArrowheadDragging",value:function(e){null!=e.zIndex&&(this.cell.setZIndex(e.zIndex,{ui:!0}),e.zIndex=null),this.container.style.pointerEvents=e.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(e)}},{key:"validateConnection",value:function(e,n,i,r,o,a,s){var l=this,u=this.graph.options.connecting,c=u.allowLoop,h=u.allowNode,f=u.allowEdge,g=u.allowPort,d=u.allowMulti,v=u.validateConnection,p=a?a.cell:null,y="target"===o?i:e,m="target"===o?r:n,b=!0,k=function(t){var u="source"===o?s?s.port:null:p?p.getSourcePortId():null,c="target"===o?s?s.port:null:p?p.getTargetPortId():null;return mn(t,l.graph,{edge:p,edgeView:a,sourceView:e,targetView:i,sourcePort:u,targetPort:c,sourceMagnet:n,targetMagnet:r,sourceCell:e?e.cell:null,targetCell:i?i.cell:null,type:o})};if(null!=c&&("boolean"==typeof c?c||e!==i||(b=!1):b=k(c)),b&&null!=g&&("boolean"==typeof g?!g&&m&&(b=!1):b=k(g)),b&&null!=f&&("boolean"==typeof f?!f&&t.isEdgeView(y)&&(b=!1):b=k(f)),b&&null!=h&&null==m&&("boolean"==typeof h?!h&&tc.isNodeView(y)&&(b=!1):b=k(h)),b&&null!=d&&a){var x=a.cell,w="source"===o?s:x.getSource(),P="target"===o?s:x.getTarget(),C=s?this.graph.getCellById(s.cell):null;if(w&&P&&w.cell&&P.cell&&C)if("function"==typeof d)b=k(d);else{var A=this.graph.model.getConnectedEdges(C,{outgoing:"source"===o,incoming:"target"===o});if(A.length)if("withPort"===d)A.some((function(e){var t=e.getSource(),n=e.getTarget();return t&&n&&t.cell===w.cell&&n.cell===P.cell&&null!=t.port&&t.port===w.port&&null!=n.port&&n.port===P.port}))&&(b=!1);else if(!d){A.some((function(e){var t=e.getSource(),n=e.getTarget();return t&&n&&t.cell===w.cell&&n.cell===P.cell}))&&(b=!1)}}}return b&&null!=v&&(b=k(v)),b}},{key:"allowConnectToBlank",value:function(e){var t=this.graph,n=t.options.connecting.allowBlank;if("function"!=typeof n)return!!n;var i=t.findViewByCell(e),r=e.getSourceCell(),o=e.getTargetCell(),a=t.findViewByCell(r),s=t.findViewByCell(o);return mn(n,t,{edge:e,edgeView:i,sourceCell:r,targetCell:o,sourceView:a,targetView:s,sourcePort:e.getSourcePortId(),targetPort:e.getTargetPortId(),sourceMagnet:i.sourceMagnet,targetMagnet:i.targetMagnet})}},{key:"validateEdge",value:function(e,t,n){var i=this.graph;if(!this.allowConnectToBlank(e)){var r=e.getSourceCellId(),o=e.getTargetCellId();if(!r||!o)return!1}var a=i.options.connecting.validateEdge;return!a||mn(a,i,{edge:e,type:t,previous:n})}},{key:"arrowheadDragging",value:function(e,t,n,i){i.x=t,i.y=n,i.currentTarget!==e&&(i.currentMagnet&&i.currentView&&i.currentView.unhighlight(i.currentMagnet,{type:"magnetAdsorbed"}),i.currentView=this.graph.findViewByElem(e),i.currentView?(i.currentMagnet=i.currentView.findMagnet(e),i.currentMagnet&&this.validateConnection.apply(this,f(i.getValidateConnectionArgs(i.currentView,i.currentMagnet)).concat([i.currentView.getEdgeTerminal(i.currentMagnet,t,n,this.cell,i.terminalType)]))?i.currentView.highlight(i.currentMagnet,{type:"magnetAdsorbed"}):i.currentMagnet=null):i.currentMagnet=null),i.currentTarget=e,this.cell.prop(i.terminalType,{x:t,y:n},Object.assign(Object.assign({},i.options),{ui:!0}))}},{key:"arrowheadDragged",value:function(e,t,n){var i=e.currentView,r=e.currentMagnet;if(r&&i){i.unhighlight(r,{type:"magnetAdsorbed"});var o=e.terminalType,a=i.getEdgeTerminal(r,t,n,this.cell,o);this.cell.setTerminal(o,a,{ui:!0})}}},{key:"snapArrowhead",value:function(e,t,n){var i=this,r=this.graph,o=r.options.connecting,a=o.snap,s=o.allowEdge,l="object"===b(a)&&a.radius||50,u="object"===b(a)&&a.anchor||"center",c=r.renderer.findViewsInArea({x:e-l,y:t-l,width:2*l,height:2*l},{nodeOnly:!0});if(s){var h=r.renderer.findEdgeViewsFromPoint({x:e,y:t},l).filter((function(e){return e!==i}));c.push.apply(c,f(h))}var g,d=n.closestView||null,v=n.closestMagnet||null;n.closestView=null,n.closestMagnet=null;var p,y=Number.MAX_SAFE_INTEGER,m=new eo(e,t);c.forEach((function(r){if("false"!==r.container.getAttribute("magnet")){if(r.isNodeView())g="center"===u?r.cell.getBBox().getCenter().distance(m):r.cell.getBBox().getNearestPointToPoint(m).distance(m);else if(r.isEdgeView()){var o=r.getClosestPoint(m);g=o?o.distance(m):Number.MAX_SAFE_INTEGER}g<l&&g<y&&(v===r.container||i.validateConnection.apply(i,f(n.getValidateConnectionArgs(r,null)).concat([r.getEdgeTerminal(r.container,e,t,i.cell,n.terminalType)])))&&(y=g,n.closestView=r,n.closestMagnet=r.container)}r.container.querySelectorAll("[magnet]").forEach((function(o){if("false"!==o.getAttribute("magnet")){var a=r.getBBoxOfElement(o);(g=m.distance(a.getCenter()))<l&&g<y&&(v===o||i.validateConnection.apply(i,f(n.getValidateConnectionArgs(r,o)).concat([r.getEdgeTerminal(o,e,t,i.cell,n.terminalType)])))&&(y=g,n.closestView=r,n.closestMagnet=o)}}))}));var k=n.terminalType,x=n.closestView,w=n.closestMagnet,P=v!==w;if(d&&P&&d.unhighlight(v,{type:"magnetAdsorbed"}),x){if(!P)return;x.highlight(w,{type:"magnetAdsorbed"}),p=x.getEdgeTerminal(w,e,t,this.cell,k)}else p={x:e,y:t};this.cell.setTerminal(k,p,{},Object.assign(Object.assign({},n.options),{ui:!0}))}},{key:"snapArrowheadEnd",value:function(e){var t=e.closestView,n=e.closestMagnet;t&&n&&(t.unhighlight(n,{type:"magnetAdsorbed"}),e.currentMagnet=t.findMagnet(n)),e.closestView=null,e.closestMagnet=null}},{key:"finishEmbedding",value:function(e){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(e.zIndex=null)}},{key:"fallbackConnection",value:function(e){if("remove"===e.fallbackAction)this.cell.remove({ui:!0});else this.cell.prop(e.terminalType,e.initialTerminal,{ui:!0})}},{key:"notifyConnectionEvent",value:function(e,t){var n=e.terminalType,i=e.initialTerminal,r=this.cell[n];if(r&&!Fu.equalTerminals(i,r)){var o=this.graph,a=i,s=a.cell?o.getCellById(a.cell):null,l=a.port,u=s?o.findViewByCell(s):null,c=s||e.isNewEdge?null:eo.create(i).toJSON(),h=r,f=h.cell?o.getCellById(h.cell):null,g=h.port,d=f?o.findViewByCell(f):null,v=f?null:eo.create(r).toJSON();this.notify("edge:connected",{e:t,previousCell:s,previousPort:l,previousView:u,previousPoint:c,currentCell:f,currentView:d,currentPort:g,currentPoint:v,previousMagnet:e.initialMagnet,currentMagnet:e.currentMagnet,edge:this.cell,view:this,type:n,isNew:e.isNewEdge})}}},{key:"highlightAvailableMagnets",value:function(e){var t=this,n=this.graph,i=n.model.getCells();e.marked={};for(var r=function(){var r=n.findViewByCell(i[o]);if(!r||r.cell.id===t.cell.id)return 1;var a=Array.prototype.slice.call(r.container.querySelectorAll("[magnet]"));"false"!==r.container.getAttribute("magnet")&&a.push(r.container);var s=a.filter((function(n){return t.validateConnection.apply(t,f(e.getValidateConnectionArgs(r,n)).concat([r.getEdgeTerminal(n,e.x,e.y,t.cell,e.terminalType)]))}));if(s.length>0){for(var l=0,u=s.length;l<u;l+=1)r.highlight(s[l],{type:"magnetAvailable"});r.highlight(null,{type:"nodeAvailable"}),e.marked[r.cell.id]=s}},o=0,a=i.length;o<a;o+=1)r()}},{key:"unhighlightAvailableMagnets",value:function(e){var t=this,n=e.marked||{};Object.keys(n).forEach((function(e){var i=t.graph.findViewByCell(e);i&&(n[e].forEach((function(e){i.unhighlight(e,{type:"magnetAvailable"})})),i.unhighlight(null,{type:"nodeAvailable"}))})),e.marked=null}},{key:"startArrowheadDragging",value:function(e,t,n){if(this.can("arrowheadMovable")){var i=e.target.getAttribute("data-terminal"),r=this.prepareArrowheadDragging(i,{x:t,y:n});this.setEventData(e,r)}else this.notifyUnhandledMouseDown(e,t,n)}},{key:"dragArrowhead",value:function(e,t,n){var i=this.getEventData(e);this.graph.options.connecting.snap?this.snapArrowhead(t,n,i):this.arrowheadDragging(this.getEventTarget(e),t,n,i)}},{key:"stopArrowheadDragging",value:function(e,t,n){var i=this.graph,r=this.getEventData(e);i.options.connecting.snap?this.snapArrowheadEnd(r):this.arrowheadDragged(r,t,n),this.validateEdge(this.cell,r.terminalType,r.initialTerminal)?(this.finishEmbedding(r),this.notifyConnectionEvent(r,e)):this.fallbackConnection(r),this.afterArrowheadDragging(r)}},{key:"startLabelDragging",value:function(e,t,n){if(this.can("edgeLabelMovable")){var i=e.currentTarget,r=parseInt(i.getAttribute("data-index"),10),o=this.getLabelPositionAngle(r),a=this.getLabelPositionArgs(r),s=this.getDefaultLabelPositionArgs(),l=this.mergeLabelPositionArgs(a,s);this.setEventData(e,{index:r,positionAngle:o,positionArgs:l,stopPropagation:!0,action:"drag-label"})}else this.setEventData(e,{stopPropagation:!0});this.graph.view.delegateDragEvents(e,this)}},{key:"dragLabel",value:function(e,t,n){var i=this.getEventData(e),r=this.cell.getLabelAt(i.index),o=nn({},r,{position:this.getLabelPosition(t,n,i.positionAngle,i.positionArgs)});this.cell.setLabelAt(i.index,o)}},{key:"stopLabelDragging",value:function(e,t,n){}}])}(Ws);!function(e){e.toStringTag="X6.".concat(e.name),e.isEdgeView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNodeView&&"function"==typeof i.isEdgeView&&"function"==typeof i.confirmUpdate&&"function"==typeof i.update&&"function"==typeof i.getConnection}}(ic||(ic={})),ic.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],tools:["tools"],vertices:["vertices","update"]}}),ic.registry.register("edge",ic,!0);var rc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},oc=function(e){function t(e){var n;v(this,t),(n=a(this,t)).graph=e;var i=Fs.parseJSONMarkup(t.markup),r=i.selectors,o=i.fragment;return n.background=r.background,n.grid=r.grid,n.svg=r.svg,n.defs=r.defs,n.viewport=r.viewport,n.primer=r.primer,n.stage=r.stage,n.decorator=r.decorator,n.overlay=r.overlay,n.container=n.options.container,n.restore=t.snapshoot(n.container),gi(n.container,n.prefixClassName("graph")),Si(n.container,o),n.delegateEvents(),n}return c(t,e),y(t,[{key:"disposeContainer",get:function(){return!1}},{key:"options",get:function(){return this.graph.options}},{key:"delegateEvents",value:function(){var e=this.constructor;return n(t,"delegateEvents",this,3)([e.events]),this}},{key:"guard",value:function(e,t){return"mousedown"===e.type&&2===e.button||(!(!this.options.guard||!this.options.guard(e,t))||(e.data&&void 0!==e.data.guarded?e.data.guarded:!(t&&t.cell&&Iu.isCell(t.cell))&&(this.svg!==e.target&&this.container!==e.target&&!this.svg.contains(e.target))))}},{key:"findView",value:function(e){return this.graph.findViewByElem(e)}},{key:"onDblClick",value:function(e){this.options.preventDefaultDblClick&&e.preventDefault();var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onDblClick(t,i.x,i.y):this.graph.trigger("blank:dblclick",{e:t,x:i.x,y:i.y})}}},{key:"onClick",value:function(e){if(this.getMouseMovedCount(e)<=this.options.clickThreshold){var t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;var i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onClick(t,i.x,i.y):this.graph.trigger("blank:click",{e:t,x:i.x,y:i.y})}}},{key:"isPreventDefaultContextMenu",value:function(e){var t=this.options.preventDefaultContextMenu;return"function"==typeof t&&(t=mn(t,this.graph,{view:e})),t}},{key:"onContextMenu",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(this.isPreventDefaultContextMenu(n)&&e.preventDefault(),!this.guard(t,n)){var i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onContextMenu(t,i.x,i.y):this.graph.trigger("blank:contextmenu",{e:t,x:i.x,y:i.y})}}},{key:"delegateDragEvents",value:function(e,t){null==e.data&&(e.data={}),this.setEventData(e,{currentView:t||null,mouseMovedCount:0,startPosition:{x:e.clientX,y:e.clientY}});var n=this.constructor;this.delegateDocumentEvents(n.documentEvents,e.data),this.undelegateEvents()}},{key:"getMouseMovedCount",value:function(e){return this.getEventData(e).mouseMovedCount||0}},{key:"onMouseDown",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){this.options.preventDefaultMouseDown&&e.preventDefault();var i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onMouseDown(t,i.x,i.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(t.type)&&e.preventDefault(),this.graph.trigger("blank:mousedown",{e:t,x:i.x,y:i.y})),this.delegateDragEvents(t,n)}}},{key:"onMouseMove",value:function(e){var t=this.getEventData(e),n=t.startPosition;if((!n||n.x!==e.clientX||n.y!==e.clientY)&&(null==t.mouseMovedCount&&(t.mouseMovedCount=0),t.mouseMovedCount+=1,!(t.mouseMovedCount<=this.options.moveThreshold))){var i=this.normalizeEvent(e),r=this.graph.snapToGrid(i.clientX,i.clientY),o=t.currentView;o?o.onMouseMove(i,r.x,r.y):this.graph.trigger("blank:mousemove",{e:i,x:r.x,y:r.y}),this.setEventData(i,t)}}},{key:"onMouseUp",value:function(e){this.undelegateDocumentEvents();var t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY),i=this.getEventData(e).currentView;if(i?i.onMouseUp(t,n.x,n.y):this.graph.trigger("blank:mouseup",{e:t,x:n.x,y:n.y}),!e.isPropagationStopped()){var r=new Dr(e,{type:"click",data:e.data});this.onClick(r)}e.stopImmediatePropagation(),this.delegateEvents()}},{key:"onMouseOver",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n))if(n)n.onMouseOver(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseover",{e:t})}}},{key:"onMouseOut",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n))if(n)n.onMouseOut(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseout",{e:t})}}},{key:"onMouseEnter",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var i=this.graph.findViewByElem(t.relatedTarget);if(n){if(i===n)return;n.onMouseEnter(t)}else{if(i)return;this.graph.trigger("graph:mouseenter",{e:t})}}}},{key:"onMouseLeave",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var i=this.graph.findViewByElem(t.relatedTarget);if(n){if(i===n)return;n.onMouseLeave(t)}else{if(i)return;this.graph.trigger("graph:mouseleave",{e:t})}}}},{key:"onMouseWheel",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var i=t.originalEvent,r=this.graph.snapToGrid(i.clientX,i.clientY),o=Math.max(-1,Math.min(1,i.wheelDelta||-i.detail));n?n.onMouseWheel(t,r.x,r.y,o):this.graph.trigger("blank:mousewheel",{e:t,delta:o,x:r.x,y:r.y})}}},{key:"onCustomEvent",value:function(e){var t=e.currentTarget,n=t.getAttribute("event")||t.getAttribute("data-event");if(n){var i=this.findView(t);if(i){var r=this.normalizeEvent(e);if(this.guard(r,i))return;var o=this.graph.snapToGrid(r.clientX,r.clientY);i.onCustomEvent(r,n,o.x,o.y)}}}},{key:"handleMagnetEvent",value:function(e,t){var n=e.currentTarget,i=n.getAttribute("magnet");if(i&&"false"!==i.toLowerCase()){var r=this.findView(n);if(r){var o=this.normalizeEvent(e);if(this.guard(o,r))return;var a=this.graph.snapToGrid(o.clientX,o.clientY);mn(t,this.graph,r,o,n,a.x,a.y)}}}},{key:"onMagnetMouseDown",value:function(e){this.handleMagnetEvent(e,(function(e,t,n,i,r){e.onMagnetMouseDown(t,n,i,r)}))}},{key:"onMagnetDblClick",value:function(e){this.handleMagnetEvent(e,(function(e,t,n,i,r){e.onMagnetDblClick(t,n,i,r)}))}},{key:"onMagnetContextMenu",value:function(e){var t=this.findView(e.target);this.isPreventDefaultContextMenu(t)&&e.preventDefault(),this.handleMagnetEvent(e,(function(e,t,n,i,r){e.onMagnetContextMenu(t,n,i,r)}))}},{key:"onLabelMouseDown",value:function(e){var t=e.currentTarget,n=this.findView(t);if(n){var i=this.normalizeEvent(e);if(this.guard(i,n))return;var r=this.graph.snapToGrid(i.clientX,i.clientY);n.onLabelMouseDown(i,r.x,r.y)}}},{key:"onImageDragStart",value:function(){return!1}},{key:"dispose",value:function(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=function(){}}}])}(zs);rc([zs.dispose()],oc.prototype,"dispose",null),function(e){var t="".concat(fs.prefixCls,"-graph");e.markup=[{ns:bi.xhtml,tagName:"div",selector:"background",className:"".concat(t,"-background")},{ns:bi.xhtml,tagName:"div",selector:"grid",className:"".concat(t,"-grid")},{ns:bi.svg,tagName:"svg",selector:"svg",className:"".concat(t,"-svg"),attrs:{width:"100%",height:"100%","xmlns:xlink":bi.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:"".concat(t,"-svg-viewport"),children:[{tagName:"g",selector:"primer",className:"".concat(t,"-svg-primer")},{tagName:"g",selector:"stage",className:"".concat(t,"-svg-stage")},{tagName:"g",selector:"decorator",className:"".concat(t,"-svg-decorator")},{tagName:"g",selector:"overlay",className:"".concat(t,"-svg-overlay")}]}]}],e.snapshoot=function(e){var t=e.cloneNode();return e.childNodes.forEach((function(e){return t.appendChild(e)})),function(){for(Mi(e);e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);for(var n=0,i=t.attributes.length;n<i;n+=1){var r=t.attributes[n];e.setAttribute(r.name,r.value)}t.childNodes.forEach((function(t){return e.appendChild(t)}))}}}(oc||(oc={})),function(e,t){var n=fs.prefixCls;e.events=(o(o(o(o(o(o(o(o(o(o(t={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel"},"mouseenter  .".concat(n,"-cell"),"onMouseEnter"),"mouseleave  .".concat(n,"-cell"),"onMouseLeave"),"mouseenter  .".concat(n,"-cell-tools"),"onMouseEnter"),"mouseleave  .".concat(n,"-cell-tools"),"onMouseLeave"),"mousedown   .".concat(n,"-cell [event]"),"onCustomEvent"),"touchstart  .".concat(n,"-cell [event]"),"onCustomEvent"),"mousedown   .".concat(n,"-cell [data-event]"),"onCustomEvent"),"touchstart  .".concat(n,"-cell [data-event]"),"onCustomEvent"),"dblclick    .".concat(n,"-cell [magnet]"),"onMagnetDblClick"),"contextmenu .".concat(n,"-cell [magnet]"),"onMagnetContextMenu"),o(o(o(o(o(o(o(o(o(t,"mousedown   .".concat(n,"-cell [magnet]"),"onMagnetMouseDown"),"touchstart  .".concat(n,"-cell [magnet]"),"onMagnetMouseDown"),"dblclick    .".concat(n,"-cell [data-magnet]"),"onMagnetDblClick"),"contextmenu .".concat(n,"-cell [data-magnet]"),"onMagnetContextMenu"),"mousedown   .".concat(n,"-cell [data-magnet]"),"onMagnetMouseDown"),"touchstart  .".concat(n,"-cell [data-magnet]"),"onMagnetMouseDown"),"dragstart   .".concat(n,"-cell image"),"onImageDragStart"),"mousedown   .".concat(n,"-edge .").concat(n,"-edge-label"),"onLabelMouseDown"),"touchstart  .".concat(n,"-edge .").concat(n,"-edge-label"),"onLabelMouseDown")),e.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(oc||(oc={}));var ac=function(e){function t(e){var n;return v(this,t),(n=a(this,t)).graph=e,n.init(),n}return c(t,e),y(t,[{key:"options",get:function(){return this.graph.options}},{key:"model",get:function(){return this.graph.model}},{key:"view",get:function(){return this.graph.view}},{key:"init",value:function(){}}])}(vn),sc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},lc=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"init",value:function(){!function(e,t){var n=Qr.find((function(t){return t.name===e}));if(!(n&&(n.loadTimes+=1,n.loadTimes>1)||qn.isApplyingHMR())){var i=document.createElement("style");i.setAttribute("type","text/css"),i.textContent=t;var r=document.querySelector("head");r&&r.insertBefore(i,r.firstChild),Qr.push({name:e,loadTimes:1,styleElement:i})}}("core",".x6-graph {\n  position: relative;\n  overflow: hidden;\n  outline: none;\n  touch-action: none;\n}\n.x6-graph-background,\n.x6-graph-grid,\n.x6-graph-svg {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-background-stage,\n.x6-graph-grid-stage,\n.x6-graph-svg-stage {\n  user-select: none;\n}\n.x6-graph.x6-graph-pannable {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n.x6-graph.x6-graph-panning {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  user-select: none;\n}\n.x6-node {\n  cursor: move;\n  /* stylelint-disable-next-line */\n}\n.x6-node.x6-node-immovable {\n  cursor: default;\n}\n.x6-node * {\n  -webkit-user-drag: none;\n}\n.x6-node .scalable * {\n  vector-effect: non-scaling-stroke;\n}\n.x6-node [magnet='true'] {\n  cursor: crosshair;\n  transition: opacity 0.3s;\n}\n.x6-node [magnet='true']:hover {\n  opacity: 0.7;\n}\n.x6-node foreignObject {\n  display: block;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-node foreignObject > body {\n  position: static;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-edge .source-marker,\n.x6-edge .target-marker {\n  vector-effect: non-scaling-stroke;\n}\n.x6-edge .connection {\n  stroke-linejoin: round;\n  fill: none;\n}\n.x6-edge .connection-wrap {\n  cursor: move;\n  opacity: 0;\n  fill: none;\n  stroke: #000;\n  stroke-width: 15;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n}\n.x6-edge .connection-wrap:hover {\n  opacity: 0.4;\n  stroke-opacity: 0.4;\n}\n.x6-edge .vertices {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .vertices .vertex {\n  fill: #1abc9c;\n}\n.x6-edge .vertices .vertex :hover {\n  fill: #34495e;\n  stroke: none;\n}\n.x6-edge .vertices .vertex-remove {\n  cursor: pointer;\n  fill: #fff;\n}\n.x6-edge .vertices .vertex-remove-area {\n  cursor: pointer;\n  opacity: 0.1;\n}\n.x6-edge .vertices .vertex-group:hover .vertex-remove-area {\n  opacity: 1;\n}\n.x6-edge .arrowheads {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .arrowheads .arrowhead {\n  fill: #1abc9c;\n}\n.x6-edge .arrowheads .arrowhead :hover {\n  fill: #f39c12;\n  stroke: none;\n}\n.x6-edge .tools {\n  cursor: pointer;\n  opacity: 0;\n}\n.x6-edge .tools .tool-options {\n  display: none;\n}\n.x6-edge .tools .tool-remove circle {\n  fill: #f00;\n}\n.x6-edge .tools .tool-remove path {\n  fill: #fff;\n}\n.x6-edge:hover .vertices,\n.x6-edge:hover .arrowheads,\n.x6-edge:hover .tools {\n  opacity: 1;\n}\n.x6-highlight-opacity {\n  opacity: 0.3;\n}\n.x6-cell-tool-editor {\n  position: relative;\n  display: inline-block;\n  min-height: 1em;\n  margin: 0;\n  padding: 0;\n  line-height: 1;\n  white-space: normal;\n  text-align: center;\n  vertical-align: top;\n  overflow-wrap: normal;\n  outline: none;\n  transform-origin: 0 0;\n  -webkit-user-drag: none;\n}\n.x6-edge-tool-editor {\n  border: 1px solid #275fc5;\n  border-radius: 2px;\n}\n")}},{key:"dispose",value:function(){!function(e){var t=Qr.findIndex((function(t){return t.name===e}));if(t>-1){var n=Qr[t];if(n.loadTimes-=1,n.loadTimes>0)return;var i=n.styleElement;i&&i.parentNode&&i.parentNode.removeChild(i),i=null,Qr.splice(t,1)}}("core")}}])}(ac);sc([lc.dispose()],lc.prototype,"dispose",null);var uc,cc=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};!function(e){e.get=function(t){var n=t.grid,i=(t.panning,t.mousewheel,t.embedding,cc(t,["grid","panning","mousewheel","embedding"])),r=t.container;if(null==r)throw new Error("Ensure the container of the graph is specified and valid");null==i.width&&(i.width=r.clientWidth),null==i.height&&(i.height=r.clientHeight);var o=nn({},e.defaults,i),a={size:10,visible:!1};return o.grid="number"==typeof n?{size:n,visible:!1}:"boolean"==typeof n?Object.assign(Object.assign({},a),{visible:n}):Object.assign(Object.assign({},a),n),["panning","mousewheel","embedding"].forEach((function(e){var n=t[e];"boolean"==typeof n?o[e].enabled=n:o[e]=Object.assign(Object.assign({},o[e]),n)})),o}}(uc||(uc={})),function(e){e.defaults={x:0,y:0,scaling:{min:.01,max:16},grid:{size:10,visible:!1},background:!1,panning:{enabled:!1,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:fs.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:fs.prefix("available-magnet")}}},connecting:{snap:!1,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,allowBlank:!0,allowMulti:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",router:"normal",connector:"normal",validateConnection:function(e){var t=e.type,n=e.sourceView,i=e.targetView;return null!=("target"===t?i:n)},createEdge:function(){return new Zu}},translating:{restrict:!1},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:function(){return!0}},moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},async:!0,virtual:!1,guard:function(){return!1}}}(uc||(uc={}));var hc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},fc=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},gc=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"elem",get:function(){return this.view.grid}},{key:"grid",get:function(){return this.options.grid}},{key:"init",value:function(){this.startListening(),this.draw(this.grid)}},{key:"startListening",value:function(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}},{key:"stopListening",value:function(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}},{key:"setVisible",value:function(e){this.grid.visible!==e&&(this.grid.visible=e,this.update())}},{key:"getGridSize",value:function(){return this.grid.size}},{key:"setGridSize",value:function(e){this.grid.size=Math.max(e,1),this.update()}},{key:"show",value:function(){this.setVisible(!0),this.update()}},{key:"hide",value:function(){this.setVisible(!1),this.update()}},{key:"clear",value:function(){this.elem.style.backgroundImage=""}},{key:"draw",value:function(e){this.clear(),this.instance=null,Object.assign(this.grid,e),this.patterns=this.resolveGrid(e),this.update()}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.grid.size;if(t<=1||!this.grid.visible)return this.clear();var n=this.graph.matrix(),i=this.getInstance(),r=Array.isArray(e)?e:[e];this.patterns.forEach((function(e,o){var a="pattern_".concat(o),s=n.a||1,l=n.d||1,u=e.update,c=e.markup,h=fc(e,["update","markup"]),f=Object.assign(Object.assign(Object.assign({},h),r[o]),{sx:s,sy:l,ox:n.e||0,oy:n.f||0,width:t*s,height:t*l});i.has(a)||i.add(a,ir.create("pattern",{id:a,patternUnits:"userSpaceOnUse"},ir.createVectors(c)).node);var g=i.get(a);"function"==typeof u&&u(g.childNodes[0],f);var d=f.ox%f.width;d<0&&(d+=f.width);var v=f.oy%f.height;v<0&&(v+=f.height),Bi(g,{x:d,y:v,width:f.width,height:f.height})}));var o=(new XMLSerializer).serializeToString(i.root),a="url(data:image/svg+xml;base64,".concat(btoa(o),")");this.elem.style.backgroundImage=a}},{key:"getInstance",value:function(){return this.instance||(this.instance=new No),this.instance}},{key:"resolveGrid",value:function(e){if(!e)return[];var t=e.type;if(null==t)return[Object.assign(Object.assign({},No.presets.dot),e.args)];var n=No.registry.get(t);if(n){var i=e.args||[];return Array.isArray(i)||(i=[i]),Array.isArray(n)?n.map((function(e,t){return Object.assign(Object.assign({},e),i[t])})):[Object.assign(Object.assign({},n),i[0])]}return No.registry.onNotFound(t)}},{key:"dispose",value:function(){this.stopListening(),this.clear()}}])}(ac);hc([ac.dispose()],gc.prototype,"dispose",null);var dc=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"container",get:function(){return this.graph.view.container}},{key:"viewport",get:function(){return this.graph.view.viewport}},{key:"stage",get:function(){return this.graph.view.stage}},{key:"init",value:function(){this.resize()}},{key:"getMatrix",value:function(){var e=this.viewport.getAttribute("transform");return e!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=e),Pr(this.viewportMatrix)}},{key:"setMatrix",value:function(e){var t=Pr(e),n=Or(t);this.viewport.setAttribute("transform",n),this.viewportMatrix=t,this.viewportTransformString=n}},{key:"resize",value:function(e,t){var n=void 0===e?this.options.width:e,i=void 0===t?this.options.height:t;this.options.width=n,this.options.height=i,"number"==typeof n&&(n=Math.round(n)),"number"==typeof i&&(i=Math.round(i)),this.container.style.width=null==n?"":"".concat(n,"px"),this.container.style.height=null==i?"":"".concat(i,"px");var r=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},r)),this}},{key:"getComputedSize",value:function(){var e=this.options.width,t=this.options.height;return Le(e)||(e=this.container.clientWidth),Le(t)||(t=this.container.clientHeight),{width:e,height:t}}},{key:"getScale",value:function(){return(e=this.getMatrix())?(t=null==e.a?1:e.a,r=null==e.d?1:e.d,n=e.b,i=e.c):t=r=1,{sx:n?Math.sqrt(t*t+n*n):t,sy:i?Math.sqrt(i*i+r*r):r};var e,t,n,i,r}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e=this.clampScale(e),t=this.clampScale(t),n||i){var r=this.getTranslation(),o=r.tx-n*(e-1),a=r.ty-i*(t-1);o===r.tx&&a===r.ty||this.translate(o,a)}var s=this.getMatrix();return s.a=e,s.d=t,this.setMatrix(s),this.graph.trigger("scale",{sx:e,sy:t,ox:n,oy:i}),this}},{key:"clampScale",value:function(e){var t=this.graph.options.scaling;return It(e,t.min||.01,t.max||16)}},{key:"getZoom",value:function(){return this.getScale().sx}},{key:"zoom",value:function(e,t){t=t||{};var n=e,i=e,r=this.getScale(),o=this.getComputedSize(),a=o.width/2,s=o.height/2;if(t.absolute||(n+=r.sx,i+=r.sy),t.scaleGrid&&(n=Math.round(n/t.scaleGrid)*t.scaleGrid,i=Math.round(i/t.scaleGrid)*t.scaleGrid),t.maxScale&&(n=Math.min(t.maxScale,n),i=Math.min(t.maxScale,i)),t.minScale&&(n=Math.max(t.minScale,n),i=Math.max(t.minScale,i)),t.center&&(a=t.center.x,s=t.center.y),n=this.clampScale(n),i=this.clampScale(i),a||s){var l=this.getTranslation(),u=a-(a-l.tx)*(n/r.sx),c=s-(s-l.ty)*(i/r.sy);u===l.tx&&c===l.ty||this.translate(u,c)}return this.scale(n,i),this}},{key:"getRotation",value:function(){return function(e){var t={x:0,y:1};e&&(t=Mr(e,t));var n=180*Math.atan2(t.y,t.x)/Math.PI%360-90;return{angle:n%360+(n<0?360:0)}}(this.getMatrix())}},{key:"rotate",value:function(e,t,n){if(null==t||null==n){var i=hs.getBBox(this.stage);t=i.width/2,n=i.height/2}var r=this.getMatrix().translate(t,n).rotate(e).translate(-t,-n);return this.setMatrix(r),this}},{key:"getTranslation",value:function(){return{tx:(e=this.getMatrix())&&e.e||0,ty:e&&e.f||0};var e}},{key:"translate",value:function(e,t){var n=this.getMatrix();n.e=e||0,n.f=t||0,this.setMatrix(n);var i=this.getTranslation();return this.options.x=i.tx,this.options.y=i.ty,this.graph.trigger("translate",Object.assign({},i)),this}},{key:"setOrigin",value:function(e,t){return this.translate(e||0,t||0)}},{key:"fitToContent",value:function(e,t,n,i){if("object"===b(e)){var r=e;e=r.gridWidth||1,t=r.gridHeight||1,n=r.padding||0,i=r}else e=e||1,t=t||1,n=n||0,null==i&&(i={});var o=Gn(n),a=i.border||0,s=i.contentArea?to.create(i.contentArea):this.getContentArea(i);a>0&&s.inflate(a);var l=this.getScale(),u=this.getTranslation(),c=l.sx,h=l.sy;s.x*=c,s.y*=h,s.width*=c,s.height*=h;var f=Math.max(Math.ceil((s.width+s.x)/e),1)*e,g=Math.max(Math.ceil((s.height+s.y)/t),1)*t,d=0,v=0;("negative"===i.allowNewOrigin&&s.x<0||"positive"===i.allowNewOrigin&&s.x>=0||"any"===i.allowNewOrigin)&&(d=Math.ceil(-s.x/e)*e,f+=d+=o.left),("negative"===i.allowNewOrigin&&s.y<0||"positive"===i.allowNewOrigin&&s.y>=0||"any"===i.allowNewOrigin)&&(v=Math.ceil(-s.y/t)*t,g+=v+=o.top),f+=o.right,g+=o.bottom,f=Math.max(f,i.minWidth||0),g=Math.max(g,i.minHeight||0),f=Math.min(f,i.maxWidth||Number.MAX_SAFE_INTEGER),g=Math.min(g,i.maxHeight||Number.MAX_SAFE_INTEGER);var p=this.getComputedSize(),y=f!==p.width||g!==p.height;return(d!==u.tx||v!==u.ty)&&this.translate(d,v),y&&this.resize(f,g),new to(-d/c,-v/h,f/c,g/h)}},{key:"scaleContentToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scaleContentToFitImpl(e)}},{key:"scaleContentToFitImpl",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(n.contentArea){var r=n.contentArea;e=this.graph.localToGraph(r),t=eo.create(r)}else e=this.getContentBBox(n),t=this.graph.graphToLocal(e);if(e.width&&e.height){var o,a=Gn(n.padding),s=n.minScale||0,l=n.maxScale||Number.MAX_SAFE_INTEGER,u=n.minScaleX||s,c=n.maxScaleX||l,h=n.minScaleY||s,f=n.maxScaleY||l;if(n.viewportArea)o=n.viewportArea;else{var g=this.getComputedSize(),d=this.getTranslation();o={x:d.tx,y:d.ty,width:g.width,height:g.height}}o=to.create(o).moveAndExpand({x:a.left,y:a.top,width:-a.left-a.right,height:-a.top-a.bottom});var v=this.getScale(),p=o.width/e.width*v.sx,y=o.height/e.height*v.sy;!1!==n.preserveAspectRatio&&(p=y=Math.min(p,y));var m=n.scaleGrid;if(m&&(p=m*Math.floor(p/m),y=m*Math.floor(y/m)),p=It(p,u,c),y=It(y,h,f),this.scale(p,y),i){var b=this.options,k=o.x-t.x*p-b.x,x=o.y-t.y*y-b.y;this.translate(k,x)}}}},{key:"getContentArea",value:function(){return!1!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).useCellGeometry?this.model.getAllCellsBBox()||new to:hs.getBBox(this.stage)}},{key:"getContentBBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.graph.localToGraph(this.getContentArea(e))}},{key:"getGraphArea",value:function(){var e=to.fromSize(this.getComputedSize());return this.graph.graphToLocal(e)}},{key:"zoomToRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=to.create(e),i=this.graph;t.contentArea=n,null==t.viewportArea&&(t.viewportArea={x:i.options.x,y:i.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(t,!1);var r=n.getCenter();return this.centerPoint(r.x,r.y),this}},{key:"zoomToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.zoomToRect(this.getContentArea(e),e)}},{key:"centerPoint",value:function(e,t){var n=this.getComputedSize(),i=this.getScale(),r=this.getTranslation(),o=n.width/2,a=n.height/2;t="number"==typeof t?t:a,e=o-(e="number"==typeof e?e:o)*i.sx,t=a-t*i.sy,r.tx===e&&r.ty===t||this.translate(e,t)}},{key:"centerContent",value:function(e){var t=this.graph.getContentArea(e).getCenter();this.centerPoint(t.x,t.y)}},{key:"centerCell",value:function(e){return this.positionCell(e,"center")}},{key:"positionPoint",value:function(e,t,n){var i=this.getComputedSize();(t=Fn(t,Math.max(0,i.width)))<0&&(t=i.width+t),(n=Fn(n,Math.max(0,i.height)))<0&&(n=i.height+n);var r=this.getTranslation(),o=this.getScale(),a=t-e.x*o.sx,s=n-e.y*o.sy;r.tx===a&&r.ty===s||this.translate(a,s)}},{key:"positionRect",value:function(e,t){var n=to.create(e);switch(t){case"center":return this.positionPoint(n.getCenter(),"50%","50%");case"top":return this.positionPoint(n.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(n.getTopRight(),"100%",0);case"right":return this.positionPoint(n.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(n.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(n.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(n.getBottomLeft(),0,"100%");case"left":return this.positionPoint(n.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(n.getTopLeft(),0,0);default:return this}}},{key:"positionCell",value:function(e,t){var n=e.getBBox();return this.positionRect(n,t)}},{key:"positionContent",value:function(e,t){var n=this.graph.getContentArea(t);return this.positionRect(n,e)}}])}(ac),vc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},pc=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"elem",get:function(){return this.view.background}},{key:"init",value:function(){this.startListening(),this.options.background&&this.draw(this.options.background)}},{key:"startListening",value:function(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}},{key:"stopListening",value:function(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}},{key:"updateBackgroundImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.size||"auto auto",n=e.position||"center",i=this.graph.transform.getScale(),r=this.graph.translate();if("object"===b(n)){var o=r.tx+i.sx*(n.x||0),a=r.ty+i.sy*(n.y||0);n="".concat(o,"px ").concat(a,"px")}"object"===b(t)&&(t=to.fromSize(t).scale(i.sx,i.sy),t="".concat(t.width,"px ").concat(t.height,"px")),this.elem.style.backgroundSize=t,this.elem.style.backgroundPosition=n}},{key:"drawBackgroundImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e instanceof HTMLImageElement){var n=this.optionsCache;if(!n||n.image===t.image){var i,r=t.opacity,o=t.size,a=t.repeat||"no-repeat",s=jo.registry.get(a);if("function"==typeof s){var l=t.quality||1;e.width*=l,e.height*=l;var u=s(e,t);if(!(u instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");i=u.toDataURL("image/png"),a=t.repeat&&a!==t.repeat?t.repeat:"repeat","object"===b(o)?(o.width*=u.width/e.width,o.height*=u.height/e.height):void 0===o&&(t.size={width:u.width/l,height:u.height/l})}else i=e.src,void 0===o&&(t.size={width:e.width,height:e.height});null!=n&&"object"===b(t.size)&&t.image===n.image&&t.repeat===n.repeat&&t.quality===n.quality&&(n.size=Rt(t.size));var c=this.elem.style;c.backgroundImage="url(".concat(i,")"),c.backgroundRepeat=a,c.opacity=null==r||r>=1?"":"".concat(r),this.updateBackgroundImage(t)}}else this.elem.style.backgroundImage=""}},{key:"updateBackgroundColor",value:function(e){this.elem.style.backgroundColor=e||""}},{key:"updateBackgroundOptions",value:function(e){this.graph.options.background=e}},{key:"update",value:function(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}},{key:"draw",value:function(e){var t=this,n=e||{};if(this.updateBackgroundOptions(e),this.updateBackgroundColor(n.color),n.image){this.optionsCache=Rt(n);var i=document.createElement("img");i.onload=function(){return t.drawBackgroundImage(i,e)},i.setAttribute("crossorigin","anonymous"),i.src=n.image}else this.drawBackgroundImage(null),this.optionsCache=null}},{key:"clear",value:function(){this.draw()}},{key:"dispose",value:function(){this.clear(),this.stopListening()}}])}(ac);vc([ac.dispose()],pc.prototype,"dispose",null);var yc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},mc=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"widgetOptions",get:function(){return this.options.panning}},{key:"pannable",get:function(){return this.widgetOptions&&!0===this.widgetOptions.enabled}},{key:"init",value:function(){this.onRightMouseDown=this.onRightMouseDown.bind(this),this.onSpaceKeyDown=this.onSpaceKeyDown.bind(this),this.onSpaceKeyUp=this.onSpaceKeyUp.bind(this),this.startListening(),this.updateClassName()}},{key:"startListening",value:function(){this.graph.on("blank:mousedown",this.onMouseDown,this),this.graph.on("node:unhandled:mousedown",this.onMouseDown,this),this.graph.on("edge:unhandled:mousedown",this.onMouseDown,this),Rr.on(this.graph.container,"mousedown",this.onRightMouseDown),Rr.on(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle=new zr(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()}},{key:"stopListening",value:function(){this.graph.off("blank:mousedown",this.onMouseDown,this),this.graph.off("node:unhandled:mousedown",this.onMouseDown,this),this.graph.off("edge:unhandled:mousedown",this.onMouseDown,this),Rr.off(this.graph.container,"mousedown",this.onRightMouseDown),Rr.off(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle&&this.mousewheelHandle.disable()}},{key:"allowPanning",value:function(e,t){return e.spaceKey=this.isSpaceKeyPressed,this.pannable&&Wr.isMatch(e,this.widgetOptions.modifiers,t)}},{key:"startPanning",value:function(e){var t=this.view.normalizeEvent(e);this.clientX=t.clientX,this.clientY=t.clientY,this.panning=!0,this.updateClassName(),Rr.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),Rr.on(window,"mouseup.panning",this.stopPanning.bind(this))}},{key:"pan",value:function(e){var t=this.view.normalizeEvent(e),n=t.clientX-this.clientX,i=t.clientY-this.clientY;this.clientX=t.clientX,this.clientY=t.clientY,this.graph.translateBy(n,i)}},{key:"stopPanning",value:function(e){this.panning=!1,this.updateClassName(),Rr.off(document.body,".panning"),Rr.off(window,".panning")}},{key:"updateClassName",value:function(){var e=this.view.container,t=this.view.prefixClassName("graph-panning"),n=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(gi(e,t),di(e,n)):(di(e,t),gi(e,n)):(di(e,t),di(e,n))}},{key:"onMouseDown",value:function(e){var t=e.e;if(this.allowBlankMouseDown(t)){var n=this.graph.getPlugin("selection"),i=n&&n.allowRubberband(t,!0);(this.allowPanning(t,!0)||this.allowPanning(t)&&!i)&&this.startPanning(t)}}},{key:"onRightMouseDown",value:function(e){var t=this.widgetOptions.eventTypes;(null==t?void 0:t.includes("rightMouseDown"))&&2===e.button&&this.allowPanning(e,!0)&&this.startPanning(e)}},{key:"onMouseWheel",value:function(e,t,n){this.graph.translateBy(-t,-n)}},{key:"onSpaceKeyDown",value:function(e){32===e.which&&(this.isSpaceKeyPressed=!0)}},{key:"onSpaceKeyUp",value:function(e){32===e.which&&(this.isSpaceKeyPressed=!1)}},{key:"allowBlankMouseDown",value:function(e){var t=this.widgetOptions.eventTypes;return(null==t?void 0:t.includes("leftMouseDown"))&&0===e.button||(null==t?void 0:t.includes("mouseWheelDown"))&&1===e.button}},{key:"allowMouseWheel",value:function(e){var t;return this.pannable&&!e.ctrlKey&&(null===(t=this.widgetOptions.eventTypes)||void 0===t?void 0:t.includes("mouseWheel"))}},{key:"autoPanning",value:function(e,t){var n=10,i=this.graph.getGraphArea(),r=0,o=0;e<=i.left+n&&(r=-10),t<=i.top+n&&(o=-10),e>=i.right-n&&(r=n),t>=i.bottom-n&&(o=n),0===r&&0===o||this.graph.translateBy(-r,-o)}},{key:"enablePanning",value:function(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}},{key:"disablePanning",value:function(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}},{key:"dispose",value:function(){this.stopListening()}}])}(ac);yc([ac.dispose()],mc.prototype,"dispose",null);var bc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},kc=function(e){function t(){var e;return v(this,t),(e=a(this,t,arguments)).cumulatedFactor=1,e}return c(t,e),y(t,[{key:"widgetOptions",get:function(){return this.options.mousewheel}},{key:"init",value:function(){this.container=this.graph.container,this.target=this.widgetOptions.global?document:this.container,this.mousewheelHandle=new zr(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.widgetOptions.enabled&&this.enable(!0)}},{key:"disabled",get:function(){return!0!==this.widgetOptions.enabled}},{key:"enable",value:function(e){(this.disabled||e)&&(this.widgetOptions.enabled=!0,this.mousewheelHandle.enable())}},{key:"disable",value:function(){this.disabled||(this.widgetOptions.enabled=!1,this.mousewheelHandle.disable())}},{key:"allowMouseWheel",value:function(e){var t=this.widgetOptions.guard;return(null==t||t(e))&&Wr.isMatch(e,this.widgetOptions.modifiers)}},{key:"onMouseWheel",value:function(e){var t=this.widgetOptions.guard;if((null==t||t(e))&&Wr.isMatch(e,this.widgetOptions.modifiers)){var n=this.widgetOptions.factor||1.2;null==this.currentScale&&(this.startPos={x:e.clientX,y:e.clientY},this.currentScale=this.graph.transform.getScale().sx),e.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*n*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=1.05)):this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*(1/n)*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=.95)),this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);var i=this.currentScale,r=this.graph.transform.clampScale(i*this.cumulatedFactor);if((r=It(r,this.widgetOptions.minScale||Number.MIN_SAFE_INTEGER,this.widgetOptions.maxScale||Number.MAX_SAFE_INTEGER))!==i)if(this.widgetOptions.zoomAtMousePosition){var o=!!this.graph.getPlugin("scroller")?this.graph.clientToLocal(this.startPos):this.graph.clientToGraph(this.startPos);this.graph.zoom(r,{absolute:!0,center:o.clone()})}else this.graph.zoom(r,{absolute:!0});this.currentScale=null,this.cumulatedFactor=1}}},{key:"dispose",value:function(){this.disable()}}])}(ac);bc([vn.dispose()],kc.prototype,"dispose",null);var xc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},wc=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"init",value:function(){this.resetRenderArea=ne(this.resetRenderArea,200,{leading:!0}),this.resetRenderArea(),this.startListening()}},{key:"startListening",value:function(){this.graph.on("translate",this.resetRenderArea,this),this.graph.on("scale",this.resetRenderArea,this),this.graph.on("resize",this.resetRenderArea,this)}},{key:"stopListening",value:function(){this.graph.off("translate",this.resetRenderArea,this),this.graph.off("scale",this.resetRenderArea,this),this.graph.off("resize",this.resetRenderArea,this)}},{key:"enableVirtualRender",value:function(){this.options.virtual=!0,this.resetRenderArea()}},{key:"disableVirtualRender",value:function(){this.options.virtual=!1,this.graph.renderer.setRenderArea(void 0)}},{key:"resetRenderArea",value:function(){if(this.options.virtual){var e=this.graph.getGraphArea();this.graph.renderer.setRenderArea(e)}}},{key:"dispose",value:function(){this.stopListening()}}])}(ac);xc([ac.dispose()],wc.prototype,"dispose",null);var Pc,Cc=function(){return y((function e(){v(this,e),this.isFlushing=!1,this.isFlushPending=!1,this.scheduleId=0,this.queue=[],this.frameInterval=33,this.initialTime=Date.now()}),[{key:"queueJob",value:function(e){if(e.priority&Pc.PRIOR)e.cb();else{var t=this.findInsertionIndex(e);t>=0&&this.queue.splice(t,0,e)}}},{key:"queueFlush",value:function(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.scheduleJob())}},{key:"queueFlushSync",value:function(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.flushJobsSync())}},{key:"clearJobs",value:function(){this.queue.length=0,this.isFlushing=!1,this.isFlushPending=!1,this.cancelScheduleJob()}},{key:"flushJobs",value:function(){this.isFlushPending=!1,this.isFlushing=!0;for(var e,t=this.getCurrentTime();(e=this.queue.shift())&&(e.cb(),!(this.getCurrentTime()-t>=this.frameInterval)););this.isFlushing=!1,this.queue.length&&this.queueFlush()}},{key:"flushJobsSync",value:function(){var e;for(this.isFlushPending=!1,this.isFlushing=!0;e=this.queue.shift();)try{e.cb()}catch(t){}this.isFlushing=!1}},{key:"findInsertionIndex",value:function(e){for(var t=0,n=this.queue.length,i=n-1,r=e.priority;t<=i;){var o=(i-t>>1)+t;r<=this.queue[o].priority?t=o+1:(n=o,i=o-1)}return n}},{key:"scheduleJob",value:function(){"requestIdleCallback"in window?(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.requestIdleCallback(this.flushJobs.bind(this),{timeout:100})):(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.setTimeout(this.flushJobs.bind(this)))}},{key:"cancelScheduleJob",value:function(){"cancelIdleCallback"in window?(this.scheduleId&&window.cancelIdleCallback(this.scheduleId),this.scheduleId=0):(this.scheduleId&&clearTimeout(this.scheduleId),this.scheduleId=0)}},{key:"getCurrentTime",value:function(){return"object"===("undefined"==typeof performance?"undefined":b(performance))&&"function"==typeof performance.now?performance.now():Date.now()-this.initialTime}}])}();!function(e){e[e.Update=2]="Update",e[e.RenderEdge=4]="RenderEdge",e[e.RenderNode=8]="RenderNode",e[e.PRIOR=1048576]="PRIOR"}(Pc||(Pc={}));var Ac=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Oc=function(e){function t(e){var n;return v(this,t),(n=a(this,t)).views={},n.willRemoveViews={},n.queue=new Cc,n.graph=e,n.init(),n}return c(t,e),y(t,[{key:"model",get:function(){return this.graph.model}},{key:"container",get:function(){return this.graph.view.stage}},{key:"init",value:function(){this.startListening(),this.renderViews(this.model.getCells())}},{key:"startListening",value:function(){this.model.on("reseted",this.onModelReseted,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}},{key:"stopListening",value:function(){this.model.off("reseted",this.onModelReseted,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}},{key:"onModelReseted",value:function(e){var t=e.options;this.queue.clearJobs(),this.removeZPivots(),this.resetViews();var n=this.model.getCells();this.renderViews(n,Object.assign(Object.assign({},t),{queue:n.map((function(e){return e.id}))}))}},{key:"onCellAdded",value:function(e){var t=e.cell,n=e.options;this.renderViews([t],n)}},{key:"onCellRemoved",value:function(e){var t=e.cell;this.removeViews([t])}},{key:"onCellZIndexChanged",value:function(e){var n=e.cell,i=e.options,r=this.views[n.id];r&&this.requestViewUpdate(r.view,t.FLAG_INSERT,i,Pc.Update,!0)}},{key:"onCellVisibleChanged",value:function(e){var t=e.cell,n=e.current;this.toggleVisible(t,!!n)}},{key:"requestViewUpdate",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Pc.Update,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=e.cell.id,s=this.views[a];s&&(s.flag=t,s.options=i,(e.hasAction(t,["translate","resize","rotate"])||!1===i.async)&&(r=Pc.PRIOR,o=!1),this.queue.queueJob({id:a,priority:r,cb:function(){n.renderViewInArea(e,t,i);var r=i.queue;if(r){var o=r.indexOf(e.cell.id);o>=0&&r.splice(o,1),0===r.length&&n.graph.trigger("render:done")}}}),this.getEffectedEdges(e).forEach((function(e){n.requestViewUpdate(e.view,e.flag,i,r,!1)})),o&&this.flush())}},{key:"setRenderArea",value:function(e){this.renderArea=e,this.flushWaitingViews()}},{key:"isViewMounted",value:function(e){if(null==e)return!1;var n=this.views[e.cell.id];return!!n&&n.state===t.ViewState.MOUNTED}},{key:"renderViews",value:function(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.sort((function(e,t){return e.isNode()&&t.isEdge()?-1:0})),e.forEach((function(e){var r=e.id,o=0,a=n.views[r];if(a)o=t.FLAG_INSERT;else{var s=n.createCellView(e);s&&(s.graph=n.graph,o=t.FLAG_INSERT|s.getBootstrapFlag(),a={view:s,flag:o,options:i,state:t.ViewState.CREATED},n.views[r]=a)}a&&n.requestViewUpdate(a.view,o,i,n.getRenderPriority(a.view),!1)})),this.flush()}},{key:"renderViewInArea",value:function(e,n){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e.cell,a=o.id,s=this.views[a];if(s){var l=0;this.isUpdatable(e)||s.state===t.ViewState.MOUNTED?(l=this.updateView(e,n,r),s.flag=l):s.state=t.ViewState.WAITING,l&&(!o.isEdge()||l&e.getFlag(["source","target"])||this.queue.queueJob({id:a,priority:Pc.RenderEdge,cb:function(){i.updateView(e,n,r)}}))}}},{key:"removeViews",value:function(e){var t=this;e.forEach((function(e){var n=e.id,i=t.views[n];i&&(t.willRemoveViews[n]=i,delete t.views[n],t.queue.queueJob({id:n,priority:t.getRenderPriority(i.view),cb:function(){t.removeView(i.view)}}))})),this.flush()}},{key:"flush",value:function(){this.graph.options.async?this.queue.queueFlush():this.queue.queueFlushSync()}},{key:"flushWaitingViews",value:function(){var e=this;Object.values(this.views).forEach((function(n){if(n&&n.state===t.ViewState.WAITING){var i=n.view,r=n.flag,o=n.options;e.requestViewUpdate(i,r,o,e.getRenderPriority(i),!1)}})),this.flush()}},{key:"updateView",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==e)return 0;if(Ws.isCellView(e)){if(n&t.FLAG_REMOVE)return this.removeView(e.cell),0;n&t.FLAG_INSERT&&(this.insertView(e),n^=t.FLAG_INSERT)}return n?e.confirmUpdate(n,i):0}},{key:"insertView",value:function(e){var n=this.views[e.cell.id];if(n){var i=e.cell.getZIndex(),r=this.addZPivot(i);this.container.insertBefore(e.container,r),e.cell.isVisible()||this.toggleVisible(e.cell,!1),n.state=t.ViewState.MOUNTED,this.graph.trigger("view:mounted",{view:e})}}},{key:"resetViews",value:function(){var e=this;this.willRemoveViews=Object.assign(Object.assign({},this.views),this.willRemoveViews),Object.values(this.willRemoveViews).forEach((function(t){t&&e.removeView(t.view)})),this.views={},this.willRemoveViews={}}},{key:"removeView",value:function(e){var t=e.cell,n=this.willRemoveViews[t.id];n&&e&&(n.view.remove(),delete this.willRemoveViews[t.id],this.graph.trigger("view:unmounted",{view:e}))}},{key:"toggleVisible",value:function(e,t){for(var n=this.model.getConnectedEdges(e),i=0,r=n.length;i<r;i+=1){var o=n[i];if(t){var a=o.getSourceCell(),s=o.getTargetCell();if(a&&!a.isVisible()||s&&!s.isVisible())continue;this.toggleVisible(o,!0)}else this.toggleVisible(o,!1)}var l=this.views[e.id];l&&$i(l.view.container,{display:t?"unset":"none"})}},{key:"addZPivot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null==this.zPivots&&(this.zPivots={});var t=this.zPivots,n=t[e];if(n)return n;n=t[e]=document.createComment("z-index:".concat(e+1));var i=-1/0;for(var r in t){var o=+r;o<e&&o>i&&(i=o)}var a=this.container;if(i!==-1/0){var s=t[i];a.insertBefore(n,s.nextSibling)}else a.insertBefore(n,a.firstChild);return n}},{key:"removeZPivots",value:function(){this.zPivots&&Object.values(this.zPivots).forEach((function(e){e&&e.parentNode&&e.parentNode.removeChild(e)})),this.zPivots={}}},{key:"createCellView",value:function(e){var t={graph:this.graph},n=this.graph.options.createCellView;if(n){var i=mn(n,this.graph,e);if(i)return new i(e,t);if(null===i)return null}var r=e.view;if(null!=r&&"string"==typeof r){var o=Ws.registry.get(r);return o?new o(e,t):Ws.registry.onNotFound(r)}return e.isNode()?new tc(e,t):e.isEdge()?new ic(e,t):null}},{key:"getEffectedEdges",value:function(e){for(var t=[],n=e.cell,i=this.model.getConnectedEdges(n),r=0,o=i.length;r<o;r+=1){var a=i[r],s=this.views[a.id];if(s){var l=s.view;if(this.isViewMounted(l)){var u=["update"];a.getTargetCell()===n&&u.push("target"),a.getSourceCell()===n&&u.push("source"),t.push({id:a.id,view:l,flag:l.getFlag(u)})}}}return t}},{key:"isUpdatable",value:function(e){if(e.isNodeView())return!this.renderArea||this.renderArea.isIntersectWithRect(e.cell.getBBox());if(e.isEdgeView()){var t=e.cell,n=t.getSourceCell(),i=t.getTargetCell();if(this.renderArea&&n&&i)return this.renderArea.isIntersectWithRect(n.getBBox())||this.renderArea.isIntersectWithRect(i.getBBox())}return!0}},{key:"getRenderPriority",value:function(e){return e.cell.isNode()?Pc.RenderNode:Pc.RenderEdge}},{key:"dispose",value:function(){var e=this;this.stopListening(),Object.keys(this.views).forEach((function(t){e.views[t].view.dispose()})),this.views={}}}])}(vn);Ac([vn.dispose()],Oc.prototype,"dispose",null),function(e){e.FLAG_INSERT=1<<30,e.FLAG_REMOVE=1<<29,e.FLAG_RENDER=67108863}(Oc||(Oc={})),function(e){var t;(t=e.ViewState||(e.ViewState={}))[t.CREATED=0]="CREATED",t[t.MOUNTED=1]="MOUNTED",t[t.WAITING=2]="WAITING"}(Oc||(Oc={}));var Ec=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Mc=function(e){function t(){var e;return v(this,t),(e=a(this,t,arguments)).schedule=new Oc(e.graph),e}return c(t,e),y(t,[{key:"requestViewUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.schedule.requestViewUpdate(e,t,n)}},{key:"isViewMounted",value:function(e){return this.schedule.isViewMounted(e)}},{key:"setRenderArea",value:function(e){this.schedule.setRenderArea(e)}},{key:"findViewByElem",value:function(e){if(null==e)return null;var t=this.options.container,n="string"==typeof e?t.querySelector(e):e instanceof Element?e:e[0];if(n){var i=this.graph.view.findAttr("data-cell-id",n);if(i){var r=this.schedule.views;if(r[i])return r[i].view}}return null}},{key:"findViewByCell",value:function(e){if(null==e)return null;var t=Iu.isCell(e)?e.id:e,n=this.schedule.views;return n[t]?n[t].view:null}},{key:"findViewsFromPoint",value:function(e){var t=this,n={x:e.x,y:e.y};return this.model.getCells().map((function(e){return t.findViewByCell(e)})).filter((function(e){return null!=e&&hs.getBBox(e.container,{target:t.view.stage}).containsPoint(n)}))}},{key:"findEdgeViewsFromPoint",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return this.model.getEdges().map((function(e){return t.findViewByCell(e)})).filter((function(t){if(null!=t){var i=t.getClosestPoint(e);if(i)return i.distance(e)<=n}return!1}))}},{key:"findViewsInArea",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=to.create(e);return this.model.getCells().map((function(e){return t.findViewByCell(e)})).filter((function(e){if(e){if(n.nodeOnly&&!e.isNodeView())return!1;var r=hs.getBBox(e.container,{target:t.view.stage});return 0===r.width?r.inflate(1,0):0===r.height&&r.inflate(0,1),n.strict?i.containsRect(r):i.isIntersectWithRect(r)}return!1}))}},{key:"dispose",value:function(){this.schedule.dispose()}}])}(ac);Ec([ac.dispose()],Mc.prototype,"dispose",null);var Sc=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Tc=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"cid",get:function(){return this.graph.view.cid}},{key:"svg",get:function(){return this.view.svg}},{key:"defs",get:function(){return this.view.defs}},{key:"isDefined",value:function(e){return null!=this.svg.getElementById(e)}},{key:"filter",value:function(e){var t=e.id,n=e.name;if(t||(t="filter-".concat(n,"-").concat(this.cid,"-").concat(In(JSON.stringify(e)))),!this.isDefined(t)){var i=zo.registry.get(n);if(null==i)return zo.registry.onNotFound(n);var r=i(e.args||{}),o=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},e.attrs),{id:t});ir.create(Fs.sanitize(r),o).appendTo(this.defs)}return t}},{key:"gradient",value:function(e){var t=e.id,n=e.type;if(t||(t="gradient-".concat(n,"-").concat(this.cid,"-").concat(In(JSON.stringify(e)))),!this.isDefined(t)){var i=e.stops.map((function(e){var t=null!=e.opacity&&Number.isFinite(e.opacity)?e.opacity:1;return'<stop offset="'.concat(e.offset,'" stop-color="').concat(e.color,'" stop-opacity="').concat(t,'"/>')})),r="<".concat(n,">").concat(i.join(""),"</").concat(n,">"),o=Object.assign({id:t},e.attrs);ir.create(r,o).appendTo(this.defs)}return t}},{key:"marker",value:function(e){var t=e.id,n=e.refX,i=e.refY,r=e.markerUnits,o=e.markerOrient,a=e.tagName,s=e.children,l=Sc(e,["id","refX","refY","markerUnits","markerOrient","tagName","children"]),u=t;if(u||(u="marker-".concat(this.cid,"-").concat(In(JSON.stringify(e)))),!this.isDefined(u)){"path"!==a&&delete l.d;var c=ir.create("marker",{refX:n,refY:i,id:u,overflow:"visible",orient:null!=o?o:"auto",markerUnits:r||"userSpaceOnUse"},s?s.map((function(e){var t=e.tagName,n=Sc(e,["tagName"]);return ir.create("".concat(t)||"path",Fi(Object.assign(Object.assign({},l),n)))})):[ir.create(a||"path",Fi(l))]);this.defs.appendChild(c.node)}return u}},{key:"remove",value:function(e){var t=this.svg.getElementById(e);t&&t.parentNode&&t.parentNode.removeChild(t)}}])}(ac),Nc=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"getClientMatrix",value:function(){return Pr(this.view.stage.getScreenCTM())}},{key:"getClientOffset",value:function(){var e=this.view.svg.getBoundingClientRect();return new eo(e.left,e.top)}},{key:"getPageOffset",value:function(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}},{key:"snapToGrid",value:function(e,t){return("number"==typeof e?this.clientToLocalPoint(e,t):this.clientToLocalPoint(e.x,e.y)).snapToGrid(this.graph.getGridSize())}},{key:"localToGraphPoint",value:function(e,t){var n=eo.create(e,t);return hs.transformPoint(n,this.graph.matrix())}},{key:"localToClientPoint",value:function(e,t){var n=eo.create(e,t);return hs.transformPoint(n,this.getClientMatrix())}},{key:"localToPagePoint",value:function(e,t){return("number"==typeof e?this.localToGraphPoint(e,t):this.localToGraphPoint(e)).translate(this.getPageOffset())}},{key:"localToGraphRect",value:function(e,t,n,i){var r=to.create(e,t,n,i);return hs.transformRectangle(r,this.graph.matrix())}},{key:"localToClientRect",value:function(e,t,n,i){var r=to.create(e,t,n,i);return hs.transformRectangle(r,this.getClientMatrix())}},{key:"localToPageRect",value:function(e,t,n,i){return("number"==typeof e?this.localToGraphRect(e,t,n,i):this.localToGraphRect(e)).translate(this.getPageOffset())}},{key:"graphToLocalPoint",value:function(e,t){var n=eo.create(e,t);return hs.transformPoint(n,this.graph.matrix().inverse())}},{key:"clientToLocalPoint",value:function(e,t){var n=eo.create(e,t);return hs.transformPoint(n,this.getClientMatrix().inverse())}},{key:"clientToGraphPoint",value:function(e,t){var n=eo.create(e,t);return hs.transformPoint(n,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}},{key:"pageToLocalPoint",value:function(e,t){var n=eo.create(e,t).diff(this.getPageOffset());return this.graphToLocalPoint(n)}},{key:"graphToLocalRect",value:function(e,t,n,i){var r=to.create(e,t,n,i);return hs.transformRectangle(r,this.graph.matrix().inverse())}},{key:"clientToLocalRect",value:function(e,t,n,i){var r=to.create(e,t,n,i);return hs.transformRectangle(r,this.getClientMatrix().inverse())}},{key:"clientToGraphRect",value:function(e,t,n,i){var r=to.create(e,t,n,i);return hs.transformRectangle(r,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}},{key:"pageToLocalRect",value:function(e,t,n,i){var r=to.create(e,t,n,i),o=this.getPageOffset();return r.x-=o.x,r.y-=o.y,this.graphToLocalRect(r)}}])}(ac),jc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Lc=function(e){function t(){var e;return v(this,t),(e=a(this,t,arguments)).highlights={},e}return c(t,e),y(t,[{key:"init",value:function(){this.startListening()}},{key:"startListening",value:function(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}},{key:"stopListening",value:function(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}},{key:"onCellHighlight",value:function(e){var t=e.view,n=e.magnet,i=e.options,r=void 0===i?{}:i,o=this.resolveHighlighter(r);if(o){var a=this.getHighlighterId(n,o);if(!this.highlights[a]){var s=o.highlighter;s.highlight(t,n,Object.assign({},o.args)),this.highlights[a]={cellView:t,magnet:n,highlighter:s,args:o.args}}}}},{key:"onCellUnhighlight",value:function(e){var t=e.magnet,n=e.options,i=void 0===n?{}:n,r=this.resolveHighlighter(i);if(r){var o=this.getHighlighterId(t,r);this.unhighlight(o)}}},{key:"resolveHighlighter",value:function(e){var t=this.options,n=e.highlighter;if(null==n){var i=e.type;n=i&&t.highlighting[i]||t.highlighting.default}if(null==n)return null;var r="string"==typeof n?{name:n}:n,o=r.name,a=ks.registry.get(o);return null==a?ks.registry.onNotFound(o):(ks.check(o,a),{name:o,highlighter:a,args:r.args||{}})}},{key:"getHighlighterId",value:function(e,t){return yi(e),t.name+e.id+JSON.stringify(t.args)}},{key:"unhighlight",value:function(e){var t=this.highlights[e];t&&(t.highlighter.unhighlight(t.cellView,t.magnet,t.args),delete this.highlights[e])}},{key:"dispose",value:function(){var e=this;Object.keys(this.highlights).forEach((function(t){return e.unhighlight(t)})),this.stopListening()}}])}(ac);jc([Lc.dispose()],Lc.prototype,"dispose",null);var Dc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ic=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t,[{key:"getScroller",value:function(){var e=this.graph.getPlugin("scroller");return e&&e.options.enabled?e:null}},{key:"getContainer",value:function(){var e=this.getScroller();return e?e.container.parentElement:this.graph.container.parentElement}},{key:"getSensorTarget",value:function(){var e=this.options.autoResize;if(e)return"boolean"==typeof e?this.getContainer():e}},{key:"init",value:function(){var e=this;if(this.options.autoResize){var t=this.getSensorTarget();t&&Gr.bind(t,(function(){var n=t.offsetWidth,i=t.offsetHeight;e.resize(n,i)}))}}},{key:"resize",value:function(e,t){var n=this.getScroller();n?n.resize(e,t):this.graph.transform.resize(e,t)}},{key:"dispose",value:function(){Gr.clear(this.graph.container)}}])}(ac);Dc([ac.dispose()],Ic.prototype,"dispose",null);var Rc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Vc=function(e){function t(e){var n;return v(this,t),(n=a(this,t)).installedPlugins=new Set,n.options=uc.get(e),n.css=new lc(n),n.view=new oc(n),n.defs=new Tc(n),n.coord=new Nc(n),n.transform=new dc(n),n.highlight=new Lc(n),n.grid=new gc(n),n.background=new pc(n),n.options.model?n.model=n.options.model:(n.model=new _u,n.model.graph=n),n.renderer=new Mc(n),n.panning=new mc(n),n.mousewheel=new kc(n),n.virtualRender=new wc(n),n.size=new Ic(n),n}return c(t,e),y(t,[{key:"container",get:function(){return this.options.container}},{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"isNode",value:function(e){return e.isNode()}},{key:"isEdge",value:function(e){return e.isEdge()}},{key:"resetCells",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.resetCells(e,t),this}},{key:"clearCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.model.clear(e),this}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.model.toJSON(e)}},{key:"parseJSON",value:function(e){return this.model.parseJSON(e)}},{key:"fromJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.fromJSON(e,t),this}},{key:"getCellById",value:function(e){return this.model.getCell(e)}},{key:"addNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.addNode(e,t)}},{key:"addNodes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addCell(e.map((function(e){return Bu.isNode(e)?e:t.createNode(e)})),n)}},{key:"createNode",value:function(e){return this.model.createNode(e)}},{key:"removeNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCell(e,t)}},{key:"addEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.addEdge(e,t)}},{key:"addEdges",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addCell(e.map((function(e){return Fu.isEdge(e)?e:t.createEdge(e)})),n)}},{key:"removeEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCell(e,t)}},{key:"createEdge",value:function(e){return this.model.createEdge(e)}},{key:"addCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.addCell(e,t),this}},{key:"removeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCell(e,t)}},{key:"removeCells",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCells(e,t)}},{key:"removeConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeConnectedEdges(e,t)}},{key:"disconnectConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.disconnectConnectedEdges(e,t),this}},{key:"hasCell",value:function(e){return this.model.has(e)}},{key:"getCells",value:function(){return this.model.getCells()}},{key:"getCellCount",value:function(){return this.model.total()}},{key:"getNodes",value:function(){return this.model.getNodes()}},{key:"getEdges",value:function(){return this.model.getEdges()}},{key:"getOutgoingEdges",value:function(e){return this.model.getOutgoingEdges(e)}},{key:"getIncomingEdges",value:function(e){return this.model.getIncomingEdges(e)}},{key:"getConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getConnectedEdges(e,t)}},{key:"getRootNodes",value:function(){return this.model.getRoots()}},{key:"getLeafNodes",value:function(){return this.model.getLeafs()}},{key:"isRootNode",value:function(e){return this.model.isRoot(e)}},{key:"isLeafNode",value:function(e){return this.model.isLeaf(e)}},{key:"getNeighbors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getNeighbors(e,t)}},{key:"isNeighbor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.isNeighbor(e,t,n)}},{key:"getSuccessors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getSuccessors(e,t)}},{key:"isSuccessor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.isSuccessor(e,t,n)}},{key:"getPredecessors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getPredecessors(e,t)}},{key:"isPredecessor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.isPredecessor(e,t,n)}},{key:"getCommonAncestor",value:function(){var e;return(e=this.model).getCommonAncestor.apply(e,arguments)}},{key:"getSubGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getSubGraph(e,t)}},{key:"cloneSubGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.cloneSubGraph(e,t)}},{key:"cloneCells",value:function(e){return this.model.cloneCells(e)}},{key:"getNodesFromPoint",value:function(e,t){return this.model.getNodesFromPoint(e,t)}},{key:"getNodesInArea",value:function(e,t,n,i,r){return this.model.getNodesInArea(e,t,n,i,r)}},{key:"getNodesUnderNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getNodesUnderNode(e,t)}},{key:"searchCell",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.search(e,t,n),this}},{key:"getShortestPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.getShortestPath(e,t,n)}},{key:"getAllCellsBBox",value:function(){return this.model.getAllCellsBBox()}},{key:"getCellsBBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getCellsBBox(e,t)}},{key:"startBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.model.startBatch(e,t)}},{key:"stopBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.model.stopBatch(e,t)}},{key:"batchUpdate",value:function(e,t,n){var i="string"==typeof e?e:"update",r="string"==typeof e?t:e,o="function"==typeof t?n:t;this.startBatch(i,o);var a=r();return this.stopBatch(i,o),a}},{key:"updateCellId",value:function(e,t){return this.model.updateCellId(e,t)}},{key:"findView",value:function(e){return Iu.isCell(e)?this.findViewByCell(e):this.findViewByElem(e)}},{key:"findViews",value:function(e){return to.isRectangleLike(e)?this.findViewsInArea(e):eo.isPointLike(e)?this.findViewsFromPoint(e):[]}},{key:"findViewByCell",value:function(e){return this.renderer.findViewByCell(e)}},{key:"findViewByElem",value:function(e){return this.renderer.findViewByElem(e)}},{key:"findViewsFromPoint",value:function(e,t){var n="number"==typeof e?{x:e,y:t}:e;return this.renderer.findViewsFromPoint(n)}},{key:"findViewsInArea",value:function(e,t,n,i,r){var o="number"==typeof e?{x:e,y:t,width:n,height:i}:e,a="number"==typeof e?r:t;return this.renderer.findViewsInArea(o,a)}},{key:"matrix",value:function(e){return void 0===e?this.transform.getMatrix():(this.transform.setMatrix(e),this)}},{key:"resize",value:function(e,t){var n=this.getPlugin("scroller");return n?n.resize(e,t):this.transform.resize(e,t),this}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===e?this.transform.getScale():(this.transform.scale(e,t,n,i),this)}},{key:"zoom",value:function(e,t){var n=this.getPlugin("scroller");if(n){if(void 0===e)return n.zoom();n.zoom(e,t)}else{if(void 0===e)return this.transform.getZoom();this.transform.zoom(e,t)}return this}},{key:"zoomTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPlugin("scroller");return n?n.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})):this.transform.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})),this}},{key:"zoomToRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPlugin("scroller");return n?n.zoomToRect(e,t):this.transform.zoomToRect(e,t),this}},{key:"zoomToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getPlugin("scroller");return t?t.zoomToFit(e):this.transform.zoomToFit(e),this}},{key:"rotate",value:function(e,t,n){return void 0===e?this.transform.getRotation():(this.transform.rotate(e,t,n),this)}},{key:"translate",value:function(e,t){return void 0===e?this.transform.getTranslation():(this.transform.translate(e,t),this)}},{key:"translateBy",value:function(e,t){var n=this.translate(),i=n.tx+e,r=n.ty+t;return this.translate(i,r)}},{key:"getGraphArea",value:function(){return this.transform.getGraphArea()}},{key:"getContentArea",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transform.getContentArea(e)}},{key:"getContentBBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transform.getContentBBox(e)}},{key:"fitToContent",value:function(e,t,n,i){return this.transform.fitToContent(e,t,n,i)}},{key:"scaleContentToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transform.scaleContentToFit(e),this}},{key:"center",value:function(e){return this.centerPoint(e)}},{key:"centerPoint",value:function(e,t,n){var i=this.getPlugin("scroller");return i?i.centerPoint(e,t,n):this.transform.centerPoint(e,t),this}},{key:"centerContent",value:function(e){var t=this.getPlugin("scroller");return t?t.centerContent(e):this.transform.centerContent(e),this}},{key:"centerCell",value:function(e,t){var n=this.getPlugin("scroller");return n?n.centerCell(e,t):this.transform.centerCell(e),this}},{key:"positionPoint",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=this.getPlugin("scroller");return r?r.positionPoint(e,t,n,i):this.transform.positionPoint(e,t,n),this}},{key:"positionRect",value:function(e,t,n){var i=this.getPlugin("scroller");return i?i.positionRect(e,t,n):this.transform.positionRect(e,t),this}},{key:"positionCell",value:function(e,t,n){var i=this.getPlugin("scroller");return i?i.positionCell(e,t,n):this.transform.positionCell(e,t),this}},{key:"positionContent",value:function(e,t){var n=this.getPlugin("scroller");return n?n.positionContent(e,t):this.transform.positionContent(e,t),this}},{key:"snapToGrid",value:function(e,t){return this.coord.snapToGrid(e,t)}},{key:"pageToLocal",value:function(e,t,n,i){return to.isRectangleLike(e)?this.coord.pageToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.pageToLocalRect(e,t,n,i):this.coord.pageToLocalPoint(e,t)}},{key:"localToPage",value:function(e,t,n,i){return to.isRectangleLike(e)?this.coord.localToPageRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.localToPageRect(e,t,n,i):this.coord.localToPagePoint(e,t)}},{key:"clientToLocal",value:function(e,t,n,i){return to.isRectangleLike(e)?this.coord.clientToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.clientToLocalRect(e,t,n,i):this.coord.clientToLocalPoint(e,t)}},{key:"localToClient",value:function(e,t,n,i){return to.isRectangleLike(e)?this.coord.localToClientRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.localToClientRect(e,t,n,i):this.coord.localToClientPoint(e,t)}},{key:"localToGraph",value:function(e,t,n,i){return to.isRectangleLike(e)?this.coord.localToGraphRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.localToGraphRect(e,t,n,i):this.coord.localToGraphPoint(e,t)}},{key:"graphToLocal",value:function(e,t,n,i){return to.isRectangleLike(e)?this.coord.graphToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.graphToLocalRect(e,t,n,i):this.coord.graphToLocalPoint(e,t)}},{key:"clientToGraph",value:function(e,t,n,i){return to.isRectangleLike(e)?this.coord.clientToGraphRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.clientToGraphRect(e,t,n,i):this.coord.clientToGraphPoint(e,t)}},{key:"defineFilter",value:function(e){return this.defs.filter(e)}},{key:"defineGradient",value:function(e){return this.defs.gradient(e)}},{key:"defineMarker",value:function(e){return this.defs.marker(e)}},{key:"getGridSize",value:function(){return this.grid.getGridSize()}},{key:"setGridSize",value:function(e){return this.grid.setGridSize(e),this}},{key:"showGrid",value:function(){return this.grid.show(),this}},{key:"hideGrid",value:function(){return this.grid.hide(),this}},{key:"clearGrid",value:function(){return this.grid.clear(),this}},{key:"drawGrid",value:function(e){return this.grid.draw(e),this}},{key:"updateBackground",value:function(){return this.background.update(),this}},{key:"drawBackground",value:function(e,t){var n=this.getPlugin("scroller");return null==n||null!=this.options.background&&t?this.background.draw(e):n.drawBackground(e,t),this}},{key:"clearBackground",value:function(e){var t=this.getPlugin("scroller");return null==t||null!=this.options.background&&e?this.background.clear():t.clearBackground(e),this}},{key:"enableVirtualRender",value:function(){return this.virtualRender.enableVirtualRender(),this}},{key:"disableVirtualRender",value:function(){return this.virtualRender.disableVirtualRender(),this}},{key:"isMouseWheelEnabled",value:function(){return!this.mousewheel.disabled}},{key:"enableMouseWheel",value:function(){return this.mousewheel.enable(),this}},{key:"disableMouseWheel",value:function(){return this.mousewheel.disable(),this}},{key:"toggleMouseWheel",value:function(e){return null==e?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():e?this.enableMouseWheel():this.disableMouseWheel(),this}},{key:"isPannable",value:function(){var e=this.getPlugin("scroller");return e?e.isPannable():this.panning.pannable}},{key:"enablePanning",value:function(){var e=this.getPlugin("scroller");return e?e.enablePanning():this.panning.enablePanning(),this}},{key:"disablePanning",value:function(){var e=this.getPlugin("scroller");return e?e.disablePanning():this.panning.disablePanning(),this}},{key:"togglePanning",value:function(e){return null==e?this.isPannable()?this.disablePanning():this.enablePanning():e!==this.isPannable()&&(e?this.enablePanning():this.disablePanning()),this}},{key:"use",value:function(e){if(!this.installedPlugins.has(e)){this.installedPlugins.add(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];e.init.apply(e,[this].concat(n))}return this}},{key:"getPlugin",value:function(e){return Array.from(this.installedPlugins).find((function(t){return t.name===e}))}},{key:"getPlugins",value:function(e){return Array.from(this.installedPlugins).filter((function(t){return e.includes(t.name)}))}},{key:"enablePlugins",value:function(e){var t=e;Array.isArray(t)||(t=[t]);var n=this.getPlugins(t);return null==n||n.forEach((function(e){var t;null===(t=null==e?void 0:e.enable)||void 0===t||t.call(e)})),this}},{key:"disablePlugins",value:function(e){var t=e;Array.isArray(t)||(t=[t]);var n=this.getPlugins(t);return null==n||n.forEach((function(e){var t;null===(t=null==e?void 0:e.disable)||void 0===t||t.call(e)})),this}},{key:"isPluginEnabled",value:function(e){var t,n=this.getPlugin(e);return null===(t=null==n?void 0:n.isEnabled)||void 0===t?void 0:t.call(n)}},{key:"disposePlugins",value:function(e){var t=this,n=e;Array.isArray(n)||(n=[n]);var i=this.getPlugins(n);return null==i||i.forEach((function(e){e.dispose(),t.installedPlugins.delete(e)})),this}},{key:"dispose",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.model.dispose(),this.css.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.highlight.dispose(),this.background.dispose(),this.mousewheel.dispose(),this.panning.dispose(),this.view.dispose(),this.renderer.dispose(),this.installedPlugins.forEach((function(e){e.dispose()}))}}])}(Nn);Rc([Nn.dispose()],Vc.prototype,"dispose",null),function(e){e.View=oc,e.Renderer=Mc,e.MouseWheel=kc,e.DefsManager=Tc,e.GridManager=gc,e.CoordManager=Nc,e.TransformManager=dc,e.HighlightManager=Lc,e.BackgroundManager=pc,e.PanningManager=mc}(Vc||(Vc={})),function(e){e.toStringTag="X6.".concat(e.name),e.isGraph=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag];return null==n||n===e.toStringTag}}(Vc||(Vc={})),function(e){e.render=function(t,n){var i=t instanceof HTMLElement?new e({container:t}):new e(t);return null!=n&&i.fromJSON(n),i}}(Vc||(Vc={})),function(e){e.registerNode=Bu.registry.register,e.registerEdge=Fu.registry.register,e.registerView=Ws.registry.register,e.registerAttr=us.registry.register,e.registerGrid=No.registry.register,e.registerFilter=zo.registry.register,e.registerNodeTool=vl.registry.register,e.registerEdgeTool=pl.registry.register,e.registerBackground=jo.registry.register,e.registerHighlighter=ks.registry.register,e.registerPortLayout=Es.registry.register,e.registerPortLabelLayout=Is.registry.register,e.registerMarker=za.registry.register,e.registerRouter=mu.registry.register,e.registerConnector=Eu.registry.register,e.registerAnchor=Tl.registry.register,e.registerEdgeAnchor=Dl.registry.register,e.registerConnectionPoint=ql.registry.register}(Vc||(Vc={})),function(e){e.unregisterNode=Bu.registry.unregister,e.unregisterEdge=Fu.registry.unregister,e.unregisterView=Ws.registry.unregister,e.unregisterAttr=us.registry.unregister,e.unregisterGrid=No.registry.unregister,e.unregisterFilter=zo.registry.unregister,e.unregisterNodeTool=vl.registry.unregister,e.unregisterEdgeTool=pl.registry.unregister,e.unregisterBackground=jo.registry.unregister,e.unregisterHighlighter=ks.registry.unregister,e.unregisterPortLayout=Es.registry.unregister,e.unregisterPortLabelLayout=Is.registry.unregister,e.unregisterMarker=za.registry.unregister,e.unregisterRouter=mu.registry.unregister,e.unregisterConnector=Eu.registry.unregister,e.unregisterAnchor=Tl.registry.unregister,e.unregisterEdgeAnchor=Dl.registry.unregister,e.unregisterConnectionPoint=ql.registry.unregister}(Vc||(Vc={}));var Bc=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},zc=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Fc=function(e){function t(){return v(this,t),a(this,t,arguments)}return c(t,e),y(t)}(Bu);!function(e){var t=function(t){function i(){return v(this,i),a(this,i,arguments)}return c(i,t),y(i,[{key:"init",value:function(){n(i,"init",this,3)([]),this.cell.on("change:*",this.onCellChangeAny,this)}},{key:"onCellChangeAny",value:function(t){var n=t.key,i=e.shapeMaps[this.cell.shape];if(i){var r=i.effect;r&&!r.includes(n)||this.renderHTMLComponent()}}},{key:"confirmUpdate",value:function(e){var t=this,r=n(i,"confirmUpdate",this,3)([e]);return this.handleAction(r,i.action,(function(){return t.renderHTMLComponent()}))}},{key:"renderHTMLComponent",value:function(){var t=this.selectors&&this.selectors.foContent;if(t){Mi(t);var n=e.shapeMaps[this.cell.shape];if(!n)return;var i=n.html;"function"==typeof i&&(i=i(this.cell)),i&&("string"==typeof i?t.innerHTML=i:Si(t,i))}}},{key:"dispose",value:function(){this.cell.off("change:*",this.onCellChangeAny,this)}}])}(tc);Bc([t.dispose()],t.prototype,"dispose",null),e.View=t,function(e){e.action="html",e.config({bootstrap:[e.action],actions:{html:e.action}}),tc.registry.register("html-view",e,!0)}(t=e.View||(e.View={}))}(Fc||(Fc={})),function(e){e.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},Fs.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),Bu.registry.register("html",e,!0)}(Fc||(Fc={})),function(e){e.shapeMaps={},e.register=function(t){var n=t.shape,i=t.html,r=t.effect,o=t.inherit,a=zc(t,["shape","html","effect","inherit"]);if(!n)throw new Error("should specify shape in config");e.shapeMaps[n]={html:i,effect:r},Vc.registerNode(n,Object.assign({inherit:o||"html"},a),!0)}}(Fc||(Fc={}));var Gc={class:"jl-main-page h-full w-full"},qc={class:"list w-full"},Hc={class:"leftClass"},_c={class:"titClass"},Uc={key:0,class:"rightImg"},Wc={key:1,class:"rightImg1"},Jc={class:"rightClass"},Xc={class:"flex"},Yc={class:"flex"},Zc={class:"flex"},Kc={class:"flex"},Qc={class:"flex"},$c={class:"flex"},eh=["onClick"],th={key:1,class:"h-full w-full flex-center bg-#fff"},nh={class:"modal-footer"},ih={class:"footer"},rh={class:"ml-2% flex font-700 line-height-30px"},oh={class:"color-red"},ah={__name:"tabs-content",props:{processId:{type:[String,Number],default:function(){return null}}},setup:function(n){var i=n,r=re({endTime:null,id:""}),o=re(""),a=re([]);Ve("eap/KbEapData/selectIndexInTrace2").then((function(e){a.value=e.data,e.data.forEach((function(e){e.mainEqpId===o.value?r.value.id=e.id:r.value.id=""}))}));var s=re(i.processId),l=re(null);oe((function(){return i.processId}),(function(e){s.value=e,m()}));var u,c,h=ae.PRESENTED_IMAGE_SIMPLE,f=re(!1),g=re([]),d=re({}),v=se({current:1,pageSize:200,showSizeChanger:!0,pageSizeOptions:["50","100","180","300","500"],showQuickJumper:!0,showTotal:function(e){return"共".concat(e,"条")},total:0,onChange:(u=e().mark((function t(n,i){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v.current=n,v.pageSize=i,k(d.value.equipmentId);case 3:case"end":return e.stop()}}),t)})),c=function(){var e=this,n=arguments;return new Promise((function(i,r){var o=u.apply(e,n);function a(e){t(o,i,r,a,s,"next",e)}function s(e){t(o,i,r,a,s,"throw",e)}a(void 0)}))},function(e,t){return c.apply(this,arguments)})}),p=re(0),y=re(0);function m(){var e;p.value=0,y.value=0,g.value=[],(e={processId:s.value},ie({url:"/mes/readCode/getDevice",method:"get",params:e})).then((function(e){var t=e.error,n=e.data;t||(n.forEach((function(e,t){0==e.state&&(p.value+=1),1==e.state&&(y.value+=1)})),g.value=n)}))}m();var b=re([]);function k(e){f.value=!0;var t={pageNum:v.current,pageSize:v.pageSize,equipmentId:e};De(t).then((function(e){var t=e.data;e.error||(t.list.forEach((function(e,t){e.index=t+1,e.tableUuid=le.genV4().hexNoDelim})),v.total=t.total,b.value=t.list)})).finally((function(){f.value=!1}))}var x=re(!1),w=re("");var P=[{key:"dataIndex",dataIndex:"dataIndex",title:"序号",fixed:"left",width:70,align:"center",checked:!0,ellipsis:!0},{key:"mainEqpId",dataIndex:"mainEqpId",title:"设备id",align:"center",checked:!0,ellipsis:!0,fixed:"left"},{key:"mainEqpName",dataIndex:"mainEqpName",title:"设备名称",align:"center",checked:!0,ellipsis:!0},{key:"subEqpId",dataIndex:"subEqpId",title:"设备子Id",align:"center",checked:!0,ellipsis:!0},{key:"subEqpName",dataIndex:"subEqpName",title:"设备子名称",align:"center",checked:!0,ellipsis:!0},{key:"itemName",dataIndex:"itemName",title:"项目名称",align:"center",checked:!0,ellipsis:!0},{key:"itemValue",dataIndex:"itemValue",title:"项目值",align:"center",checked:!0,ellipsis:!0},{key:"dateTime",dataIndex:"dateTime",title:"时间",align:"center",checked:!0,ellipsis:!0,width:180}];window.$useModal({modalOption:{title:"配置参数列表",width:"1200px",height:"80vh",destroyOnClose:!0,cancelBtnText:"关闭",showConfirmBtn:!1},component:function(){return ue(Re,{searchParams:r.value,"onUpdate:searchParams":function(e){return r.value=e},column:P,"show-row-selection":!1,"auto-generate-uuid":!0,"is-pagination":!1,scroll:{y:"auto"},"is-init-get-data":!0,url:"eap/KbEapData/selectListByTimeInTrace2",class:"h-full w-full"},null)}});var C=re([{key:"index",dataIndex:"index",title:"序号",width:70,align:"center",checked:!0,ellipsis:!0},{key:"pnlId",dataIndex:"pnlId",title:"PNL码",align:"center",checked:!0,ellipsis:!0},{key:"trackType",dataIndex:"trackType",title:"动作类型",align:"center",checked:!0,ellipsis:!0,customRender:function(e){return{TRACKIN:"上机",TRACKOUT:"下机"}[e.record.trackType]||""}},{key:"sliceType",dataIndex:"sliceType",title:"片型",align:"center",checked:!0,ellipsis:!0},{key:"dateTime",dataIndex:"dateTime",title:"读码时间",align:"center",checked:!0,ellipsis:!0}]);return function(e,t){var n=Pe,i=Ce,r=ae,a=ce("STable"),s=Ae;return he(),fe("div",Gc,[ge("div",qc,[g.value.length?(he(),de(i,{key:0,gutter:16,class:"w-full"},{default:ve((function(){return[(he(!0),fe(pe,null,ye(g.value,(function(e,i){return he(),de(n,{key:i,lg:12,xl:8,xxl:6},{default:ve((function(){return[ge("div",{class:"listClass",style:me({border:0===e.state?"0px":"1px solid red"})},[ge("div",Hc,[ge("div",_c,be(i+1),1),0==e.state?(he(),fe("div",Uc)):ke("",!0),1==e.state?(he(),fe("div",Wc)):ke("",!0)]),ge("div",Jc,[ge("div",Xc,[t[2]||(t[2]=ge("p",{class:"text-size-14px color-#333 font-800"},"名称:",-1)),ge("p",null,be(e.description),1)]),ge("div",Yc,[t[3]||(t[3]=ge("p",{class:"color-#333 font-800"},"代码:",-1)),ge("p",null,be(e.equipmentId),1)]),ge("div",Zc,[t[4]||(t[4]=ge("p",{class:"color-#333 font-800"},"状态:",-1)),ge("p",null,be(0==e.state?"正常":"异常"),1)]),ge("div",Kc,[t[5]||(t[5]=ge("p",{class:"color-#333 color-#333 font-800"},"最近连接时间:",-1)),ge("p",null,be(e.recentConnectionTime),1)]),ge("div",Qc,[t[6]||(t[6]=ge("p",{class:"color-#333 color-#333 font-800"},"设备地址:",-1)),ge("p",null,be(e.locationId),1)]),ge("div",$c,[ge("a",{class:"color-#646cff",onClick:function(t){return n=e,o.value=n.equipmentId,n.equipmentId=o.value,l.value=n.description,v.current=1,v.pageSize=200,d.value=n,b.value=[],w.value="".concat(d.value.description,"信息"),f.value=!0,k(d.value.equipmentId),void(x.value=!0);var n}},"查看读码信息",8,eh)])])],4)]})),_:2},1024)})),128))]})),_:1})):(he(),fe("div",th,[ue(r,{image:xe(h)},null,8,["image"])])),ue(Ie,{visible:x.value,"onUpdate:visible":t[1]||(t[1]=function(e){return x.value=e}),"destroy-on-close":!0,centered:!0,title:w.value,width:"950px",height:"650px"},{footer:ve((function(){return[ge("div",nh,[ue(s,{onClick:t[0]||(t[0]=function(e){return x.value=!1})},{default:ve((function(){return t[7]||(t[7]=[we("关闭")])})),_:1})])]})),default:ve((function(){return[ue(a,{columns:C.value,"data-source":b.value,size:"small",loading:f.value,bordered:"","row-key":"tableUuid","default-expand-all-rows":!0,pagination:v,class:"h-full","row-height":23},null,8,["columns","data-source","loading","pagination"])]})),_:1},8,["visible","title"])]),ge("div",ih,[ge("div",rh,[t[8]||(t[8]=ge("div",{class:"color-red"},"红色边框",-1)),t[9]||(t[9]=we(" 为异常状态 设备共 ")),ge("u",null,be(p.value+y.value),1),t[10]||(t[10]=we(" 个 正常设备 ")),ge("u",null,be(p.value),1),t[11]||(t[11]=we(" 个 异常设备 ")),ge("div",oh,[ge("u",null,be(y.value),1)]),t[12]||(t[12]=we(" 个 "))])])])}}},sh=Oe(ah,[["__scopeId","data-v-33740749"]]),lh=[{label:"材料信息",id:le.genV4().hexNoDelim,state:0},{label:"开料",id:le.genV4().hexNoDelim,state:0},{label:"圆角",id:le.genV4().hexNoDelim,state:0},{label:"磨边",id:le.genV4().hexNoDelim,state:0},{label:"内层前处理",id:le.genV4().hexNoDelim,state:0},{label:"涂布",id:le.genV4().hexNoDelim,state:0},{label:"内层曝光",id:le.genV4().hexNoDelim,state:4},{label:"内层蚀刻",id:le.genV4().hexNoDelim,state:3},{label:"AOI",id:le.genV4().hexNoDelim,state:3},{label:"VRS",id:le.genV4().hexNoDelim,state:3},{label:"OPE冲孔",id:le.genV4().hexNoDelim,state:0},{label:"棕化",id:le.genV4().hexNoDelim,state:3},{label:"PP裁切",id:le.genV4().hexNoDelim,state:0},{label:"热熔",id:le.genV4().hexNoDelim,state:3},{label:"叠板",id:le.genV4().hexNoDelim,state:0},{label:"压合",id:le.genV4().hexNoDelim,state:1},{label:"裁磨",id:le.genV4().hexNoDelim,state:0},{label:"X-RAY钻码",id:le.genV4().hexNoDelim,state:2},{label:"上PIN",id:le.genV4().hexNoDelim,state:3},{label:"钻孔",id:le.genV4().hexNoDelim,state:1,hasIPQC:!0,textColor:"green"},{label:"退PIN",id:le.genV4().hexNoDelim,state:3},{label:"黑影",id:le.genV4().hexNoDelim,state:1,hasIPQC:!0,textColor:"green"},{label:"VCP",id:le.genV4().hexNoDelim,state:1,hasIPQC:!0,textColor:"green"},{label:"外层前处理",id:le.genV4().hexNoDelim,state:3},{label:"外层曝光",id:le.genV4().hexNoDelim,state:3},{label:"显影",id:le.genV4().hexNoDelim,state:3},{label:"外层蚀刻",id:le.genV4().hexNoDelim,state:3},{label:"外层AOI",id:le.genV4().hexNoDelim,state:3},{label:"VRS",id:le.genV4().hexNoDelim,state:0},{label:"阻焊前处理",id:le.genV4().hexNoDelim,state:3},{label:"丝印",id:le.genV4().hexNoDelim,state:3},{label:"预烤",id:le.genV4().hexNoDelim,state:0},{label:"防焊曝光",id:le.genV4().hexNoDelim,state:3},{label:"显影",id:le.genV4().hexNoDelim,state:3},{label:"文字",id:le.genV4().hexNoDelim,state:4,hasIPQC:!0},{label:"后固化",id:le.genV4().hexNoDelim,state:4},{label:"表前处理",id:le.genV4().hexNoDelim,state:3},{type:"custom-node",id:le.genV4().hexNoDelim,state:3,yCount:60,children:[{id:le.genV4().hexNoDelim,label:"沉金",hasIPQC:!0,state:3},{id:le.genV4().hexNoDelim,label:"喷锡",hasIPQC:!0,state:3}]},{label:"后处理",id:le.genV4().hexNoDelim,state:3},{label:"镭雕",id:le.genV4().hexNoDelim,state:4},{label:"大V-CUT",id:le.genV4().hexNoDelim,hasIPQC:!0,state:0},{label:"成型",id:le.genV4().hexNoDelim,hasIPQC:!0,state:0},{label:"小板V-CUT",id:le.genV4().hexNoDelim,hasIPQC:!0,state:0},{label:"清洗",id:le.genV4().hexNoDelim,state:0},{label:"电测",id:le.genV4().hexNoDelim,state:3},{label:"AVI",id:le.genV4().hexNoDelim,state:3},{type:"custom-node",id:le.genV4().hexNoDelim,yCount:56,children:[{id:le.genV4().hexNoDelim,label:"金板清洗",state:0},{id:le.genV4().hexNoDelim,label:"离子清洗",state:0},{id:le.genV4().hexNoDelim,label:"OSP",state:0},{id:le.genV4().hexNoDelim,label:"化锡",state:0}]},{label:"包装",id:le.genV4().hexNoDelim,state:0}],uh={class:"read-graph-page h-full w-full p-5px"},ch={class:"h-full w-full"},hh=180,fh=Object.assign({name:"trace_read-the-dock"},{__name:"index",setup:function(e){var t=re(null),n=re("graph"),i=re(null),r={0:"rgb(173,185,202)",1:"red",2:"rgb(255,220,0)",3:"rgb(234,234,16)",4:"green"};var o=re(null);var a=[];function s(){ie({url:"mes/readCode/getProcess",method:"get"}).then((function(e){var t=e.data;e.error||(a=t,lh.forEach((function(e,t){var n,o=Math.floor(t/8),a=t%8;if(n=o%2==0?a*hh:1440-hh*(a+1),e.type){var s=i.value.addNode({id:e.id,x:n,y:91*o,width:130,height:55*e.children.length,zIndex:1,attrs:{body:{stroke:"rgb(15,180,240)",fill:"transparent"}}});e.children.forEach((function(t,a){t.processId=l(t);var u=i.value.addNode({id:t.id,shape:"rect",x:n+5,y:92*o-a*-e.yCount,width:120,height:40,label:t.label,attrs:{body:{stroke:"rgb(15,180,240)",strokeWidth:1,fill:r[t.state],rx:6,ry:6,cursor:"pointer"},label:{fill:t.textColor||"#000",fontSize:14,fontWeight:"bold",cursor:"pointer"}}});s.addChild(u)}))}else e.processId=l(e),i.value.addNode({id:e.id,shape:"rect",x:n,y:100*o,width:120,height:40,label:e.label,attrs:{body:{stroke:"rgb(15,180,240)",strokeWidth:1,fill:r[e.state],rx:6,ry:6,cursor:"pointer"},label:{fill:e.textColor||"#000",fontSize:14,fontWeight:"bold",cursor:"pointer"}}});lh.length!==t+1&&i.value.addEdge({shape:"edge",source:e.id,target:lh[t+1].id,connector:{name:"smooth"},attrs:{line:{stroke:"rgb(36,124,254)",strokeWidth:2,strokeDasharray:5,targetMarker:"classic"}}})})),i.value.centerContent())}))}function l(e){var t;return(null===(t=a.find((function(t){return t.processName.toUpperCase()===e.label})))||void 0===t?void 0:t.id)||null}return Ee((function(){i.value=new Vc({container:t.value,panning:{enabled:!0,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!0},background:{color:"#F2F7FA"},translating:{restrict:function(e){var t=e.cell;if(t.isNode()){var n=t.getParent();if(n)return n.getBBox()}return null}}}),i.value.on("node:click",(function(e){var t,i,r=e.node,a=(null==r||null===(t=r._parent)||void 0===t?void 0:t.id)||r.id,s=lh.find((function(e){return e.id===a})),l=null;(l=null!=s&&null!==(i=s.children)&&void 0!==i&&i.length?s.children.find((function(e){return e.id===r.id})):s).processId?(o.value=l,n.value="list"):window.$message.warning("该制程暂无读码设备信息!")})),s()})),function(e,i){var r=Me,a=Se;return he(),fe("div",uh,[ue(a,{activeKey:n.value,"onUpdate:activeKey":i[0]||(i[0]=function(e){return n.value=e}),type:"card",animated:""},{default:ve((function(){var e;return[ue(r,{key:"graph",tab:"工序流程图"},{default:ve((function(){return[ge("div",ch,[ge("div",{ref_key:"containerRef",ref:t,class:"w-full container"},null,512),i[1]||(i[1]=ge("div",{class:"footer flex pl-15px pr-15px"},[ge("div",{class:"footer-item flex flex-center"},[ge("div",{class:"mr-5px"},"说明:"),ge("div",{class:"label flex flex-center"},[ge("div",{class:"mr-5px h30px w-50px bg-#FF0000"}),we(" 重要制程 ")])]),ge("div",{class:"footer-item ml-20px flex flex-center"},[ge("div",{class:"mr-5px"},"钻码:"),ge("div",{class:"label flex flex-center"},[ge("div",{class:"mr-5px h30px w-50px bg-#FFC000"})])]),ge("div",{class:"footer-item ml-20px flex flex-center"},[ge("div",{class:"mr-5px"},"读码:"),ge("div",{class:"label flex flex-center"},[ge("div",{class:"mr-5px h30px w-50px bg-#EAEA10"})])]),ge("div",{class:"footer-item ml-20px flex flex-center"},[ge("div",{class:"mr-5px"},"打码:"),ge("div",{class:"label flex flex-center"},[ge("div",{class:"mr-5px h30px w-50px bg-#008000"})])])],-1))])]})),_:1}),ue(r,{key:"list",tab:"".concat((null===(e=o.value)||void 0===e?void 0:e.label)||"","读码设备信息"),disabled:!o.value},{default:ve((function(){var e;return[ue(sh,{"process-id":null===(e=o.value)||void 0===e?void 0:e.processId},null,8,["process-id"])]})),_:1},8,["tab","disabled"]),ue(r,{key:"listCollect",tab:"读码设备信息汇总"},{default:ve((function(){return[ue(sh)]})),_:1})]})),_:1},8,["activeKey"])])}}});i("default",Oe(fh,[["__scopeId","data-v-1908b2b6"]]))}}}))}();
